<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuring - </title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">
                    <a href="/">Rails Kılavuzları</a>
                </h1>
                <nav class="nav">
                    <a href="/">Ana Sayfa</a>
                    <a href="https://dilankaya127.github.io">Portföy</a>
                    <a href="https://github.com/dilankaya127/rails-tr-TR">GitHub</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="guide-container">
    <aside class="guide-sidebar">
        <div class="guide-toc">
            <h3>İçindekiler</h3>
            <div id="toc"></div>
        </div>
        
        <div class="guide-nav">
            <h3>Diğer Kılavuzlar</h3>
            <ul>
                <li><a href="/rails-tr-TR/guides/tr/getting_started">Rails ile Başlarken</a></li>
                <li><a href="/rails-tr-TR/guides/en/active_record_basics">Active Record Temelleri</a></li>
                <li><a href="/rails-tr-TR/guides//en/action_controller_overview">Action Controller</a></li>
                <li><a href="/rails-tr-TR/guides/tr/action_cable_overview">Action Cable</a></li>
            </ul>
        </div>
    </aside>

    <article class="guide-content">
        <header class="guide-header">
            <h1>Configuring</h1>
            
        </header>

        <div class="guide-body">
            <p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1 id="configuring-rails-applications">Configuring Rails Applications</h1>

<p>This guide covers the configuration and initialization features available to Rails applications.</p>

<p>After reading this guide, you will know:</p>

<ul>
  <li>How to adjust the behavior of your Rails applications.</li>
  <li>How to add additional code to be run at application start time.</li>
</ul>

<hr />

<h2 id="locations-for-initialization-code">Locations for Initialization Code</h2>

<p>Rails offers four standard spots to place initialization code:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">config/application.rb</code></li>
  <li>Environment-specific configuration files</li>
  <li>Initializers</li>
  <li>After-initializers</li>
</ul>

<h2 id="running-code-before-rails">Running Code Before Rails</h2>

<p>In the rare event that your application needs to run some code before Rails itself is loaded, put it above the call to <code class="language-plaintext highlighter-rouge">require "rails/all"</code> in <code class="language-plaintext highlighter-rouge">config/application.rb</code>.</p>

<h2 id="configuring-rails-components">Configuring Rails Components</h2>

<p>In general, the work of configuring Rails means configuring the components of Rails, as well as configuring Rails itself. The configuration file <code class="language-plaintext highlighter-rouge">config/application.rb</code> and environment-specific configuration files (such as <code class="language-plaintext highlighter-rouge">config/environments/production.rb</code>) allow you to specify the various settings that you want to pass down to all of the components.</p>

<p>For example, you could add this setting to <code class="language-plaintext highlighter-rouge">config/application.rb</code> file:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">time_zone</span> <span class="o">=</span> <span class="s2">"Central Time (US &amp; Canada)"</span>
</code></pre></div></div>

<p>This is a setting for Rails itself. If you want to pass settings to individual Rails components, you can do so via the same <code class="language-plaintext highlighter-rouge">config</code> object in <code class="language-plaintext highlighter-rouge">config/application.rb</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">schema_format</span> <span class="o">=</span> <span class="ss">:ruby</span>
</code></pre></div></div>

<p>Rails will use that particular setting to configure Active Record.</p>

<p>WARNING: Use the public configuration methods over calling directly to the associated class. e.g. <code class="language-plaintext highlighter-rouge">Rails.application.config.action_mailer.options</code> instead of <code class="language-plaintext highlighter-rouge">ActionMailer::Base.options</code>.</p>

<p>NOTE: If you need to apply configuration directly to a class, use a <a href="https://api.rubyonrails.org/classes/ActiveSupport/LazyLoadHooks.html">lazy load hook</a> in an initializer to avoid autoloading the class before initialization has completed. This will break because autoloading during initialization cannot be safely repeated when the app reloads.</p>

<h3 id="versioned-default-values">Versioned Default Values</h3>

<p><a href="https://api.rubyonrails.org/classes/Rails/Application/Configuration.html#method-i-load_defaults"><code class="language-plaintext highlighter-rouge">config.load_defaults</code></a> loads default configuration values for a target version and all versions prior. For example, <code class="language-plaintext highlighter-rouge">config.load_defaults 6.1</code> will load defaults for all versions up to and including version 6.1.</p>

<p>Below are the default values associated with each target version. In cases of conflicting values, newer versions take precedence over older versions.</p>

<h4 id="default-values-for-target-version-81">Default Values for Target Version 8.1</h4>

<ul>
  <li><a href="#config-action-controller-escape-json-responses"><code class="language-plaintext highlighter-rouge">config.action_controller.escape_json_responses</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li><a href="#config-yjit"><code class="language-plaintext highlighter-rouge">config.yjit</code></a>: <code class="language-plaintext highlighter-rouge">!Rails.env.local?</code></li>
</ul>

<h4 id="default-values-for-target-version-80">Default Values for Target Version 8.0</h4>

<ul>
  <li><a href="#regexp-timeout"><code class="language-plaintext highlighter-rouge">Regexp.timeout</code></a>: <code class="language-plaintext highlighter-rouge">1</code></li>
  <li><a href="#config-action-dispatch-strict-freshness"><code class="language-plaintext highlighter-rouge">config.action_dispatch.strict_freshness</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-support-to-time-preserves-timezone"><code class="language-plaintext highlighter-rouge">config.active_support.to_time_preserves_timezone</code></a>: <code class="language-plaintext highlighter-rouge">:zone</code></li>
</ul>

<h4 id="default-values-for-target-version-72">Default Values for Target Version 7.2</h4>

<ul>
  <li><a href="#config-active-record-postgresql-adapter-decode-dates"><code class="language-plaintext highlighter-rouge">config.active_record.postgresql_adapter_decode_dates</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-record-validate-migration-timestamps"><code class="language-plaintext highlighter-rouge">config.active_record.validate_migration_timestamps</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-storage-web-image-content-types"><code class="language-plaintext highlighter-rouge">config.active_storage.web_image_content_types</code></a>: <code class="language-plaintext highlighter-rouge">%w( image/png image/jpeg image/gif image/webp )</code></li>
  <li><a href="#config-yjit"><code class="language-plaintext highlighter-rouge">config.yjit</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
</ul>

<h4 id="default-values-for-target-version-71">Default Values for Target Version 7.1</h4>

<ul>
  <li><a href="#config-action-dispatch-debug-exception-log-level"><code class="language-plaintext highlighter-rouge">config.action_dispatch.debug_exception_log_level</code></a>: <code class="language-plaintext highlighter-rouge">:error</code></li>
  <li><a href="#config-action-dispatch-default-headers"><code class="language-plaintext highlighter-rouge">config.action_dispatch.default_headers</code></a>: <code class="language-plaintext highlighter-rouge">{ "X-Frame-Options" =&gt; "SAMEORIGIN", "X-XSS-Protection" =&gt; "0", "X-Content-Type-Options" =&gt; "nosniff", "X-Permitted-Cross-Domain-Policies" =&gt; "none", "Referrer-Policy" =&gt; "strict-origin-when-cross-origin" }</code></li>
  <li><a href="#config-action-text-sanitizer-vendor"><code class="language-plaintext highlighter-rouge">config.action_text.sanitizer_vendor</code></a>: <code class="language-plaintext highlighter-rouge">Rails::HTML::Sanitizer.best_supported_vendor</code></li>
  <li><a href="#config-action-view-sanitizer-vendor"><code class="language-plaintext highlighter-rouge">config.action_view.sanitizer_vendor</code></a>: <code class="language-plaintext highlighter-rouge">Rails::HTML::Sanitizer.best_supported_vendor</code></li>
  <li><a href="#config-active-record-before-committed-on-all-records"><code class="language-plaintext highlighter-rouge">config.active_record.before_committed_on_all_records</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-record-belongs-to-required-validates-foreign-key"><code class="language-plaintext highlighter-rouge">config.active_record.belongs_to_required_validates_foreign_key</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li><a href="#config-active-record-default-column-serializer"><code class="language-plaintext highlighter-rouge">config.active_record.default_column_serializer</code></a>: <code class="language-plaintext highlighter-rouge">nil</code></li>
  <li><a href="#config-active-record-encryption-hash-digest-class"><code class="language-plaintext highlighter-rouge">config.active_record.encryption.hash_digest_class</code></a>: <code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA256</code></li>
  <li><a href="#config-active-record-encryption-support-sha1-for-non-deterministic-encryption"><code class="language-plaintext highlighter-rouge">config.active_record.encryption.support_sha1_for_non_deterministic_encryption</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li><a href="#config-active-record-generate-secure-token-on"><code class="language-plaintext highlighter-rouge">config.active_record.generate_secure_token_on</code></a>: <code class="language-plaintext highlighter-rouge">:initialize</code></li>
  <li><a href="#config-active-record-marshalling-format-version"><code class="language-plaintext highlighter-rouge">config.active_record.marshalling_format_version</code></a>: <code class="language-plaintext highlighter-rouge">7.1</code></li>
  <li><a href="#config-active-record-query-log-tags-format"><code class="language-plaintext highlighter-rouge">config.active_record.query_log_tags_format</code></a>: <code class="language-plaintext highlighter-rouge">:sqlcommenter</code></li>
  <li><a href="#config-active-record-raise-on-assign-to-attr-readonly"><code class="language-plaintext highlighter-rouge">config.active_record.raise_on_assign_to_attr_readonly</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-record-run-after-transaction-callbacks-in-order-defined"><code class="language-plaintext highlighter-rouge">config.active_record.run_after_transaction_callbacks_in_order_defined</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-record-run-commit-callbacks-on-first-saved-instances-in-transaction"><code class="language-plaintext highlighter-rouge">config.active_record.run_commit_callbacks_on_first_saved_instances_in_transaction</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li><a href="#config-active-record-sqlite3-adapter-strict-strings-by-default"><code class="language-plaintext highlighter-rouge">config.active_record.sqlite3_adapter_strict_strings_by_default</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-support-cache-format-version"><code class="language-plaintext highlighter-rouge">config.active_support.cache_format_version</code></a>: <code class="language-plaintext highlighter-rouge">7.1</code></li>
  <li><a href="#config-active-support-message-serializer"><code class="language-plaintext highlighter-rouge">config.active_support.message_serializer</code></a>: <code class="language-plaintext highlighter-rouge">:json_allow_marshal</code></li>
  <li><a href="#config-active-support-raise-on-invalid-cache-expiration-time"><code class="language-plaintext highlighter-rouge">config.active_support.raise_on_invalid_cache_expiration_time</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-support-use-message-serializer-for-metadata"><code class="language-plaintext highlighter-rouge">config.active_support.use_message_serializer_for_metadata</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-add-autoload-paths-to-load-path"><code class="language-plaintext highlighter-rouge">config.add_autoload_paths_to_load_path</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li><a href="#config-dom-testing-default-html-version"><code class="language-plaintext highlighter-rouge">config.dom_testing_default_html_version</code></a>: <code class="language-plaintext highlighter-rouge">defined?(Nokogiri::HTML5) ? :html5 : :html4</code></li>
  <li><a href="#config-log-file-size"><code class="language-plaintext highlighter-rouge">config.log_file_size</code></a>: <code class="language-plaintext highlighter-rouge">100 * 1024 * 1024</code></li>
  <li><a href="#config-precompile-filter-parameters"><code class="language-plaintext highlighter-rouge">config.precompile_filter_parameters</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
</ul>

<h4 id="default-values-for-target-version-70">Default Values for Target Version 7.0</h4>

<ul>
  <li><a href="#config-action-controller-raise-on-open-redirects"><code class="language-plaintext highlighter-rouge">config.action_controller.raise_on_open_redirects</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-action-controller-wrap-parameters-by-default"><code class="language-plaintext highlighter-rouge">config.action_controller.wrap_parameters_by_default</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-action-dispatch-cookies-serializer"><code class="language-plaintext highlighter-rouge">config.action_dispatch.cookies_serializer</code></a>: <code class="language-plaintext highlighter-rouge">:json</code></li>
  <li><a href="#config-action-dispatch-default-headers"><code class="language-plaintext highlighter-rouge">config.action_dispatch.default_headers</code></a>: <code class="language-plaintext highlighter-rouge">{ "X-Frame-Options" =&gt; "SAMEORIGIN", "X-XSS-Protection" =&gt; "0", "X-Content-Type-Options" =&gt; "nosniff", "X-Download-Options" =&gt; "noopen", "X-Permitted-Cross-Domain-Policies" =&gt; "none", "Referrer-Policy" =&gt; "strict-origin-when-cross-origin" }</code></li>
  <li><a href="#config-action-mailer-smtp-timeout"><code class="language-plaintext highlighter-rouge">config.action_mailer.smtp_timeout</code></a>: <code class="language-plaintext highlighter-rouge">5</code></li>
  <li><a href="#config-action-view-apply-stylesheet-media-default"><code class="language-plaintext highlighter-rouge">config.action_view.apply_stylesheet_media_default</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li><a href="#config-action-view-button-to-generates-button-tag"><code class="language-plaintext highlighter-rouge">config.action_view.button_to_generates_button_tag</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-record-automatic-scope-inversing"><code class="language-plaintext highlighter-rouge">config.active_record.automatic_scope_inversing</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-record-partial-inserts"><code class="language-plaintext highlighter-rouge">config.active_record.partial_inserts</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li><a href="#config-active-record-verify-foreign-keys-for-fixtures"><code class="language-plaintext highlighter-rouge">config.active_record.verify_foreign_keys_for_fixtures</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-storage-multiple-file-field-include-hidden"><code class="language-plaintext highlighter-rouge">config.active_storage.multiple_file_field_include_hidden</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-storage-variant-processor"><code class="language-plaintext highlighter-rouge">config.active_storage.variant_processor</code></a>: <code class="language-plaintext highlighter-rouge">:vips</code></li>
  <li><a href="#config-active-storage-video-preview-arguments"><code class="language-plaintext highlighter-rouge">config.active_storage.video_preview_arguments</code></a>: <code class="language-plaintext highlighter-rouge">"-vf 'select=eq(n\\,0)+eq(key\\,1)+gt(scene\\,0.015),loop=loop=-1:size=2,trim=start_frame=1' -frames:v 1 -f image2"</code></li>
  <li><a href="#config-active-support-cache-format-version"><code class="language-plaintext highlighter-rouge">config.active_support.cache_format_version</code></a>: <code class="language-plaintext highlighter-rouge">7.0</code></li>
  <li><a href="#config-active-support-executor-around-test-case"><code class="language-plaintext highlighter-rouge">config.active_support.executor_around_test_case</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-support-hash-digest-class"><code class="language-plaintext highlighter-rouge">config.active_support.hash_digest_class</code></a>: <code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA256</code></li>
  <li><a href="#config-active-support-key-generator-hash-digest-class"><code class="language-plaintext highlighter-rouge">config.active_support.key_generator_hash_digest_class</code></a>: <code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA256</code></li>
</ul>

<h4 id="default-values-for-target-version-61">Default Values for Target Version 6.1</h4>

<ul>
  <li><a href="#activesupport-utc-to-local-returns-utc-offset-times"><code class="language-plaintext highlighter-rouge">ActiveSupport.utc_to_local_returns_utc_offset_times</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-action-dispatch-cookies-same-site-protection"><code class="language-plaintext highlighter-rouge">config.action_dispatch.cookies_same_site_protection</code></a>: <code class="language-plaintext highlighter-rouge">:lax</code></li>
  <li><a href="#config-action-dispatch-ssl-default-redirect-status"><code class="language-plaintext highlighter-rouge">config.action_dispatch.ssl_default_redirect_status</code></a>: <code class="language-plaintext highlighter-rouge">308</code></li>
  <li><a href="#config-action-mailbox-queues-incineration"><code class="language-plaintext highlighter-rouge">config.action_mailbox.queues.incineration</code></a>: <code class="language-plaintext highlighter-rouge">nil</code></li>
  <li><a href="#config-action-mailbox-queues-routing"><code class="language-plaintext highlighter-rouge">config.action_mailbox.queues.routing</code></a>: <code class="language-plaintext highlighter-rouge">nil</code></li>
  <li><a href="#config-action-mailer-deliver-later-queue-name"><code class="language-plaintext highlighter-rouge">config.action_mailer.deliver_later_queue_name</code></a>: <code class="language-plaintext highlighter-rouge">nil</code></li>
  <li><a href="#config-action-view-form-with-generates-remote-forms"><code class="language-plaintext highlighter-rouge">config.action_view.form_with_generates_remote_forms</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li><a href="#config-action-view-preload-links-header"><code class="language-plaintext highlighter-rouge">config.action_view.preload_links_header</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-job-retry-jitter"><code class="language-plaintext highlighter-rouge">config.active_job.retry_jitter</code></a>: <code class="language-plaintext highlighter-rouge">0.15</code></li>
  <li><a href="#config-active-record-has-many-inversing"><code class="language-plaintext highlighter-rouge">config.active_record.has_many_inversing</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-storage-queues-analysis"><code class="language-plaintext highlighter-rouge">config.active_storage.queues.analysis</code></a>: <code class="language-plaintext highlighter-rouge">nil</code></li>
  <li><a href="#config-active-storage-queues-purge"><code class="language-plaintext highlighter-rouge">config.active_storage.queues.purge</code></a>: <code class="language-plaintext highlighter-rouge">nil</code></li>
  <li><a href="#config-active-storage-track-variants"><code class="language-plaintext highlighter-rouge">config.active_storage.track_variants</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
</ul>

<h4 id="default-values-for-target-version-60">Default Values for Target Version 6.0</h4>

<ul>
  <li><a href="#config-action-dispatch-use-cookies-with-metadata"><code class="language-plaintext highlighter-rouge">config.action_dispatch.use_cookies_with_metadata</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-action-mailer-delivery-job"><code class="language-plaintext highlighter-rouge">config.action_mailer.delivery_job</code></a>: <code class="language-plaintext highlighter-rouge">"ActionMailer::MailDeliveryJob"</code></li>
  <li><a href="#config-action-view-default-enforce-utf8"><code class="language-plaintext highlighter-rouge">config.action_view.default_enforce_utf8</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
  <li><a href="#config-active-record-collection-cache-versioning"><code class="language-plaintext highlighter-rouge">config.active_record.collection_cache_versioning</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-storage-queues-analysis"><code class="language-plaintext highlighter-rouge">config.active_storage.queues.analysis</code></a>: <code class="language-plaintext highlighter-rouge">:active_storage_analysis</code></li>
  <li><a href="#config-active-storage-queues-purge"><code class="language-plaintext highlighter-rouge">config.active_storage.queues.purge</code></a>: <code class="language-plaintext highlighter-rouge">:active_storage_purge</code></li>
</ul>

<h4 id="default-values-for-target-version-52">Default Values for Target Version 5.2</h4>

<ul>
  <li><a href="#config-action-controller-default-protect-from-forgery"><code class="language-plaintext highlighter-rouge">config.action_controller.default_protect_from_forgery</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-action-dispatch-use-authenticated-cookie-encryption"><code class="language-plaintext highlighter-rouge">config.action_dispatch.use_authenticated_cookie_encryption</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-action-view-form-with-generates-ids"><code class="language-plaintext highlighter-rouge">config.action_view.form_with_generates_ids</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-record-cache-versioning"><code class="language-plaintext highlighter-rouge">config.active_record.cache_versioning</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-support-hash-digest-class"><code class="language-plaintext highlighter-rouge">config.active_support.hash_digest_class</code></a>: <code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA1</code></li>
  <li><a href="#config-active-support-use-authenticated-message-encryption"><code class="language-plaintext highlighter-rouge">config.active_support.use_authenticated_message_encryption</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
</ul>

<h4 id="default-values-for-target-version-51">Default Values for Target Version 5.1</h4>

<ul>
  <li><a href="#config-action-view-form-with-generates-remote-forms"><code class="language-plaintext highlighter-rouge">config.action_view.form_with_generates_remote_forms</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-assets-unknown-asset-fallback"><code class="language-plaintext highlighter-rouge">config.assets.unknown_asset_fallback</code></a>: <code class="language-plaintext highlighter-rouge">false</code></li>
</ul>

<h4 id="default-values-for-target-version-50">Default Values for Target Version 5.0</h4>

<ul>
  <li><a href="#config-action-controller-forgery-protection-origin-check"><code class="language-plaintext highlighter-rouge">config.action_controller.forgery_protection_origin_check</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-action-controller-per-form-csrf-tokens"><code class="language-plaintext highlighter-rouge">config.action_controller.per_form_csrf_tokens</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-record-belongs-to-required-by-default"><code class="language-plaintext highlighter-rouge">config.active_record.belongs_to_required_by_default</code></a>: <code class="language-plaintext highlighter-rouge">true</code></li>
  <li><a href="#config-active-support-to-time-preserves-timezone"><code class="language-plaintext highlighter-rouge">config.active_support.to_time_preserves_timezone</code></a>: <code class="language-plaintext highlighter-rouge">:offset</code></li>
  <li><a href="#config-ssl-options"><code class="language-plaintext highlighter-rouge">config.ssl_options</code></a>: <code class="language-plaintext highlighter-rouge">{ hsts: { subdomains: true } }</code></li>
</ul>

<h3 id="rails-general-configuration">Rails General Configuration</h3>

<p>The following configuration methods are to be called on a <code class="language-plaintext highlighter-rouge">Rails::Railtie</code> object, such as a subclass of <code class="language-plaintext highlighter-rouge">Rails::Engine</code> or <code class="language-plaintext highlighter-rouge">Rails::Application</code>.</p>

<h4 id="configadd_autoload_paths_to_load_path"><code class="language-plaintext highlighter-rouge">config.add_autoload_paths_to_load_path</code></h4>

<p>Says whether autoload paths have to be added to <code class="language-plaintext highlighter-rouge">$LOAD_PATH</code>. It is recommended to be set to <code class="language-plaintext highlighter-rouge">false</code> in <code class="language-plaintext highlighter-rouge">:zeitwerk</code> mode early, in <code class="language-plaintext highlighter-rouge">config/application.rb</code>. Zeitwerk uses absolute paths internally, and applications running in <code class="language-plaintext highlighter-rouge">:zeitwerk</code> mode do not need <code class="language-plaintext highlighter-rouge">require_dependency</code>, so models, controllers, jobs, etc. do not need to be in <code class="language-plaintext highlighter-rouge">$LOAD_PATH</code>. Setting this to <code class="language-plaintext highlighter-rouge">false</code> saves Ruby from checking these directories when resolving <code class="language-plaintext highlighter-rouge">require</code> calls with relative paths, and saves Bootsnap work and RAM, since it does not need to build an index for them.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<p>The <code class="language-plaintext highlighter-rouge">lib</code> directory is not affected by this flag, it is added to <code class="language-plaintext highlighter-rouge">$LOAD_PATH</code> always.</p>

<h4 id="configafter_initialize"><code class="language-plaintext highlighter-rouge">config.after_initialize</code></h4>

<p>Takes a block which will be run <em>after</em> Rails has finished initializing the application. That includes the initialization of the framework itself, engines, and all the application’s initializers in <code class="language-plaintext highlighter-rouge">config/initializers</code>. Note that this block <em>will</em> be run for rake tasks. Useful for configuring values set up by other initializers:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">after_initialize</span> <span class="k">do</span>
  <span class="no">ActionView</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">sanitized_allowed_tags</span><span class="p">.</span><span class="nf">delete</span> <span class="s2">"div"</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="configafter_routes_loaded"><code class="language-plaintext highlighter-rouge">config.after_routes_loaded</code></h4>

<p>Takes a block which will be run after Rails has finished loading the application routes. This block will also be run whenever routes are reloaded.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">after_routes_loaded</span> <span class="k">do</span>
  <span class="c1"># Code that does something with Rails.application.routes</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="configallow_concurrency"><code class="language-plaintext highlighter-rouge">config.allow_concurrency</code></h4>

<p>Controls whether requests should be handled concurrently. This should only
be set to <code class="language-plaintext highlighter-rouge">false</code> if application code is not thread safe. Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configasset_host"><code class="language-plaintext highlighter-rouge">config.asset_host</code></h4>

<p>Sets the host for the assets. Useful when CDNs are used for hosting assets, or when you want to work around the concurrency constraints built-in in browsers using different domain aliases. Shorter version of <code class="language-plaintext highlighter-rouge">config.action_controller.asset_host</code>.</p>

<h4 id="configassume_ssl"><code class="language-plaintext highlighter-rouge">config.assume_ssl</code></h4>

<p>Makes application believe that all requests are arriving over SSL. This is useful when proxying through a load balancer that terminates SSL, the forwarded request will appear as though it’s HTTP instead of HTTPS to the application. This makes redirects and cookie security target HTTP instead of HTTPS. This middleware makes the server assume that the proxy already terminated SSL, and that the request really is HTTPS.</p>

<h4 id="configautoflush_log"><code class="language-plaintext highlighter-rouge">config.autoflush_log</code></h4>

<p>Enables writing log file output immediately instead of buffering. Defaults to
<code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configautoload_libignore"><code class="language-plaintext highlighter-rouge">config.autoload_lib(ignore:)</code></h4>

<p>This method adds <code class="language-plaintext highlighter-rouge">lib</code> to <code class="language-plaintext highlighter-rouge">config.autoload_paths</code> and <code class="language-plaintext highlighter-rouge">config.eager_load_paths</code>.</p>

<p>Normally, the <code class="language-plaintext highlighter-rouge">lib</code> directory has subdirectories that should not be autoloaded or eager loaded. Please, pass their name relative to <code class="language-plaintext highlighter-rouge">lib</code> in the required <code class="language-plaintext highlighter-rouge">ignore</code> keyword argument. For example,</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">autoload_lib</span><span class="p">(</span><span class="ss">ignore: </span><span class="sx">%w(assets tasks generators)</span><span class="p">)</span>
</code></pre></div></div>

<p>Please, see more details in the <a href="autoloading_and_reloading_constants.html">autoloading guide</a>.</p>

<h4 id="configautoload_lib_onceignore"><code class="language-plaintext highlighter-rouge">config.autoload_lib_once(ignore:)</code></h4>

<p>The method <code class="language-plaintext highlighter-rouge">config.autoload_lib_once</code> is similar to <code class="language-plaintext highlighter-rouge">config.autoload_lib</code>, except that it adds <code class="language-plaintext highlighter-rouge">lib</code> to <code class="language-plaintext highlighter-rouge">config.autoload_once_paths</code> instead.</p>

<p>By calling <code class="language-plaintext highlighter-rouge">config.autoload_lib_once</code>, classes and modules in <code class="language-plaintext highlighter-rouge">lib</code> can be autoloaded, even from application initializers, but won’t be reloaded.</p>

<h4 id="configautoload_once_paths"><code class="language-plaintext highlighter-rouge">config.autoload_once_paths</code></h4>

<p>Accepts an array of paths from which Rails will autoload constants that won’t be wiped per request. Relevant if reloading is enabled, which it is by default in the <code class="language-plaintext highlighter-rouge">development</code> environment. Otherwise, all autoloading happens only once. All elements of this array must also be in <code class="language-plaintext highlighter-rouge">autoload_paths</code>. Default is an empty array.</p>

<h4 id="configautoload_paths"><code class="language-plaintext highlighter-rouge">config.autoload_paths</code></h4>

<p>Accepts an array of paths from which Rails will autoload constants. Default is an empty array. Since <a href="upgrading_ruby_on_rails.html#autoloading">Rails 6</a>, it is not recommended to adjust this. See <a href="autoloading_and_reloading_constants.html#autoload-paths">Autoloading and Reloading Constants</a>.</p>

<h4 id="configbeginning_of_week"><code class="language-plaintext highlighter-rouge">config.beginning_of_week</code></h4>

<p>Sets the default beginning of week for the
application. Accepts a valid day of week as a symbol (e.g. <code class="language-plaintext highlighter-rouge">:monday</code>).</p>

<h4 id="configcache_classes"><code class="language-plaintext highlighter-rouge">config.cache_classes</code></h4>

<p>Old setting equivalent to <code class="language-plaintext highlighter-rouge">!config.enable_reloading</code>. Supported for backwards compatibility.</p>

<h4 id="configcache_store"><code class="language-plaintext highlighter-rouge">config.cache_store</code></h4>

<p>Configures which cache store to use for Rails caching. Options include one of the symbols <code class="language-plaintext highlighter-rouge">:memory_store</code>, <code class="language-plaintext highlighter-rouge">:file_store</code>, <code class="language-plaintext highlighter-rouge">:mem_cache_store</code>, <code class="language-plaintext highlighter-rouge">:null_store</code>, <code class="language-plaintext highlighter-rouge">:redis_cache_store</code>, or an object that implements the cache API. Defaults to <code class="language-plaintext highlighter-rouge">:file_store</code>. See <a href="caching_with_rails.html#cache-stores">Cache Stores</a> for per-store configuration options.</p>

<h4 id="configcolorize_logging"><code class="language-plaintext highlighter-rouge">config.colorize_logging</code></h4>

<p>Specifies whether or not to use ANSI color codes when logging information. Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configconsider_all_requests_local"><code class="language-plaintext highlighter-rouge">config.consider_all_requests_local</code></h4>

<p>Is a flag. If <code class="language-plaintext highlighter-rouge">true</code> then any error will cause detailed debugging information to be dumped in the HTTP response, and the <code class="language-plaintext highlighter-rouge">Rails::Info</code> controller will show the application runtime context in <code class="language-plaintext highlighter-rouge">/rails/info/properties</code>. <code class="language-plaintext highlighter-rouge">true</code> by default in the development and test environments, and <code class="language-plaintext highlighter-rouge">false</code> in production. For finer-grained control, set this to <code class="language-plaintext highlighter-rouge">false</code> and implement <code class="language-plaintext highlighter-rouge">show_detailed_exceptions?</code> in controllers to specify which requests should provide debugging information on errors.</p>

<h4 id="configconsole"><code class="language-plaintext highlighter-rouge">config.console</code></h4>

<p>Allows you to set the class that will be used as console when you run <code class="language-plaintext highlighter-rouge">bin/rails console</code>. It’s best to run it in the <code class="language-plaintext highlighter-rouge">console</code> block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">console</span> <span class="k">do</span>
  <span class="c1"># this block is called only when running console,</span>
  <span class="c1"># so we can safely require pry here</span>
  <span class="nb">require</span> <span class="s2">"pry"</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">console</span> <span class="o">=</span> <span class="no">Pry</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="configcontent_security_policy_nonce_auto"><code class="language-plaintext highlighter-rouge">config.content_security_policy_nonce_auto</code></h4>

<p>See <a href="security.html#adding-a-nonce">Adding a Nonce</a> in the Security Guide</p>

<h4 id="configcontent_security_policy_nonce_directives"><code class="language-plaintext highlighter-rouge">config.content_security_policy_nonce_directives</code></h4>

<p>See <a href="security.html#adding-a-nonce">Adding a Nonce</a> in the Security Guide</p>

<h4 id="configcontent_security_policy_nonce_generator"><code class="language-plaintext highlighter-rouge">config.content_security_policy_nonce_generator</code></h4>

<p>See <a href="security.html#adding-a-nonce">Adding a Nonce</a> in the Security Guide</p>

<h4 id="configcontent_security_policy_report_only"><code class="language-plaintext highlighter-rouge">config.content_security_policy_report_only</code></h4>

<p>See <a href="security.html#reporting-violations">Reporting Violations</a> in the Security
Guide</p>

<h4 id="configcredentialscontent_path"><code class="language-plaintext highlighter-rouge">config.credentials.content_path</code></h4>

<p>The path of the encrypted credentials file.</p>

<p>Defaults to <code class="language-plaintext highlighter-rouge">config/credentials/#{Rails.env}.yml.enc</code> if it exists, or
<code class="language-plaintext highlighter-rouge">config/credentials.yml.enc</code> otherwise.</p>

<p>NOTE: In order for the <code class="language-plaintext highlighter-rouge">bin/rails credentials</code> commands to recognize this value,
it must be set in <code class="language-plaintext highlighter-rouge">config/application.rb</code> or <code class="language-plaintext highlighter-rouge">config/environments/#{Rails.env}.rb</code>.</p>

<h4 id="configcredentialskey_path"><code class="language-plaintext highlighter-rouge">config.credentials.key_path</code></h4>

<p>The path of the encrypted credentials key file.</p>

<p>Defaults to <code class="language-plaintext highlighter-rouge">config/credentials/#{Rails.env}.key</code> if it exists, or
<code class="language-plaintext highlighter-rouge">config/master.key</code> otherwise.</p>

<p>NOTE: In order for the <code class="language-plaintext highlighter-rouge">bin/rails credentials</code> commands to recognize this value,
it must be set in <code class="language-plaintext highlighter-rouge">config/application.rb</code> or <code class="language-plaintext highlighter-rouge">config/environments/#{Rails.env}.rb</code>.</p>

<h4 id="configdebug_exception_response_format"><code class="language-plaintext highlighter-rouge">config.debug_exception_response_format</code></h4>

<p>Sets the format used in responses when errors occur in the development environment. Defaults to <code class="language-plaintext highlighter-rouge">:api</code> for API only apps and <code class="language-plaintext highlighter-rouge">:default</code> for normal apps.</p>

<h4 id="configdisable_sandbox"><code class="language-plaintext highlighter-rouge">config.disable_sandbox</code></h4>

<p>Controls whether or not someone can start a console in sandbox mode. This is helpful to avoid a long running session of sandbox console, that could lead a database server to run out of memory. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configdom_testing_default_html_version"><code class="language-plaintext highlighter-rouge">config.dom_testing_default_html_version</code></h4>

<p>Controls whether an HTML4 parser or an HTML5 parser is used by default by the test helpers in Action View, Action Dispatch, and <code class="language-plaintext highlighter-rouge">rails-dom-testing</code>.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:html4</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">:html5</code> (see NOTE)</td>
    </tr>
  </tbody>
</table>

<p>NOTE: Nokogiri’s HTML5 parser is not supported on JRuby, so on JRuby platforms Rails will fall back to <code class="language-plaintext highlighter-rouge">:html4</code>.</p>

<h4 id="configeager_load"><code class="language-plaintext highlighter-rouge">config.eager_load</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">true</code>, eager loads all registered <code class="language-plaintext highlighter-rouge">config.eager_load_namespaces</code>. This includes your application, engines, Rails frameworks, and any other registered namespace.</p>

<h4 id="configeager_load_namespaces"><code class="language-plaintext highlighter-rouge">config.eager_load_namespaces</code></h4>

<p>Registers namespaces that are eager loaded when <code class="language-plaintext highlighter-rouge">config.eager_load</code> is set to <code class="language-plaintext highlighter-rouge">true</code>. All namespaces in the list must respond to the <code class="language-plaintext highlighter-rouge">eager_load!</code> method.</p>

<h4 id="configeager_load_paths"><code class="language-plaintext highlighter-rouge">config.eager_load_paths</code></h4>

<p>Accepts an array of paths from which Rails will eager load on boot if <code class="language-plaintext highlighter-rouge">config.eager_load</code> is true. Defaults to every folder in the <code class="language-plaintext highlighter-rouge">app</code> directory of the application.</p>

<h4 id="configenable_reloading"><code class="language-plaintext highlighter-rouge">config.enable_reloading</code></h4>

<p>If <code class="language-plaintext highlighter-rouge">config.enable_reloading</code> is true, application classes and modules are reloaded in between web requests if they change. Defaults to <code class="language-plaintext highlighter-rouge">true</code> in the <code class="language-plaintext highlighter-rouge">development</code> environment, and <code class="language-plaintext highlighter-rouge">false</code> in the <code class="language-plaintext highlighter-rouge">production</code> environment.</p>

<p>The predicate <code class="language-plaintext highlighter-rouge">config.reloading_enabled?</code> is also defined.</p>

<h4 id="configencoding"><code class="language-plaintext highlighter-rouge">config.encoding</code></h4>

<p>Sets up the application-wide encoding. Defaults to UTF-8.</p>

<h4 id="configexceptions_app"><code class="language-plaintext highlighter-rouge">config.exceptions_app</code></h4>

<p>Sets the exceptions application invoked by the <code class="language-plaintext highlighter-rouge">ShowException</code> middleware when an exception happens.
Defaults to <code class="language-plaintext highlighter-rouge">ActionDispatch::PublicExceptions.new(Rails.public_path)</code>.</p>

<h4 id="configfile_watcher"><code class="language-plaintext highlighter-rouge">config.file_watcher</code></h4>

<p>Is the class used to detect file updates in the file system when <code class="language-plaintext highlighter-rouge">config.reload_classes_only_on_change</code> is <code class="language-plaintext highlighter-rouge">true</code>. Rails ships with <code class="language-plaintext highlighter-rouge">ActiveSupport::FileUpdateChecker</code>, the default, and <code class="language-plaintext highlighter-rouge">ActiveSupport::EventedFileUpdateChecker</code>. Custom classes must conform to the <code class="language-plaintext highlighter-rouge">ActiveSupport::FileUpdateChecker</code> API.</p>

<p>Using <code class="language-plaintext highlighter-rouge">ActiveSupport::EventedFileUpdateChecker</code> depends on the <a href="https://github.com/guard/listen">listen</a> gem:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">group</span> <span class="ss">:development</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s2">"listen"</span><span class="p">,</span> <span class="s2">"~&gt; 3.5"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>On Linux and macOS no additional gems are needed, but some are required
<a href="https://github.com/guard/listen#on-bsd">for *BSD</a> and
<a href="https://github.com/guard/listen#on-windows">for Windows</a>.</p>

<p>Note that <a href="https://github.com/guard/listen#issues--limitations">some setups are unsupported</a>.</p>

<h4 id="configfilter_parameters"><code class="language-plaintext highlighter-rouge">config.filter_parameters</code></h4>

<p>Used for filtering out the parameters that you don’t want shown in the logs,
such as passwords or credit card numbers. It also filters out sensitive values
of database columns when calling <code class="language-plaintext highlighter-rouge">#inspect</code> on an Active Record object. By
default, Rails filters out passwords by adding the following filters in
<code class="language-plaintext highlighter-rouge">config/initializers/filter_parameter_logging.rb</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">filter_parameters</span> <span class="o">+=</span> <span class="p">[</span>
  <span class="ss">:passw</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:secret</span><span class="p">,</span> <span class="ss">:token</span><span class="p">,</span> <span class="ss">:_key</span><span class="p">,</span> <span class="ss">:crypt</span><span class="p">,</span> <span class="ss">:salt</span><span class="p">,</span> <span class="ss">:certificate</span><span class="p">,</span> <span class="ss">:otp</span><span class="p">,</span> <span class="ss">:ssn</span><span class="p">,</span> <span class="ss">:cvv</span><span class="p">,</span> <span class="ss">:cvc</span>
<span class="p">]</span>
</code></pre></div></div>

<p>Parameters filter works by partial matching regular expression.</p>

<h4 id="configfilter_redirect"><code class="language-plaintext highlighter-rouge">config.filter_redirect</code></h4>

<p>Used for filtering out redirect urls from application logs.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">filter_redirect</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">"s3.amazonaws.com"</span><span class="p">,</span> <span class="sr">/private-match/</span><span class="p">]</span>
</code></pre></div></div>

<p>The redirect filter works by testing that urls include strings or match regular
expressions.</p>

<h4 id="configforce_ssl"><code class="language-plaintext highlighter-rouge">config.force_ssl</code></h4>

<p>Forces all requests to be served over HTTPS, and sets “https://” as the default protocol when generating URLs. Enforcement of HTTPS is handled by the <code class="language-plaintext highlighter-rouge">ActionDispatch::SSL</code> middleware, which can be configured via <code class="language-plaintext highlighter-rouge">config.ssl_options</code>.</p>

<h4 id="confighelpers_paths"><code class="language-plaintext highlighter-rouge">config.helpers_paths</code></h4>

<p>Defines an array of additional paths to load view helpers.</p>

<h4 id="confighost_authorization"><code class="language-plaintext highlighter-rouge">config.host_authorization</code></h4>

<p>Accepts a hash of options to configure the <a href="#actiondispatch-hostauthorization">HostAuthorization
middleware</a></p>

<h4 id="confighosts"><code class="language-plaintext highlighter-rouge">config.hosts</code></h4>

<p>An array of strings, regular expressions, or <code class="language-plaintext highlighter-rouge">IPAddr</code> used to validate the
<code class="language-plaintext highlighter-rouge">Host</code> header. Used by the <a href="#actiondispatch-hostauthorization">HostAuthorization
middleware</a> to help prevent DNS rebinding
attacks.</p>

<h4 id="configjavascript_path"><code class="language-plaintext highlighter-rouge">config.javascript_path</code></h4>

<p>Sets the path where your app’s JavaScript lives relative to the <code class="language-plaintext highlighter-rouge">app</code> directory and the default value is <code class="language-plaintext highlighter-rouge">javascript</code>.
An app’s configured <code class="language-plaintext highlighter-rouge">javascript_path</code> will be excluded from <code class="language-plaintext highlighter-rouge">autoload_paths</code>.</p>

<h4 id="configlog_file_size"><code class="language-plaintext highlighter-rouge">config.log_file_size</code></h4>

<p>Defines the maximum size of the Rails log file in bytes. Defaults to <code class="language-plaintext highlighter-rouge">104_857_600</code> (100 MiB) in development and test, and unlimited in all other environments.</p>

<h4 id="configlog_formatter"><code class="language-plaintext highlighter-rouge">config.log_formatter</code></h4>

<p>Defines the formatter of the Rails logger. This option defaults to an instance of <code class="language-plaintext highlighter-rouge">ActiveSupport::Logger::SimpleFormatter</code> for all environments. If you are setting a value for <code class="language-plaintext highlighter-rouge">config.logger</code> you must manually pass the value of your formatter to your logger before it is wrapped in an <code class="language-plaintext highlighter-rouge">ActiveSupport::TaggedLogging</code> instance, Rails will not do it for you.</p>

<h4 id="configlog_level"><code class="language-plaintext highlighter-rouge">config.log_level</code></h4>

<p>Defines the verbosity of the Rails logger. This option defaults to <code class="language-plaintext highlighter-rouge">:debug</code> for all environments except production, where it defaults to <code class="language-plaintext highlighter-rouge">:info</code>. The available log levels are: <code class="language-plaintext highlighter-rouge">:debug</code>, <code class="language-plaintext highlighter-rouge">:info</code>, <code class="language-plaintext highlighter-rouge">:warn</code>, <code class="language-plaintext highlighter-rouge">:error</code>, <code class="language-plaintext highlighter-rouge">:fatal</code>, and <code class="language-plaintext highlighter-rouge">:unknown</code>.</p>

<h4 id="configlog_tags"><code class="language-plaintext highlighter-rouge">config.log_tags</code></h4>

<p>Accepts a list of methods that the <code class="language-plaintext highlighter-rouge">request</code> object responds to, a <code class="language-plaintext highlighter-rouge">Proc</code> that accepts the <code class="language-plaintext highlighter-rouge">request</code> object, or something that responds to <code class="language-plaintext highlighter-rouge">to_s</code>. This makes it easy to tag log lines with debug information like subdomain and request id - both very helpful in debugging multi-user production applications.</p>

<h4 id="configlogger"><code class="language-plaintext highlighter-rouge">config.logger</code></h4>

<p>Is the logger that will be used for <code class="language-plaintext highlighter-rouge">Rails.logger</code> and any related Rails logging such as <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.logger</code>. It defaults to an instance of <code class="language-plaintext highlighter-rouge">ActiveSupport::TaggedLogging</code> that wraps an instance of <code class="language-plaintext highlighter-rouge">ActiveSupport::Logger</code> which outputs a log to the <code class="language-plaintext highlighter-rouge">log/</code> directory. You can supply a custom logger, to get full compatibility you must follow these guidelines:</p>

<ul>
  <li>To support a formatter, you must manually assign a formatter from the <code class="language-plaintext highlighter-rouge">config.log_formatter</code> value to the logger.</li>
  <li>To support tagged logs, the log instance must be wrapped with <code class="language-plaintext highlighter-rouge">ActiveSupport::TaggedLogging</code>.</li>
  <li>To support silencing, the logger must include <code class="language-plaintext highlighter-rouge">ActiveSupport::LoggerSilence</code> module. The <code class="language-plaintext highlighter-rouge">ActiveSupport::Logger</code> class already includes these modules.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MyLogger</span> <span class="o">&lt;</span> <span class="o">::</span><span class="no">Logger</span>
  <span class="kp">include</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">LoggerSilence</span>
<span class="k">end</span>

<span class="n">mylogger</span>           <span class="o">=</span> <span class="no">MyLogger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">)</span>
<span class="n">mylogger</span><span class="p">.</span><span class="nf">formatter</span> <span class="o">=</span> <span class="n">config</span><span class="p">.</span><span class="nf">log_formatter</span>
<span class="n">config</span><span class="p">.</span><span class="nf">logger</span>      <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">TaggedLogging</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">mylogger</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="configmiddleware"><code class="language-plaintext highlighter-rouge">config.middleware</code></h4>

<p>Allows you to configure the application’s middleware. This is covered in depth in the <a href="#configuring-middleware">Configuring Middleware</a> section below.</p>

<h4 id="configprecompile_filter_parameters"><code class="language-plaintext highlighter-rouge">config.precompile_filter_parameters</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">true</code>, will precompile <a href="#config-filter-parameters"><code class="language-plaintext highlighter-rouge">config.filter_parameters</code></a>
using <a href="https://api.rubyonrails.org/classes/ActiveSupport/ParameterFilter.html#method-c-precompile_filters"><code class="language-plaintext highlighter-rouge">ActiveSupport::ParameterFilter.precompile_filters</code></a>.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configpublic_file_serverenabled"><code class="language-plaintext highlighter-rouge">config.public_file_server.enabled</code></h4>

<p>Configures whether Rails should serve static files from the public directory.
Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<p>If the server software (e.g. NGINX or Apache) should serve static files instead,
set this value to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configrailties_order"><code class="language-plaintext highlighter-rouge">config.railties_order</code></h4>

<p>Allows manually specifying the order that Railties/Engines are loaded. The
default value is <code class="language-plaintext highlighter-rouge">[:all]</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">railties_order</span> <span class="o">=</span> <span class="p">[</span><span class="no">Blog</span><span class="o">::</span><span class="no">Engine</span><span class="p">,</span> <span class="ss">:main_app</span><span class="p">,</span> <span class="ss">:all</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="configrake_eager_load"><code class="language-plaintext highlighter-rouge">config.rake_eager_load</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">true</code>, eager load the application when running Rake tasks. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configrelative_url_root"><code class="language-plaintext highlighter-rouge">config.relative_url_root</code></h4>

<p>Can be used to tell Rails that you are <a href="configuring.html#deploy-to-a-subdirectory-relative-url-root">deploying to a subdirectory</a>. The default
is <code class="language-plaintext highlighter-rouge">ENV['RAILS_RELATIVE_URL_ROOT']</code>.</p>

<h4 id="configreload_classes_only_on_change"><code class="language-plaintext highlighter-rouge">config.reload_classes_only_on_change</code></h4>

<p>Enables or disables reloading of classes only when tracked files change. By default tracks everything on autoload paths and is set to <code class="language-plaintext highlighter-rouge">true</code>. If <code class="language-plaintext highlighter-rouge">config.enable_reloading</code> is <code class="language-plaintext highlighter-rouge">false</code>, this option is ignored.</p>

<h4 id="configrequire_master_key"><code class="language-plaintext highlighter-rouge">config.require_master_key</code></h4>

<p>Causes the app to not boot if a master key hasn’t been made available through <code class="language-plaintext highlighter-rouge">ENV["RAILS_MASTER_KEY"]</code> or the <code class="language-plaintext highlighter-rouge">config/master.key</code> file.</p>

<h4 id="configsandbox_by_default"><code class="language-plaintext highlighter-rouge">config.sandbox_by_default</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">true</code>, rails console starts in sandbox mode. To start rails console in non-sandbox mode, <code class="language-plaintext highlighter-rouge">--no-sandbox</code> must be specified. This is helpful to avoid accidental writing to the production database. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configsecret_key_base"><code class="language-plaintext highlighter-rouge">config.secret_key_base</code></h4>

<p>The fallback for specifying the input secret for an application’s key generator.
It is recommended to leave this unset, and instead to specify a <code class="language-plaintext highlighter-rouge">secret_key_base</code>
in <code class="language-plaintext highlighter-rouge">config/credentials.yml.enc</code>. See the <a href="https://api.rubyonrails.org/classes/Rails/Application.html#method-i-secret_key_base"><code class="language-plaintext highlighter-rouge">secret_key_base</code> API documentation</a>
for more information and alternative configuration methods.</p>

<h4 id="configserver_timing"><code class="language-plaintext highlighter-rouge">config.server_timing</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">true</code>, adds the <a href="#actiondispatch-servertiming"><code class="language-plaintext highlighter-rouge">ServerTiming</code> middleware</a>
to the middleware stack. Defaults to <code class="language-plaintext highlighter-rouge">false</code>, but is set to <code class="language-plaintext highlighter-rouge">true</code> in the
default generated <code class="language-plaintext highlighter-rouge">config/environments/development.rb</code> file.</p>

<h4 id="configsession_options"><code class="language-plaintext highlighter-rouge">config.session_options</code></h4>

<p>Additional options passed to <code class="language-plaintext highlighter-rouge">config.session_store</code>. You should use
<code class="language-plaintext highlighter-rouge">config.session_store</code> to set this instead of modifying it yourself.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">session_store</span> <span class="ss">:cookie_store</span><span class="p">,</span> <span class="ss">key: </span><span class="s2">"_your_app_session"</span>
<span class="n">config</span><span class="p">.</span><span class="nf">session_options</span> <span class="c1"># =&gt; {key: "_your_app_session"}</span>
</code></pre></div></div>

<h4 id="configsession_store"><code class="language-plaintext highlighter-rouge">config.session_store</code></h4>

<p>Specifies what class to use to store the session. Possible values are <code class="language-plaintext highlighter-rouge">:cache_store</code>, <code class="language-plaintext highlighter-rouge">:cookie_store</code>, <code class="language-plaintext highlighter-rouge">:mem_cache_store</code>, a custom store, or <code class="language-plaintext highlighter-rouge">:disabled</code>. <code class="language-plaintext highlighter-rouge">:disabled</code> tells Rails not to deal with sessions.</p>

<p>This setting is configured via a regular method call, rather than a setter. This allows additional options to be passed:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">session_store</span> <span class="ss">:cookie_store</span><span class="p">,</span> <span class="ss">key: </span><span class="s2">"_your_app_session"</span>
</code></pre></div></div>

<p>If a custom store is specified as a symbol, it will be resolved to the <code class="language-plaintext highlighter-rouge">ActionDispatch::Session</code> namespace:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># use ActionDispatch::Session::MyCustomStore as the session store</span>
<span class="n">config</span><span class="p">.</span><span class="nf">session_store</span> <span class="ss">:my_custom_store</span>
</code></pre></div></div>

<p>The default store is a cookie store with the application name as the session key.</p>

<h4 id="configsilence_healthcheck_path"><code class="language-plaintext highlighter-rouge">config.silence_healthcheck_path</code></h4>

<p>Specifies the path of the health check that should be silenced in the logs. Uses <code class="language-plaintext highlighter-rouge">Rails::Rack::SilenceRequest</code> to implement the silencing. All in service of keeping health checks from clogging the production logs, especially for early-stage applications.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>config.silence_healthcheck_path = "/up"
</code></pre></div></div>

<h4 id="configssl_options"><code class="language-plaintext highlighter-rouge">config.ssl_options</code></h4>

<p>Configuration options for the <a href="https://api.rubyonrails.org/classes/ActionDispatch/SSL.html"><code class="language-plaintext highlighter-rouge">ActionDispatch::SSL</code></a> middleware.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">{}</code></td>
    </tr>
    <tr>
      <td>5.0</td>
      <td><code class="language-plaintext highlighter-rouge">{ hsts: { subdomains: true } }</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configtime_zone"><code class="language-plaintext highlighter-rouge">config.time_zone</code></h4>

<p>Sets the default time zone for the application and enables time zone awareness for Active Record.</p>

<h4 id="configx"><code class="language-plaintext highlighter-rouge">config.x</code></h4>

<p>Used to easily add nested custom configuration to the application config object</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">config</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">schedule</span> <span class="o">=</span> <span class="ss">:daily</span>
  <span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">schedule</span> <span class="c1"># =&gt; :daily</span>
</code></pre></div></div>

<p>See <a href="#custom-configuration">Custom Configuration</a></p>

<h4 id="configyjit"><code class="language-plaintext highlighter-rouge">config.yjit</code></h4>

<p>Enables YJIT as of Ruby 3.3, to bring sizeable performance improvements. If you are
deploying to a memory constrained environment you may want to set this to <code class="language-plaintext highlighter-rouge">false</code>.
Additionally, you can pass a hash to configure YJIT options such as <code class="language-plaintext highlighter-rouge">{ stats: true }</code>.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.2</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>8.1</td>
      <td><code class="language-plaintext highlighter-rouge">!Rails.env.local?</code></td>
    </tr>
  </tbody>
</table>

<h3 id="configuring-assets">Configuring Assets</h3>

<h4 id="configassetscss_compressor"><code class="language-plaintext highlighter-rouge">config.assets.css_compressor</code></h4>

<p>Defines the CSS compressor to use. It is set by default by <code class="language-plaintext highlighter-rouge">sass-rails</code>. The unique alternative value at the moment is <code class="language-plaintext highlighter-rouge">:yui</code>, which uses the <code class="language-plaintext highlighter-rouge">yui-compressor</code> gem.</p>

<h4 id="configassetsjs_compressor"><code class="language-plaintext highlighter-rouge">config.assets.js_compressor</code></h4>

<p>Defines the JavaScript compressor to use. Possible values are <code class="language-plaintext highlighter-rouge">:terser</code>, <code class="language-plaintext highlighter-rouge">:closure</code>, <code class="language-plaintext highlighter-rouge">:uglifier</code>, and <code class="language-plaintext highlighter-rouge">:yui</code>, which require the use of the <code class="language-plaintext highlighter-rouge">terser</code>, <code class="language-plaintext highlighter-rouge">closure-compiler</code>, <code class="language-plaintext highlighter-rouge">uglifier</code>, or <code class="language-plaintext highlighter-rouge">yui-compressor</code> gems respectively.</p>

<h4 id="configassetsgzip"><code class="language-plaintext highlighter-rouge">config.assets.gzip</code></h4>

<p>A flag that enables the creation of gzipped version of compiled assets, along with non-gzipped assets. Set to <code class="language-plaintext highlighter-rouge">true</code> by default.</p>

<h4 id="configassetspaths"><code class="language-plaintext highlighter-rouge">config.assets.paths</code></h4>

<p>Contains the paths which are used to look for assets. Appending paths to this configuration option will cause those paths to be used in the search for assets.</p>

<h4 id="configassetsprecompile"><code class="language-plaintext highlighter-rouge">config.assets.precompile</code></h4>

<p>Allows you to specify additional assets (other than <code class="language-plaintext highlighter-rouge">application.css</code> and <code class="language-plaintext highlighter-rouge">application.js</code>) which are to be precompiled when <code class="language-plaintext highlighter-rouge">bin/rails assets:precompile</code> is run.</p>

<h4 id="configassetsunknown_asset_fallback"><code class="language-plaintext highlighter-rouge">config.assets.unknown_asset_fallback</code></h4>

<p>Allows you to modify the behavior of the asset pipeline when an asset is not in the pipeline, if you use sprockets-rails 3.2.0 or newer.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>5.1</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configassetsprefix"><code class="language-plaintext highlighter-rouge">config.assets.prefix</code></h4>

<p>Defines the prefix where assets are served from. Defaults to <code class="language-plaintext highlighter-rouge">/assets</code>.</p>

<h4 id="configassetsmanifest"><code class="language-plaintext highlighter-rouge">config.assets.manifest</code></h4>

<p>Defines the full path to be used for the asset precompiler’s manifest file. Defaults to a file named <code class="language-plaintext highlighter-rouge">manifest-&lt;random&gt;.json</code> in the <code class="language-plaintext highlighter-rouge">config.assets.prefix</code> directory within the public folder.</p>

<h4 id="configassetsdigest"><code class="language-plaintext highlighter-rouge">config.assets.digest</code></h4>

<p>Enables the use of SHA256 fingerprints in asset names. Set to <code class="language-plaintext highlighter-rouge">true</code> by default.</p>

<h4 id="configassetsdebug"><code class="language-plaintext highlighter-rouge">config.assets.debug</code></h4>

<p>Disables the concatenation and compression of assets.</p>

<h4 id="configassetsversion"><code class="language-plaintext highlighter-rouge">config.assets.version</code></h4>

<p>Is an option string that is used in SHA256 hash generation. This can be changed to force all files to be recompiled.</p>

<h4 id="configassetscompile"><code class="language-plaintext highlighter-rouge">config.assets.compile</code></h4>

<p>Is a boolean that can be used to turn on live Sprockets compilation in production.</p>

<h4 id="configassetslogger"><code class="language-plaintext highlighter-rouge">config.assets.logger</code></h4>

<p>Accepts a logger conforming to the interface of Log4r or the default Ruby <code class="language-plaintext highlighter-rouge">Logger</code> class. Defaults to the same configured at <code class="language-plaintext highlighter-rouge">config.logger</code>. Setting <code class="language-plaintext highlighter-rouge">config.assets.logger</code> to <code class="language-plaintext highlighter-rouge">false</code> will turn off served assets logging.</p>

<h4 id="configassetsquiet"><code class="language-plaintext highlighter-rouge">config.assets.quiet</code></h4>

<p>Disables logging of assets requests. Set to <code class="language-plaintext highlighter-rouge">true</code> by default in <code class="language-plaintext highlighter-rouge">config/environments/development.rb</code>.</p>

<h3 id="configuring-generators">Configuring Generators</h3>

<p>Rails allows you to alter what generators are used with the <code class="language-plaintext highlighter-rouge">config.generators</code> method. This method takes a block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">generators</span> <span class="k">do</span> <span class="o">|</span><span class="n">g</span><span class="o">|</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">orm</span> <span class="ss">:active_record</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">test_framework</span> <span class="ss">:test_unit</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The full set of methods that can be used in this block are as follows:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">force_plural</code> allows pluralized model names. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">helper</code> defines whether or not to generate helpers. Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">integration_tool</code> defines which integration tool to use to generate integration tests. Defaults to <code class="language-plaintext highlighter-rouge">:test_unit</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">system_tests</code> defines which integration tool to use to generate system tests. Defaults to <code class="language-plaintext highlighter-rouge">:test_unit</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">orm</code> defines which orm to use. Defaults to <code class="language-plaintext highlighter-rouge">false</code> and will use Active Record by default.</li>
  <li><code class="language-plaintext highlighter-rouge">resource_controller</code> defines which generator to use for generating a controller when using <code class="language-plaintext highlighter-rouge">bin/rails generate resource</code>. Defaults to <code class="language-plaintext highlighter-rouge">:controller</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">resource_route</code> defines whether a resource route definition should be generated
or not. Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">scaffold_controller</code> different from <code class="language-plaintext highlighter-rouge">resource_controller</code>, defines which generator to use for generating a <em>scaffolded</em> controller when using <code class="language-plaintext highlighter-rouge">bin/rails generate scaffold</code>. Defaults to <code class="language-plaintext highlighter-rouge">:scaffold_controller</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">test_framework</code> defines which test framework to use. Defaults to <code class="language-plaintext highlighter-rouge">false</code> and will use minitest by default.</li>
  <li><code class="language-plaintext highlighter-rouge">template_engine</code> defines which template engine to use, such as ERB or Haml. Defaults to <code class="language-plaintext highlighter-rouge">:erb</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">apply_rubocop_autocorrect_after_generate!</code> applies RuboCop’s autocorrect feature after Rails generators are run.</li>
</ul>

<h3 id="configuring-middleware">Configuring Middleware</h3>

<p>Every Rails application comes with a standard set of middleware which it uses in this order in the development environment:</p>

<h4 id="actiondispatchhostauthorization"><code class="language-plaintext highlighter-rouge">ActionDispatch::HostAuthorization</code></h4>

<p>Prevents against DNS rebinding and other <code class="language-plaintext highlighter-rouge">Host</code> header attacks.
It is included in the development environment by default with the following configuration:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">hosts</span> <span class="o">=</span> <span class="p">[</span>
  <span class="no">IPAddr</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"0.0.0.0/0"</span><span class="p">),</span>        <span class="c1"># All IPv4 addresses.</span>
  <span class="no">IPAddr</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"::/0"</span><span class="p">),</span>             <span class="c1"># All IPv6 addresses.</span>
  <span class="s2">"localhost"</span><span class="p">,</span>                    <span class="c1"># The localhost reserved domain.</span>
  <span class="no">ENV</span><span class="p">[</span><span class="s2">"RAILS_DEVELOPMENT_HOSTS"</span><span class="p">]</span>  <span class="c1"># Additional comma-separated hosts for development.</span>
<span class="p">]</span>
</code></pre></div></div>

<p>In other environments <code class="language-plaintext highlighter-rouge">Rails.application.config.hosts</code> is empty and no
<code class="language-plaintext highlighter-rouge">Host</code> header checks will be done. If you want to guard against header
attacks on production, you have to manually permit the allowed hosts
with:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">hosts</span> <span class="o">&lt;&lt;</span> <span class="s2">"product.com"</span>
</code></pre></div></div>

<p>The host of a request is checked against the <code class="language-plaintext highlighter-rouge">hosts</code> entries with the case
operator (<code class="language-plaintext highlighter-rouge">#===</code>), which lets <code class="language-plaintext highlighter-rouge">hosts</code> support entries of type <code class="language-plaintext highlighter-rouge">Regexp</code>,
<code class="language-plaintext highlighter-rouge">Proc</code> and <code class="language-plaintext highlighter-rouge">IPAddr</code> to name a few. Here is an example with a regexp.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Allow requests from subdomains like `www.product.com` and</span>
<span class="c1"># `beta1.product.com`.</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">hosts</span> <span class="o">&lt;&lt;</span> <span class="sr">/.*\.product\.com/</span>
</code></pre></div></div>

<p>The provided regexp will be wrapped with both anchors (<code class="language-plaintext highlighter-rouge">\A</code> and <code class="language-plaintext highlighter-rouge">\z</code>) so it
must match the entire hostname. <code class="language-plaintext highlighter-rouge">/product.com/</code>, for example, once anchored,
would fail to match <code class="language-plaintext highlighter-rouge">www.product.com</code>.</p>

<p>A special case is supported that allows you to permit all sub-domains:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Allow requests from subdomains like `www.product.com` and</span>
<span class="c1"># `beta1.product.com`.</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">hosts</span> <span class="o">&lt;&lt;</span> <span class="s2">".product.com"</span>
</code></pre></div></div>

<p>You can exclude certain requests from Host Authorization checks by setting
<code class="language-plaintext highlighter-rouge">config.host_authorization.exclude</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Exclude requests for the /healthcheck/ path from host checking</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">host_authorization</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">exclude: </span><span class="o">-&gt;</span><span class="p">(</span><span class="n">request</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span><span class="p">.</span><span class="nf">path</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="s2">"healthcheck"</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>When a request comes to an unauthorized host, a default Rack application
will run and respond with <code class="language-plaintext highlighter-rouge">403 Forbidden</code>. This can be customized by setting
<code class="language-plaintext highlighter-rouge">config.host_authorization.response_app</code>. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">host_authorization</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">response_app: </span><span class="o">-&gt;</span> <span class="n">env</span> <span class="k">do</span>
    <span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="p">{</span> <span class="s2">"Content-Type"</span> <span class="o">=&gt;</span> <span class="s2">"text/plain"</span> <span class="p">},</span> <span class="p">[</span><span class="s2">"Bad Request"</span><span class="p">]]</span>
  <span class="k">end</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="actiondispatchservertiming"><code class="language-plaintext highlighter-rouge">ActionDispatch::ServerTiming</code></h4>

<p>Adds the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Server-Timing"><code class="language-plaintext highlighter-rouge">Server-Timing</code></a> header to the response, which includes performance
metrics from the server. This data can be viewed by inspecting the response in
the Network panel of the browser’s Developer Tools. Most browsers provide a
Timing tab that visualizes the data.</p>

<h4 id="actiondispatchssl"><code class="language-plaintext highlighter-rouge">ActionDispatch::SSL</code></h4>

<p>Forces every request to be served using HTTPS. Enabled if <code class="language-plaintext highlighter-rouge">config.force_ssl</code> is set to <code class="language-plaintext highlighter-rouge">true</code>. Options passed to this can be configured by setting <code class="language-plaintext highlighter-rouge">config.ssl_options</code>.</p>

<h4 id="actiondispatchstatic"><code class="language-plaintext highlighter-rouge">ActionDispatch::Static</code></h4>

<p>Is used to serve static assets. Disabled if <code class="language-plaintext highlighter-rouge">config.public_file_server.enabled</code> is <code class="language-plaintext highlighter-rouge">false</code>. Set <code class="language-plaintext highlighter-rouge">config.public_file_server.index_name</code> if you need to serve a static directory index file that is not named <code class="language-plaintext highlighter-rouge">index</code>. For example, to serve <code class="language-plaintext highlighter-rouge">main.html</code> instead of <code class="language-plaintext highlighter-rouge">index.html</code> for directory requests, set <code class="language-plaintext highlighter-rouge">config.public_file_server.index_name</code> to <code class="language-plaintext highlighter-rouge">"main"</code>.</p>

<h4 id="actiondispatchexecutor"><code class="language-plaintext highlighter-rouge">ActionDispatch::Executor</code></h4>

<p>Allows thread safe code reloading. Disabled if <code class="language-plaintext highlighter-rouge">config.allow_concurrency</code> is <code class="language-plaintext highlighter-rouge">false</code>, which causes <code class="language-plaintext highlighter-rouge">Rack::Lock</code> to be loaded. <code class="language-plaintext highlighter-rouge">Rack::Lock</code> wraps the app in mutex so it can only be called by a single thread at a time.</p>

<h4 id="activesupportcachestrategylocalcache"><code class="language-plaintext highlighter-rouge">ActiveSupport::Cache::Strategy::LocalCache</code></h4>

<p>Serves as a basic memory backed cache. This cache is not thread safe and is intended only for serving as a temporary memory cache for a single thread.</p>

<h4 id="rackruntime"><code class="language-plaintext highlighter-rouge">Rack::Runtime</code></h4>

<p>Sets an <code class="language-plaintext highlighter-rouge">X-Runtime</code> header, containing the time (in seconds) taken to execute the request.</p>

<h4 id="railsracklogger"><code class="language-plaintext highlighter-rouge">Rails::Rack::Logger</code></h4>

<p>Notifies the logs that the request has begun. After request is complete, flushes all the logs.</p>

<h4 id="actiondispatchshowexceptions"><code class="language-plaintext highlighter-rouge">ActionDispatch::ShowExceptions</code></h4>

<p>Rescues any exception returned by the application and renders nice exception pages if the request is local or if <code class="language-plaintext highlighter-rouge">config.consider_all_requests_local</code> is set to <code class="language-plaintext highlighter-rouge">true</code>. If <code class="language-plaintext highlighter-rouge">config.action_dispatch.show_exceptions</code> is set to <code class="language-plaintext highlighter-rouge">:none</code>, exceptions will be raised regardless.</p>

<h4 id="actiondispatchrequestid"><code class="language-plaintext highlighter-rouge">ActionDispatch::RequestId</code></h4>

<p>Makes a unique X-Request-Id header available to the response and enables the <code class="language-plaintext highlighter-rouge">ActionDispatch::Request#uuid</code> method. Configurable with <code class="language-plaintext highlighter-rouge">config.action_dispatch.request_id_header</code>.</p>

<h4 id="actiondispatchremoteip"><code class="language-plaintext highlighter-rouge">ActionDispatch::RemoteIp</code></h4>

<p>Checks for IP spoofing attacks and gets valid <code class="language-plaintext highlighter-rouge">client_ip</code> from request headers. Configurable with the <code class="language-plaintext highlighter-rouge">config.action_dispatch.ip_spoofing_check</code>, and <code class="language-plaintext highlighter-rouge">config.action_dispatch.trusted_proxies</code> options.</p>

<h4 id="racksendfile"><code class="language-plaintext highlighter-rouge">Rack::Sendfile</code></h4>

<p>Intercepts responses whose body is being served from a file and replaces it with a server specific X-Sendfile header. Configurable with <code class="language-plaintext highlighter-rouge">config.action_dispatch.x_sendfile_header</code>.</p>

<h4 id="actiondispatchcallbacks"><code class="language-plaintext highlighter-rouge">ActionDispatch::Callbacks</code></h4>

<p>Runs the prepare callbacks before serving the request.</p>

<h4 id="actiondispatchcookies"><code class="language-plaintext highlighter-rouge">ActionDispatch::Cookies</code></h4>

<p>Sets cookies for the request.</p>

<h4 id="actiondispatchsessioncookiestore"><code class="language-plaintext highlighter-rouge">ActionDispatch::Session::CookieStore</code></h4>

<p>Is responsible for storing the session in cookies. An alternate middleware can be used for this by changing <a href="#config-session-store"><code class="language-plaintext highlighter-rouge">config.session_store</code></a>.</p>

<h4 id="actiondispatchflash"><code class="language-plaintext highlighter-rouge">ActionDispatch::Flash</code></h4>

<p>Sets up the <code class="language-plaintext highlighter-rouge">flash</code> keys. Only available if <a href="#config-session-store"><code class="language-plaintext highlighter-rouge">config.session_store</code></a> is set to a value.</p>

<h4 id="rackmethodoverride"><code class="language-plaintext highlighter-rouge">Rack::MethodOverride</code></h4>

<p>Allows the method to be overridden if <code class="language-plaintext highlighter-rouge">params[:_method]</code> is set. This is the middleware which supports the PATCH, PUT, and DELETE HTTP method types.</p>

<h4 id="rackhead"><code class="language-plaintext highlighter-rouge">Rack::Head</code></h4>

<p>Returns an empty body for all HEAD requests. It leaves all other requests unchanged.</p>

<h4 id="adding-custom-middleware">Adding Custom Middleware</h4>

<p>Besides these usual middleware, you can add your own by using the <code class="language-plaintext highlighter-rouge">config.middleware.use</code> method:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">use</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre></div></div>

<p>This will put the <code class="language-plaintext highlighter-rouge">Magical::Unicorns</code> middleware on the end of the stack. You can use <code class="language-plaintext highlighter-rouge">insert_before</code> if you wish to add a middleware before another.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">insert_before</span> <span class="no">Rack</span><span class="o">::</span><span class="no">Head</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre></div></div>

<p>Or you can insert a middleware to exact position by using indexes. For example, if you want to insert <code class="language-plaintext highlighter-rouge">Magical::Unicorns</code> middleware on top of the stack, you can do it, like so:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">insert_before</span> <span class="mi">0</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre></div></div>

<p>There’s also <code class="language-plaintext highlighter-rouge">insert_after</code> which will insert a middleware after another:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">insert_after</span> <span class="no">Rack</span><span class="o">::</span><span class="no">Head</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre></div></div>

<p>Middlewares can also be completely swapped out and replaced with others:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">swap</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Failsafe</span><span class="p">,</span> <span class="no">Lifo</span><span class="o">::</span><span class="no">Failsafe</span>
</code></pre></div></div>

<p>Middlewares can be moved from one place to another:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">move_before</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">Flash</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre></div></div>

<p>This will move the <code class="language-plaintext highlighter-rouge">Magical::Unicorns</code> middleware before
<code class="language-plaintext highlighter-rouge">ActionDispatch::Flash</code>. You can also move it after:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">move_after</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">Flash</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre></div></div>

<p>They can also be removed from the stack completely:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">delete</span> <span class="no">Rack</span><span class="o">::</span><span class="no">MethodOverride</span>
</code></pre></div></div>

<h3 id="configuring-i18n">Configuring i18n</h3>

<p>All these configuration options are delegated to the <code class="language-plaintext highlighter-rouge">I18n</code> library.</p>

<h4 id="configi18navailable_locales"><code class="language-plaintext highlighter-rouge">config.i18n.available_locales</code></h4>

<p>Defines the permitted available locales for the app. Defaults to all locale keys found in locale files, usually only <code class="language-plaintext highlighter-rouge">:en</code> on a new application.</p>

<h4 id="configi18ndefault_locale"><code class="language-plaintext highlighter-rouge">config.i18n.default_locale</code></h4>

<p>Sets the default locale of an application used for i18n. Defaults to <code class="language-plaintext highlighter-rouge">:en</code>.</p>

<h4 id="configi18nenforce_available_locales"><code class="language-plaintext highlighter-rouge">config.i18n.enforce_available_locales</code></h4>

<p>Ensures that all locales passed through i18n must be declared in the <code class="language-plaintext highlighter-rouge">available_locales</code> list, raising an <code class="language-plaintext highlighter-rouge">I18n::InvalidLocale</code> exception when setting an unavailable locale. Defaults to <code class="language-plaintext highlighter-rouge">true</code>. It is recommended not to disable this option unless strongly required, since this works as a security measure against setting any invalid locale from user input.</p>

<h4 id="configi18nload_path"><code class="language-plaintext highlighter-rouge">config.i18n.load_path</code></h4>

<p>Sets the path Rails uses to look for locale files. Defaults to <code class="language-plaintext highlighter-rouge">config/locales/**/*.{yml,rb}</code>.</p>

<h4 id="configi18nraise_on_missing_translations"><code class="language-plaintext highlighter-rouge">config.i18n.raise_on_missing_translations</code></h4>

<p>Determines whether an error should be raised for missing translations. If <code class="language-plaintext highlighter-rouge">true</code>, views and controllers raise <code class="language-plaintext highlighter-rouge">I18n::MissingTranslationData</code>. If <code class="language-plaintext highlighter-rouge">:strict</code>, models also raise the error. This defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configi18nfallbacks"><code class="language-plaintext highlighter-rouge">config.i18n.fallbacks</code></h4>

<p>Sets fallback behavior for missing translations. Here are 3 usage examples for this option:</p>

<ul>
  <li>
    <p>You can set the option to <code class="language-plaintext highlighter-rouge">true</code> for using default locale as fallback, like so:</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">i18n</span><span class="p">.</span><span class="nf">fallbacks</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Or you can set an array of locales as fallback, like so:</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">i18n</span><span class="p">.</span><span class="nf">fallbacks</span> <span class="o">=</span> <span class="p">[</span><span class="ss">:tr</span><span class="p">,</span> <span class="ss">:en</span><span class="p">]</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Or you can set different fallbacks for locales individually. For example, if you want to use <code class="language-plaintext highlighter-rouge">:tr</code> for <code class="language-plaintext highlighter-rouge">:az</code> and <code class="language-plaintext highlighter-rouge">:de</code>, <code class="language-plaintext highlighter-rouge">:en</code> for <code class="language-plaintext highlighter-rouge">:da</code> as fallbacks, you can do it, like so:</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">i18n</span><span class="p">.</span><span class="nf">fallbacks</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">az: :tr</span><span class="p">,</span> <span class="ss">da: </span><span class="p">[</span><span class="ss">:de</span><span class="p">,</span> <span class="ss">:en</span><span class="p">]</span> <span class="p">}</span>
<span class="c1">#or</span>
<span class="n">config</span><span class="p">.</span><span class="nf">i18n</span><span class="p">.</span><span class="nf">fallbacks</span><span class="p">.</span><span class="nf">map</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">az: :tr</span><span class="p">,</span> <span class="ss">da: </span><span class="p">[</span><span class="ss">:de</span><span class="p">,</span> <span class="ss">:en</span><span class="p">]</span> <span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="configuring-active-model">Configuring Active Model</h3>

<h4 id="configactive_modeli18n_customize_full_message"><code class="language-plaintext highlighter-rouge">config.active_model.i18n_customize_full_message</code></h4>

<p>Controls whether the <a href="https://api.rubyonrails.org/classes/ActiveModel/Error.html#method-i-full_message"><code class="language-plaintext highlighter-rouge">Error#full_message</code></a> format can be overridden in an i18n locale file. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<p>When set to <code class="language-plaintext highlighter-rouge">true</code>, <code class="language-plaintext highlighter-rouge">full_message</code> will look for a format at the attribute and model level of the locale files. The default format is <code class="language-plaintext highlighter-rouge">"%{attribute} %{message}"</code>, where <code class="language-plaintext highlighter-rouge">attribute</code> is the name of the attribute, and <code class="language-plaintext highlighter-rouge">message</code> is the validation-specific message. The following example overrides the format for all <code class="language-plaintext highlighter-rouge">Person</code> attributes, as well as the format for a specific <code class="language-plaintext highlighter-rouge">Person</code> attribute (<code class="language-plaintext highlighter-rouge">age</code>).</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Validations</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:age</span>

  <span class="n">validates</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:age</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">en</span><span class="pi">:</span>
  <span class="na">activemodel</span><span class="pi">:</span> <span class="c1"># or activerecord:</span>
    <span class="na">errors</span><span class="pi">:</span>
      <span class="na">models</span><span class="pi">:</span>
        <span class="na">person</span><span class="pi">:</span>
          <span class="c1"># Override the format for all Person attributes:</span>
          <span class="na">format</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Invalid</span><span class="nv"> </span><span class="s">%{attribute}</span><span class="nv"> </span><span class="s">(%{message})"</span>
          <span class="na">attributes</span><span class="pi">:</span>
            <span class="na">age</span><span class="pi">:</span>
              <span class="c1"># Override the format for the age attribute:</span>
              <span class="na">format</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%{message}"</span>
              <span class="na">blank</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Please</span><span class="nv"> </span><span class="s">fill</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">your</span><span class="nv"> </span><span class="s">%{attribute}"</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">tap</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:valid?</span><span class="p">)</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">errors</span><span class="p">.</span><span class="nf">full_messages</span>
<span class="p">=&gt;</span> <span class="p">[</span>
  <span class="s2">"Invalid Name (can't be blank)"</span><span class="p">,</span>
  <span class="s2">"Please fill in your Age"</span>
<span class="p">]</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">errors</span><span class="p">.</span><span class="nf">messages</span>
<span class="p">=&gt;</span> <span class="p">{</span>
  <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"can't be blank"</span><span class="p">],</span>
  <span class="ss">:age</span>  <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"Please fill in your Age"</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="configuring-active-record">Configuring Active Record</h3>

<p><code class="language-plaintext highlighter-rouge">config.active_record</code> includes a variety of configuration options:</p>

<h4 id="configactive_recordlogger"><code class="language-plaintext highlighter-rouge">config.active_record.logger</code></h4>

<p>Accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then passed on to any new database connections made. You can retrieve this logger by calling <code class="language-plaintext highlighter-rouge">logger</code> on either an Active Record model class or an Active Record model instance. Set to <code class="language-plaintext highlighter-rouge">nil</code> to disable logging.</p>

<h4 id="configactive_recordprimary_key_prefix_type"><code class="language-plaintext highlighter-rouge">config.active_record.primary_key_prefix_type</code></h4>

<p>Lets you adjust the naming for primary key columns. By default, Rails assumes that primary key columns are named <code class="language-plaintext highlighter-rouge">id</code> (and this configuration option doesn’t need to be set). There are two other choices:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">:table_name</code> would make the primary key for the Customer class <code class="language-plaintext highlighter-rouge">customerid</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">:table_name_with_underscore</code> would make the primary key for the Customer class <code class="language-plaintext highlighter-rouge">customer_id</code>.</li>
</ul>

<h4 id="configactive_recordtable_name_prefix"><code class="language-plaintext highlighter-rouge">config.active_record.table_name_prefix</code></h4>

<p>Lets you set a global string to be prepended to table names. If you set this to <code class="language-plaintext highlighter-rouge">northwest_</code>, then the Customer class will look for <code class="language-plaintext highlighter-rouge">northwest_customers</code> as its table. The default is an empty string.</p>

<h4 id="configactive_recordtable_name_suffix"><code class="language-plaintext highlighter-rouge">config.active_record.table_name_suffix</code></h4>

<p>Lets you set a global string to be appended to table names. If you set this to <code class="language-plaintext highlighter-rouge">_northwest</code>, then the Customer class will look for <code class="language-plaintext highlighter-rouge">customers_northwest</code> as its table. The default is an empty string.</p>

<h4 id="configactive_recordschema_migrations_table_name"><code class="language-plaintext highlighter-rouge">config.active_record.schema_migrations_table_name</code></h4>

<p>Lets you set a string to be used as the name of the schema migrations table.</p>

<h4 id="configactive_recordinternal_metadata_table_name"><code class="language-plaintext highlighter-rouge">config.active_record.internal_metadata_table_name</code></h4>

<p>Lets you set a string to be used as the name of the internal metadata table.</p>

<h4 id="configactive_recordprotected_environments"><code class="language-plaintext highlighter-rouge">config.active_record.protected_environments</code></h4>

<p>Lets you set an array of names of environments where destructive actions should be prohibited.</p>

<h4 id="configactive_recordpluralize_table_names"><code class="language-plaintext highlighter-rouge">config.active_record.pluralize_table_names</code></h4>

<p>Specifies whether Rails will look for singular or plural table names in the database. If set to <code class="language-plaintext highlighter-rouge">true</code> (the default), then the Customer class will use the <code class="language-plaintext highlighter-rouge">customers</code> table. If set to <code class="language-plaintext highlighter-rouge">false</code>, then the Customer class will use the <code class="language-plaintext highlighter-rouge">customer</code> table.</p>

<p>WARNING: Some Rails generators and installers (notably <code class="language-plaintext highlighter-rouge">active_storage:install</code>
and <code class="language-plaintext highlighter-rouge">action_text:install</code>) create tables with plural names regardless of this
setting. If you set <code class="language-plaintext highlighter-rouge">pluralize_table_names</code> to <code class="language-plaintext highlighter-rouge">false</code>, you will need to
manually rename those tables after installation to maintain consistency.
This limitation exists because these installers use fixed table names
in their migrations for compatibility reasons.</p>

<h4 id="configactive_recorddefault_timezone"><code class="language-plaintext highlighter-rouge">config.active_record.default_timezone</code></h4>

<p>Determines whether to use <code class="language-plaintext highlighter-rouge">Time.local</code> (if set to <code class="language-plaintext highlighter-rouge">:local</code>) or <code class="language-plaintext highlighter-rouge">Time.utc</code> (if set to <code class="language-plaintext highlighter-rouge">:utc</code>) when pulling dates and times from the database. The default is <code class="language-plaintext highlighter-rouge">:utc</code>.</p>

<h4 id="configactive_recordschema_format"><code class="language-plaintext highlighter-rouge">config.active_record.schema_format</code></h4>

<p>Controls the format for dumping the database schema to a file. The options are <code class="language-plaintext highlighter-rouge">:ruby</code> (the default) for a database-independent version that depends on migrations, or <code class="language-plaintext highlighter-rouge">:sql</code> for a set of (potentially database-dependent) SQL statements. This can be overridden per-database by setting <code class="language-plaintext highlighter-rouge">schema_format</code> in your database configuration.</p>

<h4 id="configactive_recorderror_on_ignored_order"><code class="language-plaintext highlighter-rouge">config.active_record.error_on_ignored_order</code></h4>

<p>Specifies if an error should be raised if the order of a query is ignored during a batch query. The options are <code class="language-plaintext highlighter-rouge">true</code> (raise error) or <code class="language-plaintext highlighter-rouge">false</code> (warn). Default is <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configactive_recordtimestamped_migrations"><code class="language-plaintext highlighter-rouge">config.active_record.timestamped_migrations</code></h4>

<p>Controls whether migrations are numbered with serial integers or with timestamps. The default is <code class="language-plaintext highlighter-rouge">true</code>, to use timestamps, which are preferred if there are multiple developers working on the same application.</p>

<h4 id="configactive_recordautomatically_invert_plural_associations"><code class="language-plaintext highlighter-rouge">config.active_record.automatically_invert_plural_associations</code></h4>

<p>Controls whether Active Record will automatically look for inverse relations with a pluralized name.</p>

<p>Example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Post</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:comments</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Comment</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">belongs_to</span> <span class="ss">:post</span>
<span class="k">end</span>
</code></pre></div></div>

<p>In the above case Active Record used to only look for a <code class="language-plaintext highlighter-rouge">:comment</code> (singular) association in <code class="language-plaintext highlighter-rouge">Post</code>, and won’t find it.</p>

<p>With this option enabled, it will also look for a <code class="language-plaintext highlighter-rouge">:comments</code> association. In the vast majority of cases
having the inverse association discovered is beneficial as it can prevent some useless queries, but
it may cause backward compatibility issues with legacy code that doesn’t expect it.</p>

<p>This behavior can be disabled on a per-model basis:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Comment</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">automatically_invert_plural_associations</span> <span class="o">=</span> <span class="kp">false</span>

  <span class="n">belongs_to</span> <span class="ss">:post</span>
<span class="k">end</span>
</code></pre></div></div>

<p>And on a per-association basis:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Comment</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">automatically_invert_plural_associations</span> <span class="o">=</span> <span class="kp">true</span>

  <span class="n">belongs_to</span> <span class="ss">:post</span><span class="p">,</span> <span class="ss">inverse_of: </span><span class="kp">nil</span>
<span class="k">end</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordvalidate_migration_timestamps"><code class="language-plaintext highlighter-rouge">config.active_record.validate_migration_timestamps</code></h4>

<p>Controls whether to validate migration timestamps. When set, an error will be raised if the
timestamp prefix for a migration is more than a day ahead of the timestamp associated with the
current time. This is done to prevent forward-dating of migration files, which can impact migration
generation and other migration commands. <code class="language-plaintext highlighter-rouge">config.active_record.timestamped_migrations</code> must be set to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.2</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recorddb_warnings_action"><code class="language-plaintext highlighter-rouge">config.active_record.db_warnings_action</code></h4>

<p>Controls the action to be taken when an SQL query produces a warning. The following options are available:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:ignore</code> - Database warnings will be ignored. This is the default.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:log</code> - Database warnings will be logged via <code class="language-plaintext highlighter-rouge">ActiveRecord.logger</code> at the <code class="language-plaintext highlighter-rouge">:warn</code> level.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:raise</code> - Database warnings will be raised as <code class="language-plaintext highlighter-rouge">ActiveRecord::SQLWarning</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:report</code> - Database warnings will be reported to subscribers of Rails’ error reporter.</p>
  </li>
  <li>
    <p>Custom proc - A custom proc can be provided. It should accept a <code class="language-plaintext highlighter-rouge">SQLWarning</code> error object.</p>

    <p>For example:</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">db_warnings_action</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span> <span class="k">do</span>
  <span class="c1"># Report to custom exception reporting service</span>
  <span class="no">Bugsnag</span><span class="p">.</span><span class="nf">notify</span><span class="p">(</span><span class="n">warning</span><span class="p">.</span><span class="nf">message</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">notification</span><span class="o">|</span>
    <span class="n">notification</span><span class="p">.</span><span class="nf">add_metadata</span><span class="p">(</span><span class="ss">:warning_code</span><span class="p">,</span> <span class="n">warning</span><span class="p">.</span><span class="nf">code</span><span class="p">)</span>
    <span class="n">notification</span><span class="p">.</span><span class="nf">add_metadata</span><span class="p">(</span><span class="ss">:warning_level</span><span class="p">,</span> <span class="n">warning</span><span class="p">.</span><span class="nf">level</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="configactive_recorddb_warnings_ignore"><code class="language-plaintext highlighter-rouge">config.active_record.db_warnings_ignore</code></h4>

<p>Specifies an allowlist of warning codes and messages that will be ignored, regardless of the configured <code class="language-plaintext highlighter-rouge">db_warnings_action</code>.
The default behavior is to report all warnings. Warnings to ignore can be specified as Strings or Regexps. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">db_warnings_action</span> <span class="o">=</span> <span class="ss">:raise</span>
  <span class="c1"># The following warnings will not be raised</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">db_warnings_ignore</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sr">/Invalid utf8mb4 character string/</span><span class="p">,</span>
    <span class="s2">"An exact warning message"</span><span class="p">,</span>
    <span class="s2">"1062"</span><span class="p">,</span> <span class="c1"># MySQL Error 1062: Duplicate entry</span>
  <span class="p">]</span>
</code></pre></div></div>

<h4 id="configactive_recordmigration_strategy"><code class="language-plaintext highlighter-rouge">config.active_record.migration_strategy</code></h4>

<p>Controls the strategy class used to perform schema statement methods in a migration. The default class
delegates to the connection adapter. Custom strategies should inherit from <code class="language-plaintext highlighter-rouge">ActiveRecord::Migration::ExecutionStrategy</code>,
or may inherit from <code class="language-plaintext highlighter-rouge">DefaultStrategy</code>, which will preserve the default behaviour for methods that aren’t implemented:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CustomMigrationStrategy</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span><span class="o">::</span><span class="no">DefaultStrategy</span>
  <span class="k">def</span> <span class="nf">drop_table</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
    <span class="k">raise</span> <span class="s2">"Dropping tables is not supported!"</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">migration_strategy</span> <span class="o">=</span> <span class="no">CustomMigrationStrategy</span>
</code></pre></div></div>

<h4 id="configactive_recordschema_versions_formatter"><code class="language-plaintext highlighter-rouge">config.active_record.schema_versions_formatter</code></h4>

<p>Controls the formatter class used by schema dumper to format versions information. Custom class can be provided
to change the default behavior:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CustomSchemaVersionsFormatter</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
    <span class="vi">@connection</span> <span class="o">=</span> <span class="n">connection</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="n">versions</span><span class="p">)</span>
    <span class="c1"># Special sorting of versions to reduce the likelihood of conflicts.</span>
    <span class="n">sorted_versions</span> <span class="o">=</span> <span class="n">versions</span><span class="p">.</span><span class="nf">sort</span> <span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">|</span> <span class="n">b</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">reverse</span> <span class="o">&lt;=&gt;</span> <span class="n">a</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">reverse</span> <span class="p">}</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="o">+</span><span class="s2">"INSERT INTO schema_migrations (version) VALUES</span><span class="se">\n</span><span class="s2">"</span>
    <span class="n">sql</span> <span class="o">&lt;&lt;</span> <span class="n">sorted_versions</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">v</span><span class="o">|</span> <span class="s2">"(</span><span class="si">#{</span><span class="vi">@connection</span><span class="p">.</span><span class="nf">quote</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span> <span class="p">}.</span><span class="nf">join</span><span class="p">(</span><span class="s2">",</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">sql</span> <span class="o">&lt;&lt;</span> <span class="s2">";"</span>
    <span class="n">sql</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">schema_versions_formatter</span> <span class="o">=</span> <span class="no">CustomSchemaVersionsFormatter</span>
</code></pre></div></div>

<h4 id="configactive_recordlock_optimistically"><code class="language-plaintext highlighter-rouge">config.active_record.lock_optimistically</code></h4>

<p>Controls whether Active Record will use optimistic locking and is <code class="language-plaintext highlighter-rouge">true</code> by default.</p>

<h4 id="configactive_recordcache_timestamp_format"><code class="language-plaintext highlighter-rouge">config.active_record.cache_timestamp_format</code></h4>

<p>Controls the format of the timestamp value in the cache key. Default is <code class="language-plaintext highlighter-rouge">:usec</code>.</p>

<h4 id="configactive_recordrecord_timestamps"><code class="language-plaintext highlighter-rouge">config.active_record.record_timestamps</code></h4>

<p>Is a boolean value which controls whether or not timestamping of <code class="language-plaintext highlighter-rouge">create</code> and <code class="language-plaintext highlighter-rouge">update</code> operations on a model occur. The default value is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configactive_recordpartial_inserts"><code class="language-plaintext highlighter-rouge">config.active_record.partial_inserts</code></h4>

<p>Is a boolean value and controls whether or not partial writes are used when creating new records (i.e. whether inserts only set attributes that are different from the default).</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordpartial_updates"><code class="language-plaintext highlighter-rouge">config.active_record.partial_updates</code></h4>

<p>Is a boolean value and controls whether or not partial writes are used when updating existing records (i.e. whether updates only set attributes that are dirty). Note that when using partial updates, you should also use optimistic locking <code class="language-plaintext highlighter-rouge">config.active_record.lock_optimistically</code> since concurrent updates may write attributes based on a possibly stale read state. The default value is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configactive_recordmaintain_test_schema"><code class="language-plaintext highlighter-rouge">config.active_record.maintain_test_schema</code></h4>

<p>Is a boolean value which controls whether Active Record should try to keep your test database schema up-to-date with <code class="language-plaintext highlighter-rouge">db/schema.rb</code> (or <code class="language-plaintext highlighter-rouge">db/structure.sql</code>) when you run your tests. The default is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configactive_recorddump_schema_after_migration"><code class="language-plaintext highlighter-rouge">config.active_record.dump_schema_after_migration</code></h4>

<p>Is a flag which controls whether or not schema dump should happen
(<code class="language-plaintext highlighter-rouge">db/schema.rb</code> or <code class="language-plaintext highlighter-rouge">db/structure.sql</code>) when you run migrations. This is set to
<code class="language-plaintext highlighter-rouge">false</code> in <code class="language-plaintext highlighter-rouge">config/environments/production.rb</code> which is generated by Rails. The
default value is <code class="language-plaintext highlighter-rouge">true</code> if this configuration is not set.</p>

<h4 id="configactive_recorddump_schemas"><code class="language-plaintext highlighter-rouge">config.active_record.dump_schemas</code></h4>

<p>Controls which database schemas will be dumped when calling <code class="language-plaintext highlighter-rouge">db:schema:dump</code>.
The options are <code class="language-plaintext highlighter-rouge">:schema_search_path</code> (the default) which dumps any schemas listed in <code class="language-plaintext highlighter-rouge">schema_search_path</code>,
<code class="language-plaintext highlighter-rouge">:all</code> which always dumps all schemas regardless of the <code class="language-plaintext highlighter-rouge">schema_search_path</code>,
or a string of comma separated schemas.</p>

<h4 id="configactive_recordbefore_committed_on_all_records"><code class="language-plaintext highlighter-rouge">config.active_record.before_committed_on_all_records</code></h4>

<p>Enable before_committed! callbacks on all enrolled records in a transaction.
The previous behavior was to only run the callbacks on the first copy of a record
if there were multiple copies of the same record enrolled in the transaction.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordbelongs_to_required_by_default"><code class="language-plaintext highlighter-rouge">config.active_record.belongs_to_required_by_default</code></h4>

<p>Is a boolean value and controls whether a record fails validation if
<code class="language-plaintext highlighter-rouge">belongs_to</code> association is not present.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
    <tr>
      <td>5.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordbelongs_to_required_validates_foreign_key"><code class="language-plaintext highlighter-rouge">config.active_record.belongs_to_required_validates_foreign_key</code></h4>

<p>Enable validating only parent-related columns for presence when the parent is mandatory.
The previous behavior was to validate the presence of the parent record, which performed an extra query
to get the parent every time the child record was updated, even when parent has not changed.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordmarshalling_format_version"><code class="language-plaintext highlighter-rouge">config.active_record.marshalling_format_version</code></h4>

<p>When set to <code class="language-plaintext highlighter-rouge">7.1</code>, enables a more efficient serialization of Active Record instance with <code class="language-plaintext highlighter-rouge">Marshal.dump</code>.</p>

<p>This changes the serialization format, so models serialized this
way cannot be read by older (&lt; 7.1) versions of Rails. However, messages that
use the old format can still be read, regardless of whether this optimization is
enabled.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">6.1</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">7.1</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordaction_on_strict_loading_violation"><code class="language-plaintext highlighter-rouge">config.active_record.action_on_strict_loading_violation</code></h4>

<p>Enables raising or logging an exception if strict_loading is set on an
association. The default value is <code class="language-plaintext highlighter-rouge">:raise</code> in all environments. It can be
changed to <code class="language-plaintext highlighter-rouge">:log</code> to send violations to the logger instead of raising.</p>

<h4 id="configactive_recordstrict_loading_by_default"><code class="language-plaintext highlighter-rouge">config.active_record.strict_loading_by_default</code></h4>

<p>Is a boolean value that either enables or disables strict_loading mode by
default. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configactive_recordstrict_loading_mode"><code class="language-plaintext highlighter-rouge">config.active_record.strict_loading_mode</code></h4>

<p>Sets the mode in which strict loading is reported. Defaults to <code class="language-plaintext highlighter-rouge">:all</code>. It can be
changed to <code class="language-plaintext highlighter-rouge">:n_plus_one_only</code> to only report when loading associations that will
lead to an N + 1 query.</p>

<h4 id="configactive_recordindex_nested_attribute_errors"><code class="language-plaintext highlighter-rouge">config.active_record.index_nested_attribute_errors</code></h4>

<p>Allows errors for nested <code class="language-plaintext highlighter-rouge">has_many</code> relationships to be displayed with an index
as well as the error. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configactive_recorduse_schema_cache_dump"><code class="language-plaintext highlighter-rouge">config.active_record.use_schema_cache_dump</code></h4>

<p>Enables users to get schema cache information from <code class="language-plaintext highlighter-rouge">db/schema_cache.yml</code>
(generated by <code class="language-plaintext highlighter-rouge">bin/rails db:schema:cache:dump</code>), instead of having to send a
query to the database to get this information. Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configactive_recordcache_versioning"><code class="language-plaintext highlighter-rouge">config.active_record.cache_versioning</code></h4>

<p>Indicates whether to use a stable <code class="language-plaintext highlighter-rouge">#cache_key</code> method that is accompanied by a
changing version in the <code class="language-plaintext highlighter-rouge">#cache_version</code> method.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>5.2</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordcollection_cache_versioning"><code class="language-plaintext highlighter-rouge">config.active_record.collection_cache_versioning</code></h4>

<p>Enables the same cache key to be reused when the object being cached of type
<code class="language-plaintext highlighter-rouge">ActiveRecord::Relation</code> changes by moving the volatile information (max
updated at and count) of the relation’s cache key into the cache version to
support recycling cache key.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>6.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordhas_many_inversing"><code class="language-plaintext highlighter-rouge">config.active_record.has_many_inversing</code></h4>

<p>Enables setting the inverse record when traversing <code class="language-plaintext highlighter-rouge">belongs_to</code> to <code class="language-plaintext highlighter-rouge">has_many</code>
associations.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordautomatic_scope_inversing"><code class="language-plaintext highlighter-rouge">config.active_record.automatic_scope_inversing</code></h4>

<p>Enables automatically inferring the <code class="language-plaintext highlighter-rouge">inverse_of</code> for associations with a scope.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recorddestroy_association_async_job"><code class="language-plaintext highlighter-rouge">config.active_record.destroy_association_async_job</code></h4>

<p>Allows specifying the job that will be used to destroy the associated records in background. It defaults to <code class="language-plaintext highlighter-rouge">ActiveRecord::DestroyAssociationAsyncJob</code>.</p>

<h4 id="configactive_recorddestroy_association_async_batch_size"><code class="language-plaintext highlighter-rouge">config.active_record.destroy_association_async_batch_size</code></h4>

<p>Allows specifying the maximum number of records that will be destroyed in a background job by the <code class="language-plaintext highlighter-rouge">dependent: :destroy_async</code> association option. All else equal, a lower batch size will enqueue more, shorter-running background jobs, while a higher batch size will enqueue fewer, longer-running background jobs. This option defaults to <code class="language-plaintext highlighter-rouge">nil</code>, which will cause all dependent records for a given association to be destroyed in the same background job.</p>

<h4 id="configactive_recordqueuesdestroy"><code class="language-plaintext highlighter-rouge">config.active_record.queues.destroy</code></h4>

<p>Allows specifying the Active Job queue to use for destroy jobs. When this option
is <code class="language-plaintext highlighter-rouge">nil</code>, purge jobs are sent to the default Active Job queue (see
<a href="#config-active-job-default-queue-name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></a>). It defaults to <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<h4 id="configactive_recordenumerate_columns_in_select_statements"><code class="language-plaintext highlighter-rouge">config.active_record.enumerate_columns_in_select_statements</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">true</code>, will always include column names in <code class="language-plaintext highlighter-rouge">SELECT</code> statements, and avoid wildcard <code class="language-plaintext highlighter-rouge">SELECT * FROM ...</code> queries. This avoids prepared statement cache errors when adding columns to a PostgreSQL database for example. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configactive_recordverify_foreign_keys_for_fixtures"><code class="language-plaintext highlighter-rouge">config.active_record.verify_foreign_keys_for_fixtures</code></h4>

<p>Ensures all foreign key constraints are valid after fixtures are loaded in tests. Supported by PostgreSQL and SQLite only.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordraise_on_assign_to_attr_readonly"><code class="language-plaintext highlighter-rouge">config.active_record.raise_on_assign_to_attr_readonly</code></h4>

<p>Enable raising on assignment to attr_readonly attributes. The previous
behavior would allow assignment but silently not persist changes to the
database.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordrun_commit_callbacks_on_first_saved_instances_in_transaction"><code class="language-plaintext highlighter-rouge">config.active_record.run_commit_callbacks_on_first_saved_instances_in_transaction</code></h4>

<p>When multiple Active Record instances change the same record within a transaction, Rails runs <code class="language-plaintext highlighter-rouge">after_commit</code> or <code class="language-plaintext highlighter-rouge">after_rollback</code> callbacks for only one of them. This option specifies how Rails chooses which instance receives the callbacks.</p>

<p>When <code class="language-plaintext highlighter-rouge">true</code>, transactional callbacks are run on the first instance to save, even though its instance state may be stale.</p>

<p>When <code class="language-plaintext highlighter-rouge">false</code>, transactional callbacks are run on the instances with the freshest instance state. Those instances are chosen as follows:</p>

<ul>
  <li>In general, run transactional callbacks on the last instance to save a given record within the transaction.</li>
  <li>There are two exceptions:
    <ul>
      <li>If the record is created within the transaction, then updated by another instance, <code class="language-plaintext highlighter-rouge">after_create_commit</code> callbacks will be run on the second instance. This is instead of the <code class="language-plaintext highlighter-rouge">after_update_commit</code> callbacks that would naively be run based on that instance’s state.</li>
      <li>If the record is destroyed within the transaction, then <code class="language-plaintext highlighter-rouge">after_destroy_commit</code> callbacks will be fired on the last destroyed instance, even if a stale instance subsequently performed an update (which will have affected 0 rows).</li>
    </ul>
  </li>
</ul>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recorddefault_column_serializer"><code class="language-plaintext highlighter-rouge">config.active_record.default_column_serializer</code></h4>

<p>The serializer implementation to use if none is explicitly specified for a given
column.</p>

<p>Historically <code class="language-plaintext highlighter-rouge">serialize</code> and <code class="language-plaintext highlighter-rouge">store</code> while allowing to use alternative serializer
implementations, would use <code class="language-plaintext highlighter-rouge">YAML</code> by default, but it’s not a very efficient format
and can be the source of security vulnerabilities if not carefully employed.</p>

<p>As such it is recommended to prefer stricter, more limited formats for database
serialization.</p>

<p>Unfortunately there isn’t really any suitable defaults available in Ruby’s standard
library. <code class="language-plaintext highlighter-rouge">JSON</code> could work as a format, but the <code class="language-plaintext highlighter-rouge">json</code> gems will cast unsupported
types to strings which may lead to bugs.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">YAML</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordrun_after_transaction_callbacks_in_order_defined"><code class="language-plaintext highlighter-rouge">config.active_record.run_after_transaction_callbacks_in_order_defined</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">true</code>, <code class="language-plaintext highlighter-rouge">after_commit</code> callbacks are executed in the order they are defined in a model. When <code class="language-plaintext highlighter-rouge">false</code>, they are executed in reverse order.</p>

<p>All other callbacks are always executed in the order they are defined in a model (unless you use <code class="language-plaintext highlighter-rouge">prepend: true</code>).</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordquery_log_tags_enabled"><code class="language-plaintext highlighter-rouge">config.active_record.query_log_tags_enabled</code></h4>

<p>Specifies whether or not to enable adapter-level query comments. Defaults to
<code class="language-plaintext highlighter-rouge">false</code>, but is set to <code class="language-plaintext highlighter-rouge">true</code> in the default generated <code class="language-plaintext highlighter-rouge">config/environments/development.rb</code> file.</p>

<p>NOTE: When this is set to <code class="language-plaintext highlighter-rouge">true</code> database prepared statements will be automatically disabled.</p>

<h4 id="configactive_recordquery_log_tags"><code class="language-plaintext highlighter-rouge">config.active_record.query_log_tags</code></h4>

<p>Define an <code class="language-plaintext highlighter-rouge">Array</code> specifying the key/value tags to be inserted in an SQL comment. Defaults to
<code class="language-plaintext highlighter-rouge">[ :application, :controller, :action, :job ]</code>. The available tags are: <code class="language-plaintext highlighter-rouge">:application</code>, <code class="language-plaintext highlighter-rouge">:controller</code>,
<code class="language-plaintext highlighter-rouge">:namespaced_controller</code>, <code class="language-plaintext highlighter-rouge">:action</code>, <code class="language-plaintext highlighter-rouge">:job</code>, and <code class="language-plaintext highlighter-rouge">:source_location</code>.</p>

<h4 id="configactive_recordquery_log_tags_format"><code class="language-plaintext highlighter-rouge">config.active_record.query_log_tags_format</code></h4>

<p>A <code class="language-plaintext highlighter-rouge">Symbol</code> specifying the formatter to use for tags. Valid values are <code class="language-plaintext highlighter-rouge">:sqlcommenter</code> and <code class="language-plaintext highlighter-rouge">:legacy</code>.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:legacy</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">:sqlcommenter</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordcache_query_log_tags"><code class="language-plaintext highlighter-rouge">config.active_record.cache_query_log_tags</code></h4>

<p>Specifies whether or not to enable caching of query log tags. For applications
that have a large number of queries, caching query log tags can provide a
performance benefit when the context does not change during the lifetime of the
request or job execution. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configactive_recordquery_log_tags_prepend_comment"><code class="language-plaintext highlighter-rouge">config.active_record.query_log_tags_prepend_comment</code></h4>

<p>Specifies whether or not to prepend query log tags comment to the query.</p>

<p>By default comments are appended at the end of the query. Certain databases, such as MySQL will
truncate the query text. This is the case for slow query logs and the results of querying
some InnoDB internal tables where the length of the query is more than 1024 bytes.
In order to not lose the log tags comments from the queries, you can prepend the comments using this option.</p>

<p>Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configactive_recordschema_cache_ignored_tables"><code class="language-plaintext highlighter-rouge">config.active_record.schema_cache_ignored_tables</code></h4>

<p>Define the list of table that should be ignored when generating the schema
cache. It accepts an <code class="language-plaintext highlighter-rouge">Array</code> of strings, representing the table names, or
regular expressions.</p>

<h4 id="configactive_recordverbose_query_logs"><code class="language-plaintext highlighter-rouge">config.active_record.verbose_query_logs</code></h4>

<p>Specifies if source locations of methods that call database queries should be logged below relevant queries. By default, the flag is <code class="language-plaintext highlighter-rouge">true</code> in development and <code class="language-plaintext highlighter-rouge">false</code> in all other environments.</p>

<h4 id="configactive_recordsqlite3_adapter_strict_strings_by_default"><code class="language-plaintext highlighter-rouge">config.active_record.sqlite3_adapter_strict_strings_by_default</code></h4>

<p>Specifies whether the SQLite3Adapter should be used in a strict strings mode.
The use of a strict strings mode disables double-quoted string literals.</p>

<p>SQLite has some quirks around double-quoted string literals.
It first tries to consider double-quoted strings as identifier names, but if they don’t exist
it then considers them as string literals. Because of this, typos can silently go unnoticed.
For example, it is possible to create an index for a non existing column.
See <a href="https://www.sqlite.org/quirks.html#double_quoted_string_literals_are_accepted">SQLite documentation</a> for more details.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordpostgresql_adapter_decode_dates"><code class="language-plaintext highlighter-rouge">config.active_record.postgresql_adapter_decode_dates</code></h4>

<p>Specifies whether the PostgresqlAdapter should decode date columns.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">connection</span>
     <span class="p">.</span><span class="nf">select_value</span><span class="p">(</span><span class="s2">"select '2024-01-01'::date"</span><span class="p">).</span><span class="nf">class</span> <span class="c1">#=&gt; Date</span>
</code></pre></div></div>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.2</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordasync_query_executor"><code class="language-plaintext highlighter-rouge">config.active_record.async_query_executor</code></h4>

<p>Specifies how asynchronous queries are pooled.</p>

<p>It defaults to <code class="language-plaintext highlighter-rouge">nil</code>, which means <code class="language-plaintext highlighter-rouge">load_async</code> is disabled and instead directly executes queries in the foreground.
For queries to actually be performed asynchronously, it must be set to either <code class="language-plaintext highlighter-rouge">:global_thread_pool</code> or <code class="language-plaintext highlighter-rouge">:multi_thread_pool</code>.</p>

<p><code class="language-plaintext highlighter-rouge">:global_thread_pool</code> will use a single pool for all databases the application connects to. This is the preferred configuration
for applications with only a single database, or applications which only ever query one database shard at a time.</p>

<p><code class="language-plaintext highlighter-rouge">:multi_thread_pool</code> will use one pool per database, and each pool size can be configured individually in <code class="language-plaintext highlighter-rouge">database.yml</code> through the
<code class="language-plaintext highlighter-rouge">max_threads</code> and <code class="language-plaintext highlighter-rouge">min_threads</code> properties. This can be useful to applications regularly querying multiple databases at a time, and that need to more precisely define the max concurrency.</p>

<h4 id="configactive_recordglobal_executor_concurrency"><code class="language-plaintext highlighter-rouge">config.active_record.global_executor_concurrency</code></h4>

<p>Used in conjunction with <code class="language-plaintext highlighter-rouge">config.active_record.async_query_executor = :global_thread_pool</code>, defines how many asynchronous
queries can be executed concurrently.</p>

<p>Defaults to <code class="language-plaintext highlighter-rouge">4</code>.</p>

<p>This number must be considered in accordance with the database connection pool size configured in <code class="language-plaintext highlighter-rouge">database.yml</code>. The connection pool
should be large enough to accommodate both the foreground threads (ie. web server or job worker threads) and background threads.</p>

<p>For each process, Rails will create one global query executor that uses this many threads to process async queries. Thus, the pool size
should be at least <code class="language-plaintext highlighter-rouge">thread_count + global_executor_concurrency + 1</code>. For example, if your web server has a maximum of 3 threads,
and <code class="language-plaintext highlighter-rouge">global_executor_concurrency</code> is set to 4, then your pool size should be at least 8.</p>

<h4 id="configactive_recordyaml_column_permitted_classes"><code class="language-plaintext highlighter-rouge">config.active_record.yaml_column_permitted_classes</code></h4>

<p>Defaults to <code class="language-plaintext highlighter-rouge">[Symbol]</code>. Allows applications to include additional permitted classes to <code class="language-plaintext highlighter-rouge">safe_load()</code> on the <code class="language-plaintext highlighter-rouge">ActiveRecord::Coders::YAMLColumn</code>.</p>

<h4 id="configactive_recorduse_yaml_unsafe_load"><code class="language-plaintext highlighter-rouge">config.active_record.use_yaml_unsafe_load</code></h4>

<p>Defaults to <code class="language-plaintext highlighter-rouge">false</code>. Allows applications to opt into using <code class="language-plaintext highlighter-rouge">unsafe_load</code> on the <code class="language-plaintext highlighter-rouge">ActiveRecord::Coders::YAMLColumn</code>.</p>

<h4 id="configactive_recordraise_int_wider_than_64bit"><code class="language-plaintext highlighter-rouge">config.active_record.raise_int_wider_than_64bit</code></h4>

<p>Defaults to <code class="language-plaintext highlighter-rouge">true</code>. Determines whether to raise an exception or not when
the PostgreSQL adapter is provided an integer that is wider than signed
64bit representation.</p>

<h4 id="configactive_recordgenerate_secure_token_on"><code class="language-plaintext highlighter-rouge">config.active_record.generate_secure_token_on</code></h4>

<p>Controls when to generate a value for <code class="language-plaintext highlighter-rouge">has_secure_token</code> declarations. By
default, generate the value when the model is initialized:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_secure_token</span>
<span class="k">end</span>

<span class="n">record</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">new</span>
<span class="n">record</span><span class="p">.</span><span class="nf">token</span> <span class="c1"># =&gt; "fwZcXX6SkJBJRogzMdciS7wf"</span>
</code></pre></div></div>

<p>With <code class="language-plaintext highlighter-rouge">config.active_record.generate_secure_token_on = :create</code>, generate the
value when the model is created:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/application.rb</span>

<span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">generate_secure_token_on</span> <span class="o">=</span> <span class="ss">:create</span>

<span class="c1"># app/models/user.rb</span>
<span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_secure_token</span> <span class="ss">on: :create</span>
<span class="k">end</span>

<span class="n">record</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">new</span>
<span class="n">record</span><span class="p">.</span><span class="nf">token</span> <span class="c1"># =&gt; nil</span>
<span class="n">record</span><span class="p">.</span><span class="nf">save!</span>
<span class="n">record</span><span class="p">.</span><span class="nf">token</span> <span class="c1"># =&gt; "fwZcXX6SkJBJRogzMdciS7wf"</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:create</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">:initialize</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordpermanent_connection_checkout"><code class="language-plaintext highlighter-rouge">config.active_record.permanent_connection_checkout</code></h4>

<p>Controls whether <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.connection</code> raises an error, emits a deprecation warning, or neither.</p>

<p><code class="language-plaintext highlighter-rouge">ActiveRecord::Base.connection</code> checkouts a database connection from the pool and keeps it leased until the end of
the request or job. This behavior can be undesirable in environments that use many more threads or fibers than there
is available connections.</p>

<p>This configuration can be used to track down and eliminate code that calls <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.connection</code> and
migrate it to use <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.with_connection</code> instead.</p>

<p>The value can be set to <code class="language-plaintext highlighter-rouge">:disallowed</code>, <code class="language-plaintext highlighter-rouge">:deprecated</code>, or <code class="language-plaintext highlighter-rouge">true</code> to respectively raise an error, emit a deprecation
warning, or neither.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recorddatabase_cli"><code class="language-plaintext highlighter-rouge">config.active_record.database_cli</code></h4>

<p>Controls which CLI tool will be used for accessing the database when running <code class="language-plaintext highlighter-rouge">bin/rails dbconsole</code>. By default
the standard tool for the database will be used (e.g. <code class="language-plaintext highlighter-rouge">psql</code> for PostgreSQL and <code class="language-plaintext highlighter-rouge">mysql</code> for MySQL). The option
takes a hash which specifies the tool per-database system, and an array can be used where fallback options are
required:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/application.rb</span>

<span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">database_cli</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">postgresql: </span><span class="s2">"pgcli"</span><span class="p">,</span> <span class="ss">mysql: </span><span class="sx">%w[ mycli mysql ]</span> <span class="p">}</span>
</code></pre></div></div>

<h4 id="configactive_recorduse_legacy_signed_id_verifier"><code class="language-plaintext highlighter-rouge">config.active_record.use_legacy_signed_id_verifier</code></h4>

<p>Controls whether signed IDs are generated and verified using legacy options. Can be set to:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:generate_and_verify</code> (default) - Generate and verify signed IDs using the following legacy options:</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="p">{</span> <span class="ss">digest: </span><span class="s2">"SHA256"</span><span class="p">,</span> <span class="ss">serializer: </span><span class="no">JSON</span><span class="p">,</span> <span class="ss">url_safe: </span><span class="kp">true</span> <span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:verify</code> - Generate and verify signed IDs using options from <a href="https://api.rubyonrails.org/classes/Rails/Application.html#method-i-message_verifiers"><code class="language-plaintext highlighter-rouge">Rails.application.message_verifiers</code></a>, but fall back to verifying with the same options as <code class="language-plaintext highlighter-rouge">:generate_and_verify</code>.</p>
  </li>
  <li>
    <p>false - Generate and verify signed IDs using options from <a href="https://api.rubyonrails.org/classes/Rails/Application.html#method-i-message_verifiers"><code class="language-plaintext highlighter-rouge">Rails.application.message_verifiers</code></a> only.</p>
  </li>
</ul>

<p>The purpose of this setting is to provide a smooth transition to a unified configuration for all message verifiers. Having a unified configuration makes it more straightforward to rotate secrets and upgrade signing algorithms.</p>

<p>WARNING: Setting this to false may cause old signed IDs to become unreadable if <code class="language-plaintext highlighter-rouge">Rails.application.message_verifiers</code> is not properly configured. Use <a href="https://api.rubyonrails.org/classes/ActiveSupport/MessageVerifiers.html#method-i-rotate"><code class="language-plaintext highlighter-rouge">MessageVerifiers#rotate</code></a> or <a href="https://api.rubyonrails.org/classes/ActiveSupport/MessageVerifiers.html#method-i-prepend"><code class="language-plaintext highlighter-rouge">MessageVerifiers#prepend</code></a> to configure <code class="language-plaintext highlighter-rouge">Rails.application.message_verifiers</code> with the appropriate options, such as <code class="language-plaintext highlighter-rouge">:digest</code> and <code class="language-plaintext highlighter-rouge">:url_safe</code>.</p>

<h4 id="activerecordconnectionadaptersmysql2adapteremulate_booleans-and-activerecordconnectionadapterstrilogyadapteremulate_booleans"><code class="language-plaintext highlighter-rouge">ActiveRecord::ConnectionAdapters::Mysql2Adapter.emulate_booleans</code> and <code class="language-plaintext highlighter-rouge">ActiveRecord::ConnectionAdapters::TrilogyAdapter.emulate_booleans</code></h4>

<p>Controls whether the Active Record MySQL adapter will consider all <code class="language-plaintext highlighter-rouge">tinyint(1)</code> columns as booleans. Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="activerecordconnectionadapterspostgresqladaptercreate_unlogged_tables"><code class="language-plaintext highlighter-rouge">ActiveRecord::ConnectionAdapters::PostgreSQLAdapter.create_unlogged_tables</code></h4>

<p>Controls whether database tables created by PostgreSQL should be “unlogged”, which can speed
up performance but adds a risk of data loss if the database crashes. It is
highly recommended that you do not enable this in a production environment.
Defaults to <code class="language-plaintext highlighter-rouge">false</code> in all environments.</p>

<p>To enable this for tests:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/environments/test.rb</span>

<span class="no">ActiveSupport</span><span class="p">.</span><span class="nf">on_load</span><span class="p">(</span><span class="ss">:active_record_postgresqladapter</span><span class="p">)</span> <span class="k">do</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">create_unlogged_tables</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="activerecordconnectionadapterspostgresqladapterdatetime_type"><code class="language-plaintext highlighter-rouge">ActiveRecord::ConnectionAdapters::PostgreSQLAdapter.datetime_type</code></h4>

<p>Controls what native type the Active Record PostgreSQL adapter should use when you call <code class="language-plaintext highlighter-rouge">datetime</code> in
a migration or schema. It takes a symbol which must correspond to one of the
configured <code class="language-plaintext highlighter-rouge">NATIVE_DATABASE_TYPES</code>. The default is <code class="language-plaintext highlighter-rouge">:timestamp</code>, meaning
<code class="language-plaintext highlighter-rouge">t.datetime</code> in a migration will create a “timestamp without time zone” column.</p>

<p>To use “timestamp with time zone”:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/application.rb</span>

<span class="no">ActiveSupport</span><span class="p">.</span><span class="nf">on_load</span><span class="p">(</span><span class="ss">:active_record_postgresqladapter</span><span class="p">)</span> <span class="k">do</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">datetime_type</span> <span class="o">=</span> <span class="ss">:timestamptz</span>
<span class="k">end</span>
</code></pre></div></div>

<p>You should run <code class="language-plaintext highlighter-rouge">bin/rails db:migrate</code> to rebuild your schema.rb if you change this.</p>

<h4 id="activerecordschemadumperignore_tables"><code class="language-plaintext highlighter-rouge">ActiveRecord::SchemaDumper.ignore_tables</code></h4>

<p>Accepts an array of tables that should <em>not</em> be included in any generated schema file.</p>

<h4 id="activerecordschemadumperfk_ignore_pattern"><code class="language-plaintext highlighter-rouge">ActiveRecord::SchemaDumper.fk_ignore_pattern</code></h4>

<p>Allows setting a different regular expression that will be used to decide
whether a foreign key’s name should be dumped to db/schema.rb or not. By
default, foreign key names starting with <code class="language-plaintext highlighter-rouge">fk_rails_</code> are not exported to the
database schema dump. Defaults to <code class="language-plaintext highlighter-rouge">/^fk_rails_[0-9a-f]{10}$/</code>.</p>

<h4 id="configactive_recordencryptionadd_to_filter_parameters"><code class="language-plaintext highlighter-rouge">config.active_record.encryption.add_to_filter_parameters</code></h4>

<p>Enables automatic filtering of encrypted attributes on <code class="language-plaintext highlighter-rouge">inspect</code>.</p>

<p>The default value is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configactive_recordencryptionhash_digest_class"><code class="language-plaintext highlighter-rouge">config.active_record.encryption.hash_digest_class</code></h4>

<p>Sets the digest algorithm used by Active Record Encryption.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA1</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA256</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordencryptionsupport_sha1_for_non_deterministic_encryption"><code class="language-plaintext highlighter-rouge">config.active_record.encryption.support_sha1_for_non_deterministic_encryption</code></h4>

<p>Enables support for decrypting existing data encrypted using a SHA-1 digest class. When <code class="language-plaintext highlighter-rouge">false</code>,
it will only support the digest configured in <code class="language-plaintext highlighter-rouge">config.active_record.encryption.hash_digest_class</code>.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_recordencryptioncompressor"><code class="language-plaintext highlighter-rouge">config.active_record.encryption.compressor</code></h4>

<p>Sets the compressor used by Active Record Encryption. The default value is <code class="language-plaintext highlighter-rouge">Zlib</code>.</p>

<p>You can use your own compressor by setting this to a class that responds to <code class="language-plaintext highlighter-rouge">deflate</code> and <code class="language-plaintext highlighter-rouge">inflate</code>.</p>

<h4 id="configactive_recordprotocol_adapters"><code class="language-plaintext highlighter-rouge">config.active_record.protocol_adapters</code></h4>

<p>When using a URL to configure the database connection, this option provides a mapping from the protocol to the underlying
database adapter. For example, this means the environment can specify <code class="language-plaintext highlighter-rouge">DATABASE_URL=mysql://localhost/database</code> and Rails will map
<code class="language-plaintext highlighter-rouge">mysql</code> to the <code class="language-plaintext highlighter-rouge">mysql2</code> adapter, but the application can also override these mappings:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">protocol_adapters</span><span class="p">.</span><span class="nf">mysql</span> <span class="o">=</span> <span class="s2">"trilogy"</span>
</code></pre></div></div>

<p>If no mapping is found, the protocol is used as the adapter name.</p>

<h3 id="configuring-action-controller">Configuring Action Controller</h3>

<p><code class="language-plaintext highlighter-rouge">config.action_controller</code> includes a number of configuration settings:</p>

<h4 id="configaction_controllerasset_host"><code class="language-plaintext highlighter-rouge">config.action_controller.asset_host</code></h4>

<p>Sets the host for the assets. Useful when CDNs are used for hosting assets rather than the application server itself. You should only use this if you have a different configuration for Action Mailer, otherwise use <code class="language-plaintext highlighter-rouge">config.asset_host</code>.</p>

<h4 id="configaction_controllerperform_caching"><code class="language-plaintext highlighter-rouge">config.action_controller.perform_caching</code></h4>

<p>Configures whether the application should perform the caching features provided by the Action Controller component. Set to <code class="language-plaintext highlighter-rouge">false</code> in the development environment, <code class="language-plaintext highlighter-rouge">true</code> in production. If it’s not specified, the default will be <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_controllerdefault_static_extension"><code class="language-plaintext highlighter-rouge">config.action_controller.default_static_extension</code></h4>

<p>Configures the extension used for cached pages. Defaults to <code class="language-plaintext highlighter-rouge">.html</code>.</p>

<h4 id="configaction_controllerinclude_all_helpers"><code class="language-plaintext highlighter-rouge">config.action_controller.include_all_helpers</code></h4>

<p>Configures whether all view helpers are available everywhere or are scoped to the corresponding controller. If set to <code class="language-plaintext highlighter-rouge">false</code>, <code class="language-plaintext highlighter-rouge">UsersHelper</code> methods are only available for views rendered as part of <code class="language-plaintext highlighter-rouge">UsersController</code>. If <code class="language-plaintext highlighter-rouge">true</code>, <code class="language-plaintext highlighter-rouge">UsersHelper</code> methods are available everywhere. The default configuration behavior (when this option is not explicitly set to <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code>) is that all view helpers are available to each controller.</p>

<h4 id="configaction_controllerlogger"><code class="language-plaintext highlighter-rouge">config.action_controller.logger</code></h4>

<p>Accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then used to log information from Action Controller. Set to <code class="language-plaintext highlighter-rouge">nil</code> to disable logging.</p>

<h4 id="configaction_controllerrequest_forgery_protection_token"><code class="language-plaintext highlighter-rouge">config.action_controller.request_forgery_protection_token</code></h4>

<p>Sets the token parameter name for RequestForgery. Calling <code class="language-plaintext highlighter-rouge">protect_from_forgery</code> sets it to <code class="language-plaintext highlighter-rouge">:authenticity_token</code> by default.</p>

<h4 id="configaction_controllerallow_forgery_protection"><code class="language-plaintext highlighter-rouge">config.action_controller.allow_forgery_protection</code></h4>

<p>Enables or disables CSRF protection. By default this is <code class="language-plaintext highlighter-rouge">false</code> in the test environment and <code class="language-plaintext highlighter-rouge">true</code> in all other environments.</p>

<h4 id="configaction_controllerforgery_protection_origin_check"><code class="language-plaintext highlighter-rouge">config.action_controller.forgery_protection_origin_check</code></h4>

<p>Configures whether the HTTP <code class="language-plaintext highlighter-rouge">Origin</code> header should be checked against the site’s origin as an additional CSRF defense.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>5.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_controllerper_form_csrf_tokens"><code class="language-plaintext highlighter-rouge">config.action_controller.per_form_csrf_tokens</code></h4>

<p>Configures whether CSRF tokens are only valid for the method/action they were generated for.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>5.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_controllerdefault_protect_from_forgery"><code class="language-plaintext highlighter-rouge">config.action_controller.default_protect_from_forgery</code></h4>

<p>Determines whether forgery protection is added on <code class="language-plaintext highlighter-rouge">ActionController::Base</code>.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>5.2</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_controllerrelative_url_root"><code class="language-plaintext highlighter-rouge">config.action_controller.relative_url_root</code></h4>

<p>Can be used to tell Rails that you are <a href="configuring.html#deploy-to-a-subdirectory-relative-url-root">deploying to a subdirectory</a>. The default is
<a href="#config-relative-url-root"><code class="language-plaintext highlighter-rouge">config.relative_url_root</code></a>.</p>

<h4 id="configaction_controllerpermit_all_parameters"><code class="language-plaintext highlighter-rouge">config.action_controller.permit_all_parameters</code></h4>

<p>Sets all the parameters for mass assignment to be permitted by default. The default value is <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configaction_controlleraction_on_unpermitted_parameters"><code class="language-plaintext highlighter-rouge">config.action_controller.action_on_unpermitted_parameters</code></h4>

<p>Controls behavior when parameters that are not explicitly permitted are found. The default value is <code class="language-plaintext highlighter-rouge">:log</code> in test and development environments, <code class="language-plaintext highlighter-rouge">false</code> otherwise. The values can be:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">false</code> to take no action</li>
  <li><code class="language-plaintext highlighter-rouge">:log</code> to emit an <code class="language-plaintext highlighter-rouge">ActiveSupport::Notifications.instrument</code> event on the <code class="language-plaintext highlighter-rouge">unpermitted_parameters.action_controller</code> topic and log at the DEBUG level</li>
  <li><code class="language-plaintext highlighter-rouge">:raise</code> to raise a <code class="language-plaintext highlighter-rouge">ActionController::UnpermittedParameters</code> exception</li>
</ul>

<h4 id="configaction_controlleralways_permitted_parameters"><code class="language-plaintext highlighter-rouge">config.action_controller.always_permitted_parameters</code></h4>

<p>Sets a list of permitted parameters that are permitted by default. The default values are <code class="language-plaintext highlighter-rouge">['controller', 'action']</code>.</p>

<h4 id="configaction_controllerenable_fragment_cache_logging"><code class="language-plaintext highlighter-rouge">config.action_controller.enable_fragment_cache_logging</code></h4>

<p>Determines whether to log fragment cache reads and writes in verbose format as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Read fragment views/v1/2914079/v1/2914079/recordings/70182313-20160225015037000000/d0bdf2974e1ef6d31685c3b392ad0b74 (0.6ms)
Rendered messages/_message.html.erb in 1.2 ms [cache hit]
Write fragment views/v1/2914079/v1/2914079/recordings/70182313-20160225015037000000/3b4e249ac9d168c617e32e84b99218b5 (1.1ms)
Rendered recordings/threads/_thread.html.erb in 1.5 ms [cache miss]
</code></pre></div></div>

<p>By default it is set to <code class="language-plaintext highlighter-rouge">false</code> which results in following output:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rendered messages/_message.html.erb in 1.2 ms [cache hit]
Rendered recordings/threads/_thread.html.erb in 1.5 ms [cache miss]
</code></pre></div></div>

<h4 id="configaction_controllerraise_on_missing_callback_actions"><code class="language-plaintext highlighter-rouge">config.action_controller.raise_on_missing_callback_actions</code></h4>

<p>Raises an <code class="language-plaintext highlighter-rouge">AbstractController::ActionNotFound</code> when the action specified in callback’s <code class="language-plaintext highlighter-rouge">:only</code> or <code class="language-plaintext highlighter-rouge">:except</code> options is missing in the controller.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code> (development and test), <code class="language-plaintext highlighter-rouge">false</code> (other envs)</td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_controllerraise_on_open_redirects"><code class="language-plaintext highlighter-rouge">config.action_controller.raise_on_open_redirects</code></h4>

<p>Protect an application from unintentionally redirecting to an external host
(also known as an “open redirect”) by making external redirects opt-in.</p>

<p>When this configuration is set to <code class="language-plaintext highlighter-rouge">true</code>, an
<code class="language-plaintext highlighter-rouge">ActionController::Redirecting::UnsafeRedirectError</code> will be raised when a URL
with an external host is passed to <a href="https://api.rubyonrails.org/classes/ActionController/Redirecting.html#method-i-redirect_to">redirect_to</a>. If an open redirect should
be allowed, then <code class="language-plaintext highlighter-rouge">allow_other_host: true</code> can be added to the call to
<code class="language-plaintext highlighter-rouge">redirect_to</code>.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_controllerlog_query_tags_around_actions"><code class="language-plaintext highlighter-rouge">config.action_controller.log_query_tags_around_actions</code></h4>

<p>Determines whether controller context for query tags will be automatically
updated via an <code class="language-plaintext highlighter-rouge">around_filter</code>. The default value is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_controllerwrap_parameters_by_default"><code class="language-plaintext highlighter-rouge">config.action_controller.wrap_parameters_by_default</code></h4>

<p>Before Rails 7.0, new applications were generated with an initializer named
<code class="language-plaintext highlighter-rouge">wrap_parameters.rb</code> that enabled parameter wrapping in <code class="language-plaintext highlighter-rouge">ActionController::Base</code>
for JSON requests.</p>

<p>Setting this configuration value to <code class="language-plaintext highlighter-rouge">true</code> has the same behavior as the
initializer, allowing applications to remove the initializer if they do not wish
to customize parameter wrapping behavior.</p>

<p>Regardless of this value, applications can continue to customize the parameter
wrapping behavior as before in an initializer or per controller.</p>

<p>See <a href="https://api.rubyonrails.org/classes/ActionController/ParamsWrapper.html"><code class="language-plaintext highlighter-rouge">ParamsWrapper</code></a> for more information on parameter
wrapping.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="actioncontrollerbasewrap_parameters"><code class="language-plaintext highlighter-rouge">ActionController::Base.wrap_parameters</code></h4>

<p>Configures the <a href="https://api.rubyonrails.org/classes/ActionController/ParamsWrapper.html"><code class="language-plaintext highlighter-rouge">ParamsWrapper</code></a>. This can be called at
the top level, or on individual controllers.</p>

<h4 id="configaction_controllerescape_json_responses"><code class="language-plaintext highlighter-rouge">config.action_controller.escape_json_responses</code></h4>

<p>Configures the JSON renderer to escape HTML entities and Unicode characters that are invalid in JavaScript.</p>

<p>This is useful if you relied on the JSON response having those characters escaped to embed the JSON document in
&lt;script&gt; tags in HTML.</p>

<p>This is mainly for compatibility when upgrading Rails applications, otherwise you can use the <code class="language-plaintext highlighter-rouge">:escape</code> option for
<code class="language-plaintext highlighter-rouge">render json:</code> in specific controller actions.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>8.1</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h3 id="configuring-action-dispatch">Configuring Action Dispatch</h3>

<h4 id="configaction_dispatchcookies_serializer"><code class="language-plaintext highlighter-rouge">config.action_dispatch.cookies_serializer</code></h4>

<p>Specifies which serializer to use for cookies. Accepts the same values as
<a href="#config-active-support-message-serializer"><code class="language-plaintext highlighter-rouge">config.active_support.message_serializer</code></a>,
plus <code class="language-plaintext highlighter-rouge">:hybrid</code> which is an alias for <code class="language-plaintext highlighter-rouge">:json_allow_marshal</code>.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:marshal</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">:json</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_dispatchdebug_exception_log_level"><code class="language-plaintext highlighter-rouge">config.action_dispatch.debug_exception_log_level</code></h4>

<p>Configures the log level used by the <a href="https://api.rubyonrails.org/classes/ActionDispatch/DebugExceptions.html"><code class="language-plaintext highlighter-rouge">ActionDispatch::DebugExceptions</code></a>
middleware when logging uncaught exceptions during requests.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:fatal</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">:error</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_dispatchdefault_headers"><code class="language-plaintext highlighter-rouge">config.action_dispatch.default_headers</code></h4>

<p>Is a hash with HTTP headers that are set by default in each response.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td>&lt;pre&gt;<code>{<br />  "X-Frame-Options" =&gt; "SAMEORIGIN",<br />  "X-XSS-Protection" =&gt; "1; mode=block",<br />  "X-Content-Type-Options" =&gt; "nosniff",<br />  "X-Download-Options" =&gt; "noopen",<br />  "X-Permitted-Cross-Domain-Policies" =&gt; "none",<br />  "Referrer-Policy" =&gt; "strict-origin-when-cross-origin"<br />}</code>&lt;/pre&gt;</td>
    </tr>
    <tr>
      <td>7.0</td>
      <td>&lt;pre&gt;<code>{<br />  "X-Frame-Options" =&gt; "SAMEORIGIN",<br />  "X-XSS-Protection" =&gt; "0",<br />  "X-Content-Type-Options" =&gt; "nosniff",<br />  "X-Download-Options" =&gt; "noopen",<br />  "X-Permitted-Cross-Domain-Policies" =&gt; "none",<br />  "Referrer-Policy" =&gt; "strict-origin-when-cross-origin"<br />}</code>&lt;/pre&gt;</td>
    </tr>
    <tr>
      <td>7.1</td>
      <td>&lt;pre&gt;<code>{<br />  "X-Frame-Options" =&gt; "SAMEORIGIN",<br />  "X-XSS-Protection" =&gt; "0",<br />  "X-Content-Type-Options" =&gt; "nosniff",<br />  "X-Permitted-Cross-Domain-Policies" =&gt; "none",<br />  "Referrer-Policy" =&gt; "strict-origin-when-cross-origin"<br />}</code>&lt;/pre&gt;</td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_dispatchdefault_charset"><code class="language-plaintext highlighter-rouge">config.action_dispatch.default_charset</code></h4>

<p>Specifies the default character set for all renders. Defaults to <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<h4 id="configaction_dispatchtld_length"><code class="language-plaintext highlighter-rouge">config.action_dispatch.tld_length</code></h4>

<p>Sets the TLD (top-level domain) length for the application. Defaults to <code class="language-plaintext highlighter-rouge">1</code>.</p>

<h4 id="configaction_dispatchignore_accept_header"><code class="language-plaintext highlighter-rouge">config.action_dispatch.ignore_accept_header</code></h4>

<p>Is used to determine whether to ignore accept headers from a request. Defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configaction_dispatchx_sendfile_header"><code class="language-plaintext highlighter-rouge">config.action_dispatch.x_sendfile_header</code></h4>

<p>Specifies server specific X-Sendfile header. This is useful for accelerated file sending from server. For example it can be set to ‘X-Sendfile’ for Apache.</p>

<h4 id="configaction_dispatchhttp_auth_salt"><code class="language-plaintext highlighter-rouge">config.action_dispatch.http_auth_salt</code></h4>

<p>Sets the HTTP Auth salt value. Defaults
to <code class="language-plaintext highlighter-rouge">'http authentication'</code>.</p>

<h4 id="configaction_dispatchsigned_cookie_salt"><code class="language-plaintext highlighter-rouge">config.action_dispatch.signed_cookie_salt</code></h4>

<p>Sets the signed cookies salt value.
Defaults to <code class="language-plaintext highlighter-rouge">'signed cookie'</code>.</p>

<h4 id="configaction_dispatchencrypted_cookie_salt"><code class="language-plaintext highlighter-rouge">config.action_dispatch.encrypted_cookie_salt</code></h4>

<p>Sets the encrypted cookies salt value. Defaults to <code class="language-plaintext highlighter-rouge">'encrypted cookie'</code>.</p>

<h4 id="configaction_dispatchencrypted_signed_cookie_salt"><code class="language-plaintext highlighter-rouge">config.action_dispatch.encrypted_signed_cookie_salt</code></h4>

<p>Sets the signed encrypted cookies salt value. Defaults to <code class="language-plaintext highlighter-rouge">'signed encrypted
cookie'</code>.</p>

<h4 id="configaction_dispatchauthenticated_encrypted_cookie_salt"><code class="language-plaintext highlighter-rouge">config.action_dispatch.authenticated_encrypted_cookie_salt</code></h4>

<p>Sets the authenticated encrypted cookie salt. Defaults to <code class="language-plaintext highlighter-rouge">'authenticated
encrypted cookie'</code>.</p>

<h4 id="configaction_dispatchencrypted_cookie_cipher"><code class="language-plaintext highlighter-rouge">config.action_dispatch.encrypted_cookie_cipher</code></h4>

<p>Sets the cipher to be used for encrypted cookies. This defaults to
<code class="language-plaintext highlighter-rouge">"aes-256-gcm"</code>.</p>

<h4 id="configaction_dispatchsigned_cookie_digest"><code class="language-plaintext highlighter-rouge">config.action_dispatch.signed_cookie_digest</code></h4>

<p>Sets the digest to be used for signed cookies. This defaults to <code class="language-plaintext highlighter-rouge">"SHA1"</code>.</p>

<h4 id="configaction_dispatchcookies_rotations"><code class="language-plaintext highlighter-rouge">config.action_dispatch.cookies_rotations</code></h4>

<p>Allows rotating secrets, ciphers, and digests for encrypted and signed cookies.</p>

<h4 id="configaction_dispatchuse_authenticated_cookie_encryption"><code class="language-plaintext highlighter-rouge">config.action_dispatch.use_authenticated_cookie_encryption</code></h4>

<p>Controls whether signed and encrypted cookies use the AES-256-GCM cipher or the
older AES-256-CBC cipher.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>5.2</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_dispatchuse_cookies_with_metadata"><code class="language-plaintext highlighter-rouge">config.action_dispatch.use_cookies_with_metadata</code></h4>

<p>Enables writing cookies with the purpose metadata embedded.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>6.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_dispatchperform_deep_munge"><code class="language-plaintext highlighter-rouge">config.action_dispatch.perform_deep_munge</code></h4>

<p>Configures whether <code class="language-plaintext highlighter-rouge">deep_munge</code> method should be performed on the parameters.
See <a href="security.html#unsafe-query-generation">Security Guide</a> for more
information. It defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_dispatchrescue_responses"><code class="language-plaintext highlighter-rouge">config.action_dispatch.rescue_responses</code></h4>

<p>Configures what exceptions are assigned to an HTTP status. It accepts a hash and you can specify pairs of exception/status.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># It's good to use #[]= or #merge! to respect the default values</span>
<span class="n">config</span><span class="p">.</span><span class="nf">action_dispatch</span><span class="p">.</span><span class="nf">rescue_responses</span><span class="p">[</span><span class="s2">"MyAuthenticationError"</span><span class="p">]</span> <span class="o">=</span> <span class="ss">:unauthorized</span>
</code></pre></div></div>

<p>Use <code class="language-plaintext highlighter-rouge">ActionDispatch::ExceptionWrapper.rescue_responses</code> to observe the configuration. By default, it is defined as:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="s2">"ActionController::RoutingError"</span> <span class="o">=&gt;</span> <span class="ss">:not_found</span><span class="p">,</span>
  <span class="s2">"AbstractController::ActionNotFound"</span> <span class="o">=&gt;</span> <span class="ss">:not_found</span><span class="p">,</span>
  <span class="s2">"ActionController::MethodNotAllowed"</span> <span class="o">=&gt;</span> <span class="ss">:method_not_allowed</span><span class="p">,</span>
  <span class="s2">"ActionController::UnknownHttpMethod"</span> <span class="o">=&gt;</span> <span class="ss">:method_not_allowed</span><span class="p">,</span>
  <span class="s2">"ActionController::NotImplemented"</span> <span class="o">=&gt;</span> <span class="ss">:not_implemented</span><span class="p">,</span>
  <span class="s2">"ActionController::UnknownFormat"</span> <span class="o">=&gt;</span> <span class="ss">:not_acceptable</span><span class="p">,</span>
  <span class="s2">"ActionDispatch::Http::MimeNegotiation::InvalidType"</span> <span class="o">=&gt;</span> <span class="ss">:not_acceptable</span><span class="p">,</span>
  <span class="s2">"ActionController::MissingExactTemplate"</span> <span class="o">=&gt;</span> <span class="ss">:not_acceptable</span><span class="p">,</span>
  <span class="s2">"ActionController::InvalidAuthenticityToken"</span> <span class="o">=&gt;</span> <span class="ss">:unprocessable_entity</span><span class="p">,</span>
  <span class="s2">"ActionController::InvalidCrossOriginRequest"</span> <span class="o">=&gt;</span> <span class="ss">:unprocessable_entity</span><span class="p">,</span>
  <span class="s2">"ActionDispatch::Http::Parameters::ParseError"</span> <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s2">"ActionController::BadRequest"</span> <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s2">"ActionController::ParameterMissing"</span> <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s2">"Rack::QueryParser::ParameterTypeError"</span> <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s2">"Rack::QueryParser::InvalidParameterError"</span> <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s2">"ActiveRecord::RecordNotFound"</span> <span class="o">=&gt;</span> <span class="ss">:not_found</span><span class="p">,</span>
  <span class="s2">"ActiveRecord::StaleObjectError"</span> <span class="o">=&gt;</span> <span class="ss">:conflict</span><span class="p">,</span>
  <span class="s2">"ActiveRecord::RecordInvalid"</span> <span class="o">=&gt;</span> <span class="ss">:unprocessable_entity</span><span class="p">,</span>
  <span class="s2">"ActiveRecord::RecordNotSaved"</span> <span class="o">=&gt;</span> <span class="ss">:unprocessable_entity</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Any exceptions that are not configured will be mapped to 500 Internal Server Error.</p>

<h4 id="configaction_dispatchcookies_same_site_protection"><code class="language-plaintext highlighter-rouge">config.action_dispatch.cookies_same_site_protection</code></h4>

<p>Configures the default value of the <code class="language-plaintext highlighter-rouge">SameSite</code> attribute when setting cookies.
When set to <code class="language-plaintext highlighter-rouge">nil</code>, the <code class="language-plaintext highlighter-rouge">SameSite</code> attribute is not added. To allow the value of
the <code class="language-plaintext highlighter-rouge">SameSite</code> attribute to be configured dynamically based on the request, a
proc may be specified. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">action_dispatch</span><span class="p">.</span><span class="nf">cookies_same_site_protection</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">request</span><span class="p">)</span> <span class="k">do</span>
  <span class="ss">:strict</span> <span class="k">unless</span> <span class="n">request</span><span class="p">.</span><span class="nf">user_agent</span> <span class="o">==</span> <span class="s2">"TestAgent"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">:lax</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_dispatchssl_default_redirect_status"><code class="language-plaintext highlighter-rouge">config.action_dispatch.ssl_default_redirect_status</code></h4>

<p>Configures the default HTTP status code used when redirecting non-GET/HEAD
requests from HTTP to HTTPS in the <code class="language-plaintext highlighter-rouge">ActionDispatch::SSL</code> middleware.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">307</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">308</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_dispatchlog_rescued_responses"><code class="language-plaintext highlighter-rouge">config.action_dispatch.log_rescued_responses</code></h4>

<p>Enables logging those unhandled exceptions configured in <code class="language-plaintext highlighter-rouge">rescue_responses</code>. It
defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_dispatchshow_exceptions"><code class="language-plaintext highlighter-rouge">config.action_dispatch.show_exceptions</code></h4>

<p>The <code class="language-plaintext highlighter-rouge">config.action_dispatch.show_exceptions</code> configuration controls how Action Pack (specifically the <a href="/configuring.html#actiondispatch-showexceptions"><code class="language-plaintext highlighter-rouge">ActionDispatch::ShowExceptions</code></a> middleware) handles exceptions raised while responding to requests.</p>

<p>Setting the value to <code class="language-plaintext highlighter-rouge">:all</code> configures Action Pack to rescue from exceptions and render corresponding error pages. For example, Action Pack would rescue from an <code class="language-plaintext highlighter-rouge">ActiveRecord::RecordNotFound</code> exception and render the contents of <code class="language-plaintext highlighter-rouge">public/404.html</code> with a <code class="language-plaintext highlighter-rouge">404 Not found</code> status code.</p>

<p>Setting the value to <code class="language-plaintext highlighter-rouge">:rescuable</code> configures Action Pack to rescue from exceptions defined in <a href="/configuring.html#config-action-dispatch-rescue-responses"><code class="language-plaintext highlighter-rouge">config.action_dispatch.rescue_responses</code></a>, and raise all others. For example, Action Pack would rescue from <code class="language-plaintext highlighter-rouge">ActiveRecord::RecordNotFound</code>, but would raise a <code class="language-plaintext highlighter-rouge">NoMethodError</code>.</p>

<p>Setting the value to <code class="language-plaintext highlighter-rouge">:none</code> configures Action Pack to raise all exceptions.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">:all</code> - render error pages for all exceptions</li>
  <li><code class="language-plaintext highlighter-rouge">:rescuable</code> - render error pages for exceptions declared by <a href="/configuring.html#config-action-dispatch-rescue-responses"><code class="language-plaintext highlighter-rouge">config.action_dispatch.rescue_responses</code></a></li>
  <li><code class="language-plaintext highlighter-rouge">:none</code> - raise all exceptions</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">:all</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_dispatchstrict_freshness"><code class="language-plaintext highlighter-rouge">config.action_dispatch.strict_freshness</code></h4>

<p>Configures whether the <code class="language-plaintext highlighter-rouge">ActionDispatch::ETag</code> middleware should prefer the <code class="language-plaintext highlighter-rouge">ETag</code> header over the <code class="language-plaintext highlighter-rouge">Last-Modified</code> header when both are present in the response.</p>

<p>If set to <code class="language-plaintext highlighter-rouge">true</code>, when both headers are present only the <code class="language-plaintext highlighter-rouge">ETag</code> is considered as specified by RFC 7232 section 6.</p>

<p>If set to <code class="language-plaintext highlighter-rouge">false</code>, when both headers are present, both headers are checked and both need to match for the response to be considered fresh.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>8.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_dispatchalways_write_cookie"><code class="language-plaintext highlighter-rouge">config.action_dispatch.always_write_cookie</code></h4>

<p>Cookies will be written at the end of a request if they marked as insecure, if the request is made over SSL, or if the request is made to an onion service.</p>

<p>If set to <code class="language-plaintext highlighter-rouge">true</code>, cookies will be written even if this criteria is not met.</p>

<p>This defaults to <code class="language-plaintext highlighter-rouge">true</code> in <code class="language-plaintext highlighter-rouge">development</code>, and <code class="language-plaintext highlighter-rouge">false</code> in all other environments.</p>

<h4 id="actiondispatchcallbacksbefore"><code class="language-plaintext highlighter-rouge">ActionDispatch::Callbacks.before</code></h4>

<p>Takes a block of code to run before the request.</p>

<h4 id="actiondispatchcallbacksafter"><code class="language-plaintext highlighter-rouge">ActionDispatch::Callbacks.after</code></h4>

<p>Takes a block of code to run after the request.</p>

<h3 id="configuring-action-view">Configuring Action View</h3>

<p><code class="language-plaintext highlighter-rouge">config.action_view</code> includes a small number of configuration settings:</p>

<h4 id="configaction_viewcache_template_loading"><code class="language-plaintext highlighter-rouge">config.action_view.cache_template_loading</code></h4>

<p>Controls whether or not templates should be reloaded on each request. Defaults to <code class="language-plaintext highlighter-rouge">!config.enable_reloading</code>.</p>

<h4 id="configaction_viewfield_error_proc"><code class="language-plaintext highlighter-rouge">config.action_view.field_error_proc</code></h4>

<p>Provides an HTML generator for displaying errors that come from Active Model. The block is evaluated within
the context of an Action View template. The default is</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">html_tag</span><span class="p">,</span> <span class="n">instance</span><span class="o">|</span> <span class="n">content_tag</span> <span class="ss">:div</span><span class="p">,</span> <span class="n">html_tag</span><span class="p">,</span> <span class="ss">class: </span><span class="s2">"field_with_errors"</span> <span class="p">}</span>
</code></pre></div></div>

<h4 id="configaction_viewdefault_form_builder"><code class="language-plaintext highlighter-rouge">config.action_view.default_form_builder</code></h4>

<p>Tells Rails which form builder to use by default. The default is
<code class="language-plaintext highlighter-rouge">ActionView::Helpers::FormBuilder</code>. If you want your form builder class to be
loaded after initialization (so it’s reloaded on each request in development),
you can pass it as a <code class="language-plaintext highlighter-rouge">String</code>.</p>

<h4 id="configaction_viewlogger"><code class="language-plaintext highlighter-rouge">config.action_view.logger</code></h4>

<p>Accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then used to log information from Action View. Set to <code class="language-plaintext highlighter-rouge">nil</code> to disable logging.</p>

<h4 id="configaction_viewerb_trim_mode"><code class="language-plaintext highlighter-rouge">config.action_view.erb_trim_mode</code></h4>

<p>Controls if certain ERB syntax should trim. It defaults to <code class="language-plaintext highlighter-rouge">'-'</code>, which turns on trimming of tail spaces and newline when using <code class="language-plaintext highlighter-rouge">&lt;%= -%&gt;</code> or <code class="language-plaintext highlighter-rouge">&lt;%= =%&gt;</code>. Setting this to anything else will turn off trimming support.</p>

<h4 id="configaction_viewfrozen_string_literal"><code class="language-plaintext highlighter-rouge">config.action_view.frozen_string_literal</code></h4>

<p>Compiles the ERB template with the <code class="language-plaintext highlighter-rouge"># frozen_string_literal: true</code> magic comment, making all string literals frozen and saving allocations. Set to <code class="language-plaintext highlighter-rouge">true</code> to enable it for all views.</p>

<h4 id="configaction_viewembed_authenticity_token_in_remote_forms"><code class="language-plaintext highlighter-rouge">config.action_view.embed_authenticity_token_in_remote_forms</code></h4>

<p>Allows you to set the default behavior for <code class="language-plaintext highlighter-rouge">authenticity_token</code> in forms with
<code class="language-plaintext highlighter-rouge">remote: true</code>. By default it’s set to <code class="language-plaintext highlighter-rouge">false</code>, which means that remote forms
will not include <code class="language-plaintext highlighter-rouge">authenticity_token</code>, which is helpful when you’re
fragment-caching the form. Remote forms get the authenticity from the <code class="language-plaintext highlighter-rouge">meta</code>
tag, so embedding is unnecessary unless you support browsers without
JavaScript. In such case you can either pass <code class="language-plaintext highlighter-rouge">authenticity_token: true</code> as a
form option or set this config setting to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_viewprefix_partial_path_with_controller_namespace"><code class="language-plaintext highlighter-rouge">config.action_view.prefix_partial_path_with_controller_namespace</code></h4>

<p>Determines whether or not partials are looked up from a subdirectory in templates rendered from namespaced controllers. For example, consider a controller named <code class="language-plaintext highlighter-rouge">Admin::ArticlesController</code> which renders this template:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="vi">@article</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The default setting is <code class="language-plaintext highlighter-rouge">true</code>, which uses the partial at <code class="language-plaintext highlighter-rouge">/admin/articles/_article.erb</code>. Setting the value to <code class="language-plaintext highlighter-rouge">false</code> would render <code class="language-plaintext highlighter-rouge">/articles/_article.erb</code>, which is the same behavior as rendering from a non-namespaced controller such as <code class="language-plaintext highlighter-rouge">ArticlesController</code>.</p>

<h4 id="configaction_viewautomatically_disable_submit_tag"><code class="language-plaintext highlighter-rouge">config.action_view.automatically_disable_submit_tag</code></h4>

<p>Determines whether <code class="language-plaintext highlighter-rouge">submit_tag</code> should automatically disable on click, this
defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_viewdebug_missing_translation"><code class="language-plaintext highlighter-rouge">config.action_view.debug_missing_translation</code></h4>

<p>Determines whether to wrap the missing translations key in a <code class="language-plaintext highlighter-rouge">&lt;span&gt;</code> tag or not. This defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_viewform_with_generates_remote_forms"><code class="language-plaintext highlighter-rouge">config.action_view.form_with_generates_remote_forms</code></h4>

<p>Determines whether <code class="language-plaintext highlighter-rouge">form_with</code> generates remote forms or not.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_viewform_with_generates_ids"><code class="language-plaintext highlighter-rouge">config.action_view.form_with_generates_ids</code></h4>

<p>Determines whether <code class="language-plaintext highlighter-rouge">form_with</code> generates ids on inputs.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>5.2</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_viewdefault_enforce_utf8"><code class="language-plaintext highlighter-rouge">config.action_view.default_enforce_utf8</code></h4>

<p>Determines whether forms are generated with a hidden tag that forces older versions of Internet Explorer to submit forms encoded in UTF-8.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>6.0</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_viewimage_loading"><code class="language-plaintext highlighter-rouge">config.action_view.image_loading</code></h4>

<p>Specifies a default value for the <code class="language-plaintext highlighter-rouge">loading</code> attribute of <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> tags rendered by the <code class="language-plaintext highlighter-rouge">image_tag</code> helper. For example, when set to <code class="language-plaintext highlighter-rouge">"lazy"</code>, <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> tags rendered by <code class="language-plaintext highlighter-rouge">image_tag</code> will include <code class="language-plaintext highlighter-rouge">loading="lazy"</code>, which <a href="https://html.spec.whatwg.org/#lazy-loading-attributes">instructs the browser to wait until an image is near the viewport to load it</a>. (This value can still be overridden per image by passing e.g. <code class="language-plaintext highlighter-rouge">loading: "eager"</code> to <code class="language-plaintext highlighter-rouge">image_tag</code>.) Defaults to <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<h4 id="configaction_viewimage_decoding"><code class="language-plaintext highlighter-rouge">config.action_view.image_decoding</code></h4>

<p>Specifies a default value for the <code class="language-plaintext highlighter-rouge">decoding</code> attribute of <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> tags rendered by the <code class="language-plaintext highlighter-rouge">image_tag</code> helper. Defaults to <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<h4 id="configaction_viewannotate_rendered_view_with_filenames"><code class="language-plaintext highlighter-rouge">config.action_view.annotate_rendered_view_with_filenames</code></h4>

<p>Determines whether to annotate rendered view with template file names. This defaults to <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configaction_viewpreload_links_header"><code class="language-plaintext highlighter-rouge">config.action_view.preload_links_header</code></h4>

<p>Determines whether <code class="language-plaintext highlighter-rouge">javascript_include_tag</code> and <code class="language-plaintext highlighter-rouge">stylesheet_link_tag</code> will generate a <code class="language-plaintext highlighter-rouge">link</code> header that preload assets.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_viewbutton_to_generates_button_tag"><code class="language-plaintext highlighter-rouge">config.action_view.button_to_generates_button_tag</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">false</code>, <code class="language-plaintext highlighter-rouge">button_to</code> will render a <code class="language-plaintext highlighter-rouge">&lt;button&gt;</code> or an <code class="language-plaintext highlighter-rouge">&lt;input&gt;</code> inside a
<code class="language-plaintext highlighter-rouge">&lt;form&gt;</code> depending on how content is passed (<code class="language-plaintext highlighter-rouge">&lt;form&gt;</code> omitted for brevity):</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">button_to</span> <span class="s2">"Content"</span><span class="p">,</span> <span class="s2">"/"</span> <span class="cp">%&gt;</span>
# =&gt; <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Content"</span><span class="nt">&gt;</span>

<span class="cp">&lt;%=</span> <span class="n">button_to</span> <span class="s2">"/"</span> <span class="k">do</span> <span class="cp">%&gt;</span>
  Content
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
# =&gt; <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Content<span class="nt">&lt;/button&gt;</span>
</code></pre></div></div>

<p>Setting this value to <code class="language-plaintext highlighter-rouge">true</code> makes <code class="language-plaintext highlighter-rouge">button_to</code> generate a <code class="language-plaintext highlighter-rouge">&lt;button&gt;</code> tag inside
the <code class="language-plaintext highlighter-rouge">&lt;form&gt;</code> in both cases.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_viewapply_stylesheet_media_default"><code class="language-plaintext highlighter-rouge">config.action_view.apply_stylesheet_media_default</code></h4>

<p>Determines whether <code class="language-plaintext highlighter-rouge">stylesheet_link_tag</code> will render <code class="language-plaintext highlighter-rouge">screen</code> as the default
value for the <code class="language-plaintext highlighter-rouge">media</code> attribute when it’s not provided.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_viewprepend_content_exfiltration_prevention"><code class="language-plaintext highlighter-rouge">config.action_view.prepend_content_exfiltration_prevention</code></h4>

<p>Determines whether or not the <code class="language-plaintext highlighter-rouge">form_tag</code> and <code class="language-plaintext highlighter-rouge">button_to</code> helpers will produce HTML tags prepended with browser-safe (but technically invalid) HTML that guarantees their contents cannot be captured by any preceding unclosed tags. The default value is <code class="language-plaintext highlighter-rouge">false</code>.</p>

<h4 id="configaction_viewsanitizer_vendor"><code class="language-plaintext highlighter-rouge">config.action_view.sanitizer_vendor</code></h4>

<p>Configures the set of HTML sanitizers used by Action View by setting <code class="language-plaintext highlighter-rouge">ActionView::Helpers::SanitizeHelper.sanitizer_vendor</code>. The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
      <th>Which parses markup as</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">Rails::HTML4::Sanitizer</code></td>
      <td>HTML4</td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">Rails::HTML5::Sanitizer</code> (see NOTE)</td>
      <td>HTML5</td>
    </tr>
  </tbody>
</table>

<p>NOTE: <code class="language-plaintext highlighter-rouge">Rails::HTML5::Sanitizer</code> is not supported on JRuby, so on JRuby platforms Rails will fall back to <code class="language-plaintext highlighter-rouge">Rails::HTML4::Sanitizer</code>.</p>

<h3 id="configuring-action-mailbox">Configuring Action Mailbox</h3>

<p><code class="language-plaintext highlighter-rouge">config.action_mailbox</code> provides the following configuration options:</p>

<h4 id="configaction_mailboxlogger"><code class="language-plaintext highlighter-rouge">config.action_mailbox.logger</code></h4>

<p>Contains the logger used by Action Mailbox. It accepts a logger conforming to the interface of Log4r or the default Ruby Logger class. The default is <code class="language-plaintext highlighter-rouge">Rails.logger</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">action_mailbox</span><span class="p">.</span><span class="nf">logger</span> <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="configaction_mailboxincinerate_after"><code class="language-plaintext highlighter-rouge">config.action_mailbox.incinerate_after</code></h4>

<p>Accepts an <code class="language-plaintext highlighter-rouge">ActiveSupport::Duration</code> indicating how long after processing <code class="language-plaintext highlighter-rouge">ActionMailbox::InboundEmail</code> records should be destroyed. It defaults to <code class="language-plaintext highlighter-rouge">30.days</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Incinerate inbound emails 14 days after processing.</span>
<span class="n">config</span><span class="p">.</span><span class="nf">action_mailbox</span><span class="p">.</span><span class="nf">incinerate_after</span> <span class="o">=</span> <span class="mi">14</span><span class="p">.</span><span class="nf">days</span>
</code></pre></div></div>

<h4 id="configaction_mailboxqueuesincineration"><code class="language-plaintext highlighter-rouge">config.action_mailbox.queues.incineration</code></h4>

<p>Accepts a symbol indicating the Active Job queue to use for incineration jobs.
When this option is <code class="language-plaintext highlighter-rouge">nil</code>, incineration jobs are sent to the default Active Job
queue (see <a href="#config-active-job-default-queue-name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></a>).</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:action_mailbox_incineration</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_mailboxqueuesrouting"><code class="language-plaintext highlighter-rouge">config.action_mailbox.queues.routing</code></h4>

<p>Accepts a symbol indicating the Active Job queue to use for routing jobs. When
this option is <code class="language-plaintext highlighter-rouge">nil</code>, routing jobs are sent to the default Active Job queue (see
<a href="#config-active-job-default-queue-name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></a>).</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:action_mailbox_routing</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_mailboxstorage_service"><code class="language-plaintext highlighter-rouge">config.action_mailbox.storage_service</code></h4>

<p>Accepts a symbol indicating the Active Storage service to use for uploading emails. When this option is <code class="language-plaintext highlighter-rouge">nil</code>, emails are uploaded to the default Active Storage service (see <code class="language-plaintext highlighter-rouge">config.active_storage.service</code>).</p>

<h3 id="configuring-action-mailer">Configuring Action Mailer</h3>

<p>There are a number of settings available on <code class="language-plaintext highlighter-rouge">config.action_mailer</code>:</p>

<h4 id="configaction_mailerasset_host"><code class="language-plaintext highlighter-rouge">config.action_mailer.asset_host</code></h4>

<p>Sets the host for the assets. Useful when CDNs are used for hosting assets rather than the application server itself. You should only use this if you have a different configuration for Action Controller, otherwise use <code class="language-plaintext highlighter-rouge">config.asset_host</code>.</p>

<h4 id="configaction_mailerlogger"><code class="language-plaintext highlighter-rouge">config.action_mailer.logger</code></h4>

<p>Accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then used to log information from Action Mailer. Set to <code class="language-plaintext highlighter-rouge">nil</code> to disable logging.</p>

<h4 id="configaction_mailersmtp_settings"><code class="language-plaintext highlighter-rouge">config.action_mailer.smtp_settings</code></h4>

<p>Allows detailed configuration for the <code class="language-plaintext highlighter-rouge">:smtp</code> delivery method. It accepts a hash of options, which can include any of these options:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">:address</code> - Allows you to use a remote mail server. Just change it from its default “localhost” setting.</li>
  <li><code class="language-plaintext highlighter-rouge">:port</code> - On the off chance that your mail server doesn’t run on port 25, you can change it.</li>
  <li><code class="language-plaintext highlighter-rouge">:domain</code> - If you need to specify a HELO domain, you can do it here.</li>
  <li><code class="language-plaintext highlighter-rouge">:user_name</code> - If your mail server requires authentication, set the username in this setting.</li>
  <li><code class="language-plaintext highlighter-rouge">:password</code> - If your mail server requires authentication, set the password in this setting.</li>
  <li><code class="language-plaintext highlighter-rouge">:authentication</code> - If your mail server requires authentication, you need to specify the authentication type here. This is a symbol and one of <code class="language-plaintext highlighter-rouge">:plain</code>, <code class="language-plaintext highlighter-rouge">:login</code>, <code class="language-plaintext highlighter-rouge">:cram_md5</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">:enable_starttls</code> - Use STARTTLS when connecting to your SMTP server and fail if unsupported. It defaults to <code class="language-plaintext highlighter-rouge">false</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">:enable_starttls_auto</code> - Detects if STARTTLS is enabled in your SMTP server and starts to use it. It defaults to <code class="language-plaintext highlighter-rouge">true</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">:openssl_verify_mode</code> - When using TLS, you can set how OpenSSL checks the certificate. This is useful if you need to validate a self-signed and/or a wildcard certificate. This can be the name of one of the OpenSSL verify constants, <code class="language-plaintext highlighter-rouge">'none'</code> or <code class="language-plaintext highlighter-rouge">'peer'</code> - or the constant directly <code class="language-plaintext highlighter-rouge">OpenSSL::SSL::VERIFY_NONE</code> or <code class="language-plaintext highlighter-rouge">OpenSSL::SSL::VERIFY_PEER</code>, respectively.</li>
  <li><code class="language-plaintext highlighter-rouge">:ssl/:tls</code> - Enables the SMTP connection to use SMTP/TLS (SMTPS: SMTP over direct TLS connection).</li>
  <li><code class="language-plaintext highlighter-rouge">:open_timeout</code> - Number of seconds to wait while attempting to open a connection.</li>
  <li><code class="language-plaintext highlighter-rouge">:read_timeout</code> - Number of seconds to wait until timing-out a read(2) call.</li>
</ul>

<p>Additionally, it is possible to pass any <a href="https://github.com/mikel/mail/blob/master/lib/mail/network/delivery_methods/smtp.rb">configuration option <code class="language-plaintext highlighter-rouge">Mail::SMTP</code> respects</a>.</p>

<h4 id="configaction_mailersmtp_timeout"><code class="language-plaintext highlighter-rouge">config.action_mailer.smtp_timeout</code></h4>

<p>Prior to version 2.8.0, the <code class="language-plaintext highlighter-rouge">mail</code> gem did not configure any default timeouts
for its SMTP requests. This configuration enables applications to configure
default values for both <code class="language-plaintext highlighter-rouge">:open_timeout</code> and <code class="language-plaintext highlighter-rouge">:read_timeout</code> in the <code class="language-plaintext highlighter-rouge">mail</code> gem so
that requests do not end up stuck indefinitely.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">5</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_mailersendmail_settings"><code class="language-plaintext highlighter-rouge">config.action_mailer.sendmail_settings</code></h4>

<p>Allows detailed configuration for the <code class="language-plaintext highlighter-rouge">:sendmail</code> delivery method. It accepts a hash of options, which can include any of these options:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">:location</code> - The location of the sendmail executable. Defaults to <code class="language-plaintext highlighter-rouge">/usr/sbin/sendmail</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">:arguments</code> - The command line arguments. Defaults to <code class="language-plaintext highlighter-rouge">%w[ -i ]</code>.</li>
</ul>

<h4 id="configaction_mailerfile_settings"><code class="language-plaintext highlighter-rouge">config.action_mailer.file_settings</code></h4>

<p>Configures the <code class="language-plaintext highlighter-rouge">:file</code> delivery method. It accepts a hash of options, which can include:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">:location</code> - The location where files are saved. Defaults to <code class="language-plaintext highlighter-rouge">"#{Rails.root}/tmp/mails"</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">:extension</code> - The file extension. Defaults to the empty string.</li>
</ul>

<h4 id="configaction_mailerraise_delivery_errors"><code class="language-plaintext highlighter-rouge">config.action_mailer.raise_delivery_errors</code></h4>

<p>Specifies whether to raise an error if email delivery cannot be completed. It defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_mailerdelivery_method"><code class="language-plaintext highlighter-rouge">config.action_mailer.delivery_method</code></h4>

<p>Defines the delivery method and defaults to <code class="language-plaintext highlighter-rouge">:smtp</code>. See the <a href="action_mailer_basics.html#action-mailer-configuration">configuration section in the Action Mailer guide</a> for more info.</p>

<h4 id="configaction_mailerperform_deliveries"><code class="language-plaintext highlighter-rouge">config.action_mailer.perform_deliveries</code></h4>

<p>Specifies whether mail will actually be delivered and is <code class="language-plaintext highlighter-rouge">true</code> by default. It can be convenient to set it to <code class="language-plaintext highlighter-rouge">false</code> for testing.</p>

<h4 id="configaction_mailerdefault_options"><code class="language-plaintext highlighter-rouge">config.action_mailer.default_options</code></h4>

<p>Configures Action Mailer defaults. Use to set options like <code class="language-plaintext highlighter-rouge">from</code> or <code class="language-plaintext highlighter-rouge">reply_to</code> for every mailer. These default to:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">mime_version:  </span><span class="s2">"1.0"</span><span class="p">,</span>
  <span class="ss">charset:       </span><span class="s2">"UTF-8"</span><span class="p">,</span>
  <span class="ss">content_type: </span><span class="s2">"text/plain"</span><span class="p">,</span>
  <span class="ss">parts_order:  </span><span class="p">[</span><span class="s2">"text/plain"</span><span class="p">,</span> <span class="s2">"text/enriched"</span><span class="p">,</span> <span class="s2">"text/html"</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Assign a hash to set additional options:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">default_options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">from: </span><span class="s2">"noreply@example.com"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="configaction_mailerobservers"><code class="language-plaintext highlighter-rouge">config.action_mailer.observers</code></h4>

<p>Registers observers which will be notified when mail is delivered.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">observers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"MailObserver"</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="configaction_mailerinterceptors"><code class="language-plaintext highlighter-rouge">config.action_mailer.interceptors</code></h4>

<p>Registers interceptors which will be called before mail is sent.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">interceptors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"MailInterceptor"</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="configaction_mailerpreview_interceptors"><code class="language-plaintext highlighter-rouge">config.action_mailer.preview_interceptors</code></h4>

<p>Registers interceptors which will be called before mail is previewed.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">preview_interceptors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"MyPreviewMailInterceptor"</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="configaction_mailerpreview_paths"><code class="language-plaintext highlighter-rouge">config.action_mailer.preview_paths</code></h4>

<p>Specifies the locations of mailer previews. Appending paths to this configuration option will cause those paths to be used in the search for mailer previews.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">preview_paths</span> <span class="o">&lt;&lt;</span> <span class="s2">"</span><span class="si">#{</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="si">}</span><span class="s2">/lib/mailer_previews"</span>
</code></pre></div></div>

<h4 id="configaction_mailershow_previews"><code class="language-plaintext highlighter-rouge">config.action_mailer.show_previews</code></h4>

<p>Enable or disable mailer previews. By default this is <code class="language-plaintext highlighter-rouge">true</code> in development.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">show_previews</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre></div></div>

<h4 id="configaction_mailerperform_caching"><code class="language-plaintext highlighter-rouge">config.action_mailer.perform_caching</code></h4>

<p>Specifies whether the mailer templates should perform fragment caching or not. If it’s not specified, the default will be <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_mailerdeliver_later_queue_name"><code class="language-plaintext highlighter-rouge">config.action_mailer.deliver_later_queue_name</code></h4>

<p>Specifies the Active Job queue to use for the default delivery job (see
<code class="language-plaintext highlighter-rouge">config.action_mailer.delivery_job</code>). When this option is set to <code class="language-plaintext highlighter-rouge">nil</code>, delivery
jobs are sent to the default Active Job queue (see
<a href="#config-active-job-default-queue-name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></a>).</p>

<p>Mailer classes can override this to use a different queue. Note that this only applies when using the default delivery job. If your mailer is using a custom job, its queue will be used.</p>

<p>Ensure that your Active Job adapter is also configured to process the specified queue, otherwise delivery jobs may be silently ignored.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:mailers</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configaction_mailerdelivery_job"><code class="language-plaintext highlighter-rouge">config.action_mailer.delivery_job</code></h4>

<p>Specifies delivery job for mail.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">ActionMailer::MailDeliveryJob</code></td>
    </tr>
    <tr>
      <td>6.0</td>
      <td><code class="language-plaintext highlighter-rouge">"ActionMailer::MailDeliveryJob"</code></td>
    </tr>
  </tbody>
</table>

<h3 id="configuring-active-support">Configuring Active Support</h3>

<p>There are a few configuration options available in Active Support:</p>

<h4 id="configactive_supportbare"><code class="language-plaintext highlighter-rouge">config.active_support.bare</code></h4>

<p>Enables or disables the loading of <code class="language-plaintext highlighter-rouge">active_support/all</code> when booting Rails. Defaults to <code class="language-plaintext highlighter-rouge">nil</code>, which means <code class="language-plaintext highlighter-rouge">active_support/all</code> is loaded.</p>

<h4 id="configactive_supporttest_order"><code class="language-plaintext highlighter-rouge">config.active_support.test_order</code></h4>

<p>Sets the order in which the test cases are executed. Possible values are <code class="language-plaintext highlighter-rouge">:random</code> and <code class="language-plaintext highlighter-rouge">:sorted</code>. Defaults to <code class="language-plaintext highlighter-rouge">:random</code>.</p>

<h4 id="configactive_supportescape_html_entities_in_json"><code class="language-plaintext highlighter-rouge">config.active_support.escape_html_entities_in_json</code></h4>

<p>Enables or disables the escaping of HTML entities in JSON serialization. Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configactive_supportuse_standard_json_time_format"><code class="language-plaintext highlighter-rouge">config.active_support.use_standard_json_time_format</code></h4>

<p>Enables or disables serializing dates to ISO 8601 format. Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configactive_supporttime_precision"><code class="language-plaintext highlighter-rouge">config.active_support.time_precision</code></h4>

<p>Sets the precision of JSON encoded time values. Defaults to <code class="language-plaintext highlighter-rouge">3</code>.</p>

<h4 id="configactive_supporthash_digest_class"><code class="language-plaintext highlighter-rouge">config.active_support.hash_digest_class</code></h4>

<p>Allows configuring the digest class to use to generate non-sensitive digests, such as the ETag header.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">OpenSSL::Digest::MD5</code></td>
    </tr>
    <tr>
      <td>5.2</td>
      <td><code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA1</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA256</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_supportkey_generator_hash_digest_class"><code class="language-plaintext highlighter-rouge">config.active_support.key_generator_hash_digest_class</code></h4>

<p>Allows configuring the digest class to use to derive secrets from the configured secret base, such as for encrypted cookies.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA1</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">OpenSSL::Digest::SHA256</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_supportuse_authenticated_message_encryption"><code class="language-plaintext highlighter-rouge">config.active_support.use_authenticated_message_encryption</code></h4>

<p>Specifies whether to use AES-256-GCM authenticated encryption as the default cipher for encrypting messages instead of AES-256-CBC.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>5.2</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_supportmessage_serializer"><code class="language-plaintext highlighter-rouge">config.active_support.message_serializer</code></h4>

<p>Specifies the default serializer used by <a href="https://api.rubyonrails.org/classes/ActiveSupport/MessageEncryptor.html"><code class="language-plaintext highlighter-rouge">ActiveSupport::MessageEncryptor</code></a>
and <a href="https://api.rubyonrails.org/classes/ActiveSupport/MessageVerifier.html"><code class="language-plaintext highlighter-rouge">ActiveSupport::MessageVerifier</code></a> instances. To make migrating between
serializers easier, the provided serializers include a fallback mechanism to
support multiple deserialization formats:</p>

<table>
  <thead>
    <tr>
      <th>Serializer</th>
      <th>Serialize and deserialize</th>
      <th>Fallback deserialize</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:marshal</code></td>
      <td><code class="language-plaintext highlighter-rouge">Marshal</code></td>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::JSON</code>, <code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:json</code></td>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::JSON</code></td>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:json_allow_marshal</code></td>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::JSON</code></td>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code>, <code class="language-plaintext highlighter-rouge">Marshal</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:message_pack</code></td>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code></td>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::JSON</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:message_pack_allow_marshal</code></td>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code></td>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::JSON</code>, <code class="language-plaintext highlighter-rouge">Marshal</code></td>
    </tr>
  </tbody>
</table>

<p>WARNING: <code class="language-plaintext highlighter-rouge">Marshal</code> is a potential vector for deserialization attacks in cases
where a message signing secret has been leaked. <em>If possible, choose a
serializer that does not support <code class="language-plaintext highlighter-rouge">Marshal</code>.</em></p>

<p>INFO: The <code class="language-plaintext highlighter-rouge">:message_pack</code> and <code class="language-plaintext highlighter-rouge">:message_pack_allow_marshal</code> serializers support
roundtripping some Ruby types that are not supported by JSON, such as <code class="language-plaintext highlighter-rouge">Symbol</code>.
They can also provide improved performance and smaller payload sizes. However,
they require the <a href="https://rubygems.org/gems/msgpack"><code class="language-plaintext highlighter-rouge">msgpack</code> gem</a>.</p>

<p>Each of the above serializers will emit a <a href="active_support_instrumentation.html#message-serializer-fallback-active-support"><code class="language-plaintext highlighter-rouge">message_serializer_fallback.active_support</code></a>
event notification when they fall back to an alternate deserialization format,
allowing you to track how often such fallbacks occur.</p>

<p>Alternatively, you can specify any serializer object that responds to <code class="language-plaintext highlighter-rouge">dump</code> and
<code class="language-plaintext highlighter-rouge">load</code> methods. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_support</span><span class="p">.</span><span class="nf">message_serializer</span> <span class="o">=</span> <span class="no">YAML</span>
</code></pre></div></div>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:marshal</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">:json_allow_marshal</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_supportuse_message_serializer_for_metadata"><code class="language-plaintext highlighter-rouge">config.active_support.use_message_serializer_for_metadata</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">true</code>, enables a performance optimization that serializes message data and
metadata together. This changes the message format, so messages serialized this
way cannot be read by older (&lt; 7.1) versions of Rails. However, messages that
use the old format can still be read, regardless of whether this optimization is
enabled.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_supportcache_format_version"><code class="language-plaintext highlighter-rouge">config.active_support.cache_format_version</code></h4>

<p>Specifies which serialization format to use for the cache. Possible values are
<code class="language-plaintext highlighter-rouge">7.0</code>, and <code class="language-plaintext highlighter-rouge">7.1</code>.</p>

<p><code class="language-plaintext highlighter-rouge">7.0</code> serializes cache entries more efficiently.</p>

<p><code class="language-plaintext highlighter-rouge">7.1</code> further improves efficiency, and allows expired and version-mismatched
cache entries to be detected without deserializing their values. It also
includes an optimization for bare string values such as view fragments.</p>

<p>All formats are backward and forward compatible, meaning cache entries written
in one format can be read when using another format. This behavior makes it
easy to migrate between formats without invalidating the entire cache.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">7.0</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">7.1</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_supportdeprecation"><code class="language-plaintext highlighter-rouge">config.active_support.deprecation</code></h4>

<p>Configures the behavior of deprecation warnings. See
<a href="https://api.rubyonrails.org/classes/ActiveSupport/Deprecation/Behavior.html#method-i-behavior-3D"><code class="language-plaintext highlighter-rouge">Deprecation::Behavior</code></a> for a description of the
available options.</p>

<p>In the default generated <code class="language-plaintext highlighter-rouge">config/environments</code> files, this is set to <code class="language-plaintext highlighter-rouge">:log</code> for
development and <code class="language-plaintext highlighter-rouge">:stderr</code> for test, and it is omitted for production in favor of
<a href="#config-active-support-report-deprecations"><code class="language-plaintext highlighter-rouge">config.active_support.report_deprecations</code></a>.</p>

<h4 id="configactive_supportdisallowed_deprecation"><code class="language-plaintext highlighter-rouge">config.active_support.disallowed_deprecation</code></h4>

<p>Configures the behavior of disallowed deprecation warnings. See
<a href="https://api.rubyonrails.org/classes/ActiveSupport/Deprecation/Behavior.html#method-i-behavior-3D"><code class="language-plaintext highlighter-rouge">Deprecation::Behavior</code></a> for a description of the
available options.</p>

<p>This option is intended for development and test. For production, favor
<a href="#config-active-support-report-deprecations"><code class="language-plaintext highlighter-rouge">config.active_support.report_deprecations</code></a>.</p>

<h4 id="configactive_supportdisallowed_deprecation_warnings"><code class="language-plaintext highlighter-rouge">config.active_support.disallowed_deprecation_warnings</code></h4>

<p>Configures deprecation warnings that the Application considers disallowed. This allows, for example, specific deprecations to be treated as hard failures.</p>

<h4 id="configactive_supportreport_deprecations"><code class="language-plaintext highlighter-rouge">config.active_support.report_deprecations</code></h4>

<p>When <code class="language-plaintext highlighter-rouge">false</code>, disables all deprecation warnings, including disallowed deprecations, from the <a href="https://api.rubyonrails.org/classes/Rails/Application.html#method-i-deprecators">application’s deprecators</a>. This includes all the deprecations from Rails and other gems that may add their deprecator to the collection of deprecators, but may not prevent all deprecation warnings emitted from ActiveSupport::Deprecation.</p>

<p>In the default generated <code class="language-plaintext highlighter-rouge">config/environments</code> files, this is set to <code class="language-plaintext highlighter-rouge">false</code> for production.</p>

<h4 id="configactive_supportisolation_level"><code class="language-plaintext highlighter-rouge">config.active_support.isolation_level</code></h4>

<p>Configures the locality of most of Rails internal state. If you use a fiber based server or job processor (e.g. <code class="language-plaintext highlighter-rouge">falcon</code>), you should set it to <code class="language-plaintext highlighter-rouge">:fiber</code>. Otherwise it is best to use <code class="language-plaintext highlighter-rouge">:thread</code> locality. Defaults to <code class="language-plaintext highlighter-rouge">:thread</code>.</p>

<h4 id="configactive_supportexecutor_around_test_case"><code class="language-plaintext highlighter-rouge">config.active_support.executor_around_test_case</code></h4>

<p>Configure the test suite to call <code class="language-plaintext highlighter-rouge">Rails.application.executor.wrap</code> around test cases.
This makes test cases behave closer to an actual request or job.
Several features that are normally disabled in test, such as Active Record query cache
and asynchronous queries will then be enabled.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_supportto_time_preserves_timezone"><code class="language-plaintext highlighter-rouge">config.active_support.to_time_preserves_timezone</code></h4>

<p>Specifies whether <code class="language-plaintext highlighter-rouge">to_time</code> methods preserve the UTC offset of their receivers or preserves the timezone. If set to <code class="language-plaintext highlighter-rouge">:zone</code>, <code class="language-plaintext highlighter-rouge">to_time</code> methods will use the timezone of their receivers. If set to <code class="language-plaintext highlighter-rouge">:offset</code>, <code class="language-plaintext highlighter-rouge">to_time</code> methods will use the UTC offset. If <code class="language-plaintext highlighter-rouge">false</code>, <code class="language-plaintext highlighter-rouge">to_time</code> methods will convert to the local system UTC offset instead.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>5.0</td>
      <td><code class="language-plaintext highlighter-rouge">:offset</code></td>
    </tr>
    <tr>
      <td>8.0</td>
      <td><code class="language-plaintext highlighter-rouge">:zone</code></td>
    </tr>
  </tbody>
</table>

<h4 id="activesupportloggersilencer"><code class="language-plaintext highlighter-rouge">ActiveSupport::Logger.silencer</code></h4>

<p>Is set to <code class="language-plaintext highlighter-rouge">false</code> to disable the ability to silence logging in a block. The default is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="activesupportcachestorelogger"><code class="language-plaintext highlighter-rouge">ActiveSupport::Cache::Store.logger</code></h4>

<p>Specifies the logger to use within cache store operations.</p>

<h4 id="activesupportutc_to_local_returns_utc_offset_times"><code class="language-plaintext highlighter-rouge">ActiveSupport.utc_to_local_returns_utc_offset_times</code></h4>

<p>Configures <a href="https://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html#method-i-utc_to_local"><code class="language-plaintext highlighter-rouge">ActiveSupport::TimeZone.utc_to_local</code></a> to return a time with a UTC
offset instead of a UTC time incorporating that offset.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_supportraise_on_invalid_cache_expiration_time"><code class="language-plaintext highlighter-rouge">config.active_support.raise_on_invalid_cache_expiration_time</code></h4>

<p>Specifies whether an <code class="language-plaintext highlighter-rouge">ArgumentError</code> should be raised if <code class="language-plaintext highlighter-rouge">Rails.cache</code>
<a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch"><code class="language-plaintext highlighter-rouge">fetch</code></a> or <a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-write"><code class="language-plaintext highlighter-rouge">write</code></a>
are given an invalid <code class="language-plaintext highlighter-rouge">expires_at</code> or <code class="language-plaintext highlighter-rouge">expires_in</code> time.</p>

<p>Options are <code class="language-plaintext highlighter-rouge">true</code> and <code class="language-plaintext highlighter-rouge">false</code>. If <code class="language-plaintext highlighter-rouge">false</code>, the exception will be reported
as <code class="language-plaintext highlighter-rouge">handled</code> and logged instead.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h3 id="configuring-active-job">Configuring Active Job</h3>

<p><code class="language-plaintext highlighter-rouge">config.active_job</code> provides the following configuration options:</p>

<h4 id="configactive_jobqueue_adapter"><code class="language-plaintext highlighter-rouge">config.active_job.queue_adapter</code></h4>

<p>Sets the adapter for the queuing backend. The default adapter is <code class="language-plaintext highlighter-rouge">:async</code>. For an up-to-date list of built-in adapters see the <a href="https://api.rubyonrails.org/classes/ActiveJob/QueueAdapters.html">ActiveJob::QueueAdapters API documentation</a>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Be sure to have the adapter's gem in your Gemfile</span>
<span class="c1"># and follow the adapter's specific installation</span>
<span class="c1"># and deployment instructions.</span>
<span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">queue_adapter</span> <span class="o">=</span> <span class="ss">:sidekiq</span>
</code></pre></div></div>

<h4 id="configactive_jobdefault_queue_name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></h4>

<p>Can be used to change the default queue name. By default this is <code class="language-plaintext highlighter-rouge">"default"</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">default_queue_name</span> <span class="o">=</span> <span class="ss">:medium_priority</span>
</code></pre></div></div>

<h4 id="configactive_jobqueue_name_prefix"><code class="language-plaintext highlighter-rouge">config.active_job.queue_name_prefix</code></h4>

<p>Allows you to set an optional, non-blank, queue name prefix for all jobs. By default it is blank and not used.</p>

<p>The following configuration would queue the given job on the <code class="language-plaintext highlighter-rouge">production_high_priority</code> queue when run in production:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">queue_name_prefix</span> <span class="o">=</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">env</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">GuestsCleanupJob</span> <span class="o">&lt;</span> <span class="no">ActiveJob</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">queue_as</span> <span class="ss">:high_priority</span>
  <span class="c1">#....</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="configactive_jobqueue_name_delimiter"><code class="language-plaintext highlighter-rouge">config.active_job.queue_name_delimiter</code></h4>

<p>Has a default value of <code class="language-plaintext highlighter-rouge">'_'</code>. If <code class="language-plaintext highlighter-rouge">queue_name_prefix</code> is set, then <code class="language-plaintext highlighter-rouge">queue_name_delimiter</code> joins the prefix and the non-prefixed queue name.</p>

<p>The following configuration would queue the provided job on the <code class="language-plaintext highlighter-rouge">video_server.low_priority</code> queue:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># prefix must be set for delimiter to be used</span>
<span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">queue_name_prefix</span> <span class="o">=</span> <span class="s2">"video_server"</span>
<span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">queue_name_delimiter</span> <span class="o">=</span> <span class="s2">"."</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">EncoderJob</span> <span class="o">&lt;</span> <span class="no">ActiveJob</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">queue_as</span> <span class="ss">:low_priority</span>
  <span class="c1">#....</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="configactive_joblogger"><code class="language-plaintext highlighter-rouge">config.active_job.logger</code></h4>

<p>Accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then used to log information from Active Job. You can retrieve this logger by calling <code class="language-plaintext highlighter-rouge">logger</code> on either an Active Job class or an Active Job instance. Set to <code class="language-plaintext highlighter-rouge">nil</code> to disable logging.</p>

<h4 id="configactive_jobcustom_serializers"><code class="language-plaintext highlighter-rouge">config.active_job.custom_serializers</code></h4>

<p>Allows to set custom argument serializers. Defaults to <code class="language-plaintext highlighter-rouge">[]</code>.</p>

<h4 id="configactive_joblog_arguments"><code class="language-plaintext highlighter-rouge">config.active_job.log_arguments</code></h4>

<p>Controls if the arguments of a job are logged. Defaults to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configactive_jobverbose_enqueue_logs"><code class="language-plaintext highlighter-rouge">config.active_job.verbose_enqueue_logs</code></h4>

<p>Specifies if source locations of methods that enqueue background jobs should be logged below relevant enqueue log lines. By default, the flag is <code class="language-plaintext highlighter-rouge">true</code> in development and <code class="language-plaintext highlighter-rouge">false</code> in all other environments.</p>

<h4 id="configactive_jobretry_jitter"><code class="language-plaintext highlighter-rouge">config.active_job.retry_jitter</code></h4>

<p>Controls the amount of “jitter” (random variation) applied to the delay time calculated when retrying failed jobs.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">0.0</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">0.15</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_joblog_query_tags_around_perform"><code class="language-plaintext highlighter-rouge">config.active_job.log_query_tags_around_perform</code></h4>

<p>Determines whether job context for query tags will be automatically updated via
an <code class="language-plaintext highlighter-rouge">around_perform</code>. The default value is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h3 id="configuring-action-cable">Configuring Action Cable</h3>

<h4 id="configaction_cableurl"><code class="language-plaintext highlighter-rouge">config.action_cable.url</code></h4>

<p>Accepts a string for the URL for where you are hosting your Action Cable
server. You would use this option if you are running Action Cable servers that
are separated from your main application.</p>

<h4 id="configaction_cablemount_path"><code class="language-plaintext highlighter-rouge">config.action_cable.mount_path</code></h4>

<p>Accepts a string for where to mount Action Cable, as part of the main server
process. Defaults to <code class="language-plaintext highlighter-rouge">/cable</code>. You can set this as nil to not mount Action
Cable as part of your normal Rails server.</p>

<p>You can find more detailed configuration options in the
<a href="action_cable_overview.html#configuration">Action Cable Overview</a>.</p>

<h4 id="configaction_cableprecompile_assets"><code class="language-plaintext highlighter-rouge">config.action_cable.precompile_assets</code></h4>

<p>Determines whether the Action Cable assets should be added to the asset pipeline precompilation. It
has no effect if Sprockets is not used. The default value is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configaction_cableallow_same_origin_as_host"><code class="language-plaintext highlighter-rouge">config.action_cable.allow_same_origin_as_host</code></h4>

<p>Determines whether an origin matching the cable server itself will be permitted.
The default value is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<p>Set to false to disable automatic access for same-origin requests, and strictly allow
only the configured origins.</p>

<h4 id="configaction_cableallowed_request_origins"><code class="language-plaintext highlighter-rouge">config.action_cable.allowed_request_origins</code></h4>

<p>Determines the request origins which will be accepted by the cable server.
The default value is <code class="language-plaintext highlighter-rouge">/https?:\/\/localhost:\d+/</code> in the <code class="language-plaintext highlighter-rouge">development</code> environment.</p>

<h3 id="configuring-active-storage">Configuring Active Storage</h3>

<p><code class="language-plaintext highlighter-rouge">config.active_storage</code> provides the following configuration options:</p>

<h4 id="configactive_storagechecksum_implementation"><code class="language-plaintext highlighter-rouge">config.active_storage.checksum_implementation</code></h4>

<p>Specify which digest implementation to use for internal checksums.
The value must respond to Ruby’s <code class="language-plaintext highlighter-rouge">Digest</code> interface.</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">OpenSSL::Digest::MD5</code> or <code class="language-plaintext highlighter-rouge">Digest::MD5</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_storagevariant_processor"><code class="language-plaintext highlighter-rouge">config.active_storage.variant_processor</code></h4>

<p>Accepts a symbol <code class="language-plaintext highlighter-rouge">:mini_magick</code> or <code class="language-plaintext highlighter-rouge">:vips</code>, specifying whether variant transformations and blob analysis will be performed with MiniMagick or ruby-vips.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">:mini_magick</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">:vips</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_storageanalyzers"><code class="language-plaintext highlighter-rouge">config.active_storage.analyzers</code></h4>

<p>Accepts an array of classes indicating the analyzers available for Active Storage blobs.
By default, this is defined as:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">analyzers</span> <span class="o">=</span> <span class="p">[</span><span class="no">ActiveStorage</span><span class="o">::</span><span class="no">Analyzer</span><span class="o">::</span><span class="no">ImageAnalyzer</span><span class="o">::</span><span class="no">Vips</span><span class="p">,</span> <span class="no">ActiveStorage</span><span class="o">::</span><span class="no">Analyzer</span><span class="o">::</span><span class="no">ImageAnalyzer</span><span class="o">::</span><span class="no">ImageMagick</span><span class="p">,</span> <span class="no">ActiveStorage</span><span class="o">::</span><span class="no">Analyzer</span><span class="o">::</span><span class="no">VideoAnalyzer</span><span class="p">,</span> <span class="no">ActiveStorage</span><span class="o">::</span><span class="no">Analyzer</span><span class="o">::</span><span class="no">AudioAnalyzer</span><span class="p">]</span>
</code></pre></div></div>

<p>The image analyzers can extract width and height of an image blob; the video analyzer can extract width, height, duration, angle, aspect ratio, and presence/absence of video/audio channels of a video blob; the audio analyzer can extract duration and bit rate of an audio blob.</p>

<h4 id="configactive_storagepreviewers"><code class="language-plaintext highlighter-rouge">config.active_storage.previewers</code></h4>

<p>Accepts an array of classes indicating the image previewers available in Active Storage blobs.
By default, this is defined as:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">previewers</span> <span class="o">=</span> <span class="p">[</span><span class="no">ActiveStorage</span><span class="o">::</span><span class="no">Previewer</span><span class="o">::</span><span class="no">PopplerPDFPreviewer</span><span class="p">,</span> <span class="no">ActiveStorage</span><span class="o">::</span><span class="no">Previewer</span><span class="o">::</span><span class="no">MuPDFPreviewer</span><span class="p">,</span> <span class="no">ActiveStorage</span><span class="o">::</span><span class="no">Previewer</span><span class="o">::</span><span class="no">VideoPreviewer</span><span class="p">]</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">PopplerPDFPreviewer</code> and <code class="language-plaintext highlighter-rouge">MuPDFPreviewer</code> can generate a thumbnail from the first page of a PDF blob; <code class="language-plaintext highlighter-rouge">VideoPreviewer</code> from the relevant frame of a video blob.</p>

<h4 id="configactive_storagepaths"><code class="language-plaintext highlighter-rouge">config.active_storage.paths</code></h4>

<p>Accepts a hash of options indicating the locations of previewer/analyzer commands. The default is <code class="language-plaintext highlighter-rouge">{}</code>, meaning the commands will be looked for in the default path. Can include any of these options:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">:ffprobe</code> - The location of the ffprobe executable.</li>
  <li><code class="language-plaintext highlighter-rouge">:mutool</code> - The location of the mutool executable.</li>
  <li><code class="language-plaintext highlighter-rouge">:ffmpeg</code> - The location of the ffmpeg executable.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">paths</span><span class="p">[</span><span class="ss">:ffprobe</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"/usr/local/bin/ffprobe"</span>
</code></pre></div></div>

<h4 id="configactive_storagevariable_content_types"><code class="language-plaintext highlighter-rouge">config.active_storage.variable_content_types</code></h4>

<p>Accepts an array of strings indicating the content types that Active Storage
can transform through the variant processor.
By default, this is defined as:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">variable_content_types</span> <span class="o">=</span> <span class="sx">%w(image/png image/gif image/jpeg image/tiff image/bmp image/vnd.adobe.photoshop image/vnd.microsoft.icon image/webp image/avif image/heic image/heif)</span>
</code></pre></div></div>

<h4 id="configactive_storageweb_image_content_types"><code class="language-plaintext highlighter-rouge">config.active_storage.web_image_content_types</code></h4>

<p>Accepts an array of strings regarded as web image content types in which
variants can be processed without being converted to the fallback PNG format.
For example, if you want to use <code class="language-plaintext highlighter-rouge">AVIF</code> variants in your application you can add
<code class="language-plaintext highlighter-rouge">image/avif</code> to this array.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">%w(image/png image/jpeg image/gif)</code></td>
    </tr>
    <tr>
      <td>7.2</td>
      <td><code class="language-plaintext highlighter-rouge">%w(image/png image/jpeg image/gif image/webp)</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_storagecontent_types_to_serve_as_binary"><code class="language-plaintext highlighter-rouge">config.active_storage.content_types_to_serve_as_binary</code></h4>

<p>Accepts an array of strings indicating the content types that Active Storage will always serve as an attachment, rather than inline.
By default, this is defined as:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">content_types_to_serve_as_binary</span> <span class="o">=</span> <span class="sx">%w(text/html image/svg+xml application/postscript application/x-shockwave-flash text/xml application/xml application/xhtml+xml application/mathml+xml text/cache-manifest)</span>
</code></pre></div></div>

<h4 id="configactive_storagecontent_types_allowed_inline"><code class="language-plaintext highlighter-rouge">config.active_storage.content_types_allowed_inline</code></h4>

<p>Accepts an array of strings indicating the content types that Active Storage allows to serve as inline.
By default, this is defined as:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">content_types_allowed_inline</span> <span class="o">=</span> <span class="sx">%w(image/webp image/avif image/png image/gif image/jpeg image/tiff image/vnd.adobe.photoshop image/vnd.microsoft.icon application/pdf)</span>
</code></pre></div></div>

<h4 id="configactive_storagequeuesanalysis"><code class="language-plaintext highlighter-rouge">config.active_storage.queues.analysis</code></h4>

<p>Accepts a symbol indicating the Active Job queue to use for analysis jobs. When
this option is <code class="language-plaintext highlighter-rouge">nil</code>, analysis jobs are sent to the default Active Job queue
(see <a href="#config-active-job-default-queue-name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></a>).</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>6.0</td>
      <td><code class="language-plaintext highlighter-rouge">:active_storage_analysis</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_storagequeuesmirror"><code class="language-plaintext highlighter-rouge">config.active_storage.queues.mirror</code></h4>

<p>Accepts a symbol indicating the Active Job queue to use for direct upload
mirroring jobs. When this option is <code class="language-plaintext highlighter-rouge">nil</code>, mirroring jobs are sent to the
default Active Job queue (see <a href="#config-active-job-default-queue-name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></a>). The
default is <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<h4 id="configactive_storagequeuespreview_image"><code class="language-plaintext highlighter-rouge">config.active_storage.queues.preview_image</code></h4>

<p>Accepts a symbol indicating the Active Job queue to use for preprocessing
previews of images. When this option is <code class="language-plaintext highlighter-rouge">nil</code>, jobs are sent to the default
Active Job queue (see <a href="#config-active-job-default-queue-name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></a>). The default
is <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<h4 id="configactive_storagequeuespurge"><code class="language-plaintext highlighter-rouge">config.active_storage.queues.purge</code></h4>

<p>Accepts a symbol indicating the Active Job queue to use for purge jobs. When
this option is <code class="language-plaintext highlighter-rouge">nil</code>, purge jobs are sent to the default Active Job queue (see
<a href="#config-active-job-default-queue-name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></a>).</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>6.0</td>
      <td><code class="language-plaintext highlighter-rouge">:active_storage_purge</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">nil</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_storagequeuestransform"><code class="language-plaintext highlighter-rouge">config.active_storage.queues.transform</code></h4>

<p>Accepts a symbol indicating the Active Job queue to use for preprocessing
variants. When this option is <code class="language-plaintext highlighter-rouge">nil</code>, jobs are sent to the default Active Job
queue (see <a href="#config-active-job-default-queue-name"><code class="language-plaintext highlighter-rouge">config.active_job.default_queue_name</code></a>). The default is <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<h4 id="configactive_storagelogger"><code class="language-plaintext highlighter-rouge">config.active_storage.logger</code></h4>

<p>Can be used to set the logger used by Active Storage. Accepts a logger conforming to the interface of Log4r or the default Ruby Logger class.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">logger</span> <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="configactive_storageservice_urls_expire_in"><code class="language-plaintext highlighter-rouge">config.active_storage.service_urls_expire_in</code></h4>

<p>Determines the default expiry of URLs generated by:</p>

<ul>
  <li><a href="https://api.rubyonrails.org/classes/ActiveStorage/Blob.html#method-i-url"><code class="language-plaintext highlighter-rouge">ActiveStorage::Blob#url</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActiveStorage/Blob.html#method-i-service_url_for_direct_upload"><code class="language-plaintext highlighter-rouge">ActiveStorage::Blob#service_url_for_direct_upload</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActiveStorage/Preview.html#method-i-url"><code class="language-plaintext highlighter-rouge">ActiveStorage::Preview#url</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActiveStorage/Variant.html#method-i-url"><code class="language-plaintext highlighter-rouge">ActiveStorage::Variant#url</code></a></li>
</ul>

<p>The default is 5 minutes.</p>

<h4 id="configactive_storageurls_expire_in"><code class="language-plaintext highlighter-rouge">config.active_storage.urls_expire_in</code></h4>

<p>Determines the default expiry of URLs in the Rails application generated by Active Storage. The default is nil.</p>

<h4 id="configactive_storagetouch_attachment_records"><code class="language-plaintext highlighter-rouge">config.active_storage.touch_attachment_records</code></h4>

<p>Directs ActiveStorage::Attachments to touch its corresponding record when updated. The default is true.</p>

<h4 id="configactive_storageroutes_prefix"><code class="language-plaintext highlighter-rouge">config.active_storage.routes_prefix</code></h4>

<p>Can be used to set the route prefix for the routes served by Active Storage. Accepts a string that will be prepended to the generated routes.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">routes_prefix</span> <span class="o">=</span> <span class="s2">"/files"</span>
</code></pre></div></div>

<p>The default is <code class="language-plaintext highlighter-rouge">/rails/active_storage</code>.</p>

<h4 id="configactive_storagetrack_variants"><code class="language-plaintext highlighter-rouge">config.active_storage.track_variants</code></h4>

<p>Determines whether variants are recorded in the database.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>6.1</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_storagedraw_routes"><code class="language-plaintext highlighter-rouge">config.active_storage.draw_routes</code></h4>

<p>Can be used to toggle Active Storage route generation. The default is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h4 id="configactive_storageresolve_model_to_route"><code class="language-plaintext highlighter-rouge">config.active_storage.resolve_model_to_route</code></h4>

<p>Can be used to globally change how Active Storage files are delivered.</p>

<p>Allowed values are:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">:rails_storage_redirect</code>: Redirect to signed, short-lived service URLs.</li>
  <li><code class="language-plaintext highlighter-rouge">:rails_storage_proxy</code>: Proxy files by downloading them.</li>
</ul>

<p>The default is <code class="language-plaintext highlighter-rouge">:rails_storage_redirect</code>.</p>

<h4 id="configactive_storagevideo_preview_arguments"><code class="language-plaintext highlighter-rouge">config.active_storage.video_preview_arguments</code></h4>

<p>Can be used to alter the way ffmpeg generates video preview images.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">"-y -vframes 1 -f image2"</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">"-vf 'select=eq(n\\,0)+eq(key\\,1)+gt(scene\\,0.015)"</code><sup><mark><strong><em>1</em></strong></mark></sup> <br /> <code class="language-plaintext highlighter-rouge">+ ",loop=loop=-1:size=2,trim=start_frame=1'"</code><sup><mark><strong><em>2</em></strong></mark></sup><br /> <code class="language-plaintext highlighter-rouge">+ " -frames:v 1 -f image2"</code> <br /><br /> &lt;ol&gt;&lt;li&gt;Select the first video frame, plus keyframes, plus frames that meet the scene change threshold.&lt;/li&gt; &lt;li&gt;Use the first video frame as a fallback when no other frames meet the criteria by looping the first (one or) two selected frames, then dropping the first looped frame.&lt;/li&gt;&lt;/ol&gt;</td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_storagemultiple_file_field_include_hidden"><code class="language-plaintext highlighter-rouge">config.active_storage.multiple_file_field_include_hidden</code></h4>

<p>In Rails 7.1 and beyond, Active Storage <code class="language-plaintext highlighter-rouge">has_many_attached</code> relationships will
default to <em>replacing</em> the current collection instead of <em>appending</em> to it. Thus
to support submitting an <em>empty</em> collection, when <code class="language-plaintext highlighter-rouge">multiple_file_field_include_hidden</code>
is <code class="language-plaintext highlighter-rouge">true</code>, the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-file_field"><code class="language-plaintext highlighter-rouge">file_field</code></a>
helper will render an auxiliary hidden field, similar to the auxiliary field
rendered by the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-checkbox"><code class="language-plaintext highlighter-rouge">checkbox</code></a>
helper.</p>

<p>The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
    </tr>
    <tr>
      <td>7.0</td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
  </tbody>
</table>

<h4 id="configactive_storageprecompile_assets"><code class="language-plaintext highlighter-rouge">config.active_storage.precompile_assets</code></h4>

<p>Determines whether the Active Storage assets should be added to the asset pipeline precompilation. It
has no effect if Sprockets is not used. The default value is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h3 id="configuring-action-text">Configuring Action Text</h3>

<h4 id="configaction_textattachment_tag_name"><code class="language-plaintext highlighter-rouge">config.action_text.attachment_tag_name</code></h4>

<p>Accepts a string for the HTML tag used to wrap attachments. Defaults to <code class="language-plaintext highlighter-rouge">"action-text-attachment"</code>.</p>

<h4 id="configaction_textsanitizer_vendor"><code class="language-plaintext highlighter-rouge">config.action_text.sanitizer_vendor</code></h4>

<p>Configures the HTML sanitizer used by Action Text by setting <code class="language-plaintext highlighter-rouge">ActionText::ContentHelper.sanitizer</code> to an instance of the class returned from the vendor’s <code class="language-plaintext highlighter-rouge">.safe_list_sanitizer</code> method. The default value depends on the <code class="language-plaintext highlighter-rouge">config.load_defaults</code> target version:</p>

<table>
  <thead>
    <tr>
      <th>Starting with version</th>
      <th>The default value is</th>
      <th>Which parses markup as</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(original)</td>
      <td><code class="language-plaintext highlighter-rouge">Rails::HTML4::Sanitizer</code></td>
      <td>HTML4</td>
    </tr>
    <tr>
      <td>7.1</td>
      <td><code class="language-plaintext highlighter-rouge">Rails::HTML5::Sanitizer</code> (see NOTE)</td>
      <td>HTML5</td>
    </tr>
  </tbody>
</table>

<p>NOTE: <code class="language-plaintext highlighter-rouge">Rails::HTML5::Sanitizer</code> is not supported on JRuby, so on JRuby platforms Rails will fall back to <code class="language-plaintext highlighter-rouge">Rails::HTML4::Sanitizer</code>.</p>

<h4 id="regexptimeout"><code class="language-plaintext highlighter-rouge">Regexp.timeout</code></h4>

<p>See Ruby’s documentation for <a href="https://docs.ruby-lang.org/en/master/Regexp.html#method-c-timeout-3D"><code class="language-plaintext highlighter-rouge">Regexp.timeout=</code></a>.</p>

<h3 id="configuring-a-database">Configuring a Database</h3>

<p>Just about every Rails application will interact with a database. You can connect to the database by setting an environment variable <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> or by using a configuration file called <code class="language-plaintext highlighter-rouge">config/database.yml</code>.</p>

<p>Using the <code class="language-plaintext highlighter-rouge">config/database.yml</code> file you can specify all the information needed to access your database:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
</code></pre></div></div>

<p>This will connect to the database named <code class="language-plaintext highlighter-rouge">blog_development</code> using the <code class="language-plaintext highlighter-rouge">postgresql</code> adapter. This same information can be stored in a URL and provided via an environment variable like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ENV</span><span class="p">[</span><span class="s2">"DATABASE_URL"</span><span class="p">]</span> <span class="c1"># =&gt; "postgresql://localhost/blog_development?pool=5"</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">config/database.yml</code> file contains sections for three different environments in which Rails can run by default:</p>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">development</code> environment is used on your development/local computer as you interact manually with the application.</li>
  <li>The <code class="language-plaintext highlighter-rouge">test</code> environment is used when running automated tests.</li>
  <li>The <code class="language-plaintext highlighter-rouge">production</code> environment is used when you deploy your application for the world to use.</li>
</ul>

<p>If you wish, you can manually specify a URL inside of your <code class="language-plaintext highlighter-rouge">config/database.yml</code></p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">url</span><span class="pi">:</span> <span class="s">postgresql://localhost/blog_development?pool=5</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">config/database.yml</code> file can contain ERB tags <code class="language-plaintext highlighter-rouge">&lt;%= %&gt;</code>. Anything in the tags will be evaluated as Ruby code. You can use this to pull out data from an environment variable or to perform calculations to generate the needed connection information.</p>

<p>When using a <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> or a <code class="language-plaintext highlighter-rouge">url</code> key in your <code class="language-plaintext highlighter-rouge">config/database.yml</code>
file, Rails allows mapping the protocol in the URL to a database adapter that
can be configured from within the application. This allows the adapter to be
configured without modifying the URL set in the deployment environment. See:
<a href="#config-active-record-protocol-adapters"><code class="language-plaintext highlighter-rouge">config.active_record.protocol_adapters</code></a>.</p>

<p>TIP: You don’t have to update the database configurations manually. If you look at the options of the application generator, you will see that one of the options is named <code class="language-plaintext highlighter-rouge">--database</code>. This option allows you to choose an adapter from a list of the most used relational databases. You can even run the generator repeatedly: <code class="language-plaintext highlighter-rouge">cd .. &amp;&amp; rails new blog --database=mysql</code>. When you confirm the overwriting of the <code class="language-plaintext highlighter-rouge">config/database.yml</code> file, your application will be configured for MySQL instead of SQLite. Detailed examples of the common database connections are below.</p>

<h3 id="connection-preference">Connection Preference</h3>

<p>Since there are two ways to configure your connection (using <code class="language-plaintext highlighter-rouge">config/database.yml</code> or using an environment variable) it is important to understand how they can interact.</p>

<p>If you have an empty <code class="language-plaintext highlighter-rouge">config/database.yml</code> file but your <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> is present, then Rails will connect to the database via your environment variable:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>config/database.yml

<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
postgresql://localhost/my_database
</code></pre></div></div>

<p>If you have a <code class="language-plaintext highlighter-rouge">config/database.yml</code> but no <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> then this file will be used to connect to your database:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>config/database.yml
development:
  adapter: postgresql
  database: my_database
  host: localhost

<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
</code></pre></div></div>

<p>If you have both <code class="language-plaintext highlighter-rouge">config/database.yml</code> and <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> set then Rails will merge the configuration together. To better understand this we must see some examples.</p>

<p>When duplicate connection information is provided the environment variable will take precedence:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>config/database.yml
development:
  adapter: sqlite3
  database: NOT_my_database
  host: localhost

<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
postgresql://localhost/my_database

<span class="nv">$ </span>bin/rails runner <span class="s1">'puts ActiveRecord::Base.configurations.inspect'</span>
<span class="c">#&lt;ActiveRecord::DatabaseConfigurations:0x00007fc8eab02880 @configurations=[</span>
  <span class="c">#&lt;ActiveRecord::DatabaseConfigurations::UrlConfig:0x00007fc8eab020b0</span>
    @env_name<span class="o">=</span><span class="s2">"development"</span>, @spec_name<span class="o">=</span><span class="s2">"primary"</span>,
    @config<span class="o">={</span><span class="s2">"adapter"</span><span class="o">=&gt;</span><span class="s2">"postgresql"</span>, <span class="s2">"database"</span><span class="o">=&gt;</span><span class="s2">"my_database"</span>, <span class="s2">"host"</span><span class="o">=&gt;</span><span class="s2">"localhost"</span><span class="o">}</span>
    @url<span class="o">=</span><span class="s2">"postgresql://localhost/my_database"</span><span class="o">&gt;</span>
  <span class="o">]</span>
</code></pre></div></div>

<p>Here the adapter, host, and database match the information in <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code>.</p>

<p>If non-duplicate information is provided you will get all unique values, environment variable still takes precedence in cases of any conflicts.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>config/database.yml
development:
  adapter: sqlite3
  pool: 5

<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
postgresql://localhost/my_database

<span class="nv">$ </span>bin/rails runner <span class="s1">'puts ActiveRecord::Base.configurations.inspect'</span>
<span class="c">#&lt;ActiveRecord::DatabaseConfigurations:0x00007fc8eab02880 @configurations=[</span>
  <span class="c">#&lt;ActiveRecord::DatabaseConfigurations::UrlConfig:0x00007fc8eab020b0</span>
    @env_name<span class="o">=</span><span class="s2">"development"</span>, @spec_name<span class="o">=</span><span class="s2">"primary"</span>,
    @config<span class="o">={</span><span class="s2">"adapter"</span><span class="o">=&gt;</span><span class="s2">"postgresql"</span>, <span class="s2">"database"</span><span class="o">=&gt;</span><span class="s2">"my_database"</span>, <span class="s2">"host"</span><span class="o">=&gt;</span><span class="s2">"localhost"</span>, <span class="s2">"pool"</span><span class="o">=&gt;</span>5<span class="o">}</span>
    @url<span class="o">=</span><span class="s2">"postgresql://localhost/my_database"</span><span class="o">&gt;</span>
  <span class="o">]</span>
</code></pre></div></div>

<p>Since pool is not in the <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> provided connection information its information is merged in. Since <code class="language-plaintext highlighter-rouge">adapter</code> is duplicate, the <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> connection information wins.</p>

<p>The only way to explicitly not use the connection information in <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> is to specify an explicit URL connection using the <code class="language-plaintext highlighter-rouge">"url"</code> sub key:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>config/database.yml
development:
  url: sqlite3:NOT_my_database

<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
postgresql://localhost/my_database

<span class="nv">$ </span>bin/rails runner <span class="s1">'puts ActiveRecord::Base.configurations.inspect'</span>
<span class="c">#&lt;ActiveRecord::DatabaseConfigurations:0x00007fc8eab02880 @configurations=[</span>
  <span class="c">#&lt;ActiveRecord::DatabaseConfigurations::UrlConfig:0x00007fc8eab020b0</span>
    @env_name<span class="o">=</span><span class="s2">"development"</span>, @spec_name<span class="o">=</span><span class="s2">"primary"</span>,
    @config<span class="o">={</span><span class="s2">"adapter"</span><span class="o">=&gt;</span><span class="s2">"sqlite3"</span>, <span class="s2">"database"</span><span class="o">=&gt;</span><span class="s2">"NOT_my_database"</span><span class="o">}</span>
    @url<span class="o">=</span><span class="s2">"sqlite3:NOT_my_database"</span><span class="o">&gt;</span>
  <span class="o">]</span>
</code></pre></div></div>

<p>Here the connection information in <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> is ignored, note the different adapter and database name.</p>

<p>Since it is possible to embed ERB in your <code class="language-plaintext highlighter-rouge">config/database.yml</code> it is best practice to explicitly show you are using the <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code> to connect to your database. This is especially useful in production since you should not commit secrets like your database password into your source control (such as Git).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>config/database.yml
production:
  url: &lt;%<span class="o">=</span> ENV[<span class="s1">'DATABASE_URL'</span><span class="o">]</span> %&gt;
</code></pre></div></div>

<p>Now the behavior is clear, that we are only using the connection information in <code class="language-plaintext highlighter-rouge">ENV['DATABASE_URL']</code>.</p>

<h4 id="configuring-an-sqlite3-database">Configuring an SQLite3 Database</h4>

<p>Rails comes with built-in support for <a href="https://www.sqlite.org">SQLite3</a>, which is a lightweight serverless database application. While Rails better configures SQLite for production workloads, a busy production environment may overload SQLite. Rails defaults to using an SQLite database when creating a new project because it is a zero configuration database that just works, but you can always change it later.</p>

<p>Here’s the section of the default configuration file (<code class="language-plaintext highlighter-rouge">config/database.yml</code>) with connection information for the development environment:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">sqlite3</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">storage/development.sqlite3</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
  <span class="na">timeout</span><span class="pi">:</span> <span class="m">5000</span>
</code></pre></div></div>

<p><a href="https://sqlite.org/loadext.html">SQLite extensions</a> are supported when using <code class="language-plaintext highlighter-rouge">sqlite3</code> gem v2.4.0 or later by configuring <code class="language-plaintext highlighter-rouge">extensions</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">sqlite3</span>
  <span class="na">extensions</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">SQLean::UUID</span>                     <span class="c1"># module name responding to `.to_path`</span>
    <span class="pi">-</span> <span class="s">.sqlpkg/nalgeon/crypto/crypto.so</span> <span class="c1"># or a filesystem path</span>
    <span class="pi">-</span> <span class="s">&lt;%= AppExtensions.location %&gt;</span>    <span class="c1"># or ruby code returning a path</span>
</code></pre></div></div>

<p>Many useful features can be added to SQLite through extensions. You may wish to browse the <a href="https://sqlpkg.org/">SQLite extension hub</a> or use gems like <a href="https://github.com/fractaledmind/sqlpkg-ruby"><code class="language-plaintext highlighter-rouge">sqlpkg-ruby</code></a> and <a href="https://github.com/flavorjones/sqlean-ruby"><code class="language-plaintext highlighter-rouge">sqlean-ruby</code></a> that simplify extension management.</p>

<p>Other configuration options are described in the <a href="https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SQLite3Adapter.html">SQLite3Adapter documentation</a>.</p>

<h4 id="configuring-a-mysql-or-mariadb-database">Configuring a MySQL or MariaDB Database</h4>

<p>If you choose to use MySQL or MariaDB instead of the shipped SQLite3 database, your <code class="language-plaintext highlighter-rouge">config/database.yml</code> will look a little different. Here’s the development section:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">mysql2</span>
  <span class="na">encoding</span><span class="pi">:</span> <span class="s">utf8mb4</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">root</span>
  <span class="na">password</span><span class="pi">:</span>
  <span class="na">socket</span><span class="pi">:</span> <span class="s">/tmp/mysql.sock</span>
</code></pre></div></div>

<p>If your development database has a root user with an empty password, this configuration should work for you. Otherwise, change the username and password in the <code class="language-plaintext highlighter-rouge">development</code> section as appropriate.</p>

<p>NOTE: If your MySQL version is 5.5 or 5.6 and want to use the <code class="language-plaintext highlighter-rouge">utf8mb4</code> character set by default, please configure your MySQL server to support the longer key prefix by enabling <code class="language-plaintext highlighter-rouge">innodb_large_prefix</code> system variable.</p>

<p>Advisory Locks are enabled by default on MySQL and are used to make database migrations concurrent safe. You can disable advisory locks by setting <code class="language-plaintext highlighter-rouge">advisory_locks</code> to <code class="language-plaintext highlighter-rouge">false</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">production</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">mysql2</span>
  <span class="na">advisory_locks</span><span class="pi">:</span> <span class="kc">false</span>
</code></pre></div></div>

<h4 id="configuring-a-postgresql-database">Configuring a PostgreSQL Database</h4>

<p>If you choose to use PostgreSQL, your <code class="language-plaintext highlighter-rouge">config/database.yml</code> will be customized to use PostgreSQL databases:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">encoding</span><span class="pi">:</span> <span class="s">unicode</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
</code></pre></div></div>

<p>By default Active Record uses database features like prepared statements and advisory locks. You might need to disable those features if you’re using an external connection pooler like PgBouncer:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">production</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">prepared_statements</span><span class="pi">:</span> <span class="kc">false</span>
  <span class="na">advisory_locks</span><span class="pi">:</span> <span class="kc">false</span>
</code></pre></div></div>

<p>If enabled, Active Record will create up to <code class="language-plaintext highlighter-rouge">1000</code> prepared statements per database connection by default. To modify this behavior you can set <code class="language-plaintext highlighter-rouge">statement_limit</code> to a different value:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">production</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">statement_limit</span><span class="pi">:</span> <span class="m">200</span>
</code></pre></div></div>

<p>The more prepared statements in use: the more memory your database will require. If your PostgreSQL database is hitting memory limits, try lowering <code class="language-plaintext highlighter-rouge">statement_limit</code> or disabling prepared statements.</p>

<h4 id="configuring-an-sqlite3-database-for-jruby-platform">Configuring an SQLite3 Database for JRuby Platform</h4>

<p>If you choose to use SQLite3 and are using JRuby, your <code class="language-plaintext highlighter-rouge">config/database.yml</code> will look a little different. Here’s the development section:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">jdbcsqlite3</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">storage/development.sqlite3</span>
</code></pre></div></div>

<h4 id="configuring-a-mysql-or-mariadb-database-for-jruby-platform">Configuring a MySQL or MariaDB Database for JRuby Platform</h4>

<p>If you choose to use MySQL or MariaDB and are using JRuby, your <code class="language-plaintext highlighter-rouge">config/database.yml</code> will look a little different. Here’s the development section:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">jdbcmysql</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">root</span>
  <span class="na">password</span><span class="pi">:</span>
</code></pre></div></div>

<h4 id="configuring-a-postgresql-database-for-jruby-platform">Configuring a PostgreSQL Database for JRuby Platform</h4>

<p>If you choose to use PostgreSQL and are using JRuby, your <code class="language-plaintext highlighter-rouge">config/database.yml</code> will look a little different. Here’s the development section:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">jdbcpostgresql</span>
  <span class="na">encoding</span><span class="pi">:</span> <span class="s">unicode</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">blog</span>
  <span class="na">password</span><span class="pi">:</span>
</code></pre></div></div>

<p>Change the username and password in the <code class="language-plaintext highlighter-rouge">development</code> section as appropriate.</p>

<h4 id="configuring-metadata-storage">Configuring Metadata Storage</h4>

<p>By default Rails will store information about your Rails environment and schema
in an internal table named <code class="language-plaintext highlighter-rouge">ar_internal_metadata</code>.</p>

<p>To turn this off per connection, set <code class="language-plaintext highlighter-rouge">use_metadata_table</code> in your database
configuration. This is useful when working with a shared database and/or
database user that cannot create tables.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">use_metadata_table</span><span class="pi">:</span> <span class="kc">false</span>
</code></pre></div></div>

<h4 id="configuring-retry-behaviour">Configuring Retry Behaviour</h4>

<p>By default, Rails will automatically reconnect to the database server and retry certain queries
if something goes wrong. Only safely retryable (idempotent) queries will be retried. The number
of retries can be specified in your the database configuration via <code class="language-plaintext highlighter-rouge">connection_retries</code>, or disabled
by setting the value to 0. The default number of retries is 1.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">mysql2</span>
  <span class="na">connection_retries</span><span class="pi">:</span> <span class="m">3</span>
</code></pre></div></div>

<p>The database config also allows a <code class="language-plaintext highlighter-rouge">retry_deadline</code> to be configured. If a <code class="language-plaintext highlighter-rouge">retry_deadline</code> is configured,
an otherwise-retryable query will <em>not</em> be retried if the specified time has elapsed while the query was
first tried. For example, a <code class="language-plaintext highlighter-rouge">retry_deadline</code> of 5 seconds means that if 5 seconds have passed since a query
was first attempted, we won’t retry the query, even if it is idempotent and there are <code class="language-plaintext highlighter-rouge">connection_retries</code> left.</p>

<p>This value defaults to nil, meaning that all retryable queries are retried regardless of time elapsed.
The value for this config should be specified in seconds.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">mysql2</span>
  <span class="na">retry_deadline</span><span class="pi">:</span> <span class="m">5</span> <span class="c1"># Stop retrying queries after 5 seconds</span>
</code></pre></div></div>

<h4 id="configuring-query-cache">Configuring Query Cache</h4>

<p>By default, Rails automatically caches the result sets returned by queries. If Rails encounters the same query
again for that request or job, it will use the cached result set as opposed to running the query against
the database again.</p>

<p>The query cache is stored in memory, and to avoid using too much memory, it automatically evicts the least recently
used queries when reaching a threshold. By default the threshold is <code class="language-plaintext highlighter-rouge">100</code>, but can be configured in the <code class="language-plaintext highlighter-rouge">database.yml</code>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">mysql2</span>
  <span class="na">query_cache</span><span class="pi">:</span> <span class="m">200</span>
</code></pre></div></div>

<p>To entirely disable query caching, it can be set to <code class="language-plaintext highlighter-rouge">false</code></p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">mysql2</span>
  <span class="na">query_cache</span><span class="pi">:</span> <span class="kc">false</span>
</code></pre></div></div>

<h3 id="creating-rails-environments">Creating Rails Environments</h3>

<p>By default Rails ships with three environments: “development”, “test”, and “production”. While these are sufficient for most use cases, there are circumstances when you want more environments.</p>

<p>Imagine you have a server which mirrors the production environment but is only used for testing. Such a server is commonly called a “staging server”. To define an environment called “staging” for this server, just create a file called <code class="language-plaintext highlighter-rouge">config/environments/staging.rb</code>. Since this is a production-like environment, you could copy the contents of <code class="language-plaintext highlighter-rouge">config/environments/production.rb</code> as a starting point and make the necessary changes from there. It’s also possible to require and extend other environment configurations like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/environments/staging.rb</span>
<span class="nb">require_relative</span> <span class="s2">"production"</span>

<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span>
  <span class="c1"># Staging overrides</span>
<span class="k">end</span>
</code></pre></div></div>

<p>That environment is no different than the default ones, start a server with <code class="language-plaintext highlighter-rouge">bin/rails server -e staging</code>, a console with <code class="language-plaintext highlighter-rouge">bin/rails console -e staging</code>, <code class="language-plaintext highlighter-rouge">Rails.env.staging?</code> works, etc.</p>

<h3 id="deploy-to-a-subdirectory-relative-url-root">Deploy to a Subdirectory (relative URL root)</h3>

<p>By default Rails expects that your application is running at the root
(e.g. <code class="language-plaintext highlighter-rouge">/</code>). This section explains how to run your application inside a directory.</p>

<p>Let’s assume we want to deploy our application to “/app1”. Rails needs to know
this directory to generate the appropriate routes:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">relative_url_root</span> <span class="o">=</span> <span class="s2">"/app1"</span>
</code></pre></div></div>

<p>alternatively you can set the <code class="language-plaintext highlighter-rouge">RAILS_RELATIVE_URL_ROOT</code> environment
variable.</p>

<p>Rails will now prepend “/app1” when generating links.</p>

<h4 id="using-passenger">Using Passenger</h4>

<p>Passenger makes it easy to run your application in a subdirectory. You can find the relevant configuration in the <a href="https://www.phusionpassenger.com/library/deploy/apache/deploy/ruby/#deploying-an-app-to-a-sub-uri-or-subdirectory">Passenger manual</a>.</p>

<h4 id="using-a-reverse-proxy">Using a Reverse Proxy</h4>

<p>Deploying your application using a reverse proxy has definite advantages over traditional deploys. They allow you to have more control over your server by layering the components required by your application.</p>

<p>Many modern web servers can be used as a proxy server to balance third-party elements such as caching servers or application servers.</p>

<p>One such application server you can use is <a href="https://bogomips.org/unicorn/">Unicorn</a> to run behind a reverse proxy.</p>

<p>In this case, you would need to configure the proxy server (NGINX, Apache, etc) to accept connections from your application server (Unicorn). By default Unicorn will listen for TCP connections on port 8080, but you can change the port or configure it to use sockets instead.</p>

<p>You can find more information in the <a href="https://bogomips.org/unicorn/README.html">Unicorn readme</a> and understand the <a href="https://bogomips.org/unicorn/PHILOSOPHY.html">philosophy</a> behind it.</p>

<p>Once you’ve configured the application server, you must proxy requests to it by configuring your web server appropriately. For example your NGINX config may include:</p>

<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">upstream</span> <span class="s">application_server</span> <span class="p">{</span>
  <span class="kn">server</span> <span class="nf">0.0.0.0</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">server</span> <span class="p">{</span>
  <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
  <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>

  <span class="kn">root</span> <span class="n">/root/path/to/your_app/public</span><span class="p">;</span>

  <span class="kn">try_files</span> <span class="nv">$uri</span><span class="n">/index.html</span> <span class="nv">$uri</span><span class="s">.html</span> <span class="s">@app</span><span class="p">;</span>

  <span class="kn">location</span> <span class="s">@app</span> <span class="p">{</span>
    <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
    <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$http_host</span><span class="p">;</span>
    <span class="kn">proxy_redirect</span> <span class="no">off</span><span class="p">;</span>
    <span class="kn">proxy_pass</span> <span class="s">http://application_server</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1"># some other configuration</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Be sure to read the <a href="https://nginx.org/en/docs/">NGINX documentation</a> for the most up-to-date information.</p>

<h2 id="rails-environment-settings">Rails Environment Settings</h2>

<p>Some parts of Rails can also be configured externally by supplying environment variables. The following environment variables are recognized by various parts of Rails:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ENV["RAILS_ENV"]</code> defines the Rails environment (production, development, test, and so on) that Rails will run under.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ENV["RAILS_RELATIVE_URL_ROOT"]</code> is used by the routing code to recognize URLs when you <a href="configuring.html#deploy-to-a-subdirectory-relative-url-root">deploy your application to a subdirectory</a>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ENV["RAILS_CACHE_ID"]</code> and <code class="language-plaintext highlighter-rouge">ENV["RAILS_APP_VERSION"]</code> are used to generate expanded cache keys in Rails’ caching code. This allows you to have multiple separate caches from the same application.</p>
  </li>
</ul>

<h2 id="using-initializer-files">Using Initializer Files</h2>

<p>After loading the framework and any gems in your application, Rails turns to
loading initializers. An initializer is any Ruby file stored under
<code class="language-plaintext highlighter-rouge">config/initializers</code> in your application. You can use initializers to hold
configuration settings that should be made after all of the frameworks and gems
are loaded, such as options to configure settings for these parts.</p>

<p>The files in <code class="language-plaintext highlighter-rouge">config/initializers</code> (and any subdirectories of
<code class="language-plaintext highlighter-rouge">config/initializers</code>) are sorted and loaded one by one as part of
the <code class="language-plaintext highlighter-rouge">load_config_initializers</code> initializer.</p>

<p>If an initializer has code that relies on code in another initializer, you can
combine them into a single initializer instead. This makes the dependencies more
explicit, and can help surface new concepts within your application. Rails also
supports numbering of initializer file names, but this can lead to file name
churn. Explicitly loading initializers with <code class="language-plaintext highlighter-rouge">require</code> is not recommended, since
it will cause the initializer to get loaded twice.</p>

<p>NOTE: There is no guarantee that your initializers will run after all the gem
initializers, so any initialization code that depends on a given gem having been
initialized should go into a <code class="language-plaintext highlighter-rouge">config.after_initialize</code> block.</p>

<h2 id="load-hooks">Load Hooks</h2>

<p>Rails code can often be referenced on load of an application. Rails is responsible for the load order of these frameworks, so when you load frameworks, such as <code class="language-plaintext highlighter-rouge">ActiveRecord::Base</code>, prematurely you are violating an implicit contract your application has with Rails. Moreover, by loading code such as <code class="language-plaintext highlighter-rouge">ActiveRecord::Base</code> on boot of your application you are loading entire frameworks which may slow down your boot time and could cause conflicts with load order and boot of your application.</p>

<p>Load and configuration hooks are the API that allow you to hook into this initialization process without violating the load contract with Rails. This will also mitigate boot performance degradation and avoid conflicts.</p>

<h3 id="avoid-loading-rails-frameworks">Avoid Loading Rails Frameworks</h3>

<p>Since Ruby is a dynamic language, some code will cause different Rails frameworks to load. Take this snippet for instance:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">include</span><span class="p">(</span><span class="no">MyActiveRecordHelper</span><span class="p">)</span>
</code></pre></div></div>

<p>This snippet means that when this file is loaded, it will encounter <code class="language-plaintext highlighter-rouge">ActiveRecord::Base</code>. This encounter causes Ruby to look for the definition of that constant and will require it. This causes the entire Active Record framework to be loaded on boot.</p>

<p><code class="language-plaintext highlighter-rouge">ActiveSupport.on_load</code> is a mechanism that can be used to defer the loading of code until it is actually needed. The snippet above can be changed to:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="p">.</span><span class="nf">on_load</span><span class="p">(</span><span class="ss">:active_record</span><span class="p">)</span> <span class="k">do</span>
  <span class="kp">include</span> <span class="no">MyActiveRecordHelper</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This new snippet will only include <code class="language-plaintext highlighter-rouge">MyActiveRecordHelper</code> when <code class="language-plaintext highlighter-rouge">ActiveRecord::Base</code> is loaded.</p>

<h3 id="when-are-hooks-called">When are Hooks called?</h3>

<p>In the Rails framework these hooks are called when a specific library is loaded. For example, when <code class="language-plaintext highlighter-rouge">ActionController::Base</code> is loaded, the <code class="language-plaintext highlighter-rouge">:action_controller_base</code> hook is called. This means that all <code class="language-plaintext highlighter-rouge">ActiveSupport.on_load</code> calls with <code class="language-plaintext highlighter-rouge">:action_controller_base</code> hooks will be called in the context of <code class="language-plaintext highlighter-rouge">ActionController::Base</code> (that means <code class="language-plaintext highlighter-rouge">self</code> will be an <code class="language-plaintext highlighter-rouge">ActionController::Base</code>).</p>

<h3 id="modifying-code-to-use-load-hooks">Modifying Code to Use Load Hooks</h3>

<p>Modifying code is generally straightforward. If you have a line of code that refers to a Rails framework such as <code class="language-plaintext highlighter-rouge">ActiveRecord::Base</code> you can wrap that code in a load hook.</p>

<p><strong>Modifying calls to <code class="language-plaintext highlighter-rouge">include</code></strong></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">include</span><span class="p">(</span><span class="no">MyActiveRecordHelper</span><span class="p">)</span>
</code></pre></div></div>

<p>becomes</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="p">.</span><span class="nf">on_load</span><span class="p">(</span><span class="ss">:active_record</span><span class="p">)</span> <span class="k">do</span>
  <span class="c1"># self refers to ActiveRecord::Base here,</span>
  <span class="c1"># so we can call .include</span>
  <span class="kp">include</span> <span class="no">MyActiveRecordHelper</span>
<span class="k">end</span>
</code></pre></div></div>

<p><strong>Modifying calls to <code class="language-plaintext highlighter-rouge">prepend</code></strong></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">prepend</span><span class="p">(</span><span class="no">MyActionControllerHelper</span><span class="p">)</span>
</code></pre></div></div>

<p>becomes</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="p">.</span><span class="nf">on_load</span><span class="p">(</span><span class="ss">:action_controller_base</span><span class="p">)</span> <span class="k">do</span>
  <span class="c1"># self refers to ActionController::Base here,</span>
  <span class="c1"># so we can call .prepend</span>
  <span class="n">prepend</span> <span class="no">MyActionControllerHelper</span>
<span class="k">end</span>
</code></pre></div></div>

<p><strong>Modifying calls to class methods</strong></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">include_root_in_json</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre></div></div>

<p>becomes</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="p">.</span><span class="nf">on_load</span><span class="p">(</span><span class="ss">:active_record</span><span class="p">)</span> <span class="k">do</span>
  <span class="c1"># self refers to ActiveRecord::Base here</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">include_root_in_json</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="available-load-hooks">Available Load Hooks</h3>

<p>These are the load hooks you can use in your own code. To hook into the initialization process of one of the following classes use the available hook.</p>

<table>
  <thead>
    <tr>
      <th>Class</th>
      <th>Hook</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionCable</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_cable</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionCable::Channel::Base</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_cable_channel</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionCable::Connection::Base</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_cable_connection</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionCable::Connection::TestCase</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_cable_connection_test_case</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionController::API</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_controller_api</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionController::API</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_controller</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionController::Base</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_controller_base</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionController::Base</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_controller</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionController::TestCase</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_controller_test_case</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionDispatch::IntegrationTest</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_dispatch_integration_test</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionDispatch::Response</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_dispatch_response</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionDispatch::Request</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_dispatch_request</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionDispatch::SystemTestCase</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_dispatch_system_test_case</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionMailbox::Base</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_mailbox</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionMailbox::InboundEmail</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_mailbox_inbound_email</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionMailbox::Record</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_mailbox_record</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionMailbox::TestCase</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_mailbox_test_case</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionMailer::Base</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_mailer</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionMailer::TestCase</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_mailer_test_case</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionText::Content</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_text_content</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionText::Record</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_text_record</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionText::RichText</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_text_rich_text</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionText::EncryptedRichText</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_text_encrypted_rich_text</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionView::Base</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_view</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActionView::TestCase</code></td>
      <td><code class="language-plaintext highlighter-rouge">action_view_test_case</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveJob::Base</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_job</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveJob::TestCase</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_job_test_case</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveModel::Model</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_model</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveModel::Translation</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_model_translation</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveRecord::Base</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_record</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveRecord::DatabaseConfigurations</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_record_database_configurations</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveRecord::Encryption</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_record_encryption</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveRecord::TestFixtures</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_record_fixtures</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_record_postgresqladapter</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveRecord::ConnectionAdapters::Mysql2Adapter</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_record_mysql2adapter</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveRecord::ConnectionAdapters::TrilogyAdapter</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_record_trilogyadapter</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveRecord::ConnectionAdapters::SQLite3Adapter</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_record_sqlite3adapter</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveStorage::Attachment</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_storage_attachment</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveStorage::VariantRecord</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_storage_variant_record</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveStorage::Blob</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_storage_blob</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveStorage::Record</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_storage_record</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ActiveSupport::TestCase</code></td>
      <td><code class="language-plaintext highlighter-rouge">active_support_test_case</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">i18n</code></td>
      <td><code class="language-plaintext highlighter-rouge">i18n</code></td>
    </tr>
  </tbody>
</table>

<h2 id="initialization-events">Initialization Events</h2>

<p>Rails has 5 initialization events which can be hooked into (listed in the order that they are run):</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">before_configuration</code>: This is run when the application class inherits from <code class="language-plaintext highlighter-rouge">Rails::Application</code> in <code class="language-plaintext highlighter-rouge">config/application.rb</code>. Before the class body is executed. Engines may use this hook to run code before the application itself gets configured.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">before_initialize</code>: This is run directly before the initialization process of the application occurs with the <code class="language-plaintext highlighter-rouge">:bootstrap_hook</code> initializer near the beginning of the Rails initialization process.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">to_prepare</code>: Run after the initializers are run for all Railties (including the application itself) and after the middleware stack is built, but before eager loading. More importantly, will run upon every code reload in <code class="language-plaintext highlighter-rouge">development</code>, but only once (during boot-up) in <code class="language-plaintext highlighter-rouge">production</code> and <code class="language-plaintext highlighter-rouge">test</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">before_eager_load</code>: This is run directly before eager loading occurs, which is the default behavior for the <code class="language-plaintext highlighter-rouge">production</code> environment and not for the <code class="language-plaintext highlighter-rouge">development</code> environment.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">after_initialize</code>: Run directly after the initialization of the application, after the application initializers in <code class="language-plaintext highlighter-rouge">config/initializers</code> are run.</p>
  </li>
</ul>

<p>To define an event for these hooks, use the block syntax within a <code class="language-plaintext highlighter-rouge">Rails::Application</code>, <code class="language-plaintext highlighter-rouge">Rails::Railtie</code> or <code class="language-plaintext highlighter-rouge">Rails::Engine</code> subclass:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">YourApp</span>
  <span class="k">class</span> <span class="nc">Application</span> <span class="o">&lt;</span> <span class="no">Rails</span><span class="o">::</span><span class="no">Application</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">before_initialize</span> <span class="k">do</span>
      <span class="c1"># initialization code goes here</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Alternatively, you can also do it through the <code class="language-plaintext highlighter-rouge">config</code> method on the <code class="language-plaintext highlighter-rouge">Rails.application</code> object:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">before_initialize</span> <span class="k">do</span>
  <span class="c1"># initialization code goes here</span>
<span class="k">end</span>
</code></pre></div></div>

<p>WARNING: Some parts of your application, notably routing, are not yet set up at the point where the <code class="language-plaintext highlighter-rouge">after_initialize</code> block is called.</p>

<h3 id="railsrailtieinitializer"><code class="language-plaintext highlighter-rouge">Rails::Railtie#initializer</code></h3>

<p>Rails has several initializers that run on startup that are all defined by using the <code class="language-plaintext highlighter-rouge">initializer</code> method from <code class="language-plaintext highlighter-rouge">Rails::Railtie</code>. Here’s an example of the <code class="language-plaintext highlighter-rouge">set_helpers_path</code> initializer from Action Controller:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">initializer</span> <span class="s2">"action_controller.set_helpers_path"</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
  <span class="no">ActionController</span><span class="o">::</span><span class="no">Helpers</span><span class="p">.</span><span class="nf">helpers_path</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="nf">helpers_paths</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">initializer</code> method takes three arguments with the first being the name for the initializer and the second being an options hash (not shown here) and the third being a block. The <code class="language-plaintext highlighter-rouge">:before</code> key in the options hash can be specified to specify which initializer this new initializer must run before, and the <code class="language-plaintext highlighter-rouge">:after</code> key will specify which initializer to run this initializer <em>after</em>.</p>

<p>Initializers defined using the <code class="language-plaintext highlighter-rouge">initializer</code> method will be run in the order they are defined in, with the exception of ones that use the <code class="language-plaintext highlighter-rouge">:before</code> or <code class="language-plaintext highlighter-rouge">:after</code> methods.</p>

<p>WARNING: You may put your initializer before or after any other initializer in the chain, as long as it is logical. Say you have 4 initializers called “one” through “four” (defined in that order) and you define “four” to go <em>before</em> “two” but <em>after</em> “three”, that just isn’t logical and Rails will not be able to determine your initializer order.</p>

<p>The block argument of the <code class="language-plaintext highlighter-rouge">initializer</code> method is the instance of the application itself, and so we can access the configuration on it by using the <code class="language-plaintext highlighter-rouge">config</code> method as done in the example.</p>

<p>Because <code class="language-plaintext highlighter-rouge">Rails::Application</code> inherits from <code class="language-plaintext highlighter-rouge">Rails::Railtie</code> (indirectly), you can use the <code class="language-plaintext highlighter-rouge">initializer</code> method in <code class="language-plaintext highlighter-rouge">config/application.rb</code> to define initializers for the application.</p>

<h3 id="initializers">Initializers</h3>

<p>Below is a comprehensive list of all the initializers found in Rails in the order that they are defined (and therefore run in, unless otherwise stated).</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">load_environment_hook</code>: Serves as a placeholder so that <code class="language-plaintext highlighter-rouge">:load_environment_config</code> can be defined to run before it.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">load_active_support</code>: Optionally requires <code class="language-plaintext highlighter-rouge">active_support/all</code> if <code class="language-plaintext highlighter-rouge">config.active_support.bare</code> is un-truthful, which is the default.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">initialize_logger</code>: Initializes the logger (an <code class="language-plaintext highlighter-rouge">ActiveSupport::BroadcastLogger</code> object) for the application and makes it accessible at <code class="language-plaintext highlighter-rouge">Rails.logger</code>, provided that no initializer inserted before this point has defined <code class="language-plaintext highlighter-rouge">Rails.logger</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">initialize_cache</code>: If <code class="language-plaintext highlighter-rouge">Rails.cache</code> isn’t set yet, initializes the cache by referencing the value in <code class="language-plaintext highlighter-rouge">config.cache_store</code> and stores the outcome as <code class="language-plaintext highlighter-rouge">Rails.cache</code>. If this object responds to the <code class="language-plaintext highlighter-rouge">middleware</code> method, its middleware is inserted before <code class="language-plaintext highlighter-rouge">Rack::Runtime</code> in the middleware stack.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">set_clear_dependencies_hook</code>: This initializer - which runs only if <code class="language-plaintext highlighter-rouge">config.enable_reloading</code> is set to <code class="language-plaintext highlighter-rouge">true</code> - uses <code class="language-plaintext highlighter-rouge">ActionDispatch::Callbacks.after</code> to remove the constants which have been referenced during the request from the object space so that they will be reloaded during the following request.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">bootstrap_hook</code>: Runs all configured <code class="language-plaintext highlighter-rouge">before_initialize</code> blocks.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">i18n.callbacks</code>: In the development environment, sets up a <code class="language-plaintext highlighter-rouge">to_prepare</code> callback which will call <code class="language-plaintext highlighter-rouge">I18n.reload!</code> if any of the locales have changed since the last request. In production this callback will only run on the first request.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_support.deprecation_behavior</code>: Sets up deprecation reporting behavior for <a href="https://api.rubyonrails.org/classes/Rails/Application.html#method-i-deprecators"><code class="language-plaintext highlighter-rouge">Rails.application.deprecators</code></a> based on <a href="#config-active-support-report-deprecations"><code class="language-plaintext highlighter-rouge">config.active_support.report_deprecations</code></a>, <a href="#config-active-support-deprecation"><code class="language-plaintext highlighter-rouge">config.active_support.deprecation</code></a>, <a href="#config-active-support-disallowed-deprecation"><code class="language-plaintext highlighter-rouge">config.active_support.disallowed_deprecation</code></a>, and <a href="#config-active-support-disallowed-deprecation-warnings"><code class="language-plaintext highlighter-rouge">config.active_support.disallowed_deprecation_warnings</code></a>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_support.initialize_time_zone</code>: Sets the default time zone for the application based on the <code class="language-plaintext highlighter-rouge">config.time_zone</code> setting, which defaults to “UTC”.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_support.initialize_beginning_of_week</code>: Sets the default beginning of week for the application based on <code class="language-plaintext highlighter-rouge">config.beginning_of_week</code> setting, which defaults to <code class="language-plaintext highlighter-rouge">:monday</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_support.set_configs</code>: Sets up Active Support by using the settings in <code class="language-plaintext highlighter-rouge">config.active_support</code> by <code class="language-plaintext highlighter-rouge">send</code>‘ing the method names as setters to <code class="language-plaintext highlighter-rouge">ActiveSupport</code> and passing the values through.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_dispatch.configure</code>: Configures the <code class="language-plaintext highlighter-rouge">ActionDispatch::Http::URL.tld_length</code> to be set to the value of <code class="language-plaintext highlighter-rouge">config.action_dispatch.tld_length</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_view.set_configs</code>: Sets up Action View by using the settings in <code class="language-plaintext highlighter-rouge">config.action_view</code> by <code class="language-plaintext highlighter-rouge">send</code>‘ing the method names as setters to <code class="language-plaintext highlighter-rouge">ActionView::Base</code> and passing the values through.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_controller.assets_config</code>: Initializes the <code class="language-plaintext highlighter-rouge">config.action_controller.assets_dir</code> to the app’s public directory if not explicitly configured.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_controller.set_helpers_path</code>: Sets Action Controller’s <code class="language-plaintext highlighter-rouge">helpers_path</code> to the application’s <code class="language-plaintext highlighter-rouge">helpers_path</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_controller.parameters_config</code>: Configures strong parameters options for <code class="language-plaintext highlighter-rouge">ActionController::Parameters</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_controller.set_configs</code>: Sets up Action Controller by using the settings in <code class="language-plaintext highlighter-rouge">config.action_controller</code> by <code class="language-plaintext highlighter-rouge">send</code>‘ing the method names as setters to <code class="language-plaintext highlighter-rouge">ActionController::Base</code> and passing the values through.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_controller.compile_config_methods</code>: Initializes methods for the config settings specified so that they are quicker to access.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_record.initialize_timezone</code>: Sets <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.time_zone_aware_attributes</code> to <code class="language-plaintext highlighter-rouge">true</code>, as well as setting <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.default_timezone</code> to UTC. When attributes are read from the database, they will be converted into the time zone specified by <code class="language-plaintext highlighter-rouge">Time.zone</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_record.logger</code>: Sets <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.logger</code> - if it’s not already set - to <code class="language-plaintext highlighter-rouge">Rails.logger</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_record.migration_error</code>: Configures middleware to check for pending migrations.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_record.check_schema_cache_dump</code>: Loads the schema cache dump if configured and available.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_record.set_configs</code>: Sets up Active Record by using the settings in <code class="language-plaintext highlighter-rouge">config.active_record</code> by <code class="language-plaintext highlighter-rouge">send</code>‘ing the method names as setters to <code class="language-plaintext highlighter-rouge">ActiveRecord::Base</code> and passing the values through.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_record.initialize_database</code>: Loads the database configuration (by default) from <code class="language-plaintext highlighter-rouge">config/database.yml</code> and establishes a connection for the current environment.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_record.log_runtime</code>: Includes <code class="language-plaintext highlighter-rouge">ActiveRecord::Railties::ControllerRuntime</code> and <code class="language-plaintext highlighter-rouge">ActiveRecord::Railties::JobRuntime</code> which are responsible for reporting the time taken by Active Record calls for the request back to the logger.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_record.set_reloader_hooks</code>: Resets all reloadable connections to the database if <code class="language-plaintext highlighter-rouge">config.enable_reloading</code> is set to <code class="language-plaintext highlighter-rouge">true</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_record.add_watchable_files</code>: Adds <code class="language-plaintext highlighter-rouge">schema.rb</code> and <code class="language-plaintext highlighter-rouge">structure.sql</code> files to watchable files.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_job.logger</code>: Sets <code class="language-plaintext highlighter-rouge">ActiveJob::Base.logger</code> - if it’s not already set -
to <code class="language-plaintext highlighter-rouge">Rails.logger</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">active_job.set_configs</code>: Sets up Active Job by using the settings in <code class="language-plaintext highlighter-rouge">config.active_job</code> by <code class="language-plaintext highlighter-rouge">send</code>‘ing the method names as setters to <code class="language-plaintext highlighter-rouge">ActiveJob::Base</code> and passing the values through.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_mailer.logger</code>: Sets <code class="language-plaintext highlighter-rouge">ActionMailer::Base.logger</code> - if it’s not already set - to <code class="language-plaintext highlighter-rouge">Rails.logger</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_mailer.set_configs</code>: Sets up Action Mailer by using the settings in <code class="language-plaintext highlighter-rouge">config.action_mailer</code> by <code class="language-plaintext highlighter-rouge">send</code>‘ing the method names as setters to <code class="language-plaintext highlighter-rouge">ActionMailer::Base</code> and passing the values through.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">action_mailer.compile_config_methods</code>: Initializes methods for the config settings specified so that they are quicker to access.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">set_load_path</code>: This initializer runs before <code class="language-plaintext highlighter-rouge">bootstrap_hook</code>. Adds paths
specified by <code class="language-plaintext highlighter-rouge">config.paths.load_paths</code> to <code class="language-plaintext highlighter-rouge">$LOAD_PATH</code>. And unless you set
<code class="language-plaintext highlighter-rouge">config.add_autoload_paths_to_load_path</code> to <code class="language-plaintext highlighter-rouge">false</code>, it will also add all
autoload paths specified by <code class="language-plaintext highlighter-rouge">config.autoload_paths</code>,
<code class="language-plaintext highlighter-rouge">config.eager_load_paths</code>, <code class="language-plaintext highlighter-rouge">config.autoload_once_paths</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">set_autoload_paths</code>: This initializer runs before <code class="language-plaintext highlighter-rouge">bootstrap_hook</code>. Adds all sub-directories of <code class="language-plaintext highlighter-rouge">app</code> and paths specified by <code class="language-plaintext highlighter-rouge">config.autoload_paths</code>, <code class="language-plaintext highlighter-rouge">config.eager_load_paths</code> and <code class="language-plaintext highlighter-rouge">config.autoload_once_paths</code> to <code class="language-plaintext highlighter-rouge">ActiveSupport::Dependencies.autoload_paths</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">add_routing_paths</code>: Loads (by default) all <code class="language-plaintext highlighter-rouge">config/routes.rb</code> files (in the application and railties, including engines) and sets up the routes for the application.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">add_locales</code>: Adds the files in <code class="language-plaintext highlighter-rouge">config/locales</code> (from the application, railties, and engines) to <code class="language-plaintext highlighter-rouge">I18n.load_path</code>, making available the translations in these files.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">add_view_paths</code>: Adds the directory <code class="language-plaintext highlighter-rouge">app/views</code> from the application, railties, and engines to the lookup path for view files for the application.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">add_mailer_preview_paths</code>: Adds the directory <code class="language-plaintext highlighter-rouge">test/mailers/previews</code> from the application, railties, and engines to the lookup path for mailer preview files for the application.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">load_environment_config</code>: This initializer runs before <code class="language-plaintext highlighter-rouge">load_environment_hook</code>. Loads the <code class="language-plaintext highlighter-rouge">config/environments</code> file for the current environment.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">prepend_helpers_path</code>: Adds the directory <code class="language-plaintext highlighter-rouge">app/helpers</code> from the application, railties, and engines to the lookup path for helpers for the application.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">load_config_initializers</code>: Loads all Ruby files from <code class="language-plaintext highlighter-rouge">config/initializers</code> in the application, railties, and engines. The files in this directory can be used to hold configuration settings that should be made after all of the frameworks are loaded.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">engines_blank_point</code>: Provides a point-in-initialization to hook into if you wish to do anything before engines are loaded. After this point, all railtie and engine initializers are run.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">add_generator_templates</code>: Finds templates for generators at <code class="language-plaintext highlighter-rouge">lib/templates</code> for the application, railties, and engines, and adds these to the <code class="language-plaintext highlighter-rouge">config.generators.templates</code> setting, which will make the templates available for all generators to reference.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ensure_autoload_once_paths_as_subset</code>: Ensures that the <code class="language-plaintext highlighter-rouge">config.autoload_once_paths</code> only contains paths from <code class="language-plaintext highlighter-rouge">config.autoload_paths</code>. If it contains extra paths, then an exception will be raised.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">add_to_prepare_blocks</code>: The block for every <code class="language-plaintext highlighter-rouge">config.to_prepare</code> call in the application, a railtie, or engine is added to the <code class="language-plaintext highlighter-rouge">to_prepare</code> callbacks for Action Dispatch which will be run per request in development, or before the first request in production.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">add_builtin_route</code>: If the application is running under the development environment then this will append the route for <code class="language-plaintext highlighter-rouge">rails/info/properties</code> to the application routes. This route provides the detailed information such as Rails and Ruby version for <code class="language-plaintext highlighter-rouge">public/index.html</code> in a default Rails application.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">build_middleware_stack</code>: Builds the middleware stack for the application, returning an object which has a <code class="language-plaintext highlighter-rouge">call</code> method which takes a Rack environment object for the request.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">eager_load!</code>: If <code class="language-plaintext highlighter-rouge">config.eager_load</code> is <code class="language-plaintext highlighter-rouge">true</code>, runs the <code class="language-plaintext highlighter-rouge">config.before_eager_load</code> hooks and then calls <code class="language-plaintext highlighter-rouge">eager_load!</code> which will load all <code class="language-plaintext highlighter-rouge">config.eager_load_namespaces</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">finisher_hook</code>: Provides a hook for after the initialization of process of the application is complete, as well as running all the <code class="language-plaintext highlighter-rouge">config.after_initialize</code> blocks for the application, railties, and engines.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">set_routes_reloader_hook</code>: Configures Action Dispatch to reload the routes file using <code class="language-plaintext highlighter-rouge">ActiveSupport::Callbacks.to_run</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">disable_dependency_loading</code>: Disables the automatic dependency loading if the <code class="language-plaintext highlighter-rouge">config.eager_load</code> is set to <code class="language-plaintext highlighter-rouge">true</code>.</p>
  </li>
</ul>

<h2 id="database-pooling">Database Pooling</h2>

<p>Active Record database connections are managed by <a href="https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/ConnectionPool.html"><code class="language-plaintext highlighter-rouge">ActiveRecord::ConnectionAdapters::ConnectionPool</code></a> which ensures that a connection pool synchronizes the amount of thread access to a limited number of database connections. This limit defaults to 5 and can be configured in <code class="language-plaintext highlighter-rouge">database.yml</code>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">sqlite3</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">storage/development.sqlite3</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
  <span class="na">timeout</span><span class="pi">:</span> <span class="m">5000</span>
</code></pre></div></div>

<p>Since the connection pooling is handled inside of Active Record by default, all application servers (Thin, Puma, Unicorn, etc.) should behave the same. The database connection pool is initially empty. As demand for connections increases it will create them until it reaches the connection pool limit.</p>

<p>Any one request will check out a connection the first time it requires access to the database. At the end of the request it will check the connection back in. This means that the additional connection slot will be available again for the next request in the queue.</p>

<p>If you try to use more connections than are available, Active Record will block
you and wait for a connection from the pool. If it cannot get a connection, a
timeout error similar to that given below will be thrown.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ActiveRecord::ConnectionTimeoutError - could not obtain a database connection within 5.000 seconds (waited 5.000 seconds)
</code></pre></div></div>

<p>If you get the above error, you might want to increase the size of the
connection pool by incrementing the <code class="language-plaintext highlighter-rouge">pool</code> option in <code class="language-plaintext highlighter-rouge">database.yml</code></p>

<p>NOTE. If you are running in a multi-threaded environment, there could be a chance that several threads may be accessing multiple connections simultaneously. So depending on your current request load, you could very well have multiple threads contending for a limited number of connections.</p>

<h2 id="custom-configuration">Custom Configuration</h2>

<p>You can configure your own code through the Rails configuration object with
custom configuration under either the <code class="language-plaintext highlighter-rouge">config.x</code> namespace, or <code class="language-plaintext highlighter-rouge">config</code> directly.
The key difference between these two is that you should be using <code class="language-plaintext highlighter-rouge">config.x</code> if you
are defining <em>nested</em> configuration (ex: <code class="language-plaintext highlighter-rouge">config.x.nested.hi</code>), and just
<code class="language-plaintext highlighter-rouge">config</code> for <em>single level</em> configuration (ex: <code class="language-plaintext highlighter-rouge">config.hello</code>).</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">schedule</span> <span class="o">=</span> <span class="ss">:daily</span>
<span class="n">config</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">retries</span>  <span class="o">=</span> <span class="mi">3</span>
<span class="n">config</span><span class="p">.</span><span class="nf">super_debugger</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre></div></div>

<p>These configuration points are then available through the configuration object:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">schedule</span> <span class="c1"># =&gt; :daily</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">retries</span>  <span class="c1"># =&gt; 3</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">not_set</span>  <span class="c1"># =&gt; nil</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">super_debugger</span>                <span class="c1"># =&gt; true</span>
</code></pre></div></div>

<p>You can also use <code class="language-plaintext highlighter-rouge">Rails::Application.config_for</code> to load whole configuration files:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/payment.yml</span>
<span class="na">production</span><span class="pi">:</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">production</span>
  <span class="na">merchant_id</span><span class="pi">:</span> <span class="s">production_merchant_id</span>
  <span class="na">public_key</span><span class="pi">:</span>  <span class="s">production_public_key</span>
  <span class="na">private_key</span><span class="pi">:</span> <span class="s">production_private_key</span>

<span class="na">development</span><span class="pi">:</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">sandbox</span>
  <span class="na">merchant_id</span><span class="pi">:</span> <span class="s">development_merchant_id</span>
  <span class="na">public_key</span><span class="pi">:</span>  <span class="s">development_public_key</span>
  <span class="na">private_key</span><span class="pi">:</span> <span class="s">development_private_key</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/application.rb</span>
<span class="k">module</span> <span class="nn">MyApp</span>
  <span class="k">class</span> <span class="nc">Application</span> <span class="o">&lt;</span> <span class="no">Rails</span><span class="o">::</span><span class="no">Application</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">payment</span> <span class="o">=</span> <span class="n">config_for</span><span class="p">(</span><span class="ss">:payment</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">payment</span><span class="p">[</span><span class="s2">"merchant_id"</span><span class="p">]</span> <span class="c1"># =&gt; production_merchant_id or development_merchant_id</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Rails::Application.config_for</code> supports a <code class="language-plaintext highlighter-rouge">shared</code> configuration to group common
configurations. The shared configuration will be merged into the environment
configuration.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/example.yml</span>
<span class="na">shared</span><span class="pi">:</span>
  <span class="na">foo</span><span class="pi">:</span>
    <span class="na">bar</span><span class="pi">:</span>
      <span class="na">baz</span><span class="pi">:</span> <span class="m">1</span>

<span class="na">development</span><span class="pi">:</span>
  <span class="na">foo</span><span class="pi">:</span>
    <span class="na">bar</span><span class="pi">:</span>
      <span class="na">qux</span><span class="pi">:</span> <span class="m">2</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># development environment</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config_for</span><span class="p">(</span><span class="ss">:example</span><span class="p">)[</span><span class="ss">:foo</span><span class="p">][</span><span class="ss">:bar</span><span class="p">]</span> <span class="c1">#=&gt; { baz: 1, qux: 2 }</span>
</code></pre></div></div>

<h2 id="search-engines-indexing">Search Engines Indexing</h2>

<p>Sometimes, you may want to prevent some pages of your application to be visible
on search sites like Google, Bing, Yahoo, or Duck Duck Go. The robots that index
these sites will first analyze the <code class="language-plaintext highlighter-rouge">http://your-site.com/robots.txt</code> file to
know which pages it is allowed to index.</p>

<p>Rails creates this file for you inside the <code class="language-plaintext highlighter-rouge">/public</code> folder. By default, it allows
search engines to index all pages of your application. If you want to block
indexing on all pages of your application, use this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>User-agent: *
Disallow: /
</code></pre></div></div>

<p>To block just specific pages, it’s necessary to use a more complex syntax. Learn
it on the <a href="https://www.robotstxt.org/robotstxt.html">official documentation</a>.</p>

        </div>

        <footer class="guide-footer">
            <div class="feedback">
                <h3>Geri Bildirim</h3>
                <p>Bu kılavuzun kalitesini artırmamıza yardımcı olmak için geri bildirimlerinizi bekliyoruz.</p>
                <p>Lütfen <a href="https://github.com/dilankaya127/rails-tr-TR">GitHub Issues</a> üzerinden katkıda bulunun.</p>
            </div>
        </footer>
    </article>
</div>

<script>
// İçindekiler tablosunu otomatik oluştur
document.addEventListener('DOMContentLoaded', function() {
    const toc = document.getElementById('toc');
    const headings = document.querySelectorAll('.guide-content h2, .guide-content h3, .guide-content h4');
    
    if (headings.length > 0) {
        const tocList = document.createElement('ul');
        
        headings.forEach(function(heading, index) {
            const id = 'heading-' + index;
            heading.id = id;
            
            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = '#' + id;
            a.textContent = heading.textContent;
            a.className = 'toc-' + heading.tagName.toLowerCase();
            
            li.appendChild(a);
            tocList.appendChild(li);
        });
        
        toc.appendChild(tocList);
    }
});
</script>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Rails Kılavuzları Türkçe Çevirisi. Gönüllüler tarafından hazırlanmıştır.</p>
            <p>Orijinal dokümantasyon <a href="https://guides.rubyonrails.org">Ruby on Rails</a> ekibine aittir.</p>
        </div>
    </footer>

    <script>hljs.highlightAll();</script>
</body>
</html>