<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      7 1 Release Notes - Rails Dokümantasyonu - Türkçe
    </title>
    <link
      rel="stylesheet"
      href="/assets/css/rails.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css"
    />

    <link
      rel="icon"
      type="image/svg"
      href="/assets/img/logo_rails-circle.svg"
    />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-Y6Q8S53SSQ"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-Y6Q8S53SSQ");
    </script>
  </head>
  <body>
    <header class="header">
      <div class="container">
        <div class="header-content">
          <h1 class="logo">
            <a href="/rails/">
              <img
                src="/assets/img/logo_rails-circle.svg"
                alt="Rails Logo"
                class="logo-image"
              />
            </a>
          </h1>
          <nav class="nav">
            <a href="/">Ana Sayfa</a>
            <!-- <a href="https://dilankaya127.github.io">Portföy</a> -->

            <div class="dropdown">
              <a class="dropbtn">Kılavuzlar</a>
              <div class="dropdown-content multi-column">
                 
                <div class="dropdown-column">
                  <h4>Buradan Başlayın</h4>
                  
                  <a href="/rails/guides/tr/getting_started">Rails ile Başlarken</a>
                  
                </div>
                      
                <div class="dropdown-column">
                  <h4>Controllers</h4>
                  
                  <a href="/rails/guides/tr/action_controller_overview">Action Controller</a>
                  
                </div>
                  
                <div class="dropdown-column">
                  <h4>Diğer Bileşenler</h4>
                  
                  <a href="/rails/guides/tr/action_cable_overview">Action Cable</a>
                  
                </div>
                               
              </div>
            </div>
            <a href="https://github.com/dilankaya127/rails-tr-TR">GitHub</a>
          </nav>
        </div>
      </div>
    </header>

    <main class="main">
      <div class="container"><div class="guide-container">
  <button id="toc-toggle" class="toc-toggle">☰ İçindekiler</button>

  <aside class="guide-sidebar">
    <div class="guide-toc">
      <!-- <h3>İçindekiler</h3> -->
      <div id="toc"></div>
      <button class="toc-close" aria-label="İçindekileri Kapat">✕</button>
    </div>

    <!-- <div class="guide-nav">
            <h3>Diğer(Tüm) Kılavuzlar</h3>
            <ul>
                <li><a href="/rails/guides/tr/getting_started">Rails ile Başlarken</a></li>
                <li><a href="/rails/guides/en/active_record_basics">Active Record Temelleri</a></li>
                <li><a href="/rails/guides//en/action_controller_overview">Action Controller</a></li>
                <li><a href="/rails/guides/tr/action_cable_overview">Action Cable</a></li>
            </ul>
        </div> -->
  </aside>

  <article class="guide-content">
    <!-- <header class="guide-header">
            <h1>7 1 Release Notes</h1>
            
        </header> -->

    <div class="guide-body"><p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1 id="ruby-on-rails-71-release-notes">Ruby on Rails 7.1 Release Notes</h1>

<p>Highlights in Rails 7.1:</p>

<ul>
  <li>Generate Dockerfiles for new Rails applications</li>
  <li>Add <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.normalizes</code></li>
  <li>Add <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.generates_token_for</code></li>
  <li>Add <code class="language-plaintext highlighter-rouge">perform_all_later</code> to enqueue multiple jobs at once</li>
  <li>Composite primary keys</li>
  <li>Introduce adapter for <code class="language-plaintext highlighter-rouge">Trilogy</code></li>
  <li>Add <code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code></li>
  <li>Introducing <code class="language-plaintext highlighter-rouge">config.autoload_lib</code> and <code class="language-plaintext highlighter-rouge">config.autoload_lib_once</code> for Enhanced Autoloading</li>
  <li>Active Record API for general async queries</li>
  <li>Allow templates to set strict <code class="language-plaintext highlighter-rouge">locals</code></li>
  <li>Add <code class="language-plaintext highlighter-rouge">Rails.application.deprecators</code></li>
  <li>Support pattern matching for JSON <code class="language-plaintext highlighter-rouge">response.parsed_body</code></li>
  <li>Extend <code class="language-plaintext highlighter-rouge">response.parsed_body</code> to parse HTML with Nokogiri</li>
  <li>Introduce <code class="language-plaintext highlighter-rouge">ActionView::TestCase.register_parser</code></li>
</ul>

<p>These release notes cover only the major changes. To learn about various bug
fixes and changes, please refer to the changelogs or check out the <a href="https://github.com/rails/rails/commits/7-1-stable">list of
commits</a> in the main Rails
repository on GitHub.</p>

<hr />

<h2 id="upgrading-to-rails-71">Upgrading to Rails 7.1</h2>

<p>If you’re upgrading an existing application, it’s a great idea to have good test
coverage before going in. You should also first upgrade to Rails 7.0 in case you
haven’t and make sure your application still runs as expected before attempting
an update to Rails 7.1. A list of things to watch out for when upgrading is
available in the
<a href="upgrading_ruby_on_rails.html#upgrading-from-rails-7-0-to-rails-7-1">Upgrading Ruby on Rails</a>
guide.</p>

<h2 id="major-features">Major Features</h2>

<h3 id="generate-dockerfiles-for-new-rails-applications">Generate Dockerfiles for new Rails applications</h3>

<p><a href="https://github.com/rails/rails/pull/46762">Default Docker support</a> to new Rails applications.
When generating a new application, Rails will now include Docker-related files in the application.</p>

<p>These files serve as a foundational setup for deploying your Rails application in a
production environment using Docker. It’s important to note that these files are not
meant for development purposes.</p>

<p>Here’s a quick example of how to build and run your Rails app using these Docker files:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker build <span class="nt">-t</span> app <span class="nb">.</span>
<span class="nv">$ </span>docker volume create app-storage
<span class="nv">$ </span>docker run <span class="nt">--rm</span> <span class="nt">-it</span> <span class="nt">-v</span> app-storage:/rails/storage <span class="nt">-p</span> 3000:3000 <span class="nt">--env</span> <span class="nv">RAILS_MASTER_KEY</span><span class="o">=</span>&lt;your-config-master-key&gt; app
</code></pre></div></div>

<p>You can also start a console or runner from this Docker image:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">--rm</span> <span class="nt">-it</span> <span class="nt">-v</span> app-storage:/rails/storage <span class="nt">--env</span> <span class="nv">RAILS_MASTER_KEY</span><span class="o">=</span>&lt;your-config-master-key&gt; app console
</code></pre></div></div>

<p>For those looking to create a multi-platform image (e.g., Apple Silicon for AMD or Intel deployment),
and push it to Docker Hub, follow these steps:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker login <span class="nt">-u</span> &lt;your-user&gt;
<span class="nv">$ </span>docker buildx create <span class="nt">--use</span>
<span class="nv">$ </span>docker buildx build <span class="nt">--push</span> <span class="nt">--platform</span><span class="o">=</span>linux/amd64,linux/arm64 <span class="nt">-t</span> &lt;your-user/image-name&gt; <span class="nb">.</span>
</code></pre></div></div>

<p>This enhancement simplifies the deployment process, providing a convenient starting point for
getting your Rails application up and running in a production environment.</p>

<h3 id="add-activerecordbasenormalizes">Add <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.normalizes</code></h3>

<p><a href="https://api.rubyonrails.org/v7.1/classes/ActiveRecord/Normalization/ClassMethods.html#method-i-normalizes"><code class="language-plaintext highlighter-rouge">ActiveRecord::Base.normalizes</code></a> declares an attribute normalization. The
normalization is applied when the attribute is assigned or updated, and the
normalized value will be persisted to the database. The normalization is also
applied to the corresponding keyword argument of query methods, allowing records
to be queried using unnormalized values.</p>

<p>For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">normalizes</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">with: </span><span class="o">-&gt;</span> <span class="n">email</span> <span class="p">{</span> <span class="n">email</span><span class="p">.</span><span class="nf">strip</span><span class="p">.</span><span class="nf">downcase</span> <span class="p">}</span>
  <span class="n">normalizes</span> <span class="ss">:phone</span><span class="p">,</span> <span class="ss">with: </span><span class="o">-&gt;</span> <span class="n">phone</span> <span class="p">{</span> <span class="n">phone</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s2">"^0-9"</span><span class="p">).</span><span class="nf">delete_prefix</span><span class="p">(</span><span class="s2">"1"</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>

<span class="n">user</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">email: </span><span class="s2">" CRUISE-CONTROL@EXAMPLE.COM</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">user</span><span class="p">.</span><span class="nf">email</span>                  <span class="c1"># =&gt; "cruise-control@example.com"</span>

<span class="n">user</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">email: </span><span class="s2">"</span><span class="se">\t</span><span class="s2">CRUISE-CONTROL@EXAMPLE.COM "</span><span class="p">)</span>
<span class="n">user</span><span class="p">.</span><span class="nf">email</span>                  <span class="c1"># =&gt; "cruise-control@example.com"</span>
<span class="n">user</span><span class="p">.</span><span class="nf">email_before_type_cast</span> <span class="c1"># =&gt; "cruise-control@example.com"</span>

<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">email: </span><span class="s2">"</span><span class="se">\t</span><span class="s2">CRUISE-CONTROL@EXAMPLE.COM "</span><span class="p">).</span><span class="nf">count</span>         <span class="c1"># =&gt; 1</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">([</span><span class="s2">"email = ?"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\t</span><span class="s2">CRUISE-CONTROL@EXAMPLE.COM "</span><span class="p">]).</span><span class="nf">count</span> <span class="c1"># =&gt; 0</span>

<span class="no">User</span><span class="p">.</span><span class="nf">exists?</span><span class="p">(</span><span class="ss">email: </span><span class="s2">"</span><span class="se">\t</span><span class="s2">CRUISE-CONTROL@EXAMPLE.COM "</span><span class="p">)</span>         <span class="c1"># =&gt; true</span>
<span class="no">User</span><span class="p">.</span><span class="nf">exists?</span><span class="p">([</span><span class="s2">"email = ?"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\t</span><span class="s2">CRUISE-CONTROL@EXAMPLE.COM "</span><span class="p">])</span> <span class="c1"># =&gt; false</span>

<span class="no">User</span><span class="p">.</span><span class="nf">normalize_value_for</span><span class="p">(</span><span class="ss">:phone</span><span class="p">,</span> <span class="s2">"+1 (555) 867-5309"</span><span class="p">)</span> <span class="c1"># =&gt; "5558675309"</span>
</code></pre></div></div>

<h3 id="add-activerecordbasegenerates_token_for">Add <code class="language-plaintext highlighter-rouge">ActiveRecord::Base.generates_token_for</code></h3>

<p><a href="https://api.rubyonrails.org/v7.1/classes/ActiveRecord/TokenFor/ClassMethods.html#method-i-generates_token_for"><code class="language-plaintext highlighter-rouge">ActiveRecord::Base.generates_token_for</code></a> defines the generation of tokens
for a specific purpose. Generated tokens can expire and can also embed record
data. When using a token to fetch a record, the data from the token and the
current data from the record will be compared. If the two do not match, the
token will be treated as invalid, the same as if it had expired.</p>

<p>Here is an example implementing a single-use password reset token:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">has_secure_password</span>

  <span class="n">generates_token_for</span> <span class="ss">:password_reset</span><span class="p">,</span> <span class="ss">expires_in: </span><span class="mi">15</span><span class="p">.</span><span class="nf">minutes</span> <span class="k">do</span>
    <span class="c1"># `password_salt` (defined by `has_secure_password`) returns the salt for</span>
    <span class="c1"># the password. The salt changes when the password is changed, so the token</span>
    <span class="c1"># will expire when the password is changed.</span>
    <span class="n">password_salt</span><span class="o">&amp;</span><span class="p">.</span><span class="nf">last</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">user</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">first</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">user</span><span class="p">.</span><span class="nf">generate_token_for</span><span class="p">(</span><span class="ss">:password_reset</span><span class="p">)</span>

<span class="no">User</span><span class="p">.</span><span class="nf">find_by_token_for</span><span class="p">(</span><span class="ss">:password_reset</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="c1"># =&gt; user</span>

<span class="n">user</span><span class="p">.</span><span class="nf">update!</span><span class="p">(</span><span class="ss">password: </span><span class="s2">"new password"</span><span class="p">)</span>
<span class="no">User</span><span class="p">.</span><span class="nf">find_by_token_for</span><span class="p">(</span><span class="ss">:password_reset</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="c1"># =&gt; nil</span>
</code></pre></div></div>

<h3 id="add-perform_all_later-to-enqueue-multiple-jobs-at-once">Add <code class="language-plaintext highlighter-rouge">perform_all_later</code> to enqueue multiple jobs at once</h3>

<p>The <a href="https://github.com/rails/rails/pull/46603"><code class="language-plaintext highlighter-rouge">perform_all_later</code> method in Active Job</a>,
designed to streamline the process of enqueuing multiple jobs simultaneously. This powerful
addition allows you to efficiently enqueue jobs without triggering callbacks. This is
particularly useful when you need to enqueue a batch of jobs at once, reducing the overhead
of multiple round-trips to the queue datastore.</p>

<p>Here’s how you can take advantage of <code class="language-plaintext highlighter-rouge">perform_all_later</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Enqueueing individual jobs</span>
<span class="no">ActiveJob</span><span class="p">.</span><span class="nf">perform_all_later</span><span class="p">(</span><span class="no">MyJob</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span> <span class="no">MyJob</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"world"</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="c1"># Enqueueing an array of jobs</span>
<span class="n">user_jobs</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">pluck</span><span class="p">(</span><span class="ss">:id</span><span class="p">).</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="nb">id</span><span class="o">|</span> <span class="no">UserJob</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">user_id: </span><span class="nb">id</span><span class="p">)</span> <span class="p">}</span>
<span class="no">ActiveJob</span><span class="p">.</span><span class="nf">perform_all_later</span><span class="p">(</span><span class="n">user_jobs</span><span class="p">)</span>
</code></pre></div></div>

<p>By utilizing <code class="language-plaintext highlighter-rouge">perform_all_later</code>, you can optimize your job enqueuing process and take advantage
of improved efficiency, especially when working with large sets of jobs. It’s worth noting that
for queue adapters that support the new <code class="language-plaintext highlighter-rouge">enqueue_all</code> method, such as the Sidekiq adapter, the
enqueuing process is further optimized using <code class="language-plaintext highlighter-rouge">push_bulk</code>.</p>

<p>Please be aware that this new method introduces a separate event, <code class="language-plaintext highlighter-rouge">enqueue_all.active_job</code>,
and does not utilize the existing <code class="language-plaintext highlighter-rouge">enqueue.active_job</code> event. This ensures accurate tracking
and reporting of the bulk enqueuing process.</p>

<h3 id="composite-primary-keys">Composite primary keys</h3>

<p>Composite primary keys are now supported at both the database and application level. Rails is able to derive these keys directly from the schema. This feature is particularly beneficial for many-to-many relationships and other complex data models where a single column is insufficient to uniquely identify a record.</p>

<p>The SQL generated by query methods in Active Record (e.g. <code class="language-plaintext highlighter-rouge">#reload</code>, <code class="language-plaintext highlighter-rouge">#update</code>, <code class="language-plaintext highlighter-rouge">#delete</code>) will contain all parts of the composite primary key. Methods like <code class="language-plaintext highlighter-rouge">#first</code> and <code class="language-plaintext highlighter-rouge">#last</code> will use the full composite primary key in the <code class="language-plaintext highlighter-rouge">ORDER BY</code> statements.</p>

<p>The <code class="language-plaintext highlighter-rouge">query_constraints</code> macro can be used as a “virtual primary key” to achieve the same behavior without modifying the database schema.
Example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">TravelRoute</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">query_constraints</span> <span class="ss">:origin</span><span class="p">,</span> <span class="ss">:destination</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Similarly, associations accept a  <code class="language-plaintext highlighter-rouge">query_constraints:</code> option. This option serves as a composite foreign key, configuring the list of columns used for accessing the associated record.</p>

<p>Example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">TravelRouteReview</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:travel_route</span><span class="p">,</span> <span class="ss">query_constraints: </span><span class="p">[</span><span class="ss">:travel_route_origin</span><span class="p">,</span> <span class="ss">:travel_route_destination</span><span class="p">]</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="introduce-adapter-for-trilogy">Introduce adapter for <code class="language-plaintext highlighter-rouge">Trilogy</code></h3>

<p>A <a href="https://github.com/rails/rails/pull/47880">new adapter has been introduced</a> to facilitate the
seamless integration of <code class="language-plaintext highlighter-rouge">Trilogy</code>, a MySQL-compatible database client, with Rails applications.
Now, Rails applications have the option to incorporate <code class="language-plaintext highlighter-rouge">Trilogy</code> functionality by configuring their
<code class="language-plaintext highlighter-rouge">config/database.yml</code> file. For instance:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">trilogy</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
</code></pre></div></div>

<p>Alternatively, integration can be achieved using the <code class="language-plaintext highlighter-rouge">DATABASE_URL</code> environment variable:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ENV</span><span class="p">[</span><span class="s2">"DATABASE_URL"</span><span class="p">]</span> <span class="c1"># =&gt; "trilogy://localhost/blog_development?pool=5"</span>
</code></pre></div></div>

<h3 id="add-activesupportmessagepack">Add <code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code></h3>

<p><a href="https://api.rubyonrails.org/v7.1/classes/ActiveSupport/MessagePack.html"><code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code></a> is a serializer that integrates with the
<a href="https://github.com/msgpack/msgpack-ruby"><code class="language-plaintext highlighter-rouge">msgpack</code> gem</a>. <code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code> can serialize the basic Ruby
types supported by <code class="language-plaintext highlighter-rouge">msgpack</code>, as well as several additional types such as <code class="language-plaintext highlighter-rouge">Time</code>,
<code class="language-plaintext highlighter-rouge">ActiveSupport::TimeWithZone</code>, and <code class="language-plaintext highlighter-rouge">ActiveSupport::HashWithIndifferentAccess</code>.
Compared to <code class="language-plaintext highlighter-rouge">JSON</code> and <code class="language-plaintext highlighter-rouge">Marshal</code>, <code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code> can reduce
payload size and improve performance.</p>

<p><code class="language-plaintext highlighter-rouge">ActiveSupport::MessagePack</code> can be used as a <a href="https://guides.rubyonrails.org/v7.1/configuring.html#config-active-support-message-serializer">message serializer</a>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">active_support</span><span class="p">.</span><span class="nf">message_serializer</span> <span class="o">=</span> <span class="ss">:message_pack</span>

<span class="c1"># Or individually:</span>
<span class="no">ActiveSupport</span><span class="o">::</span><span class="no">MessageEncryptor</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="ss">serializer: :message_pack</span><span class="p">)</span>
<span class="no">ActiveSupport</span><span class="o">::</span><span class="no">MessageVerifier</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="ss">serializer: :message_pack</span><span class="p">)</span>
</code></pre></div></div>

<p>As the <a href="https://guides.rubyonrails.org/v7.1/configuring.html#config-action-dispatch-cookies-serializer">cookies serializer</a>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">action_dispatch</span><span class="p">.</span><span class="nf">cookies_serializer</span> <span class="o">=</span> <span class="ss">:message_pack</span>
</code></pre></div></div>

<p>And as a <a href="https://guides.rubyonrails.org/v7.1/caching_with_rails.html#configuration">cache serializer</a>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">cache_store</span> <span class="o">=</span> <span class="ss">:file_store</span><span class="p">,</span> <span class="s2">"tmp/cache"</span><span class="p">,</span> <span class="p">{</span> <span class="ss">serializer: :message_pack</span> <span class="p">}</span>

<span class="c1"># Or individually:</span>
<span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Cache</span><span class="p">.</span><span class="nf">lookup_store</span><span class="p">(</span><span class="ss">:file_store</span><span class="p">,</span> <span class="s2">"tmp/cache"</span><span class="p">,</span> <span class="ss">serializer: :message_pack</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="introducing-configautoload_lib-and-configautoload_lib_once-for-enhanced-autoloading">Introducing <code class="language-plaintext highlighter-rouge">config.autoload_lib</code> and <code class="language-plaintext highlighter-rouge">config.autoload_lib_once</code> for Enhanced Autoloading</h3>

<p>A <a href="https://github.com/rails/rails/pull/48572">new configuration method, <code class="language-plaintext highlighter-rouge">config.autoload_lib(ignore:)</code></a>,
has been introduced. This method is used to enhance the autoload paths of applications by including the
<code class="language-plaintext highlighter-rouge">lib</code> directory, which is not included by default. Also, <code class="language-plaintext highlighter-rouge">config.autoload_lib(ignore: %w(assets tasks))</code>
is generated for new applications.</p>

<p>When invoked from either <code class="language-plaintext highlighter-rouge">config/application.rb</code> or <code class="language-plaintext highlighter-rouge">config/environments/*.rb</code>, this method adds the
<code class="language-plaintext highlighter-rouge">lib</code> directory to both <code class="language-plaintext highlighter-rouge">config.autoload_paths</code> and <code class="language-plaintext highlighter-rouge">config.eager_load_paths</code>. It’s important to note
that this feature is not available for engines.</p>

<p>To ensure flexibility, the <code class="language-plaintext highlighter-rouge">ignore</code> keyword argument can be used to specify subdirectories within the
<code class="language-plaintext highlighter-rouge">lib</code> directory that should not be managed by the autoloaders. For instance, you can exclude directories
like <code class="language-plaintext highlighter-rouge">assets</code>, <code class="language-plaintext highlighter-rouge">tasks</code>, and <code class="language-plaintext highlighter-rouge">generators</code> by passing them to the <code class="language-plaintext highlighter-rouge">ignore</code> argument:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="p">.</span><span class="nf">autoload_lib</span><span class="p">(</span><span class="ss">ignore: </span><span class="sx">%w(assets tasks generators)</span><span class="p">)</span>
</code></pre></div></div>

<p>The <a href="https://github.com/rails/rails/pull/48610"><code class="language-plaintext highlighter-rouge">config.autoload_lib_once</code> method</a> is similar to
<code class="language-plaintext highlighter-rouge">config.autoload_lib</code>, except that it adds <code class="language-plaintext highlighter-rouge">lib</code> to <code class="language-plaintext highlighter-rouge">config.autoload_once_paths</code> instead.</p>

<p>Please, see more details in the <a href="autoloading_and_reloading_constants.html#config-autoload-lib-ignore">autoloading guide</a></p>

<h3 id="active-record-api-for-general-async-queries">Active Record API for general async queries</h3>

<p>A significant enhancement has been introduced to the Active Record API, expanding its
<a href="https://github.com/rails/rails/pull/44446">support for asynchronous queries</a>. This enhancement
addresses the need for more efficient handling of not-so-fast queries, particularly focusing on
aggregates (such as <code class="language-plaintext highlighter-rouge">count</code>, <code class="language-plaintext highlighter-rouge">sum</code>, etc.) and all methods returning a single record or anything
other than a <code class="language-plaintext highlighter-rouge">Relation</code>.</p>

<p>The new API includes the following asynchronous methods:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">async_count</code></li>
  <li><code class="language-plaintext highlighter-rouge">async_sum</code></li>
  <li><code class="language-plaintext highlighter-rouge">async_minimum</code></li>
  <li><code class="language-plaintext highlighter-rouge">async_maximum</code></li>
  <li><code class="language-plaintext highlighter-rouge">async_average</code></li>
  <li><code class="language-plaintext highlighter-rouge">async_pluck</code></li>
  <li><code class="language-plaintext highlighter-rouge">async_pick</code></li>
  <li><code class="language-plaintext highlighter-rouge">async_ids</code></li>
  <li><code class="language-plaintext highlighter-rouge">async_find_by_sql</code></li>
  <li><code class="language-plaintext highlighter-rouge">async_count_by_sql</code></li>
</ul>

<p>Here’s a brief example of how to use one of these methods, <code class="language-plaintext highlighter-rouge">async_count</code>, to count the number of published
posts in an asynchronous manner:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Synchronous count</span>
<span class="n">published_count</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">published: </span><span class="kp">true</span><span class="p">).</span><span class="nf">count</span> <span class="c1"># =&gt; 10</span>

<span class="c1"># Asynchronous count</span>
<span class="n">promise</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">published: </span><span class="kp">true</span><span class="p">).</span><span class="nf">async_count</span> <span class="c1"># =&gt; #&lt;ActiveRecord::Promise status=pending&gt;</span>
<span class="n">promise</span><span class="p">.</span><span class="nf">value</span> <span class="c1"># =&gt; 10</span>
</code></pre></div></div>

<p>These methods allow for the execution of these operations in an asynchronous manner, which can significantly
improve performance for certain types of database queries.</p>

<h3 id="allow-templates-to-set-strict-locals">Allow templates to set strict <code class="language-plaintext highlighter-rouge">locals</code></h3>

<p>Introduce a new feature that <a href="https://github.com/rails/rails/pull/45602">allows templates to set explicit <code class="language-plaintext highlighter-rouge">locals</code></a>.
This enhancement provides greater control and clarity when passing variables to your templates.</p>

<p>By default, templates will accept any <code class="language-plaintext highlighter-rouge">locals</code> as keyword arguments. However, now you can define what <code class="language-plaintext highlighter-rouge">locals</code> a
template should accept by adding a <code class="language-plaintext highlighter-rouge">locals</code> magic comment at the beginning of your template file.</p>

<p>Here’s how it works:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;%# locals: (message:) -%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">message</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>You can also set default values for these locals:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;%# locals: (message: "Hello, world!") -%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">message</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Optional keyword arguments can be splatted:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;%# locals: (message: "Hello, world!", **attributes) -%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">tag</span><span class="p">.</span><span class="nf">p</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>If you want to disable the use of locals entirely, you can do so like this:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;%# locals: () %&gt;</span>
</code></pre></div></div>

<p>Action View will process the <code class="language-plaintext highlighter-rouge">locals:</code> magic comment in any templating engine that supports <code class="language-plaintext highlighter-rouge">#</code>-prefixed comments, and will read the magic comment from any line in the partial.</p>

<p>CAUTION: Only keyword arguments are supported. Defining positional or block arguments will raise an Action View Error at render-time.</p>

<h3 id="add-railsapplicationdeprecators">Add <code class="language-plaintext highlighter-rouge">Rails.application.deprecators</code></h3>

<p>The new <a href="https://github.com/rails/rails/pull/46049"><code class="language-plaintext highlighter-rouge">Rails.application.deprecators</code> method</a> returns a
collection of managed deprecators within your application, and allows you to add and retrieve individual
deprecators with ease:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">deprecators</span><span class="p">[</span><span class="ss">:my_gem</span><span class="p">]</span> <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Deprecation</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"2.0"</span><span class="p">,</span> <span class="s2">"MyGem"</span><span class="p">)</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">deprecators</span><span class="p">[</span><span class="ss">:other_gem</span><span class="p">]</span> <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Deprecation</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"3.0"</span><span class="p">,</span> <span class="s2">"OtherGem"</span><span class="p">)</span>
</code></pre></div></div>

<p>The collection’s configuration settings affect all deprecators in the collection.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">deprecators</span><span class="p">.</span><span class="nf">debug</span> <span class="o">=</span> <span class="kp">true</span>

<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">deprecators</span><span class="p">[</span><span class="ss">:my_gem</span><span class="p">].</span><span class="nf">debug</span>
<span class="c1"># =&gt; true</span>

<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">deprecators</span><span class="p">[</span><span class="ss">:other_gem</span><span class="p">].</span><span class="nf">debug</span>
<span class="c1"># =&gt; true</span>
</code></pre></div></div>

<p>There are scenarios where you might want to mute all deprecator warnings for a specific block of code.
With the deprecators collection, you can easily silence all deprecator warnings within a block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">deprecators</span><span class="p">.</span><span class="nf">silence</span> <span class="k">do</span>
  <span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">deprecators</span><span class="p">[</span><span class="ss">:my_gem</span><span class="p">].</span><span class="nf">warn</span>    <span class="c1"># No warning (silenced)</span>
  <span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">deprecators</span><span class="p">[</span><span class="ss">:other_gem</span><span class="p">].</span><span class="nf">warn</span> <span class="c1"># No warning (silenced)</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="support-pattern-matching-for-json-responseparsed_body">Support pattern matching for JSON <code class="language-plaintext highlighter-rouge">response.parsed_body</code></h3>

<p>When <code class="language-plaintext highlighter-rouge">ActionDispatch::IntegrationTest</code> tests blocks invoke
<code class="language-plaintext highlighter-rouge">response.parsed_body</code> for JSON responses, their payloads will be available with
indifferent access. This enables integration with <a href="https://docs.ruby-lang.org/en/master/syntax/pattern_matching_rdoc.html">Ruby’s Pattern
Matching</a>, and built-in <a href="https://docs.seattlerb.org/minitest/Minitest/Assertions.html#method-i-assert_pattern">Minitest support for pattern
matching</a>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/posts.json"</span>

<span class="n">response</span><span class="p">.</span><span class="nf">content_type</span>         <span class="c1"># =&gt; "application/json; charset=utf-8"</span>
<span class="n">response</span><span class="p">.</span><span class="nf">parsed_body</span><span class="p">.</span><span class="nf">class</span>    <span class="c1"># =&gt; Array</span>
<span class="n">response</span><span class="p">.</span><span class="nf">parsed_body</span>          <span class="c1"># =&gt; [{"id"=&gt;42, "title"=&gt;"Title"},...</span>

<span class="n">assert_pattern</span> <span class="p">{</span> <span class="n">response</span><span class="p">.</span><span class="nf">parsed_body</span> <span class="o">=&gt;</span> <span class="p">[{</span> <span class="ss">id: </span><span class="mi">42</span> <span class="p">}]</span> <span class="p">}</span>

<span class="n">get</span> <span class="s2">"/posts/42.json"</span>

<span class="n">response</span><span class="p">.</span><span class="nf">content_type</span>         <span class="c1"># =&gt; "application/json; charset=utf-8"</span>
<span class="n">response</span><span class="p">.</span><span class="nf">parsed_body</span><span class="p">.</span><span class="nf">class</span>    <span class="c1"># =&gt; ActiveSupport::HashWithIndifferentAccess</span>
<span class="n">response</span><span class="p">.</span><span class="nf">parsed_body</span>          <span class="c1"># =&gt; {"id"=&gt;42, "title"=&gt;"Title"}</span>

<span class="n">assert_pattern</span> <span class="p">{</span> <span class="n">response</span><span class="p">.</span><span class="nf">parsed_body</span> <span class="o">=&gt;</span> <span class="p">[{</span> <span class="ss">title: </span><span class="sr">/title/i</span> <span class="p">}]</span> <span class="p">}</span>
</code></pre></div></div>

<h3 id="extend-responseparsed_body-to-parse-html-with-nokogiri">Extend <code class="language-plaintext highlighter-rouge">response.parsed_body</code> to parse HTML with Nokogiri</h3>

<p><a href="https://github.com/rails/rails/pull/47144">Extend the <code class="language-plaintext highlighter-rouge">ActionDispatch::Testing</code> module</a> to support parsing the
value of an HTML <code class="language-plaintext highlighter-rouge">response.body</code> into a <code class="language-plaintext highlighter-rouge">Nokogiri::HTML5::Document</code> instance:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/posts"</span>

<span class="n">response</span><span class="p">.</span><span class="nf">content_type</span>         <span class="c1"># =&gt; "text/html; charset=utf-8"</span>
<span class="n">response</span><span class="p">.</span><span class="nf">parsed_body</span><span class="p">.</span><span class="nf">class</span>    <span class="c1"># =&gt; Nokogiri::HTML5::Document</span>
<span class="n">response</span><span class="p">.</span><span class="nf">parsed_body</span><span class="p">.</span><span class="nf">to_html</span>  <span class="c1"># =&gt; "&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n..."</span>
</code></pre></div></div>

<p>Newly added <a href="https://nokogiri.org/rdoc/Nokogiri/XML/Attr.html#method-i-deconstruct_keys">Nokogiri support for pattern matching</a>,
along with built-in <a href="https://docs.seattlerb.org/minitest/Minitest/Assertions.html#method-i-assert_pattern">Minitest support for pattern
matching</a> presents opportunities to make test
assertions about the structure and content of the HTML response:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/posts"</span>

<span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="nf">parsed_body</span> <span class="c1"># =&gt; &lt;html&gt;</span>
                            <span class="c1">#      &lt;head&gt;&lt;/head&gt;</span>
                            <span class="c1">#        &lt;body&gt;</span>
                            <span class="c1">#          &lt;main&gt;&lt;h1&gt;Some main content&lt;/h1&gt;&lt;/main&gt;</span>
                            <span class="c1">#        &lt;/body&gt;</span>
                            <span class="c1">#     &lt;/html&gt;</span>

<span class="n">assert_pattern</span> <span class="p">{</span> <span class="n">html</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="s2">"main"</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">content: </span><span class="s2">"Some main content"</span> <span class="p">}</span> <span class="p">}</span>
<span class="n">assert_pattern</span> <span class="p">{</span> <span class="n">html</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="s2">"main"</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">content: </span><span class="sr">/content/</span> <span class="p">}</span> <span class="p">}</span>
<span class="n">assert_pattern</span> <span class="p">{</span> <span class="n">html</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="s2">"main"</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">children: </span><span class="p">[{</span> <span class="ss">name: </span><span class="s2">"h1"</span><span class="p">,</span> <span class="ss">content: </span><span class="sr">/content/</span> <span class="p">}]</span> <span class="p">}</span> <span class="p">}</span>
</code></pre></div></div>

<h3 id="introduce-actionviewtestcaseregister_parser">Introduce <code class="language-plaintext highlighter-rouge">ActionView::TestCase.register_parser</code></h3>

<p><a href="https://github.com/rails/rails/pull/49194">Extend <code class="language-plaintext highlighter-rouge">ActionView::TestCase</code></a> to support parsing content rendered by
view partials into known structures. By default, define <code class="language-plaintext highlighter-rouge">rendered_html</code> to parse
HTML into a <code class="language-plaintext highlighter-rouge">Nokogiri::XML::Node</code> and <code class="language-plaintext highlighter-rouge">rendered_json</code> to parse JSON into an
<code class="language-plaintext highlighter-rouge">ActiveSupport::HashWithIndifferentAccess</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">test</span> <span class="s2">"renders HTML"</span> <span class="k">do</span>
  <span class="n">article</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">title: </span><span class="s2">"Hello, world"</span><span class="p">)</span>

  <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"articles/article"</span><span class="p">,</span> <span class="ss">locals: </span><span class="p">{</span> <span class="ss">article: </span><span class="n">article</span> <span class="p">}</span>

  <span class="n">assert_pattern</span> <span class="p">{</span> <span class="n">rendered_html</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="s2">"main h1"</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">content: </span><span class="s2">"Hello, world"</span> <span class="p">}</span> <span class="p">}</span>
<span class="k">end</span>

<span class="nb">test</span> <span class="s2">"renders JSON"</span> <span class="k">do</span>
  <span class="n">article</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">title: </span><span class="s2">"Hello, world"</span><span class="p">)</span>

  <span class="n">render</span> <span class="ss">formats: :json</span><span class="p">,</span> <span class="ss">partial: </span><span class="s2">"articles/article"</span><span class="p">,</span> <span class="ss">locals: </span><span class="p">{</span> <span class="ss">article: </span><span class="n">article</span> <span class="p">}</span>

  <span class="n">assert_pattern</span> <span class="p">{</span> <span class="n">rendered_json</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">title: </span><span class="s2">"Hello, world"</span> <span class="p">}</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div></div>

<p>To parse the rendered content into RSS, register a call to <code class="language-plaintext highlighter-rouge">RSS::Parser.parse</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">register_parser</span> <span class="ss">:rss</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="n">rendered</span> <span class="p">{</span> <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">rendered</span><span class="p">)</span> <span class="p">}</span>

<span class="nb">test</span> <span class="s2">"renders RSS"</span> <span class="k">do</span>
  <span class="n">article</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">title: </span><span class="s2">"Hello, world"</span><span class="p">)</span>

  <span class="n">render</span> <span class="ss">formats: :rss</span><span class="p">,</span> <span class="ss">partial: </span><span class="n">article</span><span class="p">,</span> <span class="ss">locals: </span><span class="p">{</span> <span class="ss">article: </span><span class="n">article</span> <span class="p">}</span>

  <span class="n">assert_equal</span> <span class="s2">"Hello, world"</span><span class="p">,</span> <span class="n">rendered_rss</span><span class="p">.</span><span class="nf">items</span><span class="p">.</span><span class="nf">last</span><span class="p">.</span><span class="nf">title</span>
<span class="k">end</span>
</code></pre></div></div>

<p>To parse the rendered content into a Capybara::Simple::Node, re-register an
<code class="language-plaintext highlighter-rouge">:html</code> parser with a call to <code class="language-plaintext highlighter-rouge">Capybara.string</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">register_parser</span> <span class="ss">:html</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="n">rendered</span> <span class="p">{</span> <span class="no">Capybara</span><span class="p">.</span><span class="nf">string</span><span class="p">(</span><span class="n">rendered</span><span class="p">)</span> <span class="p">}</span>

<span class="nb">test</span> <span class="s2">"renders HTML"</span> <span class="k">do</span>
  <span class="n">article</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">title: </span><span class="s2">"Hello, world"</span><span class="p">)</span>

  <span class="n">render</span> <span class="ss">partial: </span><span class="n">article</span>

  <span class="n">rendered_html</span><span class="p">.</span><span class="nf">assert_css</span> <span class="s2">"main h1"</span><span class="p">,</span> <span class="ss">text: </span><span class="s2">"Hello, world"</span>
<span class="k">end</span>
</code></pre></div></div>

<h2 id="railties">Railties</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/railties/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals">Removals</h3>

<ul>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">bin/rails secrets:setup</code> command.</p>
  </li>
  <li>
    <p>Remove default <code class="language-plaintext highlighter-rouge">X-Download-Options</code> header since it is used only by Internet Explorer.</p>
  </li>
</ul>

<h3 id="deprecations">Deprecations</h3>

<ul>
  <li>
    <p>Deprecate usage of <code class="language-plaintext highlighter-rouge">Rails.application.secrets</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">secrets:show</code> and <code class="language-plaintext highlighter-rouge">secrets:edit</code> commands in favor of <code class="language-plaintext highlighter-rouge">credentials</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">Rails::Generators::Testing::Behaviour</code> in favor of <code class="language-plaintext highlighter-rouge">Rails::Generators::Testing::Behavior</code>.</p>
  </li>
</ul>

<h3 id="notable-changes">Notable changes</h3>

<ul>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">sandbox_by_default</code> option to start rails console in sandbox mode by default.</p>
  </li>
  <li>
    <p>Add new syntax for support filtering tests by line ranges.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">DATABASE</code> option that enables the specification of the target database when executing the
<code class="language-plaintext highlighter-rouge">rails railties:install:migrations</code> command to copy migrations.</p>
  </li>
  <li>
    <p>Add support for Bun in <code class="language-plaintext highlighter-rouge">rails new --javascript</code> generator.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>rails new my_new_app <span class="nt">--javascript</span><span class="o">=</span>bun
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add ability to show slow tests to the test runner.</p>
  </li>
</ul>

<h2 id="action-cable">Action Cable</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actioncable/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-1">Removals</h3>

<h3 id="deprecations-1">Deprecations</h3>

<h3 id="notable-changes-1">Notable changes</h3>

<ul>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">capture_broadcasts</code> test helper to capture all messages broadcasted in a block.</p>
  </li>
  <li>
    <p>Add the ability to Redis pub/sub adapter to automatically reconnect when Redis connection is lost.</p>
  </li>
  <li>
    <p>Add command callbacks <code class="language-plaintext highlighter-rouge">before_command</code>, <code class="language-plaintext highlighter-rouge">after_command</code>, and <code class="language-plaintext highlighter-rouge">around_command</code> to <code class="language-plaintext highlighter-rouge">ActionCable::Connection::Base</code>.</p>
  </li>
</ul>

<h2 id="action-pack">Action Pack</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actionpack/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-2">Removals</h3>

<ul>
  <li>
    <p>Remove deprecated behavior on <code class="language-plaintext highlighter-rouge">Request#content_type</code></p>
  </li>
  <li>
    <p>Remove deprecated ability to assign a single value to <code class="language-plaintext highlighter-rouge">config.action_dispatch.trusted_proxies</code>.</p>
  </li>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">poltergeist</code> and <code class="language-plaintext highlighter-rouge">webkit</code> (capybara-webkit) driver registration for system testing.</p>
  </li>
</ul>

<h3 id="deprecations-2">Deprecations</h3>

<ul>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">config.action_dispatch.return_only_request_media_type_on_content_type</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">AbstractController::Helpers::MissingHelperError</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">ActionDispatch::IllegalStateError</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">speaker</code>, <code class="language-plaintext highlighter-rouge">vibrate</code>, and <code class="language-plaintext highlighter-rouge">vr</code> permissions policy directives.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">true</code> and <code class="language-plaintext highlighter-rouge">false</code> values for <code class="language-plaintext highlighter-rouge">config.action_dispatch.show_exceptions</code> in favor of <code class="language-plaintext highlighter-rouge">:all</code>, <code class="language-plaintext highlighter-rouge">:rescuable</code>, or <code class="language-plaintext highlighter-rouge">:none</code>.</p>
  </li>
</ul>

<h3 id="notable-changes-2">Notable changes</h3>

<ul>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">exclude?</code> method to <code class="language-plaintext highlighter-rouge">ActionController::Parameters</code>. It is the inverse of <code class="language-plaintext highlighter-rouge">include?</code> method.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">ActionController::Parameters#extract_value</code> method to allow extracting serialized values from params.</p>
  </li>
  <li>
    <p>Add the ability to use custom logic for storing and retrieving CSRF tokens.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">html</code> and <code class="language-plaintext highlighter-rouge">screenshot</code> kwargs for system test screenshot helper.</p>
  </li>
</ul>

<h2 id="action-view">Action View</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actionview/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-3">Removals</h3>

<ul>
  <li>
    <p>Remove deprecated constant <code class="language-plaintext highlighter-rouge">ActionView::Path</code>.</p>
  </li>
  <li>
    <p>Remove deprecated support to passing instance variables as locals to partials.</p>
  </li>
</ul>

<h3 id="deprecations-3">Deprecations</h3>

<h3 id="notable-changes-3">Notable changes</h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">checkbox_tag</code> and <code class="language-plaintext highlighter-rouge">radio_button_tag</code> now accept <code class="language-plaintext highlighter-rouge">checked</code> as a keyword argument.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">picture_tag</code> helper to generate HTML <code class="language-plaintext highlighter-rouge">&lt;picture&gt;</code> tags.</p>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">simple_format</code> helper now handles a <code class="language-plaintext highlighter-rouge">:sanitize_options</code> feature, allowing the addition of extra
options for the sanitize process.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">simple_format</span><span class="p">(</span><span class="s2">"&lt;a target=</span><span class="se">\"</span><span class="s2">_blank</span><span class="se">\"</span><span class="s2"> href=</span><span class="se">\"</span><span class="s2">http://example.com</span><span class="se">\"</span><span class="s2">&gt;Continue&lt;/a&gt;"</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{</span> <span class="ss">sanitize_options: </span><span class="p">{</span> <span class="ss">attributes: </span><span class="sx">%w[target href]</span> <span class="p">}</span> <span class="p">})</span>
<span class="c1"># =&gt; "&lt;p&gt;&lt;a target=\"_blank\" href=\"http://example.com\"&gt;Continue&lt;/a&gt;&lt;/p&gt;"</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="action-mailer">Action Mailer</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actionmailer/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-4">Removals</h3>

<h3 id="deprecations-4">Deprecations</h3>

<ul>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">config.action_mailer.preview_path</code>.</p>
  </li>
  <li>
    <p>Deprecate passing params to <code class="language-plaintext highlighter-rouge">assert_enqueued_email_with</code> via the <code class="language-plaintext highlighter-rouge">:args</code> kwarg.
Now supports a <code class="language-plaintext highlighter-rouge">:params</code> kwarg, so use that to pass params.</p>
  </li>
</ul>

<h3 id="notable-changes-4">Notable changes</h3>

<ul>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">config.action_mailer.preview_paths</code> to support multiple preview paths.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">capture_emails</code> in the test helper to capture all emails sent in a block.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">deliver_enqueued_emails</code> to <code class="language-plaintext highlighter-rouge">ActionMailer::TestHelper</code> to deliver all enqueued email jobs.</p>
  </li>
</ul>

<h2 id="active-record">Active Record</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activerecord/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-5">Removals</h3>

<ul>
  <li>
    <p>Remove support for <code class="language-plaintext highlighter-rouge">ActiveRecord.legacy_connection_handling</code>.</p>
  </li>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">ActiveRecord::Base</code> config accessors</p>
  </li>
  <li>
    <p>Remove support for <code class="language-plaintext highlighter-rouge">:include_replicas</code> on <code class="language-plaintext highlighter-rouge">configs_for</code>. Use <code class="language-plaintext highlighter-rouge">:include_hidden</code> instead.</p>
  </li>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">config.active_record.partial_writes</code>.</p>
  </li>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">Tasks::DatabaseTasks.schema_file_type</code>.</p>
  </li>
  <li>
    <p>Remove <code class="language-plaintext highlighter-rouge">--no-comments</code> flag in structure dumps for PostgreSQL.</p>
  </li>
</ul>

<h3 id="deprecations-5">Deprecations</h3>

<ul>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">name</code> argument on <code class="language-plaintext highlighter-rouge">#remove_connection</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">check_pending!</code> in favor of <code class="language-plaintext highlighter-rouge">check_all_pending!</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">deferrable: true</code> option of <code class="language-plaintext highlighter-rouge">add_foreign_key</code> in favor of <code class="language-plaintext highlighter-rouge">deferrable: :immediate</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">TestFixtures#fixture_path</code> in favor of <code class="language-plaintext highlighter-rouge">TestFixtures#fixture_paths</code>.</p>
  </li>
  <li>
    <p>Deprecate delegation from <code class="language-plaintext highlighter-rouge">Base</code> to <code class="language-plaintext highlighter-rouge">connection_handler</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">config.active_record.suppress_multiple_database_warning</code>.</p>
  </li>
  <li>
    <p>Deprecate using <code class="language-plaintext highlighter-rouge">ActiveSupport::Duration</code> as an interpolated bind parameter in an SQL
string template.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">all_connection_pools</code> and make <code class="language-plaintext highlighter-rouge">connection_pool_list</code> more explicit.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">read_attribute(:id)</code> returning the primary key if the primary key is not <code class="language-plaintext highlighter-rouge">:id</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">rewhere</code> argument on <code class="language-plaintext highlighter-rouge">#merge</code>.</p>
  </li>
  <li>
    <p>Deprecate aliasing non-attributes with <code class="language-plaintext highlighter-rouge">alias_attribute</code>.</p>
  </li>
</ul>

<h3 id="notable-changes-5">Notable changes</h3>

<ul>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">TestFixtures#fixture_paths</code> to support multiple fixture paths.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">authenticate_by</code> when using <code class="language-plaintext highlighter-rouge">has_secure_password</code>.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">update_attribute!</code> to <code class="language-plaintext highlighter-rouge">ActiveRecord::Persistence</code>, which is similar to <code class="language-plaintext highlighter-rouge">update_attribute</code>
but raises <code class="language-plaintext highlighter-rouge">ActiveRecord::RecordNotSaved</code> when a <code class="language-plaintext highlighter-rouge">before_*</code> callback throws <code class="language-plaintext highlighter-rouge">:abort</code>.</p>
  </li>
  <li>
    <p>Allow using aliased attributes with <code class="language-plaintext highlighter-rouge">insert_all</code>/<code class="language-plaintext highlighter-rouge">upsert_all</code>.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">:include</code> option to <code class="language-plaintext highlighter-rouge">add_index</code>.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">#regroup</code> query method as a short-hand for <code class="language-plaintext highlighter-rouge">.unscope(:group).group(fields)</code>.</p>
  </li>
  <li>
    <p>Add support for auto-populated columns, and custom primary keys to the <code class="language-plaintext highlighter-rouge">SQLite3</code> adapter.</p>
  </li>
  <li>
    <p>Add modern, performant defaults for <code class="language-plaintext highlighter-rouge">SQLite3</code> database connections.</p>
  </li>
  <li>
    <p>Allow specifying where clauses with column-tuple syntax.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Topic</span><span class="p">.</span><span class="nf">where</span><span class="p">([</span><span class="ss">:title</span><span class="p">,</span> <span class="ss">:author_name</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">[[</span><span class="s2">"The Alchemist"</span><span class="p">,</span> <span class="s2">"Paulo Coelho"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Harry Potter"</span><span class="p">,</span> <span class="s2">"J.K Rowling"</span><span class="p">]])</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Auto generated index names are now limited to 62 bytes, which fits within the default
index name length limits for MySQL, PostgreSQL and SQLite.</p>
  </li>
  <li>
    <p>Introduce adapter for Trilogy database client.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">ActiveRecord.disconnect_all!</code> method to immediately close all connections from all pools.</p>
  </li>
  <li>
    <p>Add PostgreSQL migration commands for enum rename, add value, and rename value.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">ActiveRecord::Base#id_value</code> alias to access the raw value of a record’s id column.</p>
  </li>
  <li>
    <p>Add validation option for <code class="language-plaintext highlighter-rouge">enum</code>.</p>
  </li>
  <li>
    <p>The default hash digest for <code class="language-plaintext highlighter-rouge">ActiveRecord::Encryption</code>, used for attributes defined with <code class="language-plaintext highlighter-rouge">encrypts</code>, is now <code class="language-plaintext highlighter-rouge">SHA256</code>, changed from <code class="language-plaintext highlighter-rouge">SHA1</code> in the default configuration. These defaults also include <code class="language-plaintext highlighter-rouge">support_sha1_for_non_deterministic_encryption = false</code> which can lead to apps being unable to decrypt data encrypted with the old default hash digest if data is not re-encrypted.</p>
  </li>
</ul>

<h2 id="active-storage">Active Storage</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activestorage/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-6">Removals</h3>

<ul>
  <li>
    <p>Remove deprecated invalid default content types in Active Storage configurations.</p>
  </li>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">ActiveStorage::Current#host</code> and <code class="language-plaintext highlighter-rouge">ActiveStorage::Current#host=</code> methods.</p>
  </li>
  <li>
    <p>Remove deprecated behavior when assigning to a collection of attachments. Instead of appending to the collection,
the collection is now replaced.</p>
  </li>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">purge</code> and <code class="language-plaintext highlighter-rouge">purge_later</code> methods from the attachments association.</p>
  </li>
</ul>

<h3 id="deprecations-6">Deprecations</h3>

<h3 id="notable-changes-6">Notable changes</h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ActiveStorage::Analyzer::AudioAnalyzer</code> now outputs <code class="language-plaintext highlighter-rouge">sample_rate</code> and <code class="language-plaintext highlighter-rouge">tags</code> in the output <code class="language-plaintext highlighter-rouge">metadata</code> hash.</p>
  </li>
  <li>
    <p>Add the option to utilize predefined variants when invoking the <code class="language-plaintext highlighter-rouge">preview</code> or <code class="language-plaintext highlighter-rouge">representation</code> methods on an
attachment.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">preprocessed</code> option is added when declaring variants to preprocess variants.</p>
  </li>
  <li>
    <p>Add the ability to destroy Active Storage variants.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">User</span><span class="p">.</span><span class="nf">first</span><span class="p">.</span><span class="nf">avatar</span><span class="p">.</span><span class="nf">variant</span><span class="p">(</span><span class="ss">resize_to_limit: </span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]).</span><span class="nf">destroy</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="active-model">Active Model</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activemodel/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-7">Removals</h3>

<h3 id="deprecations-7">Deprecations</h3>

<h3 id="notable-changes-7">Notable changes</h3>

<ul>
  <li>
    <p>Add support for infinite ranges to <code class="language-plaintext highlighter-rouge">LengthValidator</code>s <code class="language-plaintext highlighter-rouge">:in</code>/<code class="language-plaintext highlighter-rouge">:within</code> options.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">validates_length_of</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">in: </span><span class="o">..</span><span class="mi">30</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add support for beginless ranges to <code class="language-plaintext highlighter-rouge">inclusivity/exclusivity</code> validators.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">validates_inclusion_of</span> <span class="ss">:birth_date</span><span class="p">,</span> <span class="ss">in: </span><span class="o">-&gt;</span> <span class="p">{</span> <span class="p">(</span><span class="o">..</span><span class="no">Date</span><span class="p">.</span><span class="nf">today</span><span class="p">)</span> <span class="p">}</span>
</code></pre></div>    </div>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">validates_exclusion_of</span> <span class="ss">:birth_date</span><span class="p">,</span> <span class="ss">in: </span><span class="o">-&gt;</span> <span class="p">{</span> <span class="p">(</span><span class="o">..</span><span class="no">Date</span><span class="p">.</span><span class="nf">today</span><span class="p">)</span> <span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add support for password challenges to <code class="language-plaintext highlighter-rouge">has_secure_password</code>. When set, validate that the password
challenge matches the persisted <code class="language-plaintext highlighter-rouge">password_digest</code>.</p>
  </li>
  <li>
    <p>Allow validators to accept lambdas without record argument.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Before</span>
<span class="n">validates_comparison_of</span> <span class="ss">:birth_date</span><span class="p">,</span> <span class="ss">less_than_or_equal_to: </span><span class="o">-&gt;</span><span class="p">(</span><span class="n">_record</span><span class="p">)</span> <span class="p">{</span> <span class="no">Date</span><span class="p">.</span><span class="nf">today</span> <span class="p">}</span>

<span class="c1"># After</span>
<span class="n">validates_comparison_of</span> <span class="ss">:birth_date</span><span class="p">,</span> <span class="ss">less_than_or_equal_to: </span><span class="o">-&gt;</span> <span class="p">{</span> <span class="no">Date</span><span class="p">.</span><span class="nf">today</span> <span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="active-support">Active Support</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activesupport/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-8">Removals</h3>

<ul>
  <li>
    <p>Remove deprecated override of <code class="language-plaintext highlighter-rouge">Enumerable#sum</code>.</p>
  </li>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">ActiveSupport::PerThreadRegistry</code>.</p>
  </li>
  <li>
    <p>Remove deprecated option to passing a format to <code class="language-plaintext highlighter-rouge">#to_s</code> in <code class="language-plaintext highlighter-rouge">Array</code>, <code class="language-plaintext highlighter-rouge">Range</code>, <code class="language-plaintext highlighter-rouge">Date</code>, <code class="language-plaintext highlighter-rouge">DateTime</code>, <code class="language-plaintext highlighter-rouge">Time</code>,
<code class="language-plaintext highlighter-rouge">BigDecimal</code>, <code class="language-plaintext highlighter-rouge">Float</code> and, <code class="language-plaintext highlighter-rouge">Integer</code>.</p>
  </li>
  <li>
    <p>Remove deprecated override of <code class="language-plaintext highlighter-rouge">ActiveSupport::TimeWithZone.name</code>.</p>
  </li>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">active_support/core_ext/uri</code> file.</p>
  </li>
  <li>
    <p>Remove deprecated <code class="language-plaintext highlighter-rouge">active_support/core_ext/range/include_time_with_zone</code> file.</p>
  </li>
  <li>
    <p>Remove implicit conversion of objects into <code class="language-plaintext highlighter-rouge">String</code> by <code class="language-plaintext highlighter-rouge">ActiveSupport::SafeBuffer</code>.</p>
  </li>
  <li>
    <p>Remove deprecated support to generate incorrect RFC 4122 UUIDs when providing a namespace ID that is not one of the
constants defined on <code class="language-plaintext highlighter-rouge">Digest::UUID</code>.</p>
  </li>
</ul>

<h3 id="deprecations-8">Deprecations</h3>

<ul>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">config.active_support.disable_to_s_conversion</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">config.active_support.remove_deprecated_time_with_zone_name</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">config.active_support.use_rfc4122_namespaced_uuids</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">SafeBuffer#clone_empty</code>.</p>
  </li>
  <li>
    <p>Deprecate usage of the singleton <code class="language-plaintext highlighter-rouge">ActiveSupport::Deprecation</code>.</p>
  </li>
  <li>
    <p>Deprecate initializing a <code class="language-plaintext highlighter-rouge">ActiveSupport::Cache::MemCacheStore</code> with an instance of <code class="language-plaintext highlighter-rouge">Dalli::Client</code>.</p>
  </li>
  <li>
    <p>Deprecate <code class="language-plaintext highlighter-rouge">Notification::Event</code>’s <code class="language-plaintext highlighter-rouge">#children</code> and <code class="language-plaintext highlighter-rouge">#parent_of?</code> methods.</p>
  </li>
</ul>

<h3 id="notable-changes-8">Notable changes</h3>

<h2 id="active-job">Active Job</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activejob/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-9">Removals</h3>

<ul>
  <li>Remove <code class="language-plaintext highlighter-rouge">QueAdapter</code>.</li>
</ul>

<h3 id="deprecations-9">Deprecations</h3>

<h3 id="notable-changes-9">Notable changes</h3>

<ul>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">perform_all_later</code> to enqueue multiple jobs at once.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">--parent</code> option to job generator to specify parent class of job.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">after_discard</code> method to <code class="language-plaintext highlighter-rouge">ActiveJob::Base</code> to run a callback when a job is about to be discarded.</p>
  </li>
  <li>
    <p>Add support for logging background job enqueue callers via <code class="language-plaintext highlighter-rouge">config.active_job.verbose_enqueue_logs</code>.</p>
  </li>
</ul>

<h2 id="action-text">Action Text</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actiontext/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-10">Removals</h3>

<h3 id="deprecations-10">Deprecations</h3>

<h3 id="notable-changes-10">Notable changes</h3>

<h2 id="action-mailbox">Action Mailbox</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actionmailbox/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="removals-11">Removals</h3>

<h3 id="deprecations-11">Deprecations</h3>

<h3 id="notable-changes-11">Notable changes</h3>

<ul>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">X-Forwarded-To</code> addresses to recipients.</p>
  </li>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">bounce_now_with</code> method to <code class="language-plaintext highlighter-rouge">ActionMailbox::Base</code> to send the bounce email without going through a
mailer queue.</p>
  </li>
</ul>

<h2 id="ruby-on-rails-guides">Ruby on Rails Guides</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/guides/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3 id="notable-changes-12">Notable changes</h3>

<h2 id="credits">Credits</h2>

<p>See the
<a href="https://contributors.rubyonrails.org/">full list of contributors to Rails</a>
for the many people who spent many hours making Rails, the stable and robust
framework it is. Kudos to all of them.</p>

</div>
  </article>
</div>
<footer class="guide-footer">
      <div class="feedback">
        <h3>Geri Bildirim</h3>
        <p>
          Bu kılavuzun kalitesini artırmamıza yardımcı olmak için geri
          bildirimlerinizi bekliyoruz.
        </p>
        <p>
          Lütfen
          <a href="https://github.com/dilankaya127/rails-tr-TR"
            >GitHub Issues</a
          >
          üzerinden katkıda bulunun.
        </p>
      </div>
    </footer>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toc = document.getElementById("toc");
    const headings = document.querySelectorAll(
      ".guide-content h2, .guide-content h3, .guide-content h4"
    );

    if (headings.length > 0) {
      const tocList = document.createElement("ul");
      const headingMap = new Map();

      headings.forEach(function (heading, index) {
        const id = "heading-" + index;
        heading.id = id;

        const li = document.createElement("li");
        const a = document.createElement("a");
        a.href = "#" + id;
        a.textContent = heading.textContent;
        a.className = "toc-" + heading.tagName.toLowerCase();

        li.appendChild(a);
        tocList.appendChild(li);

        headingMap.set(id, a);
      });

      toc.appendChild(tocList);

      // Başlıkların görünürlük oranlarını takip et
      const visibilityMap = new Map();

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const id = entry.target.getAttribute("id");
            visibilityMap.set(id, entry.intersectionRatio);
          });

          // En çok görünür olan başlığı bul
          let mostVisibleId = null;
          let maxRatio = 0;

          visibilityMap.forEach((ratio, id) => {
            if (ratio > maxRatio) {
              mostVisibleId = id;
              maxRatio = ratio;
            }
          });

          if (mostVisibleId) {
            headingMap.forEach((linkEl) => linkEl.classList.remove("active"));
            const activeLink = headingMap.get(mostVisibleId);
            if (activeLink) {
              activeLink.classList.add("active");

              // Ortalamak için:
              const linkTop = activeLink.offsetTop;
              const linkHeight = activeLink.offsetHeight;
              const tocScrollParent = toc;
              const tocHeight = tocScrollParent.offsetHeight;

              tocScrollParent.scrollTo({
                top: linkTop - tocHeight / 2 + linkHeight / 2,
                behavior: "smooth",
              });
            }
          }
        },
        {
          threshold: [0, 0.25, 0.5, 0.75, 1.0],
        }
      );

      headings.forEach((heading) => {
        observer.observe(heading);
      });

      const toggleBtn = document.getElementById("toc-toggle");
      const sidebar = document.querySelector(".guide-sidebar");

      toggleBtn.addEventListener("click", function () {
        sidebar.classList.toggle("open");
      });
      const closeBtn = document.querySelector(".toc-close");

      closeBtn?.addEventListener("click", function () {
        sidebar.classList.remove("open");
      });
    }
  });
</script>
</div>
    </main>

    <footer class="footer">
      <div class="container">
        <p>
          &copy; 2025 Rails Kılavuzları Türkçe Çevirisi.
          <a href="https://github.com/DilanKaya127">Dilan Kaya</a> tarafından
          hazırlanmıştır.
        </p>
        <p>
          Orijinal dokümantasyon
          <a href="https://guides.rubyonrails.org">Ruby on Rails</a> ekibine
          aittir.
        </p>
      </div>
    </footer>

    <script>
      hljs.highlightAll();
    </script>
  </body>
</html>
