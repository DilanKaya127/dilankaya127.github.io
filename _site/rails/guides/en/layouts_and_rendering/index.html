<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Layouts And Rendering - Rails Dokümantasyonu - Türkçe</title>
    <link rel="stylesheet" href="/assets/css/rails.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">

    <link rel="icon" type="image/svg" href="/assets/img/logo_rails-circle.svg">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">
                    <a href="/rails/">
                        <img src="/assets/img/logo_rails-circle.svg" alt="Rails Logo" class="logo-image">
                    </a>
                </h1>
                <nav class="nav">
                    <a href="/">Ana Sayfa</a>
                    <!-- <a href="https://dilankaya127.github.io">Portföy</a> -->
                    <a href="https://github.com/dilankaya127/rails-tr-TR">GitHub</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="guide-container">
  <button id="toc-toggle" class="toc-toggle">☰ İçindekiler</button>

  <aside class="guide-sidebar">
    <div class="guide-toc">
      <!-- <h3>İçindekiler</h3> -->
      <div id="toc"></div>
      <button class="toc-close" aria-label="İçindekileri Kapat">✕</button>
    </div>

    <!-- <div class="guide-nav">
            <h3>Diğer(Tüm) Kılavuzlar</h3>
            <ul>
                <li><a href="/rails/guides/tr/getting_started">Rails ile Başlarken</a></li>
                <li><a href="/rails/guides/en/active_record_basics">Active Record Temelleri</a></li>
                <li><a href="/rails/guides//en/action_controller_overview">Action Controller</a></li>
                <li><a href="/rails/guides/tr/action_cable_overview">Action Cable</a></li>
            </ul>
        </div> -->
  </aside>

  <article class="guide-content">
    <!-- <header class="guide-header">
            <h1>Layouts And Rendering</h1>
            
        </header> -->

    <div class="guide-body"><p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1 id="layouts-and-rendering-in-rails">Layouts and Rendering in Rails</h1>

<p>This guide covers the basic layout features of Action Controller and Action View.</p>

<p>After reading this guide, you will know:</p>

<ul>
  <li>How to use the various rendering methods built into Rails.</li>
  <li>How to create layouts with multiple content sections.</li>
  <li>How to use partials to DRY up your views.</li>
  <li>How to use nested layouts (sub-templates).</li>
</ul>

<hr />

<h2 id="overview-how-the-pieces-fit-together">Overview: How the Pieces Fit Together</h2>

<p>This guide focuses on the interaction between Controller and View in the Model-View-Controller triangle. As you know, the Controller is responsible for orchestrating the whole process of handling a request in Rails, though it normally hands off any heavy code to the Model. But then, when it’s time to send a response back to the user, the Controller hands things off to the View. It’s that handoff that is the subject of this guide.</p>

<p>In broad strokes, this involves deciding what should be sent as the response and calling an appropriate method to create that response. If the response is a full-blown view, Rails also does some extra work to wrap the view in a layout and possibly to pull in partial views. You’ll see all of those paths later in this guide.</p>

<h2 id="creating-responses">Creating Responses</h2>

<p>From the controller’s point of view, there are three ways to create an HTTP response:</p>

<ul>
  <li>Call <a href="https://api.rubyonrails.org/classes/ActionController/Rendering.html#method-i-render"><code class="language-plaintext highlighter-rouge">render</code></a> to create a full response to send back to the browser</li>
  <li>Call <a href="https://api.rubyonrails.org/classes/ActionController/Redirecting.html#method-i-redirect_to"><code class="language-plaintext highlighter-rouge">redirect_to</code></a> to send an HTTP redirect status code to the browser</li>
  <li>Call <a href="https://api.rubyonrails.org/classes/ActionController/Head.html#method-i-head"><code class="language-plaintext highlighter-rouge">head</code></a> to create a response consisting solely of HTTP headers to send back to the browser</li>
</ul>

<h3 id="rendering-by-default-convention-over-configuration-in-action">Rendering by Default: Convention Over Configuration in Action</h3>

<p>You’ve heard that Rails promotes “convention over configuration”. Default rendering is an excellent example of this. By default, controllers in Rails automatically render views with names that correspond to valid routes. For example, if you have this code in your <code class="language-plaintext highlighter-rouge">BooksController</code> class:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">BooksController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
<span class="k">end</span>
</code></pre></div></div>

<p>And the following in your routes file:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:books</span>
</code></pre></div></div>

<p>And you have a view file <code class="language-plaintext highlighter-rouge">app/views/books/index.html.erb</code>:</p>

<pre><code class="language-html+erb">&lt;h1&gt;Books are coming soon!&lt;/h1&gt;
</code></pre>

<p>Rails will automatically render <code class="language-plaintext highlighter-rouge">app/views/books/index.html.erb</code> when you navigate to <code class="language-plaintext highlighter-rouge">/books</code> and you will see “Books are coming soon!” on your screen.</p>

<p>However, a coming soon screen is only minimally useful, so you will soon create your <code class="language-plaintext highlighter-rouge">Book</code> model and add the index action to <code class="language-plaintext highlighter-rouge">BooksController</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">BooksController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">index</span>
    <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Note that we don’t have explicit render at the end of the index action in accordance with “convention over configuration” principle. The rule is that if you do not explicitly render something at the end of a controller action, Rails will automatically look for the <code class="language-plaintext highlighter-rouge">action_name.html.erb</code> template in the controller’s view path and render it. So in this case, Rails will render the <code class="language-plaintext highlighter-rouge">app/views/books/index.html.erb</code> file.</p>

<p>If we want to display the properties of all the books in our view, we can do so with an ERB template like this:</p>

<pre><code class="language-html+erb">&lt;h1&gt;Listing Books&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Title&lt;/th&gt;
      &lt;th&gt;Content&lt;/th&gt;
      &lt;th colspan="3"&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;

  &lt;tbody&gt;
    &lt;% @books.each do |book| %&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;%= book.title %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= book.content %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= link_to "Show", book %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= link_to "Edit", edit_book_path(book) %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= link_to "Destroy", book, data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %&gt;&lt;/td&gt;
      &lt;/tr&gt;
    &lt;% end %&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;br&gt;

&lt;%= link_to "New book", new_book_path %&gt;
</code></pre>

<p>NOTE: The actual rendering is done by nested classes of the module <a href="https://api.rubyonrails.org/classes/ActionView/Template/Handlers.html"><code class="language-plaintext highlighter-rouge">ActionView::Template::Handlers</code></a>. This guide does not dig into that process, but it’s important to know that the file extension on your view controls the choice of template handler.</p>

<h3 id="using-render">Using <code class="language-plaintext highlighter-rouge">render</code></h3>

<p>In most cases, the controller’s <a href="https://api.rubyonrails.org/classes/ActionController/Rendering.html#method-i-render"><code class="language-plaintext highlighter-rouge">render</code></a> method does the heavy lifting of rendering your application’s content for use by a browser. There are a variety of ways to customize the behavior of <code class="language-plaintext highlighter-rouge">render</code>. You can render the default view for a Rails template, or a specific template, or a file, or inline code, or nothing at all. You can render text, JSON, or XML. You can specify the content type or HTTP status of the rendered response as well.</p>

<p>TIP: If you want to see the exact results of a call to <code class="language-plaintext highlighter-rouge">render</code> without needing to inspect it in a browser, you can call <code class="language-plaintext highlighter-rouge">render_to_string</code>. This method takes exactly the same options as <code class="language-plaintext highlighter-rouge">render</code>, but it returns a string instead of sending a response back to the browser.</p>

<h4 id="rendering-an-actions-view">Rendering an Action’s View</h4>

<p>If you want to render the view that corresponds to a different template within the same controller, you can use <code class="language-plaintext highlighter-rouge">render</code> with the name of the view:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">update</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">book_params</span><span class="p">)</span>
    <span class="n">redirect_to</span><span class="p">(</span><span class="vi">@book</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="n">render</span> <span class="s2">"edit"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>If the call to <code class="language-plaintext highlighter-rouge">update</code> fails, calling the <code class="language-plaintext highlighter-rouge">update</code> action in this controller will render the <code class="language-plaintext highlighter-rouge">edit.html.erb</code> template belonging to the same controller.</p>

<p>If you prefer, you can use a symbol instead of a string to specify the action to render:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">update</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">book_params</span><span class="p">)</span>
    <span class="n">redirect_to</span><span class="p">(</span><span class="vi">@book</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="n">render</span> <span class="ss">:edit</span><span class="p">,</span> <span class="ss">status: :unprocessable_entity</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="rendering-an-actions-template-from-another-controller">Rendering an Action’s Template from Another Controller</h4>

<p>What if you want to render a template from an entirely different controller from the one that contains the action code? You can also do that with <code class="language-plaintext highlighter-rouge">render</code>, which accepts the full path (relative to <code class="language-plaintext highlighter-rouge">app/views</code>) of the template to render. For example, if you’re running code in an <code class="language-plaintext highlighter-rouge">AdminProductsController</code> that lives in <code class="language-plaintext highlighter-rouge">app/controllers/admin</code>, you can render the results of an action to a template in <code class="language-plaintext highlighter-rouge">app/views/products</code> this way:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="s2">"products/show"</span>
</code></pre></div></div>

<p>Rails knows that this view belongs to a different controller because of the embedded slash character in the string. If you want to be explicit, you can use the <code class="language-plaintext highlighter-rouge">:template</code> option (which was required on Rails 2.2 and earlier):</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">template: </span><span class="s2">"products/show"</span>
</code></pre></div></div>

<h4 id="wrapping-it-up">Wrapping it up</h4>

<p>The above two ways of rendering (rendering the template of another action in the same controller, and rendering the template of another action in a different controller) are actually variants of the same operation.</p>

<p>In fact, in the <code class="language-plaintext highlighter-rouge">BooksController</code> class, inside of the update action where we want to render the edit template if the book does not update successfully, all of the following render calls would all render the <code class="language-plaintext highlighter-rouge">edit.html.erb</code> template in the <code class="language-plaintext highlighter-rouge">views/books</code> directory:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">:edit</span>
<span class="n">render</span> <span class="ss">action: :edit</span>
<span class="n">render</span> <span class="s2">"edit"</span>
<span class="n">render</span> <span class="ss">action: </span><span class="s2">"edit"</span>
<span class="n">render</span> <span class="s2">"books/edit"</span>
<span class="n">render</span> <span class="ss">template: </span><span class="s2">"books/edit"</span>
</code></pre></div></div>

<p>Which one you use is really a matter of style and convention, but the rule of thumb is to use the simplest one that makes sense for the code you are writing.</p>

<h4 id="using-render-with-inline">Using <code class="language-plaintext highlighter-rouge">render</code> with <code class="language-plaintext highlighter-rouge">:inline</code></h4>

<p>The <code class="language-plaintext highlighter-rouge">render</code> method can do without a view completely, if you’re willing to use the <code class="language-plaintext highlighter-rouge">:inline</code> option to supply ERB as part of the method call. This is perfectly valid:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">inline: </span><span class="s2">"&lt;% products.each do |p| %&gt;&lt;p&gt;&lt;%= p.name %&gt;&lt;/p&gt;&lt;% end %&gt;"</span>
</code></pre></div></div>

<p>WARNING: There is seldom any good reason to use this option. Mixing ERB into your controllers defeats the MVC orientation of Rails and will make it harder for other developers to follow the logic of your project. Use a separate erb view instead.</p>

<p>By default, inline rendering uses ERB. You can force it to use Builder instead with the <code class="language-plaintext highlighter-rouge">:type</code> option:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">inline: </span><span class="s2">"xml.p {'Horrid coding practice!'}"</span><span class="p">,</span> <span class="ss">type: :builder</span>
</code></pre></div></div>

<h4 id="rendering-text">Rendering Text</h4>

<p>You can send plain text - with no markup at all - back to the browser by using
the <code class="language-plaintext highlighter-rouge">:plain</code> option to <code class="language-plaintext highlighter-rouge">render</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">plain: </span><span class="s2">"OK"</span>
</code></pre></div></div>

<p>TIP: Rendering pure text is most useful when you’re responding to Ajax or web
service requests that are expecting something other than proper HTML.</p>

<p>NOTE: By default, if you use the <code class="language-plaintext highlighter-rouge">:plain</code> option, the text is rendered without
using the current layout. If you want Rails to put the text into the current
layout, you need to add the <code class="language-plaintext highlighter-rouge">layout: true</code> option and use the <code class="language-plaintext highlighter-rouge">.text.erb</code>
extension for the layout file.</p>

<h4 id="rendering-html">Rendering HTML</h4>

<p>You can send an HTML string back to the browser by using the <code class="language-plaintext highlighter-rouge">:html</code> option to
<code class="language-plaintext highlighter-rouge">render</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">html: </span><span class="n">helpers</span><span class="p">.</span><span class="nf">tag</span><span class="p">.</span><span class="nf">strong</span><span class="p">(</span><span class="s2">"Not Found"</span><span class="p">)</span>
</code></pre></div></div>

<p>TIP: This is useful when you’re rendering a small snippet of HTML code.
However, you might want to consider moving it to a template file if the markup
is complex.</p>

<p>NOTE: When using <code class="language-plaintext highlighter-rouge">html:</code> option, HTML entities will be escaped if the string is not composed with <code class="language-plaintext highlighter-rouge">html_safe</code>-aware APIs.</p>

<h4 id="rendering-json">Rendering JSON</h4>

<p>JSON is a JavaScript data format used by many Ajax libraries. Rails has built-in support for converting objects to JSON and rendering that JSON back to the browser:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">json: </span><span class="vi">@product</span>
</code></pre></div></div>

<p>TIP: You don’t need to call <code class="language-plaintext highlighter-rouge">to_json</code> on the object that you want to render. If you use the <code class="language-plaintext highlighter-rouge">:json</code> option, <code class="language-plaintext highlighter-rouge">render</code> will automatically call <code class="language-plaintext highlighter-rouge">to_json</code> for you.</p>

<h4 id="rendering-xml">Rendering XML</h4>

<p>Rails also has built-in support for converting objects to XML and rendering that XML back to the caller:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">xml: </span><span class="vi">@product</span>
</code></pre></div></div>

<p>TIP: You don’t need to call <code class="language-plaintext highlighter-rouge">to_xml</code> on the object that you want to render. If you use the <code class="language-plaintext highlighter-rouge">:xml</code> option, <code class="language-plaintext highlighter-rouge">render</code> will automatically call <code class="language-plaintext highlighter-rouge">to_xml</code> for you.</p>

<h4 id="rendering-vanilla-javascript">Rendering Vanilla JavaScript</h4>

<p>Rails can render vanilla JavaScript:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">js: </span><span class="s2">"alert('Hello Rails');"</span>
</code></pre></div></div>

<p>This will send the supplied string to the browser with a MIME type of <code class="language-plaintext highlighter-rouge">text/javascript</code>.</p>

<h4 id="rendering-raw-body">Rendering Raw Body</h4>

<p>You can send a raw content back to the browser, without setting any content
type, by using the <code class="language-plaintext highlighter-rouge">:body</code> option to <code class="language-plaintext highlighter-rouge">render</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">body: </span><span class="s2">"raw"</span>
</code></pre></div></div>

<p>TIP: This option should be used only if you don’t care about the content type of
the response. Using <code class="language-plaintext highlighter-rouge">:plain</code> or <code class="language-plaintext highlighter-rouge">:html</code> might be more appropriate most of the
time.</p>

<p>NOTE: Unless overridden, your response returned from this render option will be
<code class="language-plaintext highlighter-rouge">text/plain</code>, as that is the default content type of Action Dispatch response.</p>

<h4 id="rendering-raw-file">Rendering Raw File</h4>

<p>Rails can render a raw file from an absolute path. This is useful for
conditionally rendering static files like error pages.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">file: </span><span class="s2">"</span><span class="si">#{</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="si">}</span><span class="s2">/public/404.html"</span><span class="p">,</span> <span class="ss">layout: </span><span class="kp">false</span>
</code></pre></div></div>

<p>This renders the raw file (it doesn’t support ERB or other handlers). By
default it is rendered within the current layout.</p>

<p>WARNING: Using the <code class="language-plaintext highlighter-rouge">:file</code> option in combination with users input can lead to security problems
since an attacker could use this action to access security sensitive files in your file system.</p>

<p>TIP: <code class="language-plaintext highlighter-rouge">send_file</code> is often a faster and better option if a layout isn’t required.</p>

<h4 id="rendering-objects">Rendering Objects</h4>

<p>Rails can render objects responding to <code class="language-plaintext highlighter-rouge">#render_in</code>. The format can be controlled by defining <code class="language-plaintext highlighter-rouge">#format</code> on the object.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Greeting</span>
  <span class="k">def</span> <span class="nf">render_in</span><span class="p">(</span><span class="n">view_context</span><span class="p">)</span>
    <span class="n">view_context</span><span class="p">.</span><span class="nf">render</span> <span class="ss">html: </span><span class="s2">"Hello, World"</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">format</span>
    <span class="ss">:html</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">render</span> <span class="no">Greeting</span><span class="p">.</span><span class="nf">new</span>
<span class="c1"># =&gt; "Hello World"</span>
</code></pre></div></div>

<p>This calls <code class="language-plaintext highlighter-rouge">render_in</code> on the provided object with the current view context. You can also provide the object by using the <code class="language-plaintext highlighter-rouge">:renderable</code> option to <code class="language-plaintext highlighter-rouge">render</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">renderable: </span><span class="no">Greeting</span><span class="p">.</span><span class="nf">new</span>
<span class="c1"># =&gt; "Hello World"</span>
</code></pre></div></div>

<h4 id="options-for-render">Options for <code class="language-plaintext highlighter-rouge">render</code></h4>

<p>Calls to the <a href="https://api.rubyonrails.org/classes/ActionController/Rendering.html#method-i-render"><code class="language-plaintext highlighter-rouge">render</code></a> method generally accept six options:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">:content_type</code></li>
  <li><code class="language-plaintext highlighter-rouge">:layout</code></li>
  <li><code class="language-plaintext highlighter-rouge">:location</code></li>
  <li><code class="language-plaintext highlighter-rouge">:status</code></li>
  <li><code class="language-plaintext highlighter-rouge">:formats</code></li>
  <li><code class="language-plaintext highlighter-rouge">:variants</code></li>
</ul>

<h5 id="the-content_type-option">The <code class="language-plaintext highlighter-rouge">:content_type</code> Option</h5>

<p>By default, Rails will serve the results of a rendering operation with the MIME content-type of <code class="language-plaintext highlighter-rouge">text/html</code> (or <code class="language-plaintext highlighter-rouge">application/json</code> if you use the <code class="language-plaintext highlighter-rouge">:json</code> option, or <code class="language-plaintext highlighter-rouge">application/xml</code> for the <code class="language-plaintext highlighter-rouge">:xml</code> option.). There are times when you might like to change this, and you can do so by setting the <code class="language-plaintext highlighter-rouge">:content_type</code> option:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">template: </span><span class="s2">"feed"</span><span class="p">,</span> <span class="ss">content_type: </span><span class="s2">"application/rss"</span>
</code></pre></div></div>

<h5 id="the-layout-option">The <code class="language-plaintext highlighter-rouge">:layout</code> Option</h5>

<p>With most of the options to <code class="language-plaintext highlighter-rouge">render</code>, the rendered content is displayed as part of the current layout. You’ll learn more about layouts and how to use them later in this guide.</p>

<p>You can use the <code class="language-plaintext highlighter-rouge">:layout</code> option to tell Rails to use a specific file as the layout for the current action:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">layout: </span><span class="s2">"special_layout"</span>
</code></pre></div></div>

<p>You can also tell Rails to render with no layout at all:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">layout: </span><span class="kp">false</span>
</code></pre></div></div>

<h5 id="the-location-option">The <code class="language-plaintext highlighter-rouge">:location</code> Option</h5>

<p>You can use the <code class="language-plaintext highlighter-rouge">:location</code> option to set the HTTP <code class="language-plaintext highlighter-rouge">Location</code> header:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">xml: </span><span class="n">photo</span><span class="p">,</span> <span class="ss">location: </span><span class="n">photo_url</span><span class="p">(</span><span class="n">photo</span><span class="p">)</span>
</code></pre></div></div>

<h5 id="the-status-option">The <code class="language-plaintext highlighter-rouge">:status</code> Option</h5>

<p>Rails will automatically generate a response with the correct HTTP status code (in most cases, this is <code class="language-plaintext highlighter-rouge">200 OK</code>). You can use the <code class="language-plaintext highlighter-rouge">:status</code> option to change this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">status: </span><span class="mi">500</span>
<span class="n">render</span> <span class="ss">status: :forbidden</span>
</code></pre></div></div>

<p>Rails understands both numeric status codes and the corresponding symbols shown below.</p>

<table>
  <thead>
    <tr>
      <th>Response Class</th>
      <th>HTTP Status Code</th>
      <th>Symbol</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Informational</strong></td>
      <td>100</td>
      <td>:continue</td>
    </tr>
    <tr>
      <td> </td>
      <td>101</td>
      <td>:switching_protocols</td>
    </tr>
    <tr>
      <td> </td>
      <td>102</td>
      <td>:processing</td>
    </tr>
    <tr>
      <td><strong>Success</strong></td>
      <td>200</td>
      <td>:ok</td>
    </tr>
    <tr>
      <td> </td>
      <td>201</td>
      <td>:created</td>
    </tr>
    <tr>
      <td> </td>
      <td>202</td>
      <td>:accepted</td>
    </tr>
    <tr>
      <td> </td>
      <td>203</td>
      <td>:non_authoritative_information</td>
    </tr>
    <tr>
      <td> </td>
      <td>204</td>
      <td>:no_content</td>
    </tr>
    <tr>
      <td> </td>
      <td>205</td>
      <td>:reset_content</td>
    </tr>
    <tr>
      <td> </td>
      <td>206</td>
      <td>:partial_content</td>
    </tr>
    <tr>
      <td> </td>
      <td>207</td>
      <td>:multi_status</td>
    </tr>
    <tr>
      <td> </td>
      <td>208</td>
      <td>:already_reported</td>
    </tr>
    <tr>
      <td> </td>
      <td>226</td>
      <td>:im_used</td>
    </tr>
    <tr>
      <td><strong>Redirection</strong></td>
      <td>300</td>
      <td>:multiple_choices</td>
    </tr>
    <tr>
      <td> </td>
      <td>301</td>
      <td>:moved_permanently</td>
    </tr>
    <tr>
      <td> </td>
      <td>302</td>
      <td>:found</td>
    </tr>
    <tr>
      <td> </td>
      <td>303</td>
      <td>:see_other</td>
    </tr>
    <tr>
      <td> </td>
      <td>304</td>
      <td>:not_modified</td>
    </tr>
    <tr>
      <td> </td>
      <td>305</td>
      <td>:use_proxy</td>
    </tr>
    <tr>
      <td> </td>
      <td>307</td>
      <td>:temporary_redirect</td>
    </tr>
    <tr>
      <td> </td>
      <td>308</td>
      <td>:permanent_redirect</td>
    </tr>
    <tr>
      <td><strong>Client Error</strong></td>
      <td>400</td>
      <td>:bad_request</td>
    </tr>
    <tr>
      <td> </td>
      <td>401</td>
      <td>:unauthorized</td>
    </tr>
    <tr>
      <td> </td>
      <td>402</td>
      <td>:payment_required</td>
    </tr>
    <tr>
      <td> </td>
      <td>403</td>
      <td>:forbidden</td>
    </tr>
    <tr>
      <td> </td>
      <td>404</td>
      <td>:not_found</td>
    </tr>
    <tr>
      <td> </td>
      <td>405</td>
      <td>:method_not_allowed</td>
    </tr>
    <tr>
      <td> </td>
      <td>406</td>
      <td>:not_acceptable</td>
    </tr>
    <tr>
      <td> </td>
      <td>407</td>
      <td>:proxy_authentication_required</td>
    </tr>
    <tr>
      <td> </td>
      <td>408</td>
      <td>:request_timeout</td>
    </tr>
    <tr>
      <td> </td>
      <td>409</td>
      <td>:conflict</td>
    </tr>
    <tr>
      <td> </td>
      <td>410</td>
      <td>:gone</td>
    </tr>
    <tr>
      <td> </td>
      <td>411</td>
      <td>:length_required</td>
    </tr>
    <tr>
      <td> </td>
      <td>412</td>
      <td>:precondition_failed</td>
    </tr>
    <tr>
      <td> </td>
      <td>413</td>
      <td>:payload_too_large</td>
    </tr>
    <tr>
      <td> </td>
      <td>414</td>
      <td>:uri_too_long</td>
    </tr>
    <tr>
      <td> </td>
      <td>415</td>
      <td>:unsupported_media_type</td>
    </tr>
    <tr>
      <td> </td>
      <td>416</td>
      <td>:range_not_satisfiable</td>
    </tr>
    <tr>
      <td> </td>
      <td>417</td>
      <td>:expectation_failed</td>
    </tr>
    <tr>
      <td> </td>
      <td>421</td>
      <td>:misdirected_request</td>
    </tr>
    <tr>
      <td> </td>
      <td>422</td>
      <td>:unprocessable_entity</td>
    </tr>
    <tr>
      <td> </td>
      <td>423</td>
      <td>:locked</td>
    </tr>
    <tr>
      <td> </td>
      <td>424</td>
      <td>:failed_dependency</td>
    </tr>
    <tr>
      <td> </td>
      <td>426</td>
      <td>:upgrade_required</td>
    </tr>
    <tr>
      <td> </td>
      <td>428</td>
      <td>:precondition_required</td>
    </tr>
    <tr>
      <td> </td>
      <td>429</td>
      <td>:too_many_requests</td>
    </tr>
    <tr>
      <td> </td>
      <td>431</td>
      <td>:request_header_fields_too_large</td>
    </tr>
    <tr>
      <td> </td>
      <td>451</td>
      <td>:unavailable_for_legal_reasons</td>
    </tr>
    <tr>
      <td><strong>Server Error</strong></td>
      <td>500</td>
      <td>:internal_server_error</td>
    </tr>
    <tr>
      <td> </td>
      <td>501</td>
      <td>:not_implemented</td>
    </tr>
    <tr>
      <td> </td>
      <td>502</td>
      <td>:bad_gateway</td>
    </tr>
    <tr>
      <td> </td>
      <td>503</td>
      <td>:service_unavailable</td>
    </tr>
    <tr>
      <td> </td>
      <td>504</td>
      <td>:gateway_timeout</td>
    </tr>
    <tr>
      <td> </td>
      <td>505</td>
      <td>:http_version_not_supported</td>
    </tr>
    <tr>
      <td> </td>
      <td>506</td>
      <td>:variant_also_negotiates</td>
    </tr>
    <tr>
      <td> </td>
      <td>507</td>
      <td>:insufficient_storage</td>
    </tr>
    <tr>
      <td> </td>
      <td>508</td>
      <td>:loop_detected</td>
    </tr>
    <tr>
      <td> </td>
      <td>510</td>
      <td>:not_extended</td>
    </tr>
    <tr>
      <td> </td>
      <td>511</td>
      <td>:network_authentication_required</td>
    </tr>
  </tbody>
</table>

<p>NOTE:  If you try to render content along with a non-content status code
(100-199, 204, 205, or 304), it will be dropped from the response.</p>

<h5 id="the-formats-option">The <code class="language-plaintext highlighter-rouge">:formats</code> Option</h5>

<p>Rails uses the format specified in the request (or <code class="language-plaintext highlighter-rouge">:html</code> by default). You can
change this passing the <code class="language-plaintext highlighter-rouge">:formats</code> option with a symbol or an array:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">render</span> <span class="ss">formats: :xml</span>
<span class="n">render</span> <span class="ss">formats: </span><span class="p">[</span><span class="ss">:json</span><span class="p">,</span> <span class="ss">:xml</span><span class="p">]</span>
</code></pre></div></div>

<p>If a template with the specified format does not exist an <code class="language-plaintext highlighter-rouge">ActionView::MissingTemplate</code> error is raised.</p>

<h5 id="the-variants-option">The <code class="language-plaintext highlighter-rouge">:variants</code> Option</h5>

<p>This tells Rails to look for template variations of the same format.
You can specify a list of variants by passing the <code class="language-plaintext highlighter-rouge">:variants</code> option with a symbol or an array.</p>

<p>An example of use would be this.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># called in HomeController#index</span>
<span class="n">render</span> <span class="ss">variants: </span><span class="p">[</span><span class="ss">:mobile</span><span class="p">,</span> <span class="ss">:desktop</span><span class="p">]</span>
</code></pre></div></div>

<p>With this set of variants Rails will look for the following set of templates and use the first that exists.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">app/views/home/index.html+mobile.erb</code></li>
  <li><code class="language-plaintext highlighter-rouge">app/views/home/index.html+desktop.erb</code></li>
  <li><code class="language-plaintext highlighter-rouge">app/views/home/index.html.erb</code></li>
</ul>

<p>If a template with the specified format does not exist an <code class="language-plaintext highlighter-rouge">ActionView::MissingTemplate</code> error is raised.</p>

<p>Instead of setting the variant on the render call you may also set it on the request object in your controller action.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">index</span>
  <span class="n">request</span><span class="p">.</span><span class="nf">variant</span> <span class="o">=</span> <span class="n">determine_variant</span>
<span class="k">end</span>

<span class="kp">private</span>
  <span class="k">def</span> <span class="nf">determine_variant</span>
    <span class="n">variant</span> <span class="o">=</span> <span class="kp">nil</span>
    <span class="c1"># some code to determine the variant(s) to use</span>
    <span class="n">variant</span> <span class="o">=</span> <span class="ss">:mobile</span> <span class="k">if</span> <span class="n">session</span><span class="p">[</span><span class="ss">:use_mobile</span><span class="p">]</span>

    <span class="n">variant</span>
  <span class="k">end</span>
</code></pre></div></div>

<h4 id="finding-layouts">Finding Layouts</h4>

<p>To find the current layout, Rails first looks for a file in <code class="language-plaintext highlighter-rouge">app/views/layouts</code> with the same base name as the controller. For example, rendering actions from the <code class="language-plaintext highlighter-rouge">PhotosController</code> class will use <code class="language-plaintext highlighter-rouge">app/views/layouts/photos.html.erb</code> (or <code class="language-plaintext highlighter-rouge">app/views/layouts/photos.builder</code>). If there is no such controller-specific layout, Rails will use <code class="language-plaintext highlighter-rouge">app/views/layouts/application.html.erb</code> or <code class="language-plaintext highlighter-rouge">app/views/layouts/application.builder</code>. If there is no <code class="language-plaintext highlighter-rouge">.erb</code> layout, Rails will use a <code class="language-plaintext highlighter-rouge">.builder</code> layout if one exists. Rails also provides several ways to more precisely assign specific layouts to individual controllers and actions.</p>

<h5 id="specifying-layouts-for-controllers">Specifying Layouts for Controllers</h5>

<p>You can override the default layout conventions in your controllers by using the <a href="https://api.rubyonrails.org/classes/ActionView/Layouts/ClassMethods.html#method-i-layout"><code class="language-plaintext highlighter-rouge">layout</code></a> declaration. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">layout</span> <span class="s2">"inventory"</span>
  <span class="c1">#...</span>
<span class="k">end</span>
</code></pre></div></div>

<p>With this declaration, all of the views rendered by the <code class="language-plaintext highlighter-rouge">ProductsController</code> will use <code class="language-plaintext highlighter-rouge">app/views/layouts/inventory.html.erb</code> as their layout.</p>

<p>To assign a specific layout for the entire application, use a <code class="language-plaintext highlighter-rouge">layout</code> declaration in your <code class="language-plaintext highlighter-rouge">ApplicationController</code> class:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">layout</span> <span class="s2">"main"</span>
  <span class="c1">#...</span>
<span class="k">end</span>
</code></pre></div></div>

<p>With this declaration, all of the views in the entire application will use <code class="language-plaintext highlighter-rouge">app/views/layouts/main.html.erb</code> for their layout.</p>

<h5 id="choosing-layouts-at-runtime">Choosing Layouts at Runtime</h5>

<p>You can use a symbol to defer the choice of layout until a request is processed:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">layout</span> <span class="ss">:products_layout</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@product</span> <span class="o">=</span> <span class="no">Product</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">end</span>

  <span class="kp">private</span>
    <span class="k">def</span> <span class="nf">products_layout</span>
      <span class="vi">@current_user</span><span class="p">.</span><span class="nf">special?</span> <span class="p">?</span> <span class="s2">"special"</span> <span class="p">:</span> <span class="s2">"products"</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now, if the current user is a special user, they’ll get a special layout when viewing a product.</p>

<p>You can even use an inline method, such as a Proc, to determine the layout. For example, if you pass a Proc object, the block you give the Proc will be given the <code class="language-plaintext highlighter-rouge">controller</code> instance, so the layout can be determined based on the current request:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">layout</span> <span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">controller</span><span class="o">|</span> <span class="n">controller</span><span class="p">.</span><span class="nf">request</span><span class="p">.</span><span class="nf">xhr?</span> <span class="p">?</span> <span class="s2">"popup"</span> <span class="p">:</span> <span class="s2">"application"</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div></div>

<h5 id="conditional-layouts">Conditional Layouts</h5>

<p>Layouts specified at the controller level support the <code class="language-plaintext highlighter-rouge">:only</code> and <code class="language-plaintext highlighter-rouge">:except</code> options. These options take either a method name, or an array of method names, corresponding to method names within the controller:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">layout</span> <span class="s2">"product"</span><span class="p">,</span> <span class="ss">except: </span><span class="p">[</span><span class="ss">:index</span><span class="p">,</span> <span class="ss">:rss</span><span class="p">]</span>
<span class="k">end</span>
</code></pre></div></div>

<p>With this declaration, the <code class="language-plaintext highlighter-rouge">product</code> layout would be used for everything but the <code class="language-plaintext highlighter-rouge">rss</code> and <code class="language-plaintext highlighter-rouge">index</code> methods.</p>

<h5 id="layout-inheritance">Layout Inheritance</h5>

<p>Layout declarations cascade downward in the hierarchy, and more specific layout declarations always override more general ones. For example:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">application_controller.rb</code></p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
    <span class="n">layout</span> <span class="s2">"main"</span>
  <span class="k">end</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">articles_controller.rb</code></p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">ArticlesController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">end</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">special_articles_controller.rb</code></p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">SpecialArticlesController</span> <span class="o">&lt;</span> <span class="no">ArticlesController</span>
    <span class="n">layout</span> <span class="s2">"special"</span>
  <span class="k">end</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">old_articles_controller.rb</code></p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">OldArticlesController</span> <span class="o">&lt;</span> <span class="no">SpecialArticlesController</span>
    <span class="n">layout</span> <span class="kp">false</span>

    <span class="k">def</span> <span class="nf">show</span>
      <span class="vi">@article</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">index</span>
      <span class="vi">@old_articles</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">older</span>
      <span class="n">render</span> <span class="ss">layout: </span><span class="s2">"old"</span>
    <span class="k">end</span>
    <span class="c1"># ...</span>
  <span class="k">end</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>In this application:</p>

<ul>
  <li>In general, views will be rendered in the <code class="language-plaintext highlighter-rouge">main</code> layout</li>
  <li><code class="language-plaintext highlighter-rouge">ArticlesController#index</code> will use the <code class="language-plaintext highlighter-rouge">main</code> layout</li>
  <li><code class="language-plaintext highlighter-rouge">SpecialArticlesController#index</code> will use the <code class="language-plaintext highlighter-rouge">special</code> layout</li>
  <li><code class="language-plaintext highlighter-rouge">OldArticlesController#show</code> will use no layout at all</li>
  <li><code class="language-plaintext highlighter-rouge">OldArticlesController#index</code> will use the <code class="language-plaintext highlighter-rouge">old</code> layout</li>
</ul>

<h5 id="template-inheritance">Template Inheritance</h5>

<p>Similar to the Layout Inheritance logic, if a template or partial is not found in the conventional path, the controller will look for a template or partial to render in its inheritance chain. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># app/controllers/application_controller.rb</span>
<span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># app/controllers/admin_controller.rb</span>
<span class="k">class</span> <span class="nc">AdminController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># app/controllers/admin/products_controller.rb</span>
<span class="k">class</span> <span class="nc">Admin::ProductsController</span> <span class="o">&lt;</span> <span class="no">AdminController</span>
  <span class="k">def</span> <span class="nf">index</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The lookup order for an <code class="language-plaintext highlighter-rouge">admin/products#index</code> action will be:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">app/views/admin/products/</code></li>
  <li><code class="language-plaintext highlighter-rouge">app/views/admin/</code></li>
  <li><code class="language-plaintext highlighter-rouge">app/views/application/</code></li>
</ul>

<p>This makes <code class="language-plaintext highlighter-rouge">app/views/application/</code> a great place for your shared partials, which can then be rendered in your ERB as such:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;%# app/views/admin/products/index.html.erb %&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="vi">@products</span> <span class="o">||</span> <span class="s2">"empty_list"</span> <span class="cp">%&gt;</span>

<span class="c">&lt;%# app/views/application/_empty_list.html.erb %&gt;</span>
There are no items in this list <span class="nt">&lt;em&gt;</span>yet<span class="nt">&lt;/em&gt;</span>.
</code></pre></div></div>

<h4 id="avoiding-double-render-errors">Avoiding Double Render Errors</h4>

<p>Sooner or later, most Rails developers will see the error message “Can only render or redirect once per action”. While this is annoying, it’s relatively easy to fix. Usually it happens because of a fundamental misunderstanding of the way that <code class="language-plaintext highlighter-rouge">render</code> works.</p>

<p>For example, here’s some code that will trigger this error:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">special?</span>
    <span class="n">render</span> <span class="ss">action: </span><span class="s2">"special_show"</span>
  <span class="k">end</span>
  <span class="n">render</span> <span class="ss">action: </span><span class="s2">"regular_show"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">@book.special?</code> evaluates to <code class="language-plaintext highlighter-rouge">true</code>, Rails will start the rendering process to dump the <code class="language-plaintext highlighter-rouge">@book</code> variable into the <code class="language-plaintext highlighter-rouge">special_show</code> view. But this will <em>not</em> stop the rest of the code in the <code class="language-plaintext highlighter-rouge">show</code> action from running, and when Rails hits the end of the action, it will start to render the <code class="language-plaintext highlighter-rouge">regular_show</code> view - and throw an error. The solution is simple: make sure that you have only one call to <code class="language-plaintext highlighter-rouge">render</code> or <code class="language-plaintext highlighter-rouge">redirect</code> in a single code path. One thing that can help is <code class="language-plaintext highlighter-rouge">return</code>. Here’s a patched version of the method:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">special?</span>
    <span class="n">render</span> <span class="ss">action: </span><span class="s2">"special_show"</span>
    <span class="k">return</span>
  <span class="k">end</span>
  <span class="n">render</span> <span class="ss">action: </span><span class="s2">"regular_show"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Note that the implicit render done by ActionController detects if <code class="language-plaintext highlighter-rouge">render</code> has been called, so the following will work without errors:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">special?</span>
    <span class="n">render</span> <span class="ss">action: </span><span class="s2">"special_show"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This will render a book with <code class="language-plaintext highlighter-rouge">special?</code> set with the <code class="language-plaintext highlighter-rouge">special_show</code> template, while other books will render with the default <code class="language-plaintext highlighter-rouge">show</code> template.</p>

<h3 id="using-redirect_to">Using <code class="language-plaintext highlighter-rouge">redirect_to</code></h3>

<p>Another way to handle returning responses to an HTTP request is with <a href="https://api.rubyonrails.org/classes/ActionController/Redirecting.html#method-i-redirect_to"><code class="language-plaintext highlighter-rouge">redirect_to</code></a>. As you’ve seen, <code class="language-plaintext highlighter-rouge">render</code> tells Rails which view (or other asset) to use in constructing a response. The <code class="language-plaintext highlighter-rouge">redirect_to</code> method does something completely different: it tells the browser to send a new request for a different URL. For example, you could redirect from wherever you are in your code to the index of photos in your application with this call:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">redirect_to</span> <span class="n">photos_url</span>
</code></pre></div></div>

<p>You can use <a href="https://api.rubyonrails.org/classes/ActionController/Redirecting.html#method-i-redirect_back"><code class="language-plaintext highlighter-rouge">redirect_back</code></a> to return the user to the page they just came from.
This location is pulled from the <code class="language-plaintext highlighter-rouge">HTTP_REFERER</code> header which is not guaranteed
to be set by the browser, so you must provide the <code class="language-plaintext highlighter-rouge">fallback_location</code>
to use in this case.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">redirect_back</span><span class="p">(</span><span class="ss">fallback_location: </span><span class="n">root_path</span><span class="p">)</span>
</code></pre></div></div>

<p>NOTE: <code class="language-plaintext highlighter-rouge">redirect_to</code> and <code class="language-plaintext highlighter-rouge">redirect_back</code> do not halt and return immediately from method execution, but simply set HTTP responses. Statements occurring after them in a method will be executed. You can halt by an explicit <code class="language-plaintext highlighter-rouge">return</code> or some other halting mechanism, if needed.</p>

<h4 id="getting-a-different-redirect-status-code">Getting a Different Redirect Status Code</h4>

<p>Rails uses HTTP status code 302, a temporary redirect, when you call <code class="language-plaintext highlighter-rouge">redirect_to</code>. If you’d like to use a different status code, perhaps 301, a permanent redirect, you can use the <code class="language-plaintext highlighter-rouge">:status</code> option:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">redirect_to</span> <span class="n">photos_path</span><span class="p">,</span> <span class="ss">status: </span><span class="mi">301</span>
</code></pre></div></div>

<p>Just like the <code class="language-plaintext highlighter-rouge">:status</code> option for <code class="language-plaintext highlighter-rouge">render</code>, <code class="language-plaintext highlighter-rouge">:status</code> for <code class="language-plaintext highlighter-rouge">redirect_to</code> accepts both numeric and symbolic header designations.</p>

<h4 id="the-difference-between-render-and-redirect_to">The Difference Between <code class="language-plaintext highlighter-rouge">render</code> and <code class="language-plaintext highlighter-rouge">redirect_to</code></h4>

<p>Sometimes inexperienced developers think of <code class="language-plaintext highlighter-rouge">redirect_to</code> as a sort of <code class="language-plaintext highlighter-rouge">goto</code>
command, moving execution from one place to another in your Rails code. This is
<em>not</em> correct.</p>

<p>The current action will complete, returning a response to the browser. After
this your code stops running and waits for a new request, it just happens that
you’ve told the browser what request it should make next by sending back an
HTTP 302 status code.</p>

<p>Consider these actions to see the difference:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">nil?</span>
    <span class="n">render</span> <span class="ss">action: </span><span class="s2">"index"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>With the code in this form, there will likely be a problem if the <code class="language-plaintext highlighter-rouge">@book</code> variable is <code class="language-plaintext highlighter-rouge">nil</code>. Remember, a <code class="language-plaintext highlighter-rouge">render :action</code> doesn’t run any code in the target action, so nothing will set up the <code class="language-plaintext highlighter-rouge">@books</code> variable that the <code class="language-plaintext highlighter-rouge">index</code> view will probably require. One way to fix this is to redirect instead of rendering:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">nil?</span>
    <span class="n">redirect_to</span> <span class="ss">action: :index</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>With this code, the browser will make a fresh request for the index page, the code in the <code class="language-plaintext highlighter-rouge">index</code> method will run, and all will be well.</p>

<p>The only downside to this code is that it requires a round trip to the browser: the browser requested the show action with <code class="language-plaintext highlighter-rouge">/books/1</code> and the controller finds that there are no books, so the controller sends out a 302 redirect response to the browser telling it to go to <code class="language-plaintext highlighter-rouge">/books/</code>, the browser complies and sends a new request back to the controller asking now for the <code class="language-plaintext highlighter-rouge">index</code> action, the controller then gets all the books in the database and renders the index template, sending it back down to the browser which then shows it on your screen.</p>

<p>While in a small application, this added latency might not be a problem, it is something to think about if response time is a concern. We can demonstrate one way to handle this with a contrived example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">nil?</span>
    <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
    <span class="n">flash</span><span class="p">.</span><span class="nf">now</span><span class="p">[</span><span class="ss">:alert</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Your book was not found"</span>
    <span class="n">render</span> <span class="s2">"index"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This would detect that there are no books with the specified ID, populate the <code class="language-plaintext highlighter-rouge">@books</code> instance variable with all the books in the model, and then directly render the <code class="language-plaintext highlighter-rouge">index.html.erb</code> template, returning it to the browser with a flash alert message to tell the user what happened.</p>

<h3 id="using-head-to-build-header-only-responses">Using <code class="language-plaintext highlighter-rouge">head</code> to Build Header-Only Responses</h3>

<p>The <a href="https://api.rubyonrails.org/classes/ActionController/Head.html#method-i-head"><code class="language-plaintext highlighter-rouge">head</code></a> method can be used to send responses with only headers to the browser. The <code class="language-plaintext highlighter-rouge">head</code> method accepts a number or symbol (see <a href="#the-status-option">reference table</a>) representing an HTTP status code. The options argument is interpreted as a hash of header names and values. For example, you can return only an error header:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span> <span class="ss">:bad_request</span>
</code></pre></div></div>

<p>This would produce the following header:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">400</span> <span class="ne">Bad Request</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sun, 24 Jan 2010 12:15:53 GMT</span>
<span class="na">Transfer-Encoding</span><span class="p">:</span> <span class="s">chunked</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">text/html; charset=utf-8</span>
<span class="na">X-Runtime</span><span class="p">:</span> <span class="s">0.013483</span>
<span class="na">Set-Cookie</span><span class="p">:</span> <span class="s">_blog_session=...snip...; path=/; HttpOnly</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">no-cache</span>
</code></pre></div></div>

<p>Or you can use other HTTP headers to convey other information:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span> <span class="ss">:created</span><span class="p">,</span> <span class="ss">location: </span><span class="n">photo_path</span><span class="p">(</span><span class="vi">@photo</span><span class="p">)</span>
</code></pre></div></div>

<p>Which would produce:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sun, 24 Jan 2010 12:16:44 GMT</span>
<span class="na">Transfer-Encoding</span><span class="p">:</span> <span class="s">chunked</span>
<span class="na">Location</span><span class="p">:</span> <span class="s">/photos/1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">text/html; charset=utf-8</span>
<span class="na">X-Runtime</span><span class="p">:</span> <span class="s">0.083496</span>
<span class="na">Set-Cookie</span><span class="p">:</span> <span class="s">_blog_session=...snip...; path=/; HttpOnly</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">no-cache</span>
</code></pre></div></div>

<h2 id="structuring-layouts">Structuring Layouts</h2>

<p>When Rails renders a view as a response, it does so by combining the view with the current layout, using the rules for finding the current layout that were covered earlier in this guide. Within a layout, you have access to three tools for combining different bits of output to form the overall response:</p>

<ul>
  <li>Asset tags</li>
  <li><code class="language-plaintext highlighter-rouge">yield</code> and <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-content_for"><code class="language-plaintext highlighter-rouge">content_for</code></a></li>
  <li>Partials</li>
</ul>

<h3 id="asset-tag-helpers">Asset Tag Helpers</h3>

<p>Asset tag helpers provide methods for generating HTML that link views to feeds, JavaScript, stylesheets, images, videos, and audios. There are six asset tag helpers available in Rails:</p>

<ul>
  <li><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-auto_discovery_link_tag"><code class="language-plaintext highlighter-rouge">auto_discovery_link_tag</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-javascript_include_tag"><code class="language-plaintext highlighter-rouge">javascript_include_tag</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-stylesheet_link_tag"><code class="language-plaintext highlighter-rouge">stylesheet_link_tag</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-image_tag"><code class="language-plaintext highlighter-rouge">image_tag</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-video_tag"><code class="language-plaintext highlighter-rouge">video_tag</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-audio_tag"><code class="language-plaintext highlighter-rouge">audio_tag</code></a></li>
</ul>

<p>You can use these tags in layouts or other views, although the <code class="language-plaintext highlighter-rouge">auto_discovery_link_tag</code>, <code class="language-plaintext highlighter-rouge">javascript_include_tag</code>, and <code class="language-plaintext highlighter-rouge">stylesheet_link_tag</code>, are most commonly used in the <code class="language-plaintext highlighter-rouge">&lt;head&gt;</code> section of a layout.</p>

<p>WARNING: The asset tag helpers do <em>not</em> verify the existence of the assets at the specified locations; they simply assume that you know what you’re doing and generate the link.</p>

<h4 id="linking-to-feeds-with-the-auto_discovery_link_tag">Linking to Feeds with the <code class="language-plaintext highlighter-rouge">auto_discovery_link_tag</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-auto_discovery_link_tag"><code class="language-plaintext highlighter-rouge">auto_discovery_link_tag</code></a> helper builds HTML that most browsers and feed readers can use to detect the presence of RSS, Atom, or JSON feeds. It takes the type of the link (<code class="language-plaintext highlighter-rouge">:rss</code>, <code class="language-plaintext highlighter-rouge">:atom</code>, or <code class="language-plaintext highlighter-rouge">:json</code>), a hash of options that are passed through to url_for, and a hash of options for the tag:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">auto_discovery_link_tag</span><span class="p">(</span><span class="ss">:rss</span><span class="p">,</span> <span class="p">{</span><span class="ss">action: </span><span class="s2">"feed"</span><span class="p">},</span>
  <span class="p">{</span><span class="ss">title: </span><span class="s2">"RSS Feed"</span><span class="p">})</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>There are three tag options available for the <code class="language-plaintext highlighter-rouge">auto_discovery_link_tag</code>:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">:rel</code> specifies the <code class="language-plaintext highlighter-rouge">rel</code> value in the link. The default value is “alternate”.</li>
  <li><code class="language-plaintext highlighter-rouge">:type</code> specifies an explicit MIME type. Rails will generate an appropriate MIME type automatically.</li>
  <li><code class="language-plaintext highlighter-rouge">:title</code> specifies the title of the link. The default value is the uppercase <code class="language-plaintext highlighter-rouge">:type</code> value, for example, “ATOM” or “RSS”.</li>
</ul>

<h4 id="linking-to-javascript-files-with-the-javascript_include_tag">Linking to JavaScript Files with the <code class="language-plaintext highlighter-rouge">javascript_include_tag</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-javascript_include_tag"><code class="language-plaintext highlighter-rouge">javascript_include_tag</code></a> helper returns an HTML <code class="language-plaintext highlighter-rouge">script</code> tag for each source provided.</p>

<p>If you are using Rails with the <a href="asset_pipeline.html">Asset Pipeline</a> enabled, this helper will generate a link to <code class="language-plaintext highlighter-rouge">/assets/javascripts/</code> rather than <code class="language-plaintext highlighter-rouge">public/javascripts</code> which was used in earlier versions of Rails. This link is then served by the asset pipeline.</p>

<p>A JavaScript file within a Rails application or Rails engine goes in one of three locations: <code class="language-plaintext highlighter-rouge">app/assets</code>, <code class="language-plaintext highlighter-rouge">lib/assets</code> or <code class="language-plaintext highlighter-rouge">vendor/assets</code>. These locations are explained in detail in the <a href="asset_pipeline.html#asset-organization">Asset Organization section in the Asset Pipeline Guide</a>.</p>

<p>You can specify a full path relative to the document root, or a URL, if you prefer. For example, to link to a JavaScript file <code class="language-plaintext highlighter-rouge">main.js</code> that is inside one of <code class="language-plaintext highlighter-rouge">app/assets/javascripts</code>, <code class="language-plaintext highlighter-rouge">lib/assets/javascripts</code> or <code class="language-plaintext highlighter-rouge">vendor/assets/javascripts</code>, you would do this:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">"main"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Rails will then output a <code class="language-plaintext highlighter-rouge">script</code> tag such as this:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">'/assets/main.js'</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div>

<p>The request to this asset is then served by the Sprockets gem.</p>

<p>To include multiple files such as <code class="language-plaintext highlighter-rouge">app/assets/javascripts/main.js</code> and <code class="language-plaintext highlighter-rouge">app/assets/javascripts/columns.js</code> at the same time:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">"main"</span><span class="p">,</span> <span class="s2">"columns"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>To include <code class="language-plaintext highlighter-rouge">app/assets/javascripts/main.js</code> and <code class="language-plaintext highlighter-rouge">app/assets/javascripts/photos/columns.js</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">"main"</span><span class="p">,</span> <span class="s2">"/photos/columns"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>To include <code class="language-plaintext highlighter-rouge">http://example.com/main.js</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">"http://example.com/main.js"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<h4 id="linking-to-css-files-with-the-stylesheet_link_tag">Linking to CSS Files with the <code class="language-plaintext highlighter-rouge">stylesheet_link_tag</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-stylesheet_link_tag"><code class="language-plaintext highlighter-rouge">stylesheet_link_tag</code></a> helper returns an HTML <code class="language-plaintext highlighter-rouge">&lt;link&gt;</code> tag for each source provided.</p>

<p>If you are using Rails with the “Asset Pipeline” enabled, this helper will generate a link to <code class="language-plaintext highlighter-rouge">/assets/stylesheets/</code>. This link is then processed by the Sprockets gem. A stylesheet file can be stored in one of three locations: <code class="language-plaintext highlighter-rouge">app/assets</code>, <code class="language-plaintext highlighter-rouge">lib/assets</code>, or <code class="language-plaintext highlighter-rouge">vendor/assets</code>.</p>

<p>You can specify a full path relative to the document root, or a URL. For example, to link to a stylesheet file that is inside a directory called <code class="language-plaintext highlighter-rouge">stylesheets</code> inside of one of <code class="language-plaintext highlighter-rouge">app/assets</code>, <code class="language-plaintext highlighter-rouge">lib/assets</code>, or <code class="language-plaintext highlighter-rouge">vendor/assets</code>, you would do this:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"main"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>To include <code class="language-plaintext highlighter-rouge">app/assets/stylesheets/main.css</code> and <code class="language-plaintext highlighter-rouge">app/assets/stylesheets/columns.css</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"main"</span><span class="p">,</span> <span class="s2">"columns"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>To include <code class="language-plaintext highlighter-rouge">app/assets/stylesheets/main.css</code> and <code class="language-plaintext highlighter-rouge">app/assets/stylesheets/photos/columns.css</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"main"</span><span class="p">,</span> <span class="s2">"photos/columns"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>To include <code class="language-plaintext highlighter-rouge">http://example.com/main.css</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"http://example.com/main.css"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>By default, the <code class="language-plaintext highlighter-rouge">stylesheet_link_tag</code> creates links with <code class="language-plaintext highlighter-rouge">rel="stylesheet"</code>. You can override this default by specifying an appropriate option (<code class="language-plaintext highlighter-rouge">:rel</code>):</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"main_print"</span><span class="p">,</span> <span class="ss">media: </span><span class="s2">"print"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<h4 id="linking-to-images-with-the-image_tag">Linking to Images with the <code class="language-plaintext highlighter-rouge">image_tag</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-image_tag"><code class="language-plaintext highlighter-rouge">image_tag</code></a> helper builds an HTML <code class="language-plaintext highlighter-rouge">&lt;img /&gt;</code> tag to the specified file. By default, files are loaded from <code class="language-plaintext highlighter-rouge">public/images</code>.</p>

<p>WARNING: Note that you must specify the extension of the image.</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"header.png"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>You can supply a path to the image if you like:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"icons/delete.gif"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>You can supply a hash of additional HTML options:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"icons/delete.gif"</span><span class="p">,</span> <span class="p">{</span><span class="ss">height: </span><span class="mi">45</span><span class="p">}</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>You can supply alternate text for the image which will be used if the user has images turned off in their browser. If you do not specify an alt text explicitly, it defaults to the file name of the file, capitalized and with no extension. For example, these two image tags would return the same code:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"home.gif"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"home.gif"</span><span class="p">,</span> <span class="ss">alt: </span><span class="s2">"Home"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>You can also specify a special size tag, in the format “{width}x{height}”:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"home.gif"</span><span class="p">,</span> <span class="ss">size: </span><span class="s2">"50x20"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>In addition to the above special tags, you can supply a final hash of standard HTML options, such as <code class="language-plaintext highlighter-rouge">:class</code>, <code class="language-plaintext highlighter-rouge">:id</code>, or <code class="language-plaintext highlighter-rouge">:name</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"home.gif"</span><span class="p">,</span> <span class="ss">alt: </span><span class="s2">"Go Home"</span><span class="p">,</span>
                          <span class="ss">id: </span><span class="s2">"HomeImage"</span><span class="p">,</span>
                          <span class="ss">class: </span><span class="s2">"nav_bar"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<h4 id="linking-to-videos-with-the-video_tag">Linking to Videos with the <code class="language-plaintext highlighter-rouge">video_tag</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-video_tag"><code class="language-plaintext highlighter-rouge">video_tag</code></a> helper builds an HTML5 <code class="language-plaintext highlighter-rouge">&lt;video&gt;</code> tag to the specified file. By default, files are loaded from <code class="language-plaintext highlighter-rouge">public/videos</code>.</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">video_tag</span> <span class="s2">"movie.ogg"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Produces</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;video</span> <span class="na">src=</span><span class="s">"/videos/movie.ogg"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>Like an <code class="language-plaintext highlighter-rouge">image_tag</code> you can supply a path, either absolute, or relative to the <code class="language-plaintext highlighter-rouge">public/videos</code> directory. Additionally you can specify the <code class="language-plaintext highlighter-rouge">size: "#{width}x#{height}"</code> option just like an <code class="language-plaintext highlighter-rouge">image_tag</code>. Video tags can also have any of the HTML options specified at the end (<code class="language-plaintext highlighter-rouge">id</code>, <code class="language-plaintext highlighter-rouge">class</code> et al).</p>

<p>The video tag also supports all of the <code class="language-plaintext highlighter-rouge">&lt;video&gt;</code> HTML options through the HTML options hash, including:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">poster: "image_name.png"</code>, provides an image to put in place of the video before it starts playing.</li>
  <li><code class="language-plaintext highlighter-rouge">autoplay: true</code>, starts playing the video on page load.</li>
  <li><code class="language-plaintext highlighter-rouge">loop: true</code>, loops the video once it gets to the end.</li>
  <li><code class="language-plaintext highlighter-rouge">controls: true</code>, provides browser supplied controls for the user to interact with the video.</li>
  <li><code class="language-plaintext highlighter-rouge">autobuffer: true</code>, the video will pre load the file for the user on page load.</li>
</ul>

<p>You can also specify multiple videos to play by passing an array of videos to the <code class="language-plaintext highlighter-rouge">video_tag</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">video_tag</span> <span class="p">[</span><span class="s2">"trailer.ogg"</span><span class="p">,</span> <span class="s2">"movie.ogg"</span><span class="p">]</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>This will produce:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;video&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">src=</span><span class="s">"/videos/trailer.ogg"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">src=</span><span class="s">"/videos/movie.ogg"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/video&gt;</span>
</code></pre></div></div>

<h4 id="linking-to-audio-files-with-the-audio_tag">Linking to Audio Files with the <code class="language-plaintext highlighter-rouge">audio_tag</code></h4>

<p>The <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-audio_tag"><code class="language-plaintext highlighter-rouge">audio_tag</code></a> helper builds an HTML5 <code class="language-plaintext highlighter-rouge">&lt;audio&gt;</code> tag to the specified file. By default, files are loaded from <code class="language-plaintext highlighter-rouge">public/audios</code>.</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">audio_tag</span> <span class="s2">"music.mp3"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>You can supply a path to the audio file if you like:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">audio_tag</span> <span class="s2">"music/first_song.mp3"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>You can also supply a hash of additional options, such as <code class="language-plaintext highlighter-rouge">:id</code>, <code class="language-plaintext highlighter-rouge">:class</code>, etc.</p>

<p>Like the <code class="language-plaintext highlighter-rouge">video_tag</code>, the <code class="language-plaintext highlighter-rouge">audio_tag</code> has special options:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">autoplay: true</code>, starts playing the audio on page load</li>
  <li><code class="language-plaintext highlighter-rouge">controls: true</code>, provides browser supplied controls for the user to interact with the audio.</li>
  <li><code class="language-plaintext highlighter-rouge">autobuffer: true</code>, the audio will pre load the file for the user on page load.</li>
</ul>

<h3 id="understanding-yield">Understanding <code class="language-plaintext highlighter-rouge">yield</code></h3>

<p>Within the context of a layout, <code class="language-plaintext highlighter-rouge">yield</code> identifies a section where content from the view should be inserted. The simplest way to use this is to have a single <code class="language-plaintext highlighter-rouge">yield</code>, into which the entire contents of the view currently being rendered is inserted:</p>

<pre><code class="language-html+erb">&lt;html&gt;
  &lt;head&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;%= yield %&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>You can also create a layout with multiple yielding regions:</p>

<pre><code class="language-html+erb">&lt;html&gt;
  &lt;head&gt;
    &lt;%= yield :head %&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;%= yield %&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>The main body of the view will always render into the unnamed <code class="language-plaintext highlighter-rouge">yield</code>. To render content into a named <code class="language-plaintext highlighter-rouge">yield</code>, call the <code class="language-plaintext highlighter-rouge">content_for</code> method with the same argument as the named <code class="language-plaintext highlighter-rouge">yield</code>.</p>

<p>NOTE: Newly generated applications will include <code class="language-plaintext highlighter-rouge">&lt;%= yield :head %&gt;</code> within the <code class="language-plaintext highlighter-rouge">&lt;head&gt;</code> element of its <code class="language-plaintext highlighter-rouge">app/views/layouts/application.html.erb</code> template.</p>

<h3 id="using-the-content_for-method">Using the <code class="language-plaintext highlighter-rouge">content_for</code> Method</h3>

<p>The <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-content_for"><code class="language-plaintext highlighter-rouge">content_for</code></a> method allows you to insert content into a named <code class="language-plaintext highlighter-rouge">yield</code> block in your layout. For example, this view would work with the layout that you just saw:</p>

<pre><code class="language-html+erb">&lt;% content_for :head do %&gt;
  &lt;title&gt;A simple page&lt;/title&gt;
&lt;% end %&gt;

&lt;p&gt;Hello, Rails!&lt;/p&gt;
</code></pre>

<p>The result of rendering this page into the supplied layout would be this HTML:</p>

<pre><code class="language-html+erb">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;A simple page&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;Hello, Rails!&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>The <code class="language-plaintext highlighter-rouge">content_for</code> method is very helpful when your layout contains distinct regions such as sidebars and footers that should get their own blocks of content inserted. It’s also useful for inserting page-specific JavaScript <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> elements, CSS <code class="language-plaintext highlighter-rouge">&lt;link&gt;</code> elements, context-specific <code class="language-plaintext highlighter-rouge">&lt;meta&gt;</code> elements, or any other elements into the <code class="language-plaintext highlighter-rouge">&lt;head&gt;</code> of an otherwise generic layout.</p>

<h3 id="using-partials">Using Partials</h3>

<p>Partial templates - usually just called “partials” - are another device for breaking the rendering process into more manageable chunks. With a partial, you can move the code for rendering a particular piece of a response to its own file.</p>

<h4 id="naming-partials">Naming Partials</h4>

<p>To render a partial as part of a view, you use the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/RenderingHelper.html#method-i-render"><code class="language-plaintext highlighter-rouge">render</code></a> method within the view:</p>

<pre><code class="language-html+erb">&lt;%= render "menu" %&gt;
</code></pre>

<p>This will render a file named <code class="language-plaintext highlighter-rouge">_menu.html.erb</code> at that point within the view being rendered. Note the leading underscore character: partials are named with a leading underscore to distinguish them from regular views, even though they are referred to without the underscore. This holds true even when you’re pulling in a partial from another folder:</p>

<pre><code class="language-html+erb">&lt;%= render "application/menu" %&gt;
</code></pre>

<p>Since view partials rely on the same <a href="#template-inheritance">Template Inheritance</a>
as templates and layouts, that code will pull in the partial from <code class="language-plaintext highlighter-rouge">app/views/application/_menu.html.erb</code>.</p>

<h4 id="using-partials-to-simplify-views">Using Partials to Simplify Views</h4>

<p>One way to use partials is to treat them as the equivalent of subroutines: as a way to move details out of a view so that you can grasp what’s going on more easily. For example, you might have a view that looked like this:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s2">"application/ad_banner"</span> <span class="cp">%&gt;</span>

<span class="nt">&lt;h1&gt;</span>Products<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;p&gt;</span>Here are a few of our fine products:<span class="nt">&lt;/p&gt;</span>
<span class="c">&lt;%# ... %&gt;</span>

<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s2">"application/footer"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Here, the <code class="language-plaintext highlighter-rouge">_ad_banner.html.erb</code> and <code class="language-plaintext highlighter-rouge">_footer.html.erb</code> partials could contain
content that is shared by many pages in your application. You don’t need to see
the details of these sections when you’re concentrating on a particular page.</p>

<p>As seen in the previous sections of this guide, <code class="language-plaintext highlighter-rouge">yield</code> is a very powerful tool
for cleaning up your layouts. Keep in mind that it’s pure Ruby, so you can use
it almost everywhere. For example, we can use it to DRY up form layout
definitions for several similar resources:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">users/index.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;%= render "application/search_filters", search: @q do |form| %&gt;
    &lt;p&gt;
      Name contains: &lt;%= form.text_field :name_contains %&gt;
    &lt;/p&gt;
  &lt;% end %&gt;
</code></pre>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">roles/index.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;%= render "application/search_filters", search: @q do |form| %&gt;
    &lt;p&gt;
      Title contains: &lt;%= form.text_field :title_contains %&gt;
    &lt;/p&gt;
  &lt;% end %&gt;
</code></pre>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">application/_search_filters.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;%= form_with model: search do |form| %&gt;
    &lt;h1&gt;Search form:&lt;/h1&gt;
    &lt;fieldset&gt;
      &lt;%= yield form %&gt;
    &lt;/fieldset&gt;
    &lt;p&gt;
      &lt;%= form.submit "Search" %&gt;
    &lt;/p&gt;
  &lt;% end %&gt;
</code></pre>
  </li>
</ul>

<p>TIP: For content that is shared among all pages in your application, you can use partials directly from layouts.</p>

<h4 id="partial-layouts">Partial Layouts</h4>

<p>A partial can use its own layout file, just as a view can use a layout. For example, you might call a partial like this:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"link_area"</span><span class="p">,</span> <span class="ss">layout: </span><span class="s2">"graybar"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>This would look for a partial named <code class="language-plaintext highlighter-rouge">_link_area.html.erb</code> and render it using the layout <code class="language-plaintext highlighter-rouge">_graybar.html.erb</code>. Note that layouts for partials follow the same leading-underscore naming as regular partials, and are placed in the same folder with the partial that they belong to (not in the master <code class="language-plaintext highlighter-rouge">layouts</code> folder).</p>

<p>Also note that explicitly specifying <code class="language-plaintext highlighter-rouge">:partial</code> is required when passing additional options such as <code class="language-plaintext highlighter-rouge">:layout</code>.</p>

<h4 id="passing-local-variables">Passing Local Variables</h4>

<p>You can also pass local variables into partials, making them even more powerful and flexible. For example, you can use this technique to reduce duplication between new and edit pages, while still keeping a bit of distinct content:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">new.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;h1&gt;New zone&lt;/h1&gt;
  &lt;%= render partial: "form", locals: {zone: @zone} %&gt;
</code></pre>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">edit.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;h1&gt;Editing zone&lt;/h1&gt;
  &lt;%= render partial: "form", locals: {zone: @zone} %&gt;
</code></pre>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_form.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;%= form_with model: zone do |form| %&gt;
    &lt;p&gt;
      &lt;b&gt;Zone name&lt;/b&gt;&lt;br&gt;
      &lt;%= form.text_field :name %&gt;
    &lt;/p&gt;
    &lt;p&gt;
      &lt;%= form.submit %&gt;
    &lt;/p&gt;
  &lt;% end %&gt;
</code></pre>
  </li>
</ul>

<p>Although the same partial will be rendered into both views, Action View’s submit helper will return “Create Zone” for the new action and “Update Zone” for the edit action.</p>

<p>To pass a local variable to a partial in only specific cases use the <code class="language-plaintext highlighter-rouge">local_assigns</code>.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">index.html.erb</code></p>

    <div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="n">user</span><span class="p">.</span><span class="nf">articles</span> <span class="cp">%&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">show.html.erb</code></p>

    <div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="n">article</span><span class="p">,</span> <span class="ss">full: </span><span class="kp">true</span> <span class="cp">%&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_article.html.erb</code></p>

    <div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;h2&gt;</span><span class="cp">&lt;%=</span> <span class="n">article</span><span class="p">.</span><span class="nf">title</span> <span class="cp">%&gt;</span><span class="nt">&lt;/h2&gt;</span>

  <span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">local_assigns</span><span class="p">[</span><span class="ss">:full</span><span class="p">]</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">simple_format</span> <span class="n">article</span><span class="p">.</span><span class="nf">body</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="k">else</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">truncate</span> <span class="n">article</span><span class="p">.</span><span class="nf">body</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>This way it is possible to use the partial without the need to declare all local variables.</p>

<p>Every partial also has a local variable with the same name as the partial (minus the leading underscore). You can pass an object in to this local variable via the <code class="language-plaintext highlighter-rouge">:object</code> option:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"customer"</span><span class="p">,</span> <span class="ss">object: </span><span class="vi">@new_customer</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Within the <code class="language-plaintext highlighter-rouge">customer</code> partial, the <code class="language-plaintext highlighter-rouge">customer</code> variable will refer to <code class="language-plaintext highlighter-rouge">@new_customer</code> from the parent view.</p>

<p>If you have an instance of a model to render into a partial, you can use a shorthand syntax:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="vi">@customer</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Assuming that the <code class="language-plaintext highlighter-rouge">@customer</code> instance variable contains an instance of the <code class="language-plaintext highlighter-rouge">Customer</code> model, this will use <code class="language-plaintext highlighter-rouge">_customer.html.erb</code> to render it and will pass the local variable <code class="language-plaintext highlighter-rouge">customer</code> into the partial which will refer to the <code class="language-plaintext highlighter-rouge">@customer</code> instance variable in the parent view.</p>

<h4 id="rendering-collections">Rendering Collections</h4>

<p>Partials are very useful in rendering collections. When you pass a collection to a partial via the <code class="language-plaintext highlighter-rouge">:collection</code> option, the partial will be inserted once for each member in the collection:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">index.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;h1&gt;Products&lt;/h1&gt;
  &lt;%= render partial: "product", collection: @products %&gt;
</code></pre>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_product.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;p&gt;Product Name: &lt;%= product.name %&gt;&lt;/p&gt;
</code></pre>
  </li>
</ul>

<p>When a partial is called with a pluralized collection, then the individual instances of the partial have access to the member of the collection being rendered via a variable named after the partial. In this case, the partial is <code class="language-plaintext highlighter-rouge">_product</code>, and within the <code class="language-plaintext highlighter-rouge">_product</code> partial, you can refer to <code class="language-plaintext highlighter-rouge">product</code> to get the instance that is being rendered.</p>

<p>There is also a shorthand for this. Assuming <code class="language-plaintext highlighter-rouge">@products</code> is a collection of <code class="language-plaintext highlighter-rouge">Product</code> instances, you can simply write this in the <code class="language-plaintext highlighter-rouge">index.html.erb</code> to produce the same result:</p>

<pre><code class="language-html+erb">&lt;h1&gt;Products&lt;/h1&gt;
&lt;%= render @products %&gt;
</code></pre>

<p>Rails determines the name of the partial to use by looking at the model name in the collection. In fact, you can even create a heterogeneous collection and render it this way, and Rails will choose the proper partial for each member of the collection:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">index.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;h1&gt;Contacts&lt;/h1&gt;
  &lt;%= render [customer1, employee1, customer2, employee2] %&gt;
</code></pre>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">customers/_customer.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;p&gt;Customer: &lt;%= customer.name %&gt;&lt;/p&gt;
</code></pre>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">employees/_employee.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;p&gt;Employee: &lt;%= employee.name %&gt;&lt;/p&gt;
</code></pre>
  </li>
</ul>

<p>In this case, Rails will use the customer or employee partials as appropriate for each member of the collection.</p>

<p>In the event that the collection is empty, <code class="language-plaintext highlighter-rouge">render</code> will return nil, so it should be fairly simple to provide alternative content.</p>

<pre><code class="language-html+erb">&lt;h1&gt;Products&lt;/h1&gt;
&lt;%= render(@products) || "There are no products available." %&gt;
</code></pre>

<h4 id="local-variables">Local Variables</h4>

<p>To use a custom local variable name within the partial, specify the <code class="language-plaintext highlighter-rouge">:as</code> option in the call to the partial:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"product"</span><span class="p">,</span> <span class="ss">collection: </span><span class="vi">@products</span><span class="p">,</span> <span class="ss">as: :item</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>With this change, you can access an instance of the <code class="language-plaintext highlighter-rouge">@products</code> collection as the <code class="language-plaintext highlighter-rouge">item</code> local variable within the partial.</p>

<p>You can also pass in arbitrary local variables to any partial you are rendering with the <code class="language-plaintext highlighter-rouge">locals: {}</code> option:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"product"</span><span class="p">,</span> <span class="ss">collection: </span><span class="vi">@products</span><span class="p">,</span>
           <span class="ss">as: :item</span><span class="p">,</span> <span class="ss">locals: </span><span class="p">{</span><span class="ss">title: </span><span class="s2">"Products Page"</span><span class="p">}</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>In this case, the partial will have access to a local variable <code class="language-plaintext highlighter-rouge">title</code> with the value “Products Page”.</p>

<h4 id="counter-variables">Counter Variables</h4>

<p>Rails also makes a counter variable available within a partial called by the collection. The variable is named after the title of the partial followed by <code class="language-plaintext highlighter-rouge">_counter</code>. For example, when rendering a collection <code class="language-plaintext highlighter-rouge">@products</code> the partial <code class="language-plaintext highlighter-rouge">_product.html.erb</code> can access the variable <code class="language-plaintext highlighter-rouge">product_counter</code>. The variable indexes the number of times the partial has been rendered within the enclosing view, starting with a value of <code class="language-plaintext highlighter-rouge">0</code> on the first render.</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code># index.html.erb
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"product"</span><span class="p">,</span> <span class="ss">collection: </span><span class="vi">@products</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code># _product.html.erb
<span class="cp">&lt;%=</span> <span class="n">product_counter</span> <span class="cp">%&gt;</span> # 0 for the first product, 1 for the second product...
</code></pre></div></div>

<p>This also works when the local variable name is changed using the <code class="language-plaintext highlighter-rouge">as:</code> option. So if you did <code class="language-plaintext highlighter-rouge">as: :item</code>, the counter variable would be <code class="language-plaintext highlighter-rouge">item_counter</code>.</p>

<h4 id="spacer-templates">Spacer Templates</h4>

<p>You can also specify a second partial to be rendered between instances of the main partial by using the <code class="language-plaintext highlighter-rouge">:spacer_template</code> option:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="vi">@products</span><span class="p">,</span> <span class="ss">spacer_template: </span><span class="s2">"product_ruler"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Rails will render the <code class="language-plaintext highlighter-rouge">_product_ruler</code> partial (with no data passed in to it) between each pair of <code class="language-plaintext highlighter-rouge">_product</code> partials.</p>

<h4 id="collection-partial-layouts">Collection Partial Layouts</h4>

<p>When rendering collections it is also possible to use the <code class="language-plaintext highlighter-rouge">:layout</code> option:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"product"</span><span class="p">,</span> <span class="ss">collection: </span><span class="vi">@products</span><span class="p">,</span> <span class="ss">layout: </span><span class="s2">"special_layout"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The layout will be rendered together with the partial for each item in the collection. The current object and object_counter variables will be available in the layout as well, the same way they are within the partial.</p>

<h3 id="using-nested-layouts">Using Nested Layouts</h3>

<p>You may find that your application requires a layout that differs slightly from your regular application layout to support one particular controller. Rather than repeating the main layout and editing it, you can accomplish this by using nested layouts (sometimes called sub-templates). Here’s an example:</p>

<p>Suppose you have the following <code class="language-plaintext highlighter-rouge">ApplicationController</code> layout:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">app/views/layouts/application.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;&lt;%= @page_title or "Page Title" %&gt;&lt;/title&gt;
    &lt;%= stylesheet_link_tag "layout" %&gt;
    &lt;%= yield :head %&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div id="top_menu"&gt;Top menu items here&lt;/div&gt;
    &lt;div id="menu"&gt;Menu items here&lt;/div&gt;
    &lt;div id="content"&gt;&lt;%= content_for?(:content) ? yield(:content) : yield %&gt;&lt;/div&gt;
  &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
  </li>
</ul>

<p>On pages generated by <code class="language-plaintext highlighter-rouge">NewsController</code>, you want to hide the top menu and add a right menu:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">app/views/layouts/news.html.erb</code></p>

    <pre><code class="language-html+erb">  &lt;% content_for :head do %&gt;
    &lt;style&gt;
      #top_menu {display: none}
      #right_menu {float: right; background-color: yellow; color: black}
    &lt;/style&gt;
  &lt;% end %&gt;
  &lt;% content_for :content do %&gt;
    &lt;div id="right_menu"&gt;Right menu items here&lt;/div&gt;
    &lt;%= content_for?(:news_content) ? yield(:news_content) : yield %&gt;
  &lt;% end %&gt;
  &lt;%= render template: "layouts/application" %&gt;
</code></pre>
  </li>
</ul>

<p>That’s it. The News views will use the new layout, hiding the top menu and adding a new right menu inside the “content” div.</p>

<p>There are several ways of getting similar results with different sub-templating schemes using this technique. Note that there is no limit in nesting levels. One can use the <code class="language-plaintext highlighter-rouge">ActionView::render</code> method via <code class="language-plaintext highlighter-rouge">render template: 'layouts/news'</code> to base a new layout on the News layout. If you are sure you will not subtemplate the <code class="language-plaintext highlighter-rouge">News</code> layout, you can replace the <code class="language-plaintext highlighter-rouge">content_for?(:news_content) ? yield(:news_content) : yield</code> with simply <code class="language-plaintext highlighter-rouge">yield</code>.</p>
</div>

    <footer class="guide-footer">
      <div class="feedback">
        <h3>Geri Bildirim</h3>
        <p>
          Bu kılavuzun kalitesini artırmamıza yardımcı olmak için geri
          bildirimlerinizi bekliyoruz.
        </p>
        <p>
          Lütfen
          <a href="https://github.com/dilankaya127/rails-tr-TR"
            >GitHub Issues</a
          >
          üzerinden katkıda bulunun.
        </p>
      </div>
    </footer>
  </article>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toc = document.getElementById("toc");
    const headings = document.querySelectorAll(
      ".guide-content h2, .guide-content h3, .guide-content h4"
    );

    if (headings.length > 0) {
      const tocList = document.createElement("ul");
      const headingMap = new Map();

      headings.forEach(function (heading, index) {
        const id = "heading-" + index;
        heading.id = id;

        const li = document.createElement("li");
        const a = document.createElement("a");
        a.href = "#" + id;
        a.textContent = heading.textContent;
        a.className = "toc-" + heading.tagName.toLowerCase();

        li.appendChild(a);
        tocList.appendChild(li);

        headingMap.set(id, a);
      });

      toc.appendChild(tocList);

      // Başlıkların görünürlük oranlarını takip et
      const visibilityMap = new Map();

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const id = entry.target.getAttribute("id");
            visibilityMap.set(id, entry.intersectionRatio);
          });

          // En çok görünür olan başlığı bul
          let mostVisibleId = null;
          let maxRatio = 0;

          visibilityMap.forEach((ratio, id) => {
            if (ratio > maxRatio) {
              mostVisibleId = id;
              maxRatio = ratio;
            }
          });

          if (mostVisibleId) {
            headingMap.forEach((linkEl) => linkEl.classList.remove("active"));
            const activeLink = headingMap.get(mostVisibleId);
            if (activeLink) {
              activeLink.classList.add("active");

              // Ortalamak için:
              const linkTop = activeLink.offsetTop;
              const linkHeight = activeLink.offsetHeight;
              const tocScrollParent = toc;
              const tocHeight = tocScrollParent.offsetHeight;

              tocScrollParent.scrollTo({
                top: linkTop - tocHeight / 2 + linkHeight / 2,
                behavior: "smooth",
              });
            }
          }
        },
        {
          threshold: [0, 0.25, 0.5, 0.75, 1.0],
        }
      );

      headings.forEach((heading) => {
        observer.observe(heading);
      });

      const toggleBtn = document.getElementById("toc-toggle");
      const sidebar = document.querySelector(".guide-sidebar");

      toggleBtn.addEventListener("click", function () {
        sidebar.classList.toggle("open");
      });
      const closeBtn = document.querySelector(".toc-close");

      closeBtn?.addEventListener("click", function () {
        sidebar.classList.remove("open");
      });
    }
  });
</script>

        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Rails Kılavuzları Türkçe Çevirisi. Gönüllüler tarafından hazırlanmıştır.</p>
            <p>Orijinal dokümantasyon <a href="https://guides.rubyonrails.org">Ruby on Rails</a> ekibine aittir.</p>
        </div>
    </footer>

    <script>hljs.highlightAll();</script>
</body>
</html>