<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Routing - Rails Dokümantasyonu - Türkçe</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">
                    <a href="/">Rails Kılavuzları</a>
                </h1>
                <nav class="nav">
                    <a href="/">Ana Sayfa</a>
                    <a href="https://dilankaya127.github.io">Portföy</a>
                    <a href="https://github.com/dilankaya127/rails-tr-TR">GitHub</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="guide-container">
    <aside class="guide-sidebar">
        <div class="guide-toc">
            <h3>İçindekiler</h3>
            <div id="toc"></div>
        </div>
        
        <div class="guide-nav">
            <h3>Diğer Kılavuzlar</h3>
            <ul>
                <li><a href="/rails/guides/tr/getting_started">Rails ile Başlarken</a></li>
                <li><a href="/rails/guides/en/active_record_basics">Active Record Temelleri</a></li>
                <li><a href="/rails/guides//en/action_controller_overview">Action Controller</a></li>
                <li><a href="/rails/guides/tr/action_cable_overview">Action Cable</a></li>
            </ul>
        </div>
    </aside>

    <article class="guide-content">
        <header class="guide-header">
            <h1>Routing</h1>
            
        </header>

        <div class="guide-body">
            <p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1 id="rails-routing-from-the-outside-in">Rails Routing from the Outside In</h1>

<p>This guide covers the user-facing features of Rails routing.</p>

<p>After reading this guide, you will know:</p>

<ul>
  <li>How to interpret the code in <code class="language-plaintext highlighter-rouge">config/routes.rb</code>.</li>
  <li>How to construct your own routes, using either the preferred resourceful style or the <code class="language-plaintext highlighter-rouge">match</code> method.</li>
  <li>How to declare route parameters, which are passed onto controller actions.</li>
  <li>How to automatically create paths and URLs using route helpers.</li>
  <li>Advanced techniques such as creating constraints and mounting Rack endpoints.</li>
</ul>

<hr />

<h2 id="the-purpose-of-the-rails-router">The Purpose of the Rails Router</h2>

<p>The Rails router matches incoming HTTP requests to specific controller actions
in your Rails application based on the URL path. (It can also forward to a
<a href="rails_on_rack.html">Rack</a> application.) The router also generates path and URL
helpers based on the resources configured in the router.</p>

<h3 id="routing-incoming-urls-to-code">Routing Incoming URLs to Code</h3>

<p>When your Rails application receives an incoming request, it asks the router to match it to a controller action (aka method). For example, take the following incoming request:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /users/17
</code></pre></div></div>

<p>If the first matching route is:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/users/:id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"users#show"</span>
</code></pre></div></div>

<p>The request is matched to the <code class="language-plaintext highlighter-rouge">UsersController</code> class’s <code class="language-plaintext highlighter-rouge">show</code> action with <code class="language-plaintext highlighter-rouge">{ id: '17' }</code> in the <code class="language-plaintext highlighter-rouge">params</code> hash.</p>

<p>The <code class="language-plaintext highlighter-rouge">to:</code> option expects a <code class="language-plaintext highlighter-rouge">controller#action</code> format when passed a string. Alternatively, You can pass a symbol and use the <code class="language-plaintext highlighter-rouge">action:</code> option, instead of <code class="language-plaintext highlighter-rouge">to:</code>. You can also pass a string without a <code class="language-plaintext highlighter-rouge">#</code>, in which case the <code class="language-plaintext highlighter-rouge">controller:</code> option is used instead to <code class="language-plaintext highlighter-rouge">to:</code>. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/users/:id"</span><span class="p">,</span> <span class="ss">controller: </span><span class="s2">"users"</span><span class="p">,</span> <span class="ss">action: :show</span>
</code></pre></div></div>

<p>NOTE: Rails uses snake_case for controller names when specifying routes. For example, if you have a controller named <code class="language-plaintext highlighter-rouge">UserProfilesController</code>, you would specify a route to the show action as <code class="language-plaintext highlighter-rouge">user_profiles#show</code>.</p>

<h3 id="generating-paths-and-urls-from-code">Generating Paths and URLs from Code</h3>

<p>The Router automatically generates path and URL helper methods for your application. With these methods you can avoid hard-coded path and URL strings.</p>

<p>For example, the <code class="language-plaintext highlighter-rouge">user_path</code> and <code class="language-plaintext highlighter-rouge">user_url</code> helper methods are available when defining the following route:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/users/:id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"users#show"</span><span class="p">,</span> <span class="ss">as: </span><span class="s2">"user"</span>
</code></pre></div></div>

<p>NOTE: The <code class="language-plaintext highlighter-rouge">as:</code> option is used to provide a custom name for a route, which is used when generating URL and path helpers.</p>

<p>Assuming your application contains this code in the controller:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
</code></pre></div></div>

<p>and this in the corresponding view:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'User Record'</span><span class="p">,</span> <span class="n">user_path</span><span class="p">(</span><span class="vi">@user</span><span class="p">)</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The router will generate the path <code class="language-plaintext highlighter-rouge">/users/17</code> from <code class="language-plaintext highlighter-rouge">user_path(@user)</code>. Using the <code class="language-plaintext highlighter-rouge">user_path</code> helper allows you to avoid having to hard-code a path in your views. This is helpful if you eventually move the route to a different URL, as you won’t need to update the corresponding views.</p>

<p>It also generates <code class="language-plaintext highlighter-rouge">user_url</code>, which has a similar purpose. While <code class="language-plaintext highlighter-rouge">user_path</code> generates a relative URL like <code class="language-plaintext highlighter-rouge">/users/17</code>, <code class="language-plaintext highlighter-rouge">user_url</code> generates an absolute URL such as <code class="language-plaintext highlighter-rouge">https://example.com/users/17</code> in the above example.</p>

<h3 id="configuring-the-rails-router">Configuring the Rails Router</h3>

<p>Routes live in <code class="language-plaintext highlighter-rouge">config/routes.rb</code>. Here is an example of what routes look like in a typical Rails application. The sections that follow will explain the different route helpers used in this file:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:brands</span><span class="p">,</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:index</span><span class="p">,</span> <span class="ss">:show</span><span class="p">]</span> <span class="k">do</span>
    <span class="n">resources</span> <span class="ss">:products</span><span class="p">,</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:index</span><span class="p">,</span> <span class="ss">:show</span><span class="p">]</span>
  <span class="k">end</span>

  <span class="n">resource</span> <span class="ss">:basket</span><span class="p">,</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:show</span><span class="p">,</span> <span class="ss">:update</span><span class="p">,</span> <span class="ss">:destroy</span><span class="p">]</span>

  <span class="n">resolve</span><span class="p">(</span><span class="s2">"Basket"</span><span class="p">)</span> <span class="p">{</span> <span class="n">route_for</span><span class="p">(</span><span class="ss">:basket</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Since this is a regular Ruby source file, you can use all of Ruby’s features (like conditionals and loops) to help you define your routes.</p>

<p>NOTE: The <code class="language-plaintext highlighter-rouge">Rails.application.routes.draw do ... end</code> block that wraps your route definitions is required to establish the scope for the router DSL (Domain Specific Language) and must not be deleted.</p>

<p>WARNING: Be careful with variable names in <code class="language-plaintext highlighter-rouge">routes.rb</code> as they can clash with the DSL methods of the router.</p>

<h2 id="resource-routing-the-rails-default">Resource Routing: the Rails Default</h2>

<p>Resource routing allows you to quickly declare all of the common routes for a given resource controller. For example, a single call to <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Resources.html#method-i-resources"><code class="language-plaintext highlighter-rouge">resources</code></a> declares all of the necessary routes for the <code class="language-plaintext highlighter-rouge">index</code>, <code class="language-plaintext highlighter-rouge">show</code>, <code class="language-plaintext highlighter-rouge">new</code>, <code class="language-plaintext highlighter-rouge">edit</code>, <code class="language-plaintext highlighter-rouge">create</code>, <code class="language-plaintext highlighter-rouge">update</code>, and <code class="language-plaintext highlighter-rouge">destroy</code> actions, without you having to declare each route separately.</p>

<h3 id="resources-on-the-web">Resources on the Web</h3>

<p>Browsers request pages from Rails by making a request for a URL using a specific HTTP verb, such as <code class="language-plaintext highlighter-rouge">GET</code>, <code class="language-plaintext highlighter-rouge">POST</code>, <code class="language-plaintext highlighter-rouge">PATCH</code>, <code class="language-plaintext highlighter-rouge">PUT</code>, and <code class="language-plaintext highlighter-rouge">DELETE</code>. Each HTTP verb is a request to perform an operation on the resource. A resource route maps related requests to actions in a single controller.</p>

<p>When your Rails application receives an incoming request for:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DELETE /photos/17
</code></pre></div></div>

<p>it asks the router to map it to a controller action. If the first matching route is:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span>
</code></pre></div></div>

<p>Rails would dispatch that request to the <code class="language-plaintext highlighter-rouge">destroy</code> action on the <code class="language-plaintext highlighter-rouge">PhotosController</code> with <code class="language-plaintext highlighter-rouge">{ id: '17' }</code> in <code class="language-plaintext highlighter-rouge">params</code>.</p>

<h3 id="crud-verbs-and-actions">CRUD, Verbs, and Actions</h3>

<p>In Rails, resourceful routes provide a mapping from incoming requests (a
combination of HTTP verb + URL) to controller actions. By convention, each
action generally maps to a specific <a href="active_record_basics.html#crud-reading-and-writing-data">CRUD</a> operation on your data. A single entry in
the routing file, such as:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span>
</code></pre></div></div>

<p>creates seven different routes in your application, all mapping to the <code class="language-plaintext highlighter-rouge">PhotosController</code> actions:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Used to</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/photos</td>
      <td>photos#index</td>
      <td>display a list of all photos</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/photos/new</td>
      <td>photos#new</td>
      <td>return an HTML form for creating a new photo</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/photos</td>
      <td>photos#create</td>
      <td>create a new photo</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/photos/:id</td>
      <td>photos#show</td>
      <td>display a specific photo</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/photos/:id/edit</td>
      <td>photos#edit</td>
      <td>return an HTML form for editing a photo</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/photos/:id</td>
      <td>photos#update</td>
      <td>update a specific photo</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/photos/:id</td>
      <td>photos#destroy</td>
      <td>delete a specific photo</td>
    </tr>
  </tbody>
</table>

<p>Since the router uses the HTTP verb <em>and</em> path to match inbound requests, four URLs can map to seven different controller actions. For example, the same <code class="language-plaintext highlighter-rouge">photos/</code> path matches to <code class="language-plaintext highlighter-rouge">photos#index</code> when the verb is <code class="language-plaintext highlighter-rouge">GET</code> and <code class="language-plaintext highlighter-rouge">photos#create</code> when the verb is <code class="language-plaintext highlighter-rouge">POST</code>.</p>

<p>NOTE: Order matters in the <code class="language-plaintext highlighter-rouge">routes.rb</code> file. Rails routes are matched in the order they are specified. For example, if you have a <code class="language-plaintext highlighter-rouge">resources :photos</code> above a <code class="language-plaintext highlighter-rouge">get 'photos/poll'</code> the <code class="language-plaintext highlighter-rouge">show</code> action’s route for the <code class="language-plaintext highlighter-rouge">resources</code> line will be matched before the <code class="language-plaintext highlighter-rouge">get</code> line. If you want the <code class="language-plaintext highlighter-rouge">photos/poll</code> route to match first, you’ll need to move the <code class="language-plaintext highlighter-rouge">get</code> line <strong>above</strong> the <code class="language-plaintext highlighter-rouge">resources</code> line.</p>

<h3 id="path-and-url-helpers">Path and URL Helpers</h3>

<p>Creating a resourceful route will also expose a number of helpers to controllers and views in your application.</p>

<p>For example, adding <code class="language-plaintext highlighter-rouge">resources :photos</code> to the route file will generate these <code class="language-plaintext highlighter-rouge">_path</code> helpers:</p>

<table>
  <thead>
    <tr>
      <th>Path Helper</th>
      <th>Returns URL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">photos_path</code></td>
      <td>/photos</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">new_photo_path</code></td>
      <td>/photos/new</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">edit_photo_path(:id)</code></td>
      <td>/photos/:id/edit`</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">photo_path(:id)</code></td>
      <td>/photos/:id</td>
    </tr>
  </tbody>
</table>

<p>Parameters to the path helpers, such as <code class="language-plaintext highlighter-rouge">:id</code> above, are passed to the generated URL, such that <code class="language-plaintext highlighter-rouge">edit_photo_path(10)</code> will return <code class="language-plaintext highlighter-rouge">/photos/10/edit</code>.</p>

<p>Each of these <code class="language-plaintext highlighter-rouge">_path</code> helpers also have a corresponding <code class="language-plaintext highlighter-rouge">_url</code> helper (such as <code class="language-plaintext highlighter-rouge">photos_url</code>) which returns the same path prefixed with the current host, port, and path prefix.</p>

<p>TIP: The prefix used before “_path” and “_url” is the route name and can be identified by looking at the “prefix” column of the <code class="language-plaintext highlighter-rouge">bin/rails routes</code> command output. To learn more see <a href="#listing-existing-routes">Listing Existing Routes</a> below.</p>

<h3 id="defining-multiple-resources-at-the-same-time">Defining Multiple Resources at the Same Time</h3>

<p>If you need to create routes for more than one resource, you can save a bit of typing by defining them all with a single call to <code class="language-plaintext highlighter-rouge">resources</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">:books</span><span class="p">,</span> <span class="ss">:videos</span>
</code></pre></div></div>

<p>The above is a shortcut for:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span>
<span class="n">resources</span> <span class="ss">:books</span>
<span class="n">resources</span> <span class="ss">:videos</span>
</code></pre></div></div>

<h3 id="singular-resources">Singular Resources</h3>

<p>Sometimes, you have a resource that users expect to have only one (i.e. it does not make sense to have an <code class="language-plaintext highlighter-rouge">index</code> action to list all values of that resource). In that case, you can use <code class="language-plaintext highlighter-rouge">resource</code> (singular) instead of <code class="language-plaintext highlighter-rouge">resources</code>.</p>

<p>The below resourceful route creates six routes in your application, all mapping to the <code class="language-plaintext highlighter-rouge">Geocoders</code> controller:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resource</span> <span class="ss">:geocoder</span>
<span class="n">resolve</span><span class="p">(</span><span class="s2">"Geocoder"</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="ss">:geocoder</span><span class="p">]</span> <span class="p">}</span>
</code></pre></div></div>

<p>NOTE: The call to <code class="language-plaintext highlighter-rouge">resolve</code> is necessary for converting instances of the <code class="language-plaintext highlighter-rouge">Geocoder</code> to singular routes through <a href="form_helpers.html#relying-on-record-identification">record identification</a>.</p>

<p>Here are all of the routes created for a singular resource:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Used to</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/geocoder/new</td>
      <td>geocoders#new</td>
      <td>return an HTML form for creating the geocoder</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/geocoder</td>
      <td>geocoders#create</td>
      <td>create the new geocoder</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/geocoder</td>
      <td>geocoders#show</td>
      <td>display the one and only geocoder resource</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/geocoder/edit</td>
      <td>geocoders#edit</td>
      <td>return an HTML form for editing the geocoder</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/geocoder</td>
      <td>geocoders#update</td>
      <td>update the one and only geocoder resource</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/geocoder</td>
      <td>geocoders#destroy</td>
      <td>delete the geocoder resource</td>
    </tr>
  </tbody>
</table>

<p>NOTE: Singular resources map to plural controllers. For example, the <code class="language-plaintext highlighter-rouge">geocoder</code> resource maps to the <code class="language-plaintext highlighter-rouge">GeocodersController</code>.</p>

<p>A singular resourceful route generates these helpers:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">new_geocoder_path</code> returns <code class="language-plaintext highlighter-rouge">/geocoder/new</code></li>
  <li><code class="language-plaintext highlighter-rouge">edit_geocoder_path</code> returns <code class="language-plaintext highlighter-rouge">/geocoder/edit</code></li>
  <li><code class="language-plaintext highlighter-rouge">geocoder_path</code> returns <code class="language-plaintext highlighter-rouge">/geocoder</code></li>
</ul>

<p>As with plural resources, the same helpers ending in <code class="language-plaintext highlighter-rouge">_url</code> will also include the host, port, and path prefix.</p>

<h3 id="controller-namespaces-and-routing">Controller Namespaces and Routing</h3>

<p>In large applications, you may wish to organize groups of controllers under a namespace. For example, you may have a number of controllers under an <code class="language-plaintext highlighter-rouge">Admin::</code> namespace, which are inside the <code class="language-plaintext highlighter-rouge">app/controllers/admin</code> directory. You can route to such a group by using a <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Scoping.html#method-i-namespace"><code class="language-plaintext highlighter-rouge">namespace</code></a> block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">namespace</span> <span class="ss">:admin</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:articles</span>
<span class="k">end</span>
</code></pre></div></div>

<p>For <code class="language-plaintext highlighter-rouge">Admin::ArticlesController</code>, Rails will create the following routes:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Named Route Helper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/admin/articles</td>
      <td>admin/articles#index</td>
      <td>admin_articles_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/admin/articles/new</td>
      <td>admin/articles#new</td>
      <td>new_admin_article_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/admin/articles</td>
      <td>admin/articles#create</td>
      <td>admin_articles_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/admin/articles/:id</td>
      <td>admin/articles#show</td>
      <td>admin_article_path(:id)</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/admin/articles/:id/edit</td>
      <td>admin/articles#edit</td>
      <td>edit_admin_article_path(:id)</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/admin/articles/:id</td>
      <td>admin/articles#update</td>
      <td>admin_article_path(:id)</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/admin/articles/:id</td>
      <td>admin/articles#destroy</td>
      <td>admin_article_path(:id)</td>
    </tr>
  </tbody>
</table>

<p>Note that in the above example all of the paths have a <code class="language-plaintext highlighter-rouge">/admin</code> prefix per the default convention for <code class="language-plaintext highlighter-rouge">namespace</code>.</p>

<h4 id="using-module">Using Module</h4>

<p>If you want to route <code class="language-plaintext highlighter-rouge">/articles</code> (without the prefix <code class="language-plaintext highlighter-rouge">/admin</code>) to <code class="language-plaintext highlighter-rouge">Admin::ArticlesController</code>, you can specify the module with a <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Scoping.html#method-i-scope"><code class="language-plaintext highlighter-rouge">scope</code></a> block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scope</span> <span class="ss">module: </span><span class="s2">"admin"</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:articles</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Another way to write the above:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:articles</span><span class="p">,</span> <span class="ss">module: </span><span class="s2">"admin"</span>
</code></pre></div></div>

<h4 id="using-scope">Using Scope</h4>

<p>Alternatively, you can also route <code class="language-plaintext highlighter-rouge">/admin/articles</code> to <code class="language-plaintext highlighter-rouge">ArticlesController</code> (without the <code class="language-plaintext highlighter-rouge">Admin::</code> module prefix). You can specify the path with a <code class="language-plaintext highlighter-rouge">scope</code> block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scope</span> <span class="s2">"/admin"</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:articles</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Another way to write the above:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:articles</span><span class="p">,</span> <span class="ss">path: </span><span class="s2">"/admin/articles"</span>
</code></pre></div></div>

<p>For these alternatives (without <code class="language-plaintext highlighter-rouge">/admin</code> in path and without <code class="language-plaintext highlighter-rouge">Admin::</code> in module prefix), the named route helpers remain the same as if you did not use <code class="language-plaintext highlighter-rouge">scope</code>.</p>

<p>In the last case, the following paths map to <code class="language-plaintext highlighter-rouge">ArticlesController</code>:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Named Route Helper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/admin/articles</td>
      <td>articles#index</td>
      <td>articles_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/admin/articles/new</td>
      <td>articles#new</td>
      <td>new_article_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/admin/articles</td>
      <td>articles#create</td>
      <td>articles_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/admin/articles/:id</td>
      <td>articles#show</td>
      <td>article_path(:id)</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/admin/articles/:id/edit</td>
      <td>articles#edit</td>
      <td>edit_article_path(:id)</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/admin/articles/:id</td>
      <td>articles#update</td>
      <td>article_path(:id)</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/admin/articles/:id</td>
      <td>articles#destroy</td>
      <td>article_path(:id)</td>
    </tr>
  </tbody>
</table>

<p>TIP: If you need to use a different controller namespace inside a <code class="language-plaintext highlighter-rouge">namespace</code> block you can specify an absolute controller path, e.g: <code class="language-plaintext highlighter-rouge">get '/foo', to: '/foo#index'</code>.</p>

<h3 id="nested-resources">Nested Resources</h3>

<p>It’s common to have resources that are logically children of other resources. For example, suppose your application includes these models:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Magazine</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:ads</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Ad</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">belongs_to</span> <span class="ss">:magazine</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Nested route declarations allow you to capture this relationship in your routing:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:magazines</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:ads</span>
<span class="k">end</span>
</code></pre></div></div>

<p>In addition to the routes for magazines, this declaration will also route ads to an <code class="language-plaintext highlighter-rouge">AdsController</code>. Here are all of the routes for the nested <code class="language-plaintext highlighter-rouge">ads</code> resource:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Used to</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/magazines/:magazine_id/ads</td>
      <td>ads#index</td>
      <td>display a list of all ads for a specific magazine</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/magazines/:magazine_id/ads/new</td>
      <td>ads#new</td>
      <td>return an HTML form for creating a new ad belonging to a specific magazine</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/magazines/:magazine_id/ads</td>
      <td>ads#create</td>
      <td>create a new ad belonging to a specific magazine</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/magazines/:magazine_id/ads/:id</td>
      <td>ads#show</td>
      <td>display a specific ad belonging to a specific magazine</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/magazines/:magazine_id/ads/:id/edit</td>
      <td>ads#edit</td>
      <td>return an HTML form for editing an ad belonging to a specific magazine</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/magazines/:magazine_id/ads/:id</td>
      <td>ads#update</td>
      <td>update a specific ad belonging to a specific magazine</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/magazines/:magazine_id/ads/:id</td>
      <td>ads#destroy</td>
      <td>delete a specific ad belonging to a specific magazine</td>
    </tr>
  </tbody>
</table>

<p>This will also create the usual path and url routing helpers such as <code class="language-plaintext highlighter-rouge">magazine_ads_url</code> and <code class="language-plaintext highlighter-rouge">edit_magazine_ad_path</code>. Since the <code class="language-plaintext highlighter-rouge">ads</code> resource is nested below <code class="language-plaintext highlighter-rouge">magazines</code>, The ad URLs require a magazine. The helpers can take an instance of <code class="language-plaintext highlighter-rouge">Magazine</code> as the first parameter (<code class="language-plaintext highlighter-rouge">edit_magazine_ad_path(@magazine, @ad)</code>).</p>

<h4 id="limits-to-nesting">Limits to Nesting</h4>

<p>You can nest resources within other nested resources if you like. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:publishers</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:magazines</span> <span class="k">do</span>
    <span class="n">resources</span> <span class="ss">:photos</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>In the above example, the application would recognize paths such as:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/publishers/1/magazines/2/photos/3
</code></pre></div></div>

<p>The corresponding route helper would be <code class="language-plaintext highlighter-rouge">publisher_magazine_photo_url</code>, requiring you to specify objects at all three levels. As you can see, deeply nested resources can become overly complex and cumbersome to maintain.</p>

<p>TIP: The general rule of thumb is to only nest resources 1 level deep.</p>

<h4 id="shallow-nesting">Shallow Nesting</h4>

<p>One way to avoid deep nesting (as recommended above) is to generate the
collection actions scoped under the parent - so as to get a sense of the
hierarchy, but to not nest the member actions. In other words, to only build
routes with the minimal amount of information to uniquely identify the resource.</p>

<p>NOTE: The “member” actions are the ones that apply to an individual resource and require an ID to identify the specific resource they are acting upon, such as <code class="language-plaintext highlighter-rouge">show</code>, <code class="language-plaintext highlighter-rouge">edit</code>, etc. The “collection” actions are the ones that act on the entire set of the resource, such as <code class="language-plaintext highlighter-rouge">index</code>.</p>

<p>For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:articles</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:index</span><span class="p">,</span> <span class="ss">:new</span><span class="p">,</span> <span class="ss">:create</span><span class="p">]</span>
<span class="k">end</span>
<span class="n">resources</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:show</span><span class="p">,</span> <span class="ss">:edit</span><span class="p">,</span> <span class="ss">:update</span><span class="p">,</span> <span class="ss">:destroy</span><span class="p">]</span>
</code></pre></div></div>

<p>Above we use the <code class="language-plaintext highlighter-rouge">:only</code> option which tells Rails to create only the specified routes. This idea strikes a balance between descriptive routes and deep nesting. There is a shorthand syntax to achieve just that, via the <code class="language-plaintext highlighter-rouge">:shallow</code> option:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:articles</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">shallow: </span><span class="kp">true</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This will generate the exact same routes as the first example. You can also specify the <code class="language-plaintext highlighter-rouge">:shallow</code> option in the parent resource, in which case all of the nested resources will be shallow:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:articles</span><span class="p">,</span> <span class="ss">shallow: </span><span class="kp">true</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:comments</span>
  <span class="n">resources</span> <span class="ss">:quotes</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The articles resource above will generate the following routes:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Named Route Helper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/articles/:article_id/comments(.:format)</td>
      <td>comments#index</td>
      <td>article_comments_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/articles/:article_id/comments(.:format)</td>
      <td>comments#create</td>
      <td>article_comments_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/articles/:article_id/comments/new(.:format)</td>
      <td>comments#new</td>
      <td>new_article_comment_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/comments/:id/edit(.:format)</td>
      <td>comments#edit</td>
      <td>edit_comment_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/comments/:id(.:format)</td>
      <td>comments#show</td>
      <td>comment_path</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/comments/:id(.:format)</td>
      <td>comments#update</td>
      <td>comment_path</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/comments/:id(.:format)</td>
      <td>comments#destroy</td>
      <td>comment_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/articles/:article_id/quotes(.:format)</td>
      <td>quotes#index</td>
      <td>article_quotes_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/articles/:article_id/quotes(.:format)</td>
      <td>quotes#create</td>
      <td>article_quotes_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/articles/:article_id/quotes/new(.:format)</td>
      <td>quotes#new</td>
      <td>new_article_quote_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/quotes/:id/edit(.:format)</td>
      <td>quotes#edit</td>
      <td>edit_quote_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/quotes/:id(.:format)</td>
      <td>quotes#show</td>
      <td>quote_path</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/quotes/:id(.:format)</td>
      <td>quotes#update</td>
      <td>quote_path</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/quotes/:id(.:format)</td>
      <td>quotes#destroy</td>
      <td>quote_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/articles(.:format)</td>
      <td>articles#index</td>
      <td>articles_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/articles(.:format)</td>
      <td>articles#create</td>
      <td>articles_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/articles/new(.:format)</td>
      <td>articles#new</td>
      <td>new_article_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/articles/:id/edit(.:format)</td>
      <td>articles#edit</td>
      <td>edit_article_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/articles/:id(.:format)</td>
      <td>articles#show</td>
      <td>article_path</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/articles/:id(.:format)</td>
      <td>articles#update</td>
      <td>article_path</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/articles/:id(.:format)</td>
      <td>articles#destroy</td>
      <td>article_path</td>
    </tr>
  </tbody>
</table>

<p>The <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Resources.html#method-i-shallow"><code class="language-plaintext highlighter-rouge">shallow</code></a> method with a block creates a scope inside of which every nesting is shallow. This generates the same routes as the previous example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shallow</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:articles</span> <span class="k">do</span>
    <span class="n">resources</span> <span class="ss">:comments</span>
    <span class="n">resources</span> <span class="ss">:quotes</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>There are two options that can be used with <code class="language-plaintext highlighter-rouge">scope</code> to customize shallow routes - <code class="language-plaintext highlighter-rouge">:shallow_path</code> and <code class="language-plaintext highlighter-rouge">:shallow_prefix</code>.</p>

<p>The <code class="language-plaintext highlighter-rouge">shallow_path</code> option prefixes member paths with the given parameter:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scope</span> <span class="ss">shallow_path: </span><span class="s2">"sekret"</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:articles</span> <span class="k">do</span>
    <span class="n">resources</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">shallow: </span><span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The comments resource here will have the following routes generated for it:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Named Route Helper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/articles/:article_id/comments(.:format)</td>
      <td>comments#index</td>
      <td>article_comments_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/articles/:article_id/comments(.:format)</td>
      <td>comments#create</td>
      <td>article_comments_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/articles/:article_id/comments/new(.:format)</td>
      <td>comments#new</td>
      <td>new_article_comment_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/sekret/comments/:id/edit(.:format)</td>
      <td>comments#edit</td>
      <td>edit_comment_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/sekret/comments/:id(.:format)</td>
      <td>comments#show</td>
      <td>comment_path</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/sekret/comments/:id(.:format)</td>
      <td>comments#update</td>
      <td>comment_path</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/sekret/comments/:id(.:format)</td>
      <td>comments#destroy</td>
      <td>comment_path</td>
    </tr>
  </tbody>
</table>

<p>The <code class="language-plaintext highlighter-rouge">:shallow_prefix</code> option adds the specified parameter to the <code class="language-plaintext highlighter-rouge">_path</code> and <code class="language-plaintext highlighter-rouge">_url</code> route helpers:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scope</span> <span class="ss">shallow_prefix: </span><span class="s2">"sekret"</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:articles</span> <span class="k">do</span>
    <span class="n">resources</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">shallow: </span><span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The comments resource here will have the following routes generated for it:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Named Route Helper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/articles/:article_id/comments(.:format)</td>
      <td>comments#index</td>
      <td>article_comments_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/articles/:article_id/comments(.:format)</td>
      <td>comments#create</td>
      <td>article_comments_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/articles/:article_id/comments/new(.:format)</td>
      <td>comments#new</td>
      <td>new_article_comment_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/comments/:id/edit(.:format)</td>
      <td>comments#edit</td>
      <td>edit_sekret_comment_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/comments/:id(.:format)</td>
      <td>comments#show</td>
      <td>sekret_comment_path</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/comments/:id(.:format)</td>
      <td>comments#update</td>
      <td>sekret_comment_path</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/comments/:id(.:format)</td>
      <td>comments#destroy</td>
      <td>sekret_comment_path</td>
    </tr>
  </tbody>
</table>

<h3 id="routing-concerns">Routing Concerns</h3>

<p>Routing concerns allow you to declare common routes that can be reused inside other resources. To define a concern, use a <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Concerns.html#method-i-concern"><code class="language-plaintext highlighter-rouge">concern</code></a> block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">concern</span> <span class="ss">:commentable</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:comments</span>
<span class="k">end</span>

<span class="n">concern</span> <span class="ss">:image_attachable</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:images</span><span class="p">,</span> <span class="ss">only: :index</span>
<span class="k">end</span>
</code></pre></div></div>

<p>These concerns can be used in resources to avoid code duplication and share behavior across routes:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:messages</span><span class="p">,</span> <span class="ss">concerns: :commentable</span>

<span class="n">resources</span> <span class="ss">:articles</span><span class="p">,</span> <span class="ss">concerns: </span><span class="p">[</span><span class="ss">:commentable</span><span class="p">,</span> <span class="ss">:image_attachable</span><span class="p">]</span>
</code></pre></div></div>

<p>The above is equivalent to:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:messages</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:comments</span>
<span class="k">end</span>

<span class="n">resources</span> <span class="ss">:articles</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:comments</span>
  <span class="n">resources</span> <span class="ss">:images</span><span class="p">,</span> <span class="ss">only: :index</span>
<span class="k">end</span>
</code></pre></div></div>

<p>You can also call <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Concerns.html#method-i-concerns"><code class="language-plaintext highlighter-rouge">concerns</code></a> in a <code class="language-plaintext highlighter-rouge">scope</code> or <code class="language-plaintext highlighter-rouge">namespace</code> block to get the same result as above. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">namespace</span> <span class="ss">:messages</span> <span class="k">do</span>
  <span class="n">concerns</span> <span class="ss">:commentable</span>
<span class="k">end</span>

<span class="n">namespace</span> <span class="ss">:articles</span> <span class="k">do</span>
  <span class="n">concerns</span> <span class="ss">:commentable</span>
  <span class="n">concerns</span> <span class="ss">:image_attachable</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="creating-paths-and-urls-from-objects">Creating Paths and URLs from Objects</h3>

<p>In addition to using the routing helpers, Rails can also create paths and URLs from an array of parameters. For example, suppose you have this set of routes:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:magazines</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:ads</span>
<span class="k">end</span>
</code></pre></div></div>

<p>When using <code class="language-plaintext highlighter-rouge">magazine_ad_path</code>, you can pass in instances of <code class="language-plaintext highlighter-rouge">Magazine</code> and <code class="language-plaintext highlighter-rouge">Ad</code> instead of the numeric IDs:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Ad details'</span><span class="p">,</span> <span class="n">magazine_ad_path</span><span class="p">(</span><span class="vi">@magazine</span><span class="p">,</span> <span class="vi">@ad</span><span class="p">)</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The generated path will be something like <code class="language-plaintext highlighter-rouge">/magazines/5/ads/42</code>.</p>

<p>You can also use <a href="https://api.rubyonrails.org/classes/ActionView/RoutingUrlFor.html#method-i-url_for"><code class="language-plaintext highlighter-rouge">url_for</code></a> with an array of objects to get the above path, like this:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Ad details'</span><span class="p">,</span> <span class="n">url_for</span><span class="p">([</span><span class="vi">@magazine</span><span class="p">,</span> <span class="vi">@ad</span><span class="p">])</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>In this case, Rails will see that <code class="language-plaintext highlighter-rouge">@magazine</code> is a <code class="language-plaintext highlighter-rouge">Magazine</code> and <code class="language-plaintext highlighter-rouge">@ad</code> is an <code class="language-plaintext highlighter-rouge">Ad</code> and will therefore use the <code class="language-plaintext highlighter-rouge">magazine_ad_path</code> helper. An even shorter way to write that <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to"><code class="language-plaintext highlighter-rouge">link_to</code></a> is to specify just the object instead of the full <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/UrlFor.html"><code class="language-plaintext highlighter-rouge">url_for</code></a> call:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Ad details'</span><span class="p">,</span> <span class="p">[</span><span class="vi">@magazine</span><span class="p">,</span> <span class="vi">@ad</span><span class="p">]</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>If you wanted to link to just a magazine:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Magazine details'</span><span class="p">,</span> <span class="vi">@magazine</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>For other actions, you need to insert the action name as the first element of the array, for <code class="language-plaintext highlighter-rouge">edit_magazine_ad_path</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Edit Ad'</span><span class="p">,</span> <span class="p">[</span><span class="ss">:edit</span><span class="p">,</span> <span class="vi">@magazine</span><span class="p">,</span> <span class="vi">@ad</span><span class="p">]</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>This allows you to treat instances of your models as URLs, and is a key advantage to using the resourceful style.</p>

<p>NOTE: In order to automatically derive paths and URLs from objects such as <code class="language-plaintext highlighter-rouge">[@magazine, @ad]</code>, Rails uses methods from <a href="https://api.rubyonrails.org/classes/ActiveModel/Naming.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Naming</code></a> and <a href="https://api.rubyonrails.org/classes/ActiveModel/Conversion.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Conversion</code></a> modules. Specifically, the <code class="language-plaintext highlighter-rouge">@magazine.model_name.route_key</code> returns <code class="language-plaintext highlighter-rouge">magazines</code> and <code class="language-plaintext highlighter-rouge">@magazine.to_param</code> returns a string representation of the model’s <code class="language-plaintext highlighter-rouge">id</code>. So the generated path may be something like <code class="language-plaintext highlighter-rouge">/magazines/1/ads/42</code> for the objects <code class="language-plaintext highlighter-rouge">[@magazine, @ad]</code>.</p>

<h3 id="adding-more-restful-routes">Adding More RESTful Routes</h3>

<p>You are not limited to the <a href="#crud-verbs-and-actions">seven routes</a> that RESTful routing creates by default. You can add additional routes that apply to the collection or individual members of the collection.</p>

<p>The below sections describe adding member routes and collection routes. The term <code class="language-plaintext highlighter-rouge">member</code> refers to routes acting on a single element, such as <code class="language-plaintext highlighter-rouge">show</code>, <code class="language-plaintext highlighter-rouge">update</code>, or <code class="language-plaintext highlighter-rouge">destroy</code>. The term <code class="language-plaintext highlighter-rouge">collection</code> refers to routes acting on multiple, or a collection of, elements, such as the <code class="language-plaintext highlighter-rouge">index</code> route.</p>

<h4 id="adding-member-routes">Adding Member Routes</h4>

<p>You can add a <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Resources.html#method-i-member"><code class="language-plaintext highlighter-rouge">member</code></a> block into the resource block like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span> <span class="k">do</span>
  <span class="n">member</span> <span class="k">do</span>
    <span class="n">get</span> <span class="s2">"preview"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>An incoming GET request to <code class="language-plaintext highlighter-rouge">/photos/1/preview</code> will route to the <code class="language-plaintext highlighter-rouge">preview</code> action of <code class="language-plaintext highlighter-rouge">PhotosController</code>. The resource id value will be available in <code class="language-plaintext highlighter-rouge">params[:id]</code>. It will also create the <code class="language-plaintext highlighter-rouge">preview_photo_url</code> and <code class="language-plaintext highlighter-rouge">preview_photo_path</code> helpers.</p>

<p>Within the <code class="language-plaintext highlighter-rouge">member</code> block, each route definition specifies the HTTP verb (<code class="language-plaintext highlighter-rouge">get</code>
in the above example with <code class="language-plaintext highlighter-rouge">get 'preview'</code>). In addition to <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-get"><code class="language-plaintext highlighter-rouge">get</code></a>, you can
use <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-patch"><code class="language-plaintext highlighter-rouge">patch</code></a>, <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-put"><code class="language-plaintext highlighter-rouge">put</code></a>, <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-post"><code class="language-plaintext highlighter-rouge">post</code></a>, or <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-delete"><code class="language-plaintext highlighter-rouge">delete</code></a>.</p>

<p>If you don’t have multiple <code class="language-plaintext highlighter-rouge">member</code> routes, you can also
pass <code class="language-plaintext highlighter-rouge">:on</code> to a route, eliminating the block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s2">"preview"</span><span class="p">,</span> <span class="ss">on: :member</span>
<span class="k">end</span>
</code></pre></div></div>

<p>You can also leave out the <code class="language-plaintext highlighter-rouge">:on</code> option, this will create the same member route except that the resource id value will be available in <code class="language-plaintext highlighter-rouge">params[:photo_id]</code> instead of <code class="language-plaintext highlighter-rouge">params[:id]</code>. Route helpers will also be renamed from <code class="language-plaintext highlighter-rouge">preview_photo_url</code> and <code class="language-plaintext highlighter-rouge">preview_photo_path</code> to <code class="language-plaintext highlighter-rouge">photo_preview_url</code> and <code class="language-plaintext highlighter-rouge">photo_preview_path</code>.</p>

<h4 id="adding-collection-routes">Adding Collection Routes</h4>

<p>To add a route to the collection, use a <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Resources.html#method-i-collection"><code class="language-plaintext highlighter-rouge">collection</code></a> block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span> <span class="k">do</span>
  <span class="n">collection</span> <span class="k">do</span>
    <span class="n">get</span> <span class="s2">"search"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This will enable Rails to recognize paths such as <code class="language-plaintext highlighter-rouge">/photos/search</code> with GET, and route to the <code class="language-plaintext highlighter-rouge">search</code> action of <code class="language-plaintext highlighter-rouge">PhotosController</code>. It will also create the <code class="language-plaintext highlighter-rouge">search_photos_url</code> and <code class="language-plaintext highlighter-rouge">search_photos_path</code> route helpers.</p>

<p>Just as with member routes, you can pass <code class="language-plaintext highlighter-rouge">:on</code> to a route:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s2">"search"</span><span class="p">,</span> <span class="ss">on: :collection</span>
<span class="k">end</span>
</code></pre></div></div>

<p>NOTE: If you’re defining additional resource routes with a symbol as the first positional argument, be mindful that it is not equivalent to using a string. Symbols infer controller actions while strings infer paths.</p>

<h4 id="adding-routes-for-additional-new-actions">Adding Routes for Additional New Actions</h4>

<p>To add an alternate new action using the <code class="language-plaintext highlighter-rouge">:on</code> shortcut:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:comments</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s2">"preview"</span><span class="p">,</span> <span class="ss">on: :new</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This will enable Rails to recognize paths such as <code class="language-plaintext highlighter-rouge">/comments/new/preview</code> with GET, and route to the <code class="language-plaintext highlighter-rouge">preview</code> action of <code class="language-plaintext highlighter-rouge">CommentsController</code>. It will also create the <code class="language-plaintext highlighter-rouge">preview_new_comment_url</code> and <code class="language-plaintext highlighter-rouge">preview_new_comment_path</code> route helpers.</p>

<p>TIP: If you find yourself adding many extra actions to a resourceful route, it’s time to stop and ask yourself whether you’re disguising the presence of another resource.</p>

<p>It is possible to customize the default routes and helpers generated by <code class="language-plaintext highlighter-rouge">resources</code>, see <a href="#customizing-resourceful-routes">customizing resourceful routes section</a> for more.</p>

<h2 id="non-resourceful-routes">Non-Resourceful Routes</h2>

<p>In addition to resourceful routing with <code class="language-plaintext highlighter-rouge">resources</code>, Rails has powerful support for routing arbitrary URLs to actions. You don’t get groups of routes automatically generated by resourceful routing. Instead, you set up each route separately within your application.</p>

<p>While you should usually use resourceful routing, there are places where non-resourceful routing is more appropriate. There’s no need to try to force every last piece of your application into a resourceful framework if that’s not a good fit.</p>

<p>One example use case for non-resourceful routing is mapping existing legacy URLs to new Rails actions.</p>

<h3 id="bound-parameters">Bound Parameters</h3>

<p>When you set up a regular route, you supply a series of symbols that Rails maps to parts of an incoming HTTP request. For example, consider this route:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"photos(/:id)"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#display"</span>
</code></pre></div></div>

<p>If an incoming <code class="language-plaintext highlighter-rouge">GET</code> request of <code class="language-plaintext highlighter-rouge">/photos/1</code> is processed by this route, then the result will be to invoke the <code class="language-plaintext highlighter-rouge">display</code> action of the <code class="language-plaintext highlighter-rouge">PhotosController</code>, and to make the final parameter <code class="language-plaintext highlighter-rouge">"1"</code> available as <code class="language-plaintext highlighter-rouge">params[:id]</code>. This route will also route the incoming request of <code class="language-plaintext highlighter-rouge">/photos</code> to <code class="language-plaintext highlighter-rouge">PhotosController#display</code>, since <code class="language-plaintext highlighter-rouge">:id</code> is an optional parameter, denoted by parentheses in the above example.</p>

<h3 id="dynamic-segments">Dynamic Segments</h3>

<p>You can set up as many dynamic segments within a regular route as you like. Any segment will be available to the action as part of <code class="language-plaintext highlighter-rouge">params</code>. If you set up this route:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"photos/:id/:user_id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#show"</span>
</code></pre></div></div>

<p>This route will respond to paths such as <code class="language-plaintext highlighter-rouge">/photos/1/2</code>. The <code class="language-plaintext highlighter-rouge">params</code> hash will be { controller: ‘photos’, action: ‘show’, id: ‘1’, user_id: ‘2’ }.</p>

<p>TIP: By default, dynamic segments don’t accept dots - this is because the dot is used as a separator for formatted routes. If you need to use a dot within a dynamic segment, add a constraint that overrides this – for example, <code class="language-plaintext highlighter-rouge">id: /[^\/]+/</code> allows anything except a slash.</p>

<h3 id="static-segments">Static Segments</h3>

<p>You can specify static segments when creating a route by not prepending a colon to a segment:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"photos/:id/with_user/:user_id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#show"</span>
</code></pre></div></div>

<p>This route would respond to paths such as <code class="language-plaintext highlighter-rouge">/photos/1/with_user/2</code>. In this case, <code class="language-plaintext highlighter-rouge">params</code> would be <code class="language-plaintext highlighter-rouge">{ controller: 'photos', action: 'show', id: '1', user_id: '2' }</code>.</p>

<h3 id="the-query-string">The Query String</h3>

<p>The <code class="language-plaintext highlighter-rouge">params</code> will also include any parameters from the query string. For example, with this route:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"photos/:id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#show"</span>
</code></pre></div></div>

<p>An incoming <code class="language-plaintext highlighter-rouge">GET</code> request for <code class="language-plaintext highlighter-rouge">/photos/1?user_id=2</code> will be dispatched to the <code class="language-plaintext highlighter-rouge">show</code> action of the <code class="language-plaintext highlighter-rouge">PhotosController</code> class as usual and the <code class="language-plaintext highlighter-rouge">params</code> hash will be <code class="language-plaintext highlighter-rouge">{ controller: 'photos', action: 'show', id: '1', user_id: '2' }</code>.</p>

<h3 id="defining-default-parameters">Defining Default Parameters</h3>

<p>You can define defaults in a route by supplying a hash for the <code class="language-plaintext highlighter-rouge">:defaults</code> option. This even applies to parameters that you do not specify as dynamic segments. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"photos/:id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#show"</span><span class="p">,</span> <span class="ss">defaults: </span><span class="p">{</span> <span class="ss">format: </span><span class="s2">"jpg"</span> <span class="p">}</span>
</code></pre></div></div>

<p>Rails would match <code class="language-plaintext highlighter-rouge">photos/12</code> to the <code class="language-plaintext highlighter-rouge">show</code> action of <code class="language-plaintext highlighter-rouge">PhotosController</code>, and set <code class="language-plaintext highlighter-rouge">params[:format]</code> to <code class="language-plaintext highlighter-rouge">"jpg"</code>.</p>

<p>You can also use a <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Scoping.html#method-i-defaults"><code class="language-plaintext highlighter-rouge">defaults</code></a> block to define the defaults for multiple items:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">defaults</span> <span class="ss">format: :json</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:photos</span>
  <span class="n">resources</span> <span class="ss">:articles</span>
<span class="k">end</span>
</code></pre></div></div>

<p>NOTE: You cannot override defaults via query parameters - this is for security reasons. The only defaults that can be overridden are dynamic segments via substitution in the URL path.</p>

<h3 id="naming-routes">Naming Routes</h3>

<p>You can specify a name that will be used by the <code class="language-plaintext highlighter-rouge">_path</code> and <code class="language-plaintext highlighter-rouge">_url</code> helpers for any route using the <code class="language-plaintext highlighter-rouge">:as</code> option:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"exit"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"sessions#destroy"</span><span class="p">,</span> <span class="ss">as: :logout</span>
</code></pre></div></div>

<p>This will create <code class="language-plaintext highlighter-rouge">logout_path</code> and <code class="language-plaintext highlighter-rouge">logout_url</code> as the route helpers in your application. Calling <code class="language-plaintext highlighter-rouge">logout_path</code> will return <code class="language-plaintext highlighter-rouge">/exit</code>.</p>

<p>You can also use <code class="language-plaintext highlighter-rouge">as</code> to override routing helper names defined by <code class="language-plaintext highlighter-rouge">resources</code> by placing a custom route definition <em>before</em> the resource is defined, like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">":username"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"users#show"</span><span class="p">,</span> <span class="ss">as: :user</span>
<span class="n">resources</span> <span class="ss">:users</span>
</code></pre></div></div>

<p>This will define a <code class="language-plaintext highlighter-rouge">user_path</code> helper that will match <code class="language-plaintext highlighter-rouge">/:username</code> (e.g. <code class="language-plaintext highlighter-rouge">/jane</code>). Inside the <code class="language-plaintext highlighter-rouge">show</code> action of <code class="language-plaintext highlighter-rouge">UsersController</code>, <code class="language-plaintext highlighter-rouge">params[:username]</code> will contain the username for the user.</p>

<h3 id="http-verb-constraints">HTTP Verb Constraints</h3>

<p>In general, you should use the <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-get"><code class="language-plaintext highlighter-rouge">get</code></a>, <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-post"><code class="language-plaintext highlighter-rouge">post</code></a>, <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-put"><code class="language-plaintext highlighter-rouge">put</code></a>, <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-patch"><code class="language-plaintext highlighter-rouge">patch</code></a>, and <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/HttpHelpers.html#method-i-delete"><code class="language-plaintext highlighter-rouge">delete</code></a> methods to constrain a route to a particular verb. There is a <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Base.html#method-i-match"><code class="language-plaintext highlighter-rouge">match</code></a> method that you could use with the <code class="language-plaintext highlighter-rouge">:via</code> option to match multiple verbs at once:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">match</span> <span class="s2">"photos"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#show"</span><span class="p">,</span> <span class="ss">via: </span><span class="p">[</span><span class="ss">:get</span><span class="p">,</span> <span class="ss">:post</span><span class="p">]</span>
</code></pre></div></div>

<p>The above route matches GET and POST requests to the <code class="language-plaintext highlighter-rouge">show</code> action of the <code class="language-plaintext highlighter-rouge">PhotosController</code>.</p>

<p>You can match all verbs to a particular route using <code class="language-plaintext highlighter-rouge">via: :all</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">match</span> <span class="s2">"photos"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#show"</span><span class="p">,</span> <span class="ss">via: :all</span>
</code></pre></div></div>

<p>NOTE: Routing both <code class="language-plaintext highlighter-rouge">GET</code> and <code class="language-plaintext highlighter-rouge">POST</code> requests to a single action has security
implications. For example, the <code class="language-plaintext highlighter-rouge">GET</code> action won’t check for CSRF token (so
writing to the database from <code class="language-plaintext highlighter-rouge">GET</code> request is not a good idea. For more
information see the <a href="security.html#csrf-countermeasures">security guide</a>). In
general, avoid routing all verbs to a single action unless you have a good
reason.</p>

<h3 id="segment-constraints">Segment Constraints</h3>

<p>You can use the <code class="language-plaintext highlighter-rouge">:constraints</code> option to enforce a format for a dynamic segment:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"photos/:id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#show"</span><span class="p">,</span> <span class="ss">constraints: </span><span class="p">{</span> <span class="ss">id: </span><span class="sr">/[A-Z]\d{5}/</span> <span class="p">}</span>
</code></pre></div></div>

<p>The above route definition requires <code class="language-plaintext highlighter-rouge">id</code> to be 5 alphanumeric characters long. Therefore, this route would match paths such as <code class="language-plaintext highlighter-rouge">/photos/A12345</code>, but not <code class="language-plaintext highlighter-rouge">/photos/893</code>. You can more succinctly express the same route this way:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"photos/:id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#show"</span><span class="p">,</span> <span class="ss">id: </span><span class="sr">/[A-Z]\d{5}/</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">:constraints</code> option takes regular expressions (as well as any object that responds to <code class="language-plaintext highlighter-rouge">matches?</code> method) with the restriction that regexp anchors can’t be used. For example, the following route will not work:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/:id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"articles#show"</span><span class="p">,</span> <span class="ss">constraints: </span><span class="p">{</span> <span class="ss">id: </span><span class="sr">/^\d/</span> <span class="p">}</span>
</code></pre></div></div>

<p>However, note that you don’t need to use anchors because all routes are anchored at the start and the end.</p>

<p>For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/:id"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"articles#show"</span><span class="p">,</span> <span class="ss">constraints: </span><span class="p">{</span> <span class="ss">id: </span><span class="sr">/\d.+/</span> <span class="p">}</span>
<span class="n">get</span> <span class="s2">"/:username"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"users#show"</span>
</code></pre></div></div>

<p>The above routes would allow sharing the root namespace and:</p>

<ul>
  <li>route paths that always begin with a number, like <code class="language-plaintext highlighter-rouge">/1-hello-world</code>, to <code class="language-plaintext highlighter-rouge">articles</code> with <code class="language-plaintext highlighter-rouge">id</code> value.</li>
  <li>route paths that never begin with a number, like <code class="language-plaintext highlighter-rouge">/david</code>, to <code class="language-plaintext highlighter-rouge">users</code> with <code class="language-plaintext highlighter-rouge">username</code> value.</li>
</ul>

<h3 id="request-based-constraints">Request-Based Constraints</h3>

<p>You can also constrain a route based on any method on the <a href="action_controller_overview.html#the-request-object">Request object</a> that returns a <code class="language-plaintext highlighter-rouge">String</code>.</p>

<p>You specify a request-based constraint the same way that you specify a segment constraint. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"photos"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#index"</span><span class="p">,</span> <span class="ss">constraints: </span><span class="p">{</span> <span class="ss">subdomain: </span><span class="s2">"admin"</span> <span class="p">}</span>
</code></pre></div></div>

<p>Will match an incoming request with a path to <code class="language-plaintext highlighter-rouge">admin</code> subdomain.</p>

<p>You can also specify constraints by using a <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Scoping.html#method-i-constraints"><code class="language-plaintext highlighter-rouge">constraints</code></a> block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">constraints</span> <span class="ss">subdomain: </span><span class="s2">"admin"</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:photos</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Will match something like <code class="language-plaintext highlighter-rouge">https://admin.example.com/photos</code>.</p>

<p>Request constraints work by calling a method on the <a href="action_controller_overview.html#the-request-object">Request object</a> with the same name as the hash key and then comparing the return value with the hash value. For example: <code class="language-plaintext highlighter-rouge">constraints: { subdomain: 'api' }</code> will match an <code class="language-plaintext highlighter-rouge">api</code> subdomain as expected. However, using a symbol <code class="language-plaintext highlighter-rouge">constraints: { subdomain: :api }</code> will not, because <code class="language-plaintext highlighter-rouge">request.subdomain</code> returns <code class="language-plaintext highlighter-rouge">'api'</code> as a String.</p>

<p>NOTE: Constraint values should match the corresponding Request object method return type.</p>

<p>There is an exception for the <code class="language-plaintext highlighter-rouge">format</code> constraint, while it’s a method on the Request object, it’s also an implicit optional parameter on every path. Segment constraints take precedence and the <code class="language-plaintext highlighter-rouge">format</code> constraint is only applied when enforced through a hash. For example, <code class="language-plaintext highlighter-rouge">get 'foo', constraints: { format: 'json' }</code> will match <code class="language-plaintext highlighter-rouge">GET  /foo</code> because the format is optional by default.</p>

<p>NOTE: You can <a href="#advanced-constraints">use a lambda</a> like in <code class="language-plaintext highlighter-rouge">get 'foo', constraints: lambda { |req| req.format == :json }</code> to only match the route to explicit JSON requests.</p>

<h3 id="advanced-constraints">Advanced Constraints</h3>

<p>If you have a more advanced constraint, you can provide an object that responds to <code class="language-plaintext highlighter-rouge">matches?</code> that Rails should use. Let’s say you wanted to route all users on a restricted list to the <code class="language-plaintext highlighter-rouge">RestrictedListController</code>. You could do:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RestrictedListConstraint</span>
  <span class="k">def</span> <span class="nf">initialize</span>
    <span class="vi">@ips</span> <span class="o">=</span> <span class="no">RestrictedList</span><span class="p">.</span><span class="nf">retrieve_ips</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">matches?</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="vi">@ips</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">remote_ip</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s2">"*path"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"restricted_list#index"</span><span class="p">,</span>
    <span class="ss">constraints: </span><span class="no">RestrictedListConstraint</span><span class="p">.</span><span class="nf">new</span>
<span class="k">end</span>
</code></pre></div></div>

<p>You can also specify constraints as a lambda:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s2">"*path"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"restricted_list#index"</span><span class="p">,</span>
    <span class="ss">constraints: </span><span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">request</span><span class="o">|</span> <span class="no">RestrictedList</span><span class="p">.</span><span class="nf">retrieve_ips</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">remote_ip</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Both the <code class="language-plaintext highlighter-rouge">matches?</code> method and the lambda gets the <code class="language-plaintext highlighter-rouge">request</code> object as an argument.</p>

<h4 id="constraints-in-a-block-form">Constraints in a Block Form</h4>

<p>You can specify constraints in a block form. This is useful for when you need to apply the same rule to several routes. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RestrictedListConstraint</span>
  <span class="c1"># ...Same as the example above</span>
<span class="k">end</span>

<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
  <span class="n">constraints</span><span class="p">(</span><span class="no">RestrictedListConstraint</span><span class="p">.</span><span class="nf">new</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">get</span> <span class="s2">"*path"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"restricted_list#index"</span>
    <span class="n">get</span> <span class="s2">"*other-path"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"other_restricted_list#index"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>You can also use a <code class="language-plaintext highlighter-rouge">lambda</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
  <span class="n">constraints</span><span class="p">(</span><span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">request</span><span class="o">|</span> <span class="no">RestrictedList</span><span class="p">.</span><span class="nf">retrieve_ips</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="nf">remote_ip</span><span class="p">)</span> <span class="p">})</span> <span class="k">do</span>
    <span class="n">get</span> <span class="s2">"*path"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"restricted_list#index"</span>
    <span class="n">get</span> <span class="s2">"*other-path"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"other_restricted_list#index"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="wildcard-segments">Wildcard Segments</h3>

<p>A route definition can have a wildcard segment, which is a segment prefixed with a star, such as <code class="language-plaintext highlighter-rouge">*other</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"photos/*other"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"photos#unknown"</span>
</code></pre></div></div>

<p>Wildcard segments allow for something called “route globbing”, which is a way to specify that a particular parameter (<code class="language-plaintext highlighter-rouge">*other</code> above) be matched to the remaining part of a route.</p>

<p>So the above route would match <code class="language-plaintext highlighter-rouge">photos/12</code> or <code class="language-plaintext highlighter-rouge">/photos/long/path/to/12</code>, setting <code class="language-plaintext highlighter-rouge">params[:other]</code> to <code class="language-plaintext highlighter-rouge">"12"</code> or <code class="language-plaintext highlighter-rouge">"long/path/to/12"</code>.</p>

<p>Wildcard segments can occur anywhere in a route. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"books/*section/:title"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"books#show"</span>
</code></pre></div></div>

<p>would match <code class="language-plaintext highlighter-rouge">books/some/section/last-words-a-memoir</code> with <code class="language-plaintext highlighter-rouge">params[:section]</code> equals <code class="language-plaintext highlighter-rouge">'some/section'</code>, and <code class="language-plaintext highlighter-rouge">params[:title]</code> equals <code class="language-plaintext highlighter-rouge">'last-words-a-memoir'</code>.</p>

<p>Technically, a route can have even more than one wildcard segment. The matcher assigns segments to parameters in the order they occur. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"*a/foo/*b"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"test#index"</span>
</code></pre></div></div>

<p>would match <code class="language-plaintext highlighter-rouge">zoo/woo/foo/bar/baz</code> with <code class="language-plaintext highlighter-rouge">params[:a]</code> equals <code class="language-plaintext highlighter-rouge">'zoo/woo'</code>, and <code class="language-plaintext highlighter-rouge">params[:b]</code> equals <code class="language-plaintext highlighter-rouge">'bar/baz'</code>.</p>

<h3 id="format-segments">Format Segments</h3>

<p>Given this route definition:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"*pages"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"pages#show"</span>
</code></pre></div></div>

<p>By requesting <code class="language-plaintext highlighter-rouge">'/foo/bar.json'</code>, your <code class="language-plaintext highlighter-rouge">params[:pages]</code> will be equal to <code class="language-plaintext highlighter-rouge">'foo/bar'</code> with the request format of JSON in <code class="language-plaintext highlighter-rouge">params[:format]</code>.</p>

<p>The default behavior with <code class="language-plaintext highlighter-rouge">format</code> is that if included Rails automatically captures it from the URL and includes it in params[:format], but <code class="language-plaintext highlighter-rouge">format</code> is not required in a URL.</p>

<p>If you want to match URLs without an explicit format and ignore URLs that include a format extension, you could supply <code class="language-plaintext highlighter-rouge">format: false</code> like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"*pages"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"pages#show"</span><span class="p">,</span> <span class="ss">format: </span><span class="kp">false</span>
</code></pre></div></div>

<p>If you want to make the format segment mandatory, so it cannot be omitted, you can supply <code class="language-plaintext highlighter-rouge">format: true</code> like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"*pages"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"pages#show"</span><span class="p">,</span> <span class="ss">format: </span><span class="kp">true</span>
</code></pre></div></div>

<h3 id="redirection">Redirection</h3>

<p>You can redirect any path to any other path by using the <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Redirection.html#method-i-redirect"><code class="language-plaintext highlighter-rouge">redirect</code></a> helper in your router:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/stories"</span><span class="p">,</span> <span class="ss">to: </span><span class="n">redirect</span><span class="p">(</span><span class="s2">"/articles"</span><span class="p">)</span>
</code></pre></div></div>

<p>You can also reuse dynamic segments from the match in the path to redirect to:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/stories/:name"</span><span class="p">,</span> <span class="ss">to: </span><span class="n">redirect</span><span class="p">(</span><span class="s2">"/articles/%{name}"</span><span class="p">)</span>
</code></pre></div></div>

<p>You can also provide a block to <code class="language-plaintext highlighter-rouge">redirect</code>, which receives the symbolized path parameters and the request object:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/stories/:name"</span><span class="p">,</span> <span class="ss">to: </span><span class="n">redirect</span> <span class="p">{</span> <span class="o">|</span><span class="n">path_params</span><span class="p">,</span> <span class="n">req</span><span class="o">|</span> <span class="s2">"/articles/</span><span class="si">#{</span><span class="n">path_params</span><span class="p">[</span><span class="ss">:name</span><span class="p">].</span><span class="nf">pluralize</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
<span class="n">get</span> <span class="s2">"/stories"</span><span class="p">,</span> <span class="ss">to: </span><span class="n">redirect</span> <span class="p">{</span> <span class="o">|</span><span class="n">path_params</span><span class="p">,</span> <span class="n">req</span><span class="o">|</span> <span class="s2">"/articles/</span><span class="si">#{</span><span class="n">req</span><span class="p">.</span><span class="nf">subdomain</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
</code></pre></div></div>

<p>Please note that default redirection is a 301 “Moved Permanently” redirect. Keep in mind that some web browsers or proxy servers will cache this type of redirect, making the old page inaccessible. You can use the <code class="language-plaintext highlighter-rouge">:status</code> option to change the response status:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"/stories/:name"</span><span class="p">,</span> <span class="ss">to: </span><span class="n">redirect</span><span class="p">(</span><span class="s2">"/articles/%{name}"</span><span class="p">,</span> <span class="ss">status: </span><span class="mi">302</span><span class="p">)</span>
</code></pre></div></div>

<p>In all of these cases, if you don’t provide the host (<code class="language-plaintext highlighter-rouge">http://www.example.com</code>), Rails will take those details from the current request.</p>

<h3 id="routing-to-rack-applications">Routing to Rack Applications</h3>

<p>Instead of specifying <code class="language-plaintext highlighter-rouge">:to</code> as a String like <code class="language-plaintext highlighter-rouge">'articles#index'</code>, which corresponds to the <code class="language-plaintext highlighter-rouge">index</code> method in the <code class="language-plaintext highlighter-rouge">ArticlesController</code> class, you can specify any <a href="rails_on_rack.html">Rack application</a> as the endpoint for a matcher:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">match</span> <span class="s2">"/application.js"</span><span class="p">,</span> <span class="ss">to: </span><span class="no">MyRackApp</span><span class="p">,</span> <span class="ss">via: :all</span>
</code></pre></div></div>

<p>As long as <code class="language-plaintext highlighter-rouge">MyRackApp</code> responds to <code class="language-plaintext highlighter-rouge">call</code> and returns a <code class="language-plaintext highlighter-rouge">[status, headers, body]</code>, the router won’t know the difference between the Rack application and a controller action. This is an appropriate use of <code class="language-plaintext highlighter-rouge">via: :all</code>, as you will want to allow your Rack application to handle all verbs.</p>

<p>NOTE: An interesting tidbit - <code class="language-plaintext highlighter-rouge">'articles#index'</code> expands out to <code class="language-plaintext highlighter-rouge">ArticlesController.action(:index)</code>, which returns a valid Rack application.</p>

<p>NOTE: Since procs/lambdas are objects that respond to <code class="language-plaintext highlighter-rouge">call</code>, you can implement very simple routes (e.g. for health checks) inline, something like: <code class="language-plaintext highlighter-rouge">get '/health', to: -&gt;(env) { [204, {}, ['']] }</code></p>

<p>If you specify a Rack application as the endpoint for a matcher, remember that
the route will be unchanged in the receiving application. With the following
route your Rack application should expect the route to be <code class="language-plaintext highlighter-rouge">/admin</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">match</span> <span class="s2">"/admin"</span><span class="p">,</span> <span class="ss">to: </span><span class="no">AdminApp</span><span class="p">,</span> <span class="ss">via: :all</span>
</code></pre></div></div>

<p>If you would prefer to have your Rack application receive requests at the root
path instead, use <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Base.html#method-i-mount"><code class="language-plaintext highlighter-rouge">mount</code></a>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mount</span> <span class="no">AdminApp</span><span class="p">,</span> <span class="ss">at: </span><span class="s2">"/admin"</span>
</code></pre></div></div>

<h3 id="using-root">Using <code class="language-plaintext highlighter-rouge">root</code></h3>

<p>You can specify what Rails should route <code class="language-plaintext highlighter-rouge">'/'</code> to with the <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Resources.html#method-i-root"><code class="language-plaintext highlighter-rouge">root</code></a> method:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span> <span class="ss">to: </span><span class="s2">"pages#main"</span>
<span class="n">root</span> <span class="s2">"pages#main"</span> <span class="c1"># shortcut for the above</span>
</code></pre></div></div>

<p>You typically put the <code class="language-plaintext highlighter-rouge">root</code> route at the top of the file so that it can be matched first.</p>

<p>NOTE: The <code class="language-plaintext highlighter-rouge">root</code> route primarily handles <code class="language-plaintext highlighter-rouge">GET</code> requests by default. But it is possible to configure it to handle other verbs (e.g. <code class="language-plaintext highlighter-rouge">root "posts#index", via: :post</code>)</p>

<p>You can also use root inside namespaces and scopes as well:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span> <span class="ss">to: </span><span class="s2">"home#index"</span>

<span class="n">namespace</span> <span class="ss">:admin</span> <span class="k">do</span>
  <span class="n">root</span> <span class="ss">to: </span><span class="s2">"admin#index"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The above will match <code class="language-plaintext highlighter-rouge">/admin</code> to the <code class="language-plaintext highlighter-rouge">index</code> action for the <code class="language-plaintext highlighter-rouge">AdminController</code> and match <code class="language-plaintext highlighter-rouge">/</code> to <code class="language-plaintext highlighter-rouge">index</code> action of the <code class="language-plaintext highlighter-rouge">HomeController</code>.</p>

<h3 id="unicode-character-routes">Unicode Character Routes</h3>

<p>You can specify unicode character routes directly. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span> <span class="s2">"こんにちは"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"welcome#index"</span>
</code></pre></div></div>

<h3 id="direct-routes">Direct Routes</h3>

<p>You can create custom URL helpers by calling <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/CustomUrls.html#method-i-direct"><code class="language-plaintext highlighter-rouge">direct</code></a>. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">direct</span> <span class="ss">:homepage</span> <span class="k">do</span>
  <span class="s2">"https://rubyonrails.org"</span>
<span class="k">end</span>

<span class="c1"># &gt;&gt; homepage_url</span>
<span class="c1"># =&gt; "https://rubyonrails.org"</span>
</code></pre></div></div>

<p>The return value of the block must be a valid argument for the <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/UrlFor.html"><code class="language-plaintext highlighter-rouge">url_for</code></a> method. So, you can pass a valid string URL, Hash, Array, an Active Model instance, or an Active Model class.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">direct</span> <span class="ss">:commentable</span> <span class="k">do</span> <span class="o">|</span><span class="n">model</span><span class="o">|</span>
  <span class="p">[</span> <span class="n">model</span><span class="p">,</span> <span class="ss">anchor: </span><span class="n">model</span><span class="p">.</span><span class="nf">dom_id</span> <span class="p">]</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">direct</span> <span class="ss">:main</span> <span class="k">do</span>
  <span class="p">{</span> <span class="ss">controller: </span><span class="s2">"pages"</span><span class="p">,</span> <span class="ss">action: </span><span class="s2">"index"</span><span class="p">,</span> <span class="ss">subdomain: </span><span class="s2">"www"</span> <span class="p">}</span>
<span class="k">end</span>

<span class="c1"># &gt;&gt; main_url</span>
<span class="c1"># =&gt; "http://www.example.com/pages"</span>
</code></pre></div></div>

<h3 id="using-resolve">Using <code class="language-plaintext highlighter-rouge">resolve</code></h3>

<p>The <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/CustomUrls.html#method-i-resolve"><code class="language-plaintext highlighter-rouge">resolve</code></a> method allows customizing polymorphic mapping of models. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resource</span> <span class="ss">:basket</span>

<span class="n">resolve</span><span class="p">(</span><span class="s2">"Basket"</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="ss">:basket</span><span class="p">]</span> <span class="p">}</span>
</code></pre></div></div>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@basket</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="c">&lt;!-- basket form --&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>This will generate the singular URL <code class="language-plaintext highlighter-rouge">/basket</code> instead of the usual <code class="language-plaintext highlighter-rouge">/baskets/:id</code>.</p>

<h2 id="customizing-resourceful-routes">Customizing Resourceful Routes</h2>

<p>While the default routes and helpers generated by <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Resources.html#method-i-resources"><code class="language-plaintext highlighter-rouge">resources</code></a> will usually serve you well, you may need to customize them in some way. Rails allows for several different ways to customize the resourceful routes and helpers. This section will detail the available options.</p>

<h3 id="specifying-a-controller-to-use">Specifying a Controller to Use</h3>

<p>The <code class="language-plaintext highlighter-rouge">:controller</code> option lets you explicitly specify a controller to use for the resource. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">controller: </span><span class="s2">"images"</span>
</code></pre></div></div>

<p>will recognize incoming paths beginning with <code class="language-plaintext highlighter-rouge">/photos</code> but route to the <code class="language-plaintext highlighter-rouge">Images</code> controller:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Named Route Helper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/photos</td>
      <td>images#index</td>
      <td>photos_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/photos/new</td>
      <td>images#new</td>
      <td>new_photo_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/photos</td>
      <td>images#create</td>
      <td>photos_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/photos/:id</td>
      <td>images#show</td>
      <td>photo_path(:id)</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/photos/:id/edit</td>
      <td>images#edit</td>
      <td>edit_photo_path(:id)</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/photos/:id</td>
      <td>images#update</td>
      <td>photo_path(:id)</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/photos/:id</td>
      <td>images#destroy</td>
      <td>photo_path(:id)</td>
    </tr>
  </tbody>
</table>

<p>For namespaced controllers you can use the directory notation. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:user_permissions</span><span class="p">,</span> <span class="ss">controller: </span><span class="s2">"admin/user_permissions"</span>
</code></pre></div></div>

<p>This will route to the <code class="language-plaintext highlighter-rouge">Admin::UserPermissionsController</code> instance.</p>

<p>NOTE: Only the directory notation is supported. Specifying the controller with
Ruby constant notation (e.g. <code class="language-plaintext highlighter-rouge">controller: 'Admin::UserPermissions'</code>) is not supported.</p>

<h3 id="specifying-constraints-on-id">Specifying Constraints on <code class="language-plaintext highlighter-rouge">id</code></h3>

<p>You can use the <code class="language-plaintext highlighter-rouge">:constraints</code> option to specify a required format on the implicit <code class="language-plaintext highlighter-rouge">id</code>. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">constraints: </span><span class="p">{</span> <span class="ss">id: </span><span class="sr">/[A-Z][A-Z][0-9]+/</span> <span class="p">}</span>
</code></pre></div></div>

<p>This declaration constrains the <code class="language-plaintext highlighter-rouge">:id</code> parameter to match the given regular expression. The router would no longer match <code class="language-plaintext highlighter-rouge">/photos/1</code> to this route. Instead, <code class="language-plaintext highlighter-rouge">/photos/RR27</code> would match.</p>

<p>You can specify a single constraint to apply to a number of routes by using the block form:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">constraints</span><span class="p">(</span><span class="ss">id: </span><span class="sr">/[A-Z][A-Z][0-9]+/</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:photos</span>
  <span class="n">resources</span> <span class="ss">:accounts</span>
<span class="k">end</span>
</code></pre></div></div>

<p>NOTE: You can use the more <a href="#advanced-constraints">advanced constraints</a> available in non-resourceful routes section in this context as well.</p>

<p>TIP: By default the <code class="language-plaintext highlighter-rouge">:id</code> parameter doesn’t accept dots - this is because the dot is used as a separator for formatted routes. If you need to use a dot within an <code class="language-plaintext highlighter-rouge">:id</code> add a constraint which overrides this - for example <code class="language-plaintext highlighter-rouge">id: /[^\/]+/</code> allows anything except a slash.</p>

<h3 id="overriding-the-named-route-helpers">Overriding the Named Route Helpers</h3>

<p>The <code class="language-plaintext highlighter-rouge">:as</code> option lets you override the default naming for the route helpers. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">as: </span><span class="s2">"images"</span>
</code></pre></div></div>

<p>This will match <code class="language-plaintext highlighter-rouge">/photos</code> and route the requests to <code class="language-plaintext highlighter-rouge">PhotosController</code> as usual, <em>but</em> use the value of the <code class="language-plaintext highlighter-rouge">:as</code> option to name the helpers <code class="language-plaintext highlighter-rouge">images_path</code> etc., as shown:</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Named Route Helper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/photos</td>
      <td>photos#index</td>
      <td>images_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/photos/new</td>
      <td>photos#new</td>
      <td>new_image_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/photos</td>
      <td>photos#create</td>
      <td>images_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/photos/:id</td>
      <td>photos#show</td>
      <td>image_path(:id)</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/photos/:id/edit</td>
      <td>photos#edit</td>
      <td>edit_image_path(:id)</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/photos/:id</td>
      <td>photos#update</td>
      <td>image_path(:id)</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/photos/:id</td>
      <td>photos#destroy</td>
      <td>image_path(:id)</td>
    </tr>
  </tbody>
</table>

<h3 id="renaming-the-new-and-edit-path-names">Renaming the <code class="language-plaintext highlighter-rouge">new</code> and <code class="language-plaintext highlighter-rouge">edit</code> Path Names</h3>

<p>The <code class="language-plaintext highlighter-rouge">:path_names</code> option lets you override the default <code class="language-plaintext highlighter-rouge">new</code> and <code class="language-plaintext highlighter-rouge">edit</code> segment in paths. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">path_names: </span><span class="p">{</span> <span class="ss">new: </span><span class="s2">"make"</span><span class="p">,</span> <span class="ss">edit: </span><span class="s2">"change"</span> <span class="p">}</span>
</code></pre></div></div>

<p>This would allow paths such as <code class="language-plaintext highlighter-rouge">/photos/make</code> and <code class="language-plaintext highlighter-rouge">/photos/1/change</code> instead of <code class="language-plaintext highlighter-rouge">/photos/new</code> and <code class="language-plaintext highlighter-rouge">/photos/1/edit</code>.</p>

<p>NOTE: The route helpers and controller action names aren’t changed by this option. The two paths shown would have <code class="language-plaintext highlighter-rouge">new_photo_path</code> and <code class="language-plaintext highlighter-rouge">edit_photo_path</code> helpers and still route to the <code class="language-plaintext highlighter-rouge">new</code> and <code class="language-plaintext highlighter-rouge">edit</code> actions.</p>

<p>It is also possible to change this option uniformly for all of your routes by using a <code class="language-plaintext highlighter-rouge">scope</code> block:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scope</span> <span class="ss">path_names: </span><span class="p">{</span> <span class="ss">new: </span><span class="s2">"make"</span> <span class="p">}</span> <span class="k">do</span>
  <span class="c1"># rest of your routes</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="prefixing-the-named-route-helpers-with-as">Prefixing the Named Route Helpers with <code class="language-plaintext highlighter-rouge">:as</code></h3>

<p>You can use the <code class="language-plaintext highlighter-rouge">:as</code> option to prefix the named route helpers that Rails generates for a route. Use this option to prevent name collisions between routes using a path scope. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scope</span> <span class="s2">"admin"</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">as: </span><span class="s2">"admin_photos"</span>
<span class="k">end</span>

<span class="n">resources</span> <span class="ss">:photos</span>
</code></pre></div></div>

<p>This changes the route helpers for <code class="language-plaintext highlighter-rouge">/admin/photos</code> from <code class="language-plaintext highlighter-rouge">photos_path</code>,
<code class="language-plaintext highlighter-rouge">new_photos_path</code>, etc. to <code class="language-plaintext highlighter-rouge">admin_photos_path</code>, <code class="language-plaintext highlighter-rouge">new_admin_photo_path</code>, etc.
Without the addition of <code class="language-plaintext highlighter-rouge">as: 'admin_photos'</code> on the scoped <code class="language-plaintext highlighter-rouge">resources :photos</code>,
the non-scoped <code class="language-plaintext highlighter-rouge">resources :photos</code> will not have any route helpers.</p>

<p>To prefix a group of route helpers, use <code class="language-plaintext highlighter-rouge">:as</code> with <code class="language-plaintext highlighter-rouge">scope</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scope</span> <span class="s2">"admin"</span><span class="p">,</span> <span class="ss">as: </span><span class="s2">"admin"</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">:accounts</span>
<span class="k">end</span>

<span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">:accounts</span>
</code></pre></div></div>

<p>Just as before, this changes the <code class="language-plaintext highlighter-rouge">/admin</code> scoped resource helpers to
<code class="language-plaintext highlighter-rouge">admin_photos_path</code> and <code class="language-plaintext highlighter-rouge">admin_accounts_path</code>, and allows the non-scoped
resources to use <code class="language-plaintext highlighter-rouge">photos_path</code> and <code class="language-plaintext highlighter-rouge">accounts_path</code>.</p>

<p>NOTE: The <code class="language-plaintext highlighter-rouge">namespace</code> scope will automatically add <code class="language-plaintext highlighter-rouge">:as</code> as well as <code class="language-plaintext highlighter-rouge">:module</code> and <code class="language-plaintext highlighter-rouge">:path</code> prefixes.</p>

<h3 id="using-as-in-nested-resources">Using <code class="language-plaintext highlighter-rouge">:as</code> in Nested Resources</h3>

<p>The <code class="language-plaintext highlighter-rouge">:as</code> option can override routing helper names for resources in nested routes as well. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:magazines</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:ads</span><span class="p">,</span> <span class="ss">as: </span><span class="s2">"periodical_ads"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This will create routing helpers such as <code class="language-plaintext highlighter-rouge">magazine_periodical_ads_url</code> and <code class="language-plaintext highlighter-rouge">edit_magazine_periodical_ad_path</code> instead of the default <code class="language-plaintext highlighter-rouge">magazine_ads_url</code> and <code class="language-plaintext highlighter-rouge">edit_magazine_ad_path</code>.</p>

<h3 id="parametric-scopes">Parametric Scopes</h3>

<p>You can prefix routes with a named parameter:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scope</span> <span class="s2">":account_id"</span><span class="p">,</span> <span class="ss">as: </span><span class="s2">"account"</span><span class="p">,</span> <span class="ss">constraints: </span><span class="p">{</span> <span class="ss">account_id: </span><span class="sr">/\d+/</span> <span class="p">}</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:articles</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This will provide you with paths such as <code class="language-plaintext highlighter-rouge">/1/articles/9</code> and will allow you to reference the <code class="language-plaintext highlighter-rouge">account_id</code> part of the path as <code class="language-plaintext highlighter-rouge">params[:account_id]</code> in controllers, helpers, and views.</p>

<p>It will also generate path and URL helpers prefixed with <code class="language-plaintext highlighter-rouge">account_</code>, into which you can pass your objects as expected:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">account_article_path</span><span class="p">(</span><span class="vi">@account</span><span class="p">,</span> <span class="vi">@article</span><span class="p">)</span> <span class="c1"># =&gt; /1/article/9</span>
<span class="n">url_for</span><span class="p">([</span><span class="vi">@account</span><span class="p">,</span> <span class="vi">@article</span><span class="p">])</span>            <span class="c1"># =&gt; /1/article/9</span>
<span class="n">form_with</span><span class="p">(</span><span class="ss">model: </span><span class="p">[</span><span class="vi">@account</span><span class="p">,</span> <span class="vi">@article</span><span class="p">])</span>   <span class="c1"># =&gt; &lt;form action="/1/article/9" ...&gt;</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">:as</code> option is also not mandatory, but without it, Rails will raise an error when evaluating <code class="language-plaintext highlighter-rouge">url_for([@account, @article])</code> or other helpers that rely on <code class="language-plaintext highlighter-rouge">url_for</code>, such as <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_with"><code class="language-plaintext highlighter-rouge">form_with</code></a>.</p>

<h3 id="restricting-the-routes-created">Restricting the Routes Created</h3>

<p>By default, using <code class="language-plaintext highlighter-rouge">resources</code> creates routes for the seven default actions (<code class="language-plaintext highlighter-rouge">index</code>, <code class="language-plaintext highlighter-rouge">show</code>, <code class="language-plaintext highlighter-rouge">new</code>, <code class="language-plaintext highlighter-rouge">create</code>, <code class="language-plaintext highlighter-rouge">edit</code>, <code class="language-plaintext highlighter-rouge">update</code>, and <code class="language-plaintext highlighter-rouge">destroy</code>). You can use the <code class="language-plaintext highlighter-rouge">:only</code> and <code class="language-plaintext highlighter-rouge">:except</code> options to limit which routes are created.</p>

<p>The <code class="language-plaintext highlighter-rouge">:only</code> option tells Rails to create only the specified routes:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:index</span><span class="p">,</span> <span class="ss">:show</span><span class="p">]</span>
</code></pre></div></div>

<p>Now, a <code class="language-plaintext highlighter-rouge">GET</code> request to <code class="language-plaintext highlighter-rouge">/photos</code> or <code class="language-plaintext highlighter-rouge">/photos/:id</code> would succeed, but a <code class="language-plaintext highlighter-rouge">POST</code> request to <code class="language-plaintext highlighter-rouge">/photos</code> will fail to match.</p>

<p>The <code class="language-plaintext highlighter-rouge">:except</code> option specifies a route or list of routes that Rails should <em>not</em> create:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:photos</span><span class="p">,</span> <span class="ss">except: :destroy</span>
</code></pre></div></div>

<p>In this case, Rails will create all of the normal routes except the route for <code class="language-plaintext highlighter-rouge">destroy</code> (a <code class="language-plaintext highlighter-rouge">DELETE</code> request to <code class="language-plaintext highlighter-rouge">/photos/:id</code>).</p>

<p>TIP: If your application has many RESTful routes, using <code class="language-plaintext highlighter-rouge">:only</code> and <code class="language-plaintext highlighter-rouge">:except</code> to
generate only the routes that you actually need can cut down on memory use and
speed up the routing process by eliminating <a href="#listing-unused-routes">unused
routes</a>.</p>

<h3 id="translated-paths">Translated Paths</h3>

<p>Using <code class="language-plaintext highlighter-rouge">scope</code>, we can alter path names generated by <code class="language-plaintext highlighter-rouge">resources</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scope</span><span class="p">(</span><span class="ss">path_names: </span><span class="p">{</span> <span class="ss">new: </span><span class="s2">"neu"</span><span class="p">,</span> <span class="ss">edit: </span><span class="s2">"bearbeiten"</span> <span class="p">})</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:categories</span><span class="p">,</span> <span class="ss">path: </span><span class="s2">"kategorien"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Rails now creates routes to the <code class="language-plaintext highlighter-rouge">CategoriesController</code>.</p>

<table>
  <thead>
    <tr>
      <th>HTTP Verb</th>
      <th>Path</th>
      <th>Controller#Action</th>
      <th>Named Route Helper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>/kategorien</td>
      <td>categories#index</td>
      <td>categories_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/kategorien/neu</td>
      <td>categories#new</td>
      <td>new_category_path</td>
    </tr>
    <tr>
      <td>POST</td>
      <td>/kategorien</td>
      <td>categories#create</td>
      <td>categories_path</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/kategorien/:id</td>
      <td>categories#show</td>
      <td>category_path(:id)</td>
    </tr>
    <tr>
      <td>GET</td>
      <td>/kategorien/:id/bearbeiten</td>
      <td>categories#edit</td>
      <td>edit_category_path(:id)</td>
    </tr>
    <tr>
      <td>PATCH/PUT</td>
      <td>/kategorien/:id</td>
      <td>categories#update</td>
      <td>category_path(:id)</td>
    </tr>
    <tr>
      <td>DELETE</td>
      <td>/kategorien/:id</td>
      <td>categories#destroy</td>
      <td>category_path(:id)</td>
    </tr>
  </tbody>
</table>

<h3 id="specifying-the-singular-form-of-a-resource">Specifying the Singular Form of a Resource</h3>

<p>If you need to override the singular form of a resource, you can add a rule to Active Support Inflector via <a href="https://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-inflections"><code class="language-plaintext highlighter-rouge">inflections</code></a>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Inflector</span><span class="p">.</span><span class="nf">inflections</span> <span class="k">do</span> <span class="o">|</span><span class="n">inflect</span><span class="o">|</span>
  <span class="n">inflect</span><span class="p">.</span><span class="nf">irregular</span> <span class="s2">"tooth"</span><span class="p">,</span> <span class="s2">"teeth"</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="renaming-default-route-parameter-id">Renaming Default Route Parameter <code class="language-plaintext highlighter-rouge">id</code></h3>

<p>It is possible to rename the default parameter name <code class="language-plaintext highlighter-rouge">id</code> with the <code class="language-plaintext highlighter-rouge">:param</code> option. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resources</span> <span class="ss">:videos</span><span class="p">,</span> <span class="ss">param: :identifier</span>
</code></pre></div></div>

<p>Will now use <code class="language-plaintext highlighter-rouge">params[:identifier]</code> instead of <code class="language-plaintext highlighter-rouge">params[:id]</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    videos GET  /videos(.:format)                  videos#index
           POST /videos(.:format)                  videos#create
 new_video GET  /videos/new(.:format)              videos#new
edit_video GET  /videos/:identifier/edit(.:format) videos#edit
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Video</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:identifier</span><span class="p">])</span>

<span class="c1"># Instead of</span>
<span class="no">Video</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
</code></pre></div></div>

<p>You can override <a href="https://api.rubyonrails.org/classes/ActiveRecord/Integration.html#method-i-to_param"><code class="language-plaintext highlighter-rouge">ActiveRecord::Base#to_param</code></a> of the associated model to construct a URL:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Video</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="k">def</span> <span class="nf">to_param</span>
    <span class="n">identifier</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">video</span> <span class="o">=</span> <span class="no">Video</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">identifier: </span><span class="s2">"Roman-Holiday"</span><span class="p">)</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">edit_video_path</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="s2">"/videos/Roman-Holiday/edit"</span>
</code></pre></div></div>

<h2 id="inspecting-routes">Inspecting Routes</h2>

<p>Rails offers a few different ways of inspecting and testing your routes.</p>

<h3 id="listing-existing-routes">Listing Existing Routes</h3>

<p>To get a complete list of routes available in an application, visit <code class="language-plaintext highlighter-rouge">http://localhost:3000/rails/info/routes</code> in the <strong>development</strong> environment. You can also execute the <code class="language-plaintext highlighter-rouge">bin/rails routes</code> command in your terminal to get the same output.</p>

<p>Both methods will list all of your routes, in the same order that they appear in <code class="language-plaintext highlighter-rouge">config/routes.rb</code>. For each route, you’ll see:</p>

<ul>
  <li>The route name (if any)</li>
  <li>The HTTP verb used (if the route doesn’t respond to all verbs)</li>
  <li>The URL pattern to match</li>
  <li>The routing parameters for the route</li>
</ul>

<p>For example, here’s a small section of the <code class="language-plaintext highlighter-rouge">bin/rails routes</code> output for a RESTful route:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    users GET    /users(.:format)          users#index
          POST   /users(.:format)          users#create
 new_user GET    /users/new(.:format)      users#new
edit_user GET    /users/:id/edit(.:format) users#edit
</code></pre></div></div>

<p>The route name (<code class="language-plaintext highlighter-rouge">new_user</code> above, for example) can be considered the base for deriving route helpers. To get the name of a route helper, add the suffix <code class="language-plaintext highlighter-rouge">_path</code> or <code class="language-plaintext highlighter-rouge">_url</code> to the route name (<code class="language-plaintext highlighter-rouge">new_user_path</code>, for example).</p>

<p>You can also use the <code class="language-plaintext highlighter-rouge">--expanded</code> option to turn on the expanded table formatting mode.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bin/rails routes <span class="nt">--expanded</span>

<span class="nt">--</span><span class="o">[</span> Route 1 <span class="o">]</span><span class="nt">----------------------------------------------------</span>
Prefix            | <span class="nb">users
</span>Verb              | GET
URI               | /users<span class="o">(</span>.:format<span class="o">)</span>
Controller#Action | <span class="nb">users</span><span class="c">#index</span>
<span class="nt">--</span><span class="o">[</span> Route 2 <span class="o">]</span><span class="nt">----------------------------------------------------</span>
Prefix            |
Verb              | POST
URI               | /users<span class="o">(</span>.:format<span class="o">)</span>
Controller#Action | <span class="nb">users</span><span class="c">#create</span>
<span class="nt">--</span><span class="o">[</span> Route 3 <span class="o">]</span><span class="nt">----------------------------------------------------</span>
Prefix            | new_user
Verb              | GET
URI               | /users/new<span class="o">(</span>.:format<span class="o">)</span>
Controller#Action | <span class="nb">users</span><span class="c">#new</span>
<span class="nt">--</span><span class="o">[</span> Route 4 <span class="o">]</span><span class="nt">----------------------------------------------------</span>
Prefix            | edit_user
Verb              | GET
URI               | /users/:id/edit<span class="o">(</span>.:format<span class="o">)</span>
Controller#Action | <span class="nb">users</span><span class="c">#edit</span>
</code></pre></div></div>

<h3 id="searching-routes">Searching Routes</h3>

<p>You can search through your routes with the grep option: <code class="language-plaintext highlighter-rouge">-g</code>. This outputs any routes that partially match the URL helper method name, the HTTP verb, or the URL path.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bin/rails routes <span class="nt">-g</span> new_comment
<span class="nv">$ </span>bin/rails routes <span class="nt">-g</span> POST
<span class="nv">$ </span>bin/rails routes <span class="nt">-g</span> admin
</code></pre></div></div>

<p>If you only want to see the routes that map to a specific controller, there’s the controller option: <code class="language-plaintext highlighter-rouge">-c</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bin/rails routes <span class="nt">-c</span> <span class="nb">users</span>
<span class="nv">$ </span>bin/rails routes <span class="nt">-c</span> admin/users
<span class="nv">$ </span>bin/rails routes <span class="nt">-c</span> Comments
<span class="nv">$ </span>bin/rails routes <span class="nt">-c</span> Articles::CommentsController
</code></pre></div></div>

<p>TIP: The output from <code class="language-plaintext highlighter-rouge">bin/rails routes</code> is easier to read if you widen your terminal window until the output lines don’t wrap or use the <code class="language-plaintext highlighter-rouge">--expanded</code> option.</p>

<h3 id="listing-unused-routes">Listing Unused Routes</h3>

<p>You can scan your application for unused routes with the <code class="language-plaintext highlighter-rouge">--unused</code> option. An “unused” route in Rails is a route that is defined in the config/routes.rb file but is not referenced by any controller action or view in your application. For example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bin/rails routes <span class="nt">--unused</span>
Found 8 unused routes:

     Prefix Verb   URI Pattern                Controller#Action
     people GET    /people<span class="o">(</span>.:format<span class="o">)</span>          people#index
            POST   /people<span class="o">(</span>.:format<span class="o">)</span>          people#create
 new_person GET    /people/new<span class="o">(</span>.:format<span class="o">)</span>      people#new
edit_person GET    /people/:id/edit<span class="o">(</span>.:format<span class="o">)</span> people#edit
     person GET    /people/:id<span class="o">(</span>.:format<span class="o">)</span>      people#show
            PATCH  /people/:id<span class="o">(</span>.:format<span class="o">)</span>      people#update
            PUT    /people/:id<span class="o">(</span>.:format<span class="o">)</span>      people#update
            DELETE /people/:id<span class="o">(</span>.:format<span class="o">)</span>      people#destroy
</code></pre></div></div>

<h3 id="routes-in-rails-console">Routes in Rails Console</h3>

<p>You can access route helpers using <code class="language-plaintext highlighter-rouge">Rails.application.routes.url_helpers</code> within the <a href="command_line.html#bin-rails-console">Rails Console</a>. They are also available via the <a href="command_line.html#the-app-and-helper-objects">app</a> object. For example:</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">url_helpers</span><span class="p">.</span><span class="nf">users_path</span>
<span class="p">=&gt;</span> <span class="s2">"/users"</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">user</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">first</span>
<span class="p">=&gt;</span> <span class="kt">#&lt;</span><span class="no">User</span><span class="p">:</span><span class="mh">0x00007fc1eab81628</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">app</span><span class="p">.</span><span class="nf">edit_user_path</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="s2">"/users/1/edit"</span>
</code></pre></div></div>

<h2 id="testing-routes">Testing Routes</h2>

<p>Rails offers three built-in assertions designed to make testing routes simpler:</p>

<ul>
  <li><a href="https://api.rubyonrails.org/classes/ActionDispatch/Assertions/RoutingAssertions.html#method-i-assert_generates"><code class="language-plaintext highlighter-rouge">assert_generates</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActionDispatch/Assertions/RoutingAssertions.html#method-i-assert_recognizes"><code class="language-plaintext highlighter-rouge">assert_recognizes</code></a></li>
  <li><a href="https://api.rubyonrails.org/classes/ActionDispatch/Assertions/RoutingAssertions.html#method-i-assert_routing"><code class="language-plaintext highlighter-rouge">assert_routing</code></a></li>
</ul>

<h3 id="the-assert_generates-assertion">The <code class="language-plaintext highlighter-rouge">assert_generates</code> Assertion</h3>

<p><a href="https://api.rubyonrails.org/classes/ActionDispatch/Assertions/RoutingAssertions.html#method-i-assert_generates"><code class="language-plaintext highlighter-rouge">assert_generates</code></a> asserts that a particular set of options generate a particular path and can be used with default routes or custom routes. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assert_generates</span> <span class="s2">"/photos/1"</span><span class="p">,</span> <span class="p">{</span> <span class="ss">controller: </span><span class="s2">"photos"</span><span class="p">,</span> <span class="ss">action: </span><span class="s2">"show"</span><span class="p">,</span> <span class="ss">id: </span><span class="s2">"1"</span> <span class="p">}</span>
<span class="n">assert_generates</span> <span class="s2">"/about"</span><span class="p">,</span> <span class="ss">controller: </span><span class="s2">"pages"</span><span class="p">,</span> <span class="ss">action: </span><span class="s2">"about"</span>
</code></pre></div></div>

<h3 id="the-assert_recognizes-assertion">The <code class="language-plaintext highlighter-rouge">assert_recognizes</code> Assertion</h3>

<p><a href="https://api.rubyonrails.org/classes/ActionDispatch/Assertions/RoutingAssertions.html#method-i-assert_recognizes"><code class="language-plaintext highlighter-rouge">assert_recognizes</code></a> is the inverse of <code class="language-plaintext highlighter-rouge">assert_generates</code>. It asserts that a given path is recognized and routes it to a particular spot in your application. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assert_recognizes</span><span class="p">({</span> <span class="ss">controller: </span><span class="s2">"photos"</span><span class="p">,</span> <span class="ss">action: </span><span class="s2">"show"</span><span class="p">,</span> <span class="ss">id: </span><span class="s2">"1"</span> <span class="p">},</span> <span class="s2">"/photos/1"</span><span class="p">)</span>
</code></pre></div></div>

<p>You can supply a <code class="language-plaintext highlighter-rouge">:method</code> argument to specify the HTTP verb:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assert_recognizes</span><span class="p">({</span> <span class="ss">controller: </span><span class="s2">"photos"</span><span class="p">,</span> <span class="ss">action: </span><span class="s2">"create"</span> <span class="p">},</span> <span class="p">{</span> <span class="ss">path: </span><span class="s2">"photos"</span><span class="p">,</span> <span class="ss">method: :post</span> <span class="p">})</span>
</code></pre></div></div>

<h3 id="the-assert_routing-assertion">The <code class="language-plaintext highlighter-rouge">assert_routing</code> Assertion</h3>

<p>The <a href="https://api.rubyonrails.org/classes/ActionDispatch/Assertions/RoutingAssertions.html#method-i-assert_routing"><code class="language-plaintext highlighter-rouge">assert_routing</code></a> assertion checks the route both ways. It combines the functionality of both <code class="language-plaintext highlighter-rouge">assert_generates</code> and <code class="language-plaintext highlighter-rouge">assert_recognizes</code>. It tests that the path generates the options, and that the options generate the path:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assert_routing</span><span class="p">({</span> <span class="ss">path: </span><span class="s2">"photos"</span><span class="p">,</span> <span class="ss">method: :post</span> <span class="p">},</span> <span class="p">{</span> <span class="ss">controller: </span><span class="s2">"photos"</span><span class="p">,</span> <span class="ss">action: </span><span class="s2">"create"</span> <span class="p">})</span>
</code></pre></div></div>

<h2 id="breaking-up-a-large-route-file-with-draw">Breaking Up a Large Route File With <code class="language-plaintext highlighter-rouge">draw</code></h2>

<p>In a large application with thousands of routes, a single <code class="language-plaintext highlighter-rouge">config/routes.rb</code> file can become cumbersome and hard to read. Rails offers a way to break up a single <code class="language-plaintext highlighter-rouge">routes.rb</code> file into multiple small ones using the <a href="https://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper/Resources.html#method-i-draw"><code class="language-plaintext highlighter-rouge">draw</code></a> macro.</p>

<p>For example, you could add an <code class="language-plaintext highlighter-rouge">admin.rb</code> file that contains all the routes related to the admin area, another <code class="language-plaintext highlighter-rouge">api.rb</code> file for API related resources, etc.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/routes.rb</span>

<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s2">"foo"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"foo#bar"</span>

  <span class="n">draw</span><span class="p">(</span><span class="ss">:admin</span><span class="p">)</span> <span class="c1"># Will load another route file located in `config/routes/admin.rb`</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/routes/admin.rb</span>

<span class="n">namespace</span> <span class="ss">:admin</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:comments</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Calling <code class="language-plaintext highlighter-rouge">draw(:admin)</code> inside the <code class="language-plaintext highlighter-rouge">Rails.application.routes.draw</code> block itself
will try to load a route file that has the same name as the argument given
(<code class="language-plaintext highlighter-rouge">admin.rb</code> in this example). The file needs to be located inside the
<code class="language-plaintext highlighter-rouge">config/routes</code> directory or any sub-directory (i.e. <code class="language-plaintext highlighter-rouge">config/routes/admin.rb</code> or
<code class="language-plaintext highlighter-rouge">config/routes/external/admin.rb</code>).</p>

<p>NOTE: You can use the normal routing DSL inside a secondary routing file such as <code class="language-plaintext highlighter-rouge">admin.rb</code>, but <em>do not</em> surround it with the <code class="language-plaintext highlighter-rouge">Rails.application.routes.draw</code> block. That should be used in the main <code class="language-plaintext highlighter-rouge">config/routes.rb</code> file only.</p>

<p>NOTE: Don’t use this feature unless you really need it. Having multiple routing files make it harder to discover routes in one place. For most applications - even those with a few hundred routes - it’s easier for developers to have a single routing file. The Rails routing DSL already offers a way to break routes in an organized manner with <code class="language-plaintext highlighter-rouge">namespace</code> and <code class="language-plaintext highlighter-rouge">scope</code>.</p>

        </div>

        <footer class="guide-footer">
            <div class="feedback">
                <h3>Geri Bildirim</h3>
                <p>Bu kılavuzun kalitesini artırmamıza yardımcı olmak için geri bildirimlerinizi bekliyoruz.</p>
                <p>Lütfen <a href="https://github.com/dilankaya127/rails-tr-TR">GitHub Issues</a> üzerinden katkıda bulunun.</p>
            </div>
        </footer>
    </article>
</div>

<script>
// İçindekiler tablosunu otomatik oluştur
document.addEventListener('DOMContentLoaded', function() {
    const toc = document.getElementById('toc');
    const headings = document.querySelectorAll('.guide-content h2, .guide-content h3, .guide-content h4');
    
    if (headings.length > 0) {
        const tocList = document.createElement('ul');
        
        headings.forEach(function(heading, index) {
            const id = 'heading-' + index;
            heading.id = id;
            
            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = '#' + id;
            a.textContent = heading.textContent;
            a.className = 'toc-' + heading.tagName.toLowerCase();
            
            li.appendChild(a);
            tocList.appendChild(li);
        });
        
        toc.appendChild(tocList);
    }
});
</script>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Rails Kılavuzları Türkçe Çevirisi. Gönüllüler tarafından hazırlanmıştır.</p>
            <p>Orijinal dokümantasyon <a href="https://guides.rubyonrails.org">Ruby on Rails</a> ekibine aittir.</p>
        </div>
    </footer>

    <script>hljs.highlightAll();</script>
</body>
</html>