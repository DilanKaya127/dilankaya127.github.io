<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Helpers - Rails Dokümantasyonu - Türkçe</title>
    <link rel="stylesheet" href="/assets/css/rails.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">

    <link rel="icon" type="image/svg" href="/assets/img/logo_rails-circle.svg">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">
                    <a href="/rails/">
                        <img src="/assets/img/logo_rails-circle.svg" alt="Rails Logo" class="logo-image">
                    </a>
                </h1>
                <nav class="nav">
                    <a href="/">Ana Sayfa</a>
                    <!-- <a href="https://dilankaya127.github.io">Portföy</a> -->
                    <a href="https://github.com/dilankaya127/rails-tr-TR">GitHub</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="guide-container">
  <button id="toc-toggle" class="toc-toggle">☰ İçindekiler</button>

  <aside class="guide-sidebar">
    <div class="guide-toc">
      <!-- <h3>İçindekiler</h3> -->
      <div id="toc"></div>
      <button class="toc-close" aria-label="İçindekileri Kapat">✕</button>
    </div>

    <!-- <div class="guide-nav">
            <h3>Diğer(Tüm) Kılavuzlar</h3>
            <ul>
                <li><a href="/rails/guides/tr/getting_started">Rails ile Başlarken</a></li>
                <li><a href="/rails/guides/en/active_record_basics">Active Record Temelleri</a></li>
                <li><a href="/rails/guides//en/action_controller_overview">Action Controller</a></li>
                <li><a href="/rails/guides/tr/action_cable_overview">Action Cable</a></li>
            </ul>
        </div> -->
  </aside>

  <article class="guide-content">
    <!-- <header class="guide-header">
            <h1>Form Helpers</h1>
            
        </header> -->

    <div class="guide-body"><p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1 id="action-view-form-helpers">Action View Form Helpers</h1>

<p>Forms are a common interface for user input in web applications. However, form markup can be tedious to write and maintain because of the need to handle form controls, naming, and attributes. Rails simplifies this by providing view helpers, which are methods that output HTML form markup. This guide will help you understand the different helper methods and when to use each.</p>

<p>After reading this guide, you will know:</p>

<ul>
  <li>How to create basic forms, such as a search form.</li>
  <li>How to work with model-based forms for creating and editing specific database records.</li>
  <li>How to generate select boxes from multiple types of data.</li>
  <li>What date and time helpers Rails provides.</li>
  <li>What makes a file upload form different.</li>
  <li>How to post forms to external resources and specify setting an <code class="language-plaintext highlighter-rouge">authenticity_token</code>.</li>
  <li>How to build complex forms.</li>
</ul>

<hr />

<p>This guide is not intended to be a complete list of all available form helpers. Please refer to <a href="https://api.rubyonrails.org/classes/ActionView/Helpers.html">the Rails API documentation</a> for an exhaustive list of form helpers and their arguments.</p>

<h2 id="working-with-basic-forms">Working with Basic Forms</h2>

<p>The main form helper is <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_with"><code class="language-plaintext highlighter-rouge">form_with</code></a>.</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  Form contents
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>When called without arguments, it creates an HTML <code class="language-plaintext highlighter-rouge">&lt;form&gt;</code> tag with the value of the <code class="language-plaintext highlighter-rouge">method</code> attribute set to <code class="language-plaintext highlighter-rouge">post</code> and the value of the <code class="language-plaintext highlighter-rouge">action</code> attribute set to the current page. For example, assuming the current page is a home page at <code class="language-plaintext highlighter-rouge">/home</code>, the generated HTML will look like this:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/home"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">value=</span><span class="s">"Lz6ILqUEs2CGdDa-oz38TqcqQORavGnbGkG0CQA8zc8peOps-K7sHgFSTPSkBx89pQxh3p5zPIkjoOTiA_UWbQ"</span> <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;</span>
  Form contents
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>Notice that the form contains an <code class="language-plaintext highlighter-rouge">input</code> element with type <code class="language-plaintext highlighter-rouge">hidden</code>. This <code class="language-plaintext highlighter-rouge">authenticity_token</code> hidden input is required for non-GET form submissions.
This token is a security feature in Rails used to prevent cross-site request forgery (CSRF) attacks, and form helpers automatically generate it for every non-GET form (assuming the security feature is enabled). You can read more about it in the <a href="security.html#cross-site-request-forgery-csrf">Securing Rails Applications</a> guide.</p>

<h3 id="a-generic-search-form">A Generic Search Form</h3>

<p>One of the most basic forms on the web is a search form. This form contains:</p>

<ul>
  <li>a form element with “GET” method,</li>
  <li>a label for the input,</li>
  <li>a text input element, and</li>
  <li>a submit element.</li>
</ul>

<p>Here is how to create a search form with <code class="language-plaintext highlighter-rouge">form_with</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s2">"/search"</span><span class="p">,</span> <span class="ss">method: :get</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:query</span><span class="p">,</span> <span class="s2">"Search for:"</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">search_field</span> <span class="ss">:query</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">submit</span> <span class="s2">"Search"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>This will generate the following HTML:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/search"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"get"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"query"</span><span class="nt">&gt;</span>Search for:<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">name=</span><span class="s">"query"</span> <span class="na">id=</span><span class="s">"query"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"commit"</span> <span class="na">value=</span><span class="s">"Search"</span> <span class="na">data-disable-with=</span><span class="s">"Search"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>Notice that for the search form we are using the <code class="language-plaintext highlighter-rouge">url</code> option of <code class="language-plaintext highlighter-rouge">form_with</code>. Setting <code class="language-plaintext highlighter-rouge">url: "/search"</code> changes the form action value from the default current page path to <code class="language-plaintext highlighter-rouge">action="/search"</code>.</p>

<p>In general, passing <code class="language-plaintext highlighter-rouge">url: my_path</code> to <code class="language-plaintext highlighter-rouge">form_with</code> tells the form where to make the request. The other option is to pass Active Model objects to the form, as you will learn <a href="#creating-forms-with-model-objects">below</a>. You can also use <a href="routing.html#path-and-url-helpers">URL helpers</a>.</p>

<p>The search form example above also shows the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html">form builder</a> object. You will learn about the many helpers provided by the form builder object (like<code class="language-plaintext highlighter-rouge">form.label</code> and <code class="language-plaintext highlighter-rouge">form.text_field</code>) in the next section.</p>

<p>TIP: For every form <code class="language-plaintext highlighter-rouge">input</code> element, an <code class="language-plaintext highlighter-rouge">id</code> attribute is generated from its name (<code class="language-plaintext highlighter-rouge">"query"</code> in above example). These IDs can be very useful for CSS styling or manipulation of form controls with JavaScript.</p>

<p>IMPORTANT: Use “GET” as the method for search forms. In general, Rails
conventions encourage using the right HTTP verb for controller actions. Using “GET” for
search allows users to bookmark a specific search.</p>

<h3 id="helpers-for-generating-form-elements">Helpers for Generating Form Elements</h3>

<p>The form builder object yielded by <code class="language-plaintext highlighter-rouge">form_with</code> provides many helper methods for generating common form elements such as text fields, checkboxes, and radio buttons.</p>

<p>The first argument to these methods is always the name of the input. This is
useful to remember because when the form is submitted, that name will be passed
to the controller along with the form data in the <code class="language-plaintext highlighter-rouge">params</code> hash. The name will be the key in the <code class="language-plaintext highlighter-rouge">params</code> for the value entered by the user for that field.</p>

<p>For example, if the form contains <code class="language-plaintext highlighter-rouge">&lt;%= form.text_field :query %&gt;</code>, then you
would be able to get the value of this field in the controller with
<code class="language-plaintext highlighter-rouge">params[:query]</code>.</p>

<p>When naming inputs, Rails uses certain conventions that make it possible to submit parameters with non-scalar values such as arrays or hashes, which will also be accessible in <code class="language-plaintext highlighter-rouge">params</code>. You can read more about them in the <a href="#form-input-naming-conventions-and-params-hash">Form Input Naming Conventions and Params Hash</a> section of this guide. For details on the precise usage of these helpers, please refer to the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html">API documentation</a>.</p>

<h4 id="checkboxes">Checkboxes</h4>

<p>A Checkbox is a form control that allows for a single value to be selected or deselected. A group of Checkboxes is generally used to allow a user to choose one or more options from the group.</p>

<p>Here’s an example with three checkboxes in a form:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">checkbox</span> <span class="ss">:biography</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:biography</span><span class="p">,</span> <span class="s2">"Biography"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">checkbox</span> <span class="ss">:romance</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:romance</span><span class="p">,</span> <span class="s2">"Romance"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">checkbox</span> <span class="ss">:mystery</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:mystery</span><span class="p">,</span> <span class="s2">"Mystery"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The above will generate the following:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"biography"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"biography"</span> <span class="na">id=</span><span class="s">"biography"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"biography"</span><span class="nt">&gt;</span>Biography<span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"romance"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"romance"</span> <span class="na">id=</span><span class="s">"romance"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"romance"</span><span class="nt">&gt;</span>Romance<span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"mystery"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"mystery"</span> <span class="na">id=</span><span class="s">"mystery"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"mystery"</span><span class="nt">&gt;</span>Mystery<span class="nt">&lt;/label&gt;</span>
</code></pre></div></div>

<p>The first parameter to <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-checkbox"><code class="language-plaintext highlighter-rouge">checkbox</code></a> is the name of the input which can be found in the <code class="language-plaintext highlighter-rouge">params</code> hash. If the user has checked the “Biography” checkbox only, the <code class="language-plaintext highlighter-rouge">params</code> hash would contain:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="s2">"biography"</span> <span class="o">=&gt;</span> <span class="s2">"1"</span><span class="p">,</span>
  <span class="s2">"romance"</span> <span class="o">=&gt;</span> <span class="s2">"0"</span><span class="p">,</span>
  <span class="s2">"mystery"</span> <span class="o">=&gt;</span> <span class="s2">"0"</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You can use <code class="language-plaintext highlighter-rouge">params[:biography]</code> to check if that checkbox is selected by the user.</p>

<p>The checkbox’s values (the values that will appear in <code class="language-plaintext highlighter-rouge">params</code>) can optionally be specified using the <code class="language-plaintext highlighter-rouge">checked_value</code> and <code class="language-plaintext highlighter-rouge">unchecked_value</code> parameters. See the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-checkbox">API documentation</a> for more details.</p>

<p>There is also a <code class="language-plaintext highlighter-rouge">collection_checkboxes</code>, which you can learn about in the <a href="#collection-related-helpers">Collection Related Helpers section</a>.</p>

<h4 id="radio-buttons">Radio Buttons</h4>

<p>Radio buttons are form controls that only allow the user to select one option at a time from the list of choices.</p>

<p>For example, radio buttons for choosing your favorite ice cream flavor:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">radio_button</span> <span class="ss">:flavor</span><span class="p">,</span> <span class="s2">"chocolate_chip"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:flavor_chocolate_chip</span><span class="p">,</span> <span class="s2">"Chocolate Chip"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">radio_button</span> <span class="ss">:flavor</span><span class="p">,</span> <span class="s2">"vanilla"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:flavor_vanilla</span><span class="p">,</span> <span class="s2">"Vanilla"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">radio_button</span> <span class="ss">:flavor</span><span class="p">,</span> <span class="s2">"hazelnut"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:flavor_hazelnut</span><span class="p">,</span> <span class="s2">"Hazelnut"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The above will generate the following HTML:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">value=</span><span class="s">"chocolate_chip"</span> <span class="na">name=</span><span class="s">"flavor"</span> <span class="na">id=</span><span class="s">"flavor_chocolate_chip"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"flavor_chocolate_chip"</span><span class="nt">&gt;</span>Chocolate Chip<span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">value=</span><span class="s">"vanilla"</span> <span class="na">name=</span><span class="s">"flavor"</span> <span class="na">id=</span><span class="s">"flavor_vanilla"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"flavor_vanilla"</span><span class="nt">&gt;</span>Vanilla<span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">value=</span><span class="s">"hazelnut"</span> <span class="na">name=</span><span class="s">"flavor"</span> <span class="na">id=</span><span class="s">"flavor_hazelnut"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"flavor_hazelnut"</span><span class="nt">&gt;</span>Hazelnut<span class="nt">&lt;/label&gt;</span>
</code></pre></div></div>

<p>The second argument to <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-radio_button"><code class="language-plaintext highlighter-rouge">radio_button</code></a> is the value of the input. Because these radio buttons share the same name (<code class="language-plaintext highlighter-rouge">flavor</code>), the user will only be able to select one of them, and <code class="language-plaintext highlighter-rouge">params[:flavor]</code> will contain either <code class="language-plaintext highlighter-rouge">"chocolate_chip"</code>, <code class="language-plaintext highlighter-rouge">"vanilla"</code>, or <code class="language-plaintext highlighter-rouge">hazelnut</code>.</p>

<p>NOTE: Always use labels for checkbox and radio buttons. They associate text with
a specific option using the <code class="language-plaintext highlighter-rouge">for</code> attribute and, by expanding the clickable
region, make it easier for users to click the inputs.</p>

<h3 id="other-helpers-of-interest">Other Helpers of Interest</h3>

<p>There are many other form controls including text, email, password, date, and time. The below examples show some more helpers and their generated HTML.</p>

<p>Date and time related helpers:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">date_field</span> <span class="ss">:born_on</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">time_field</span> <span class="ss">:started_at</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">datetime_local_field</span> <span class="ss">:graduation_day</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">month_field</span> <span class="ss">:birthday_month</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">week_field</span> <span class="ss">:birthday_week</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"date"</span> <span class="na">name=</span><span class="s">"born_on"</span> <span class="na">id=</span><span class="s">"born_on"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"time"</span> <span class="na">name=</span><span class="s">"started_at"</span> <span class="na">id=</span><span class="s">"started_at"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"datetime-local"</span> <span class="na">name=</span><span class="s">"graduation_day"</span> <span class="na">id=</span><span class="s">"graduation_day"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"month"</span> <span class="na">name=</span><span class="s">"birthday_month"</span> <span class="na">id=</span><span class="s">"birthday_month"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"week"</span> <span class="na">name=</span><span class="s">"birthday_week"</span> <span class="na">id=</span><span class="s">"birthday_week"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<p>Helpers with special formatting:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">password_field</span> <span class="ss">:password</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">email_field</span> <span class="ss">:address</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">telephone_field</span> <span class="ss">:phone</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">url_field</span> <span class="ss">:homepage</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">id=</span><span class="s">"password"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"email"</span> <span class="na">name=</span><span class="s">"address"</span> <span class="na">id=</span><span class="s">"address"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"tel"</span> <span class="na">name=</span><span class="s">"phone"</span> <span class="na">id=</span><span class="s">"phone"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"url"</span> <span class="na">name=</span><span class="s">"homepage"</span> <span class="na">id=</span><span class="s">"homepage"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<p>Other common helpers:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">textarea</span> <span class="ss">:message</span><span class="p">,</span> <span class="ss">size: </span><span class="s2">"70x5"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">hidden_field</span> <span class="ss">:parent_id</span><span class="p">,</span> <span class="ss">value: </span><span class="s2">"foo"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">number_field</span> <span class="ss">:price</span><span class="p">,</span> <span class="ss">in: </span><span class="mf">1.0</span><span class="o">..</span><span class="mf">20.0</span><span class="p">,</span> <span class="ss">step: </span><span class="mf">0.5</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">range_field</span> <span class="ss">:discount</span><span class="p">,</span> <span class="ss">in: </span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">search_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">color_field</span> <span class="ss">:favorite_color</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;textarea</span> <span class="na">name=</span><span class="s">"message"</span> <span class="na">id=</span><span class="s">"message"</span> <span class="na">cols=</span><span class="s">"70"</span> <span class="na">rows=</span><span class="s">"5"</span><span class="nt">&gt;&lt;/textarea&gt;</span>
<span class="nt">&lt;input</span> <span class="na">value=</span><span class="s">"foo"</span> <span class="na">autocomplete=</span><span class="s">"off"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"parent_id"</span> <span class="na">id=</span><span class="s">"parent_id"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">step=</span><span class="s">"0.5"</span> <span class="na">min=</span><span class="s">"1.0"</span> <span class="na">max=</span><span class="s">"20.0"</span> <span class="na">type=</span><span class="s">"number"</span> <span class="na">name=</span><span class="s">"price"</span> <span class="na">id=</span><span class="s">"price"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">min=</span><span class="s">"1"</span> <span class="na">max=</span><span class="s">"100"</span> <span class="na">type=</span><span class="s">"range"</span> <span class="na">name=</span><span class="s">"discount"</span> <span class="na">id=</span><span class="s">"discount"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">id=</span><span class="s">"name"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">value=</span><span class="s">"#000000"</span> <span class="na">type=</span><span class="s">"color"</span> <span class="na">name=</span><span class="s">"favorite_color"</span> <span class="na">id=</span><span class="s">"favorite_color"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<p>Hidden inputs are not shown to the user but instead hold data like any textual input. Values inside them can be changed with JavaScript.</p>

<p>TIP: If you’re using password input fields, you might want to configure your application to prevent those parameters from being logged. You can learn about how in the <a href="security.html#logging">Securing Rails Applications</a> guide.</p>

<h2 id="creating-forms-with-model-objects">Creating Forms with Model Objects</h2>

<h3 id="binding-a-form-to-an-object">Binding a Form to an Object</h3>

<p>The <code class="language-plaintext highlighter-rouge">form_with</code> helper has a <code class="language-plaintext highlighter-rouge">:model</code> option that allows you to bind the form builder object to a model object. This means that the form will be scoped to that model object, and the form’s fields will be populated with values from that model object.</p>

<p>For example, if we have a <code class="language-plaintext highlighter-rouge">@book</code> model object:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">new</span>
<span class="c1"># =&gt; #&lt;Book id: nil, title: nil, author: nil&gt;</span>
</code></pre></div></div>

<p>And the following form to create a new book:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@book</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:title</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:title</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:author</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:author</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">submit</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>It will generate this HTML:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/books"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">value=</span><span class="s">"ChwHeyegcpAFDdBvXvDuvbfW7yCA3e8gvhyieai7DhG28C3akh-dyuv-IBittsjPrIjETlQQvQJ91T77QQ8xWA"</span> <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"book_title"</span><span class="nt">&gt;</span>Title<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"book[title]"</span> <span class="na">id=</span><span class="s">"book_title"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"book_author"</span><span class="nt">&gt;</span>Author<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"book[author]"</span> <span class="na">id=</span><span class="s">"book_author"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"commit"</span> <span class="na">value=</span><span class="s">"Create Book"</span> <span class="na">data-disable-with=</span><span class="s">"Create Book"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>Some important things to notice when using <code class="language-plaintext highlighter-rouge">form_with</code> with a model object:</p>

<ul>
  <li>The form <code class="language-plaintext highlighter-rouge">action</code> is automatically filled with an appropriate value, <code class="language-plaintext highlighter-rouge">action="/books"</code>. If you were updating a book, it would be <code class="language-plaintext highlighter-rouge">action="/books/42"</code>.</li>
  <li>The form field names are scoped with <code class="language-plaintext highlighter-rouge">book[...]</code>. This means that <code class="language-plaintext highlighter-rouge">params[:book]</code> will be a hash containing all these field’s values. You can read more about the significance of input names in chapter <a href="#form-input-naming-conventions-and-params-hash">Form Input Naming Conventions and Params Hash</a> of this guide.</li>
  <li>The submit button is automatically given an appropriate text value, “Create Book” in this case.</li>
</ul>

<p>TIP: Typically your form inputs will mirror model attributes. However, they don’t have to. If there is other information you need you can include a field in your form and access it via <code class="language-plaintext highlighter-rouge">params[:book][:my_non_attribute_input]</code>.</p>

<h4 id="composite-primary-key-forms">Composite Primary Key Forms</h4>

<p>If you have a model with a <a href="active_record_composite_primary_keys.html">composite primary key</a>, the form building syntax is the same with slightly different output.</p>

<p>For example, to update a <code class="language-plaintext highlighter-rouge">@book</code> model object with a composite key <code class="language-plaintext highlighter-rouge">[:author_id, :id]</code> like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="c1"># =&gt; #&lt;Book id: 25, title: "Some book", author_id: 2&gt;</span>
</code></pre></div></div>

<p>The following form:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@book</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:title</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">submit</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Will generate this HTML output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/books/2_25"</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"ChwHeyegcpAFDdBvXvDuvbfW7yCA3e8gvhyieai7DhG28C3akh-dyuv-IBittsjPrIjETlQQvQJ91T77QQ8xWA"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"book[title]"</span> <span class="na">id=</span><span class="s">"book_title"</span> <span class="na">value=</span><span class="s">"Some book"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"commit"</span> <span class="na">value=</span><span class="s">"Update Book"</span> <span class="na">data-disable-with=</span><span class="s">"Update Book"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>Note the generated URL contains the <code class="language-plaintext highlighter-rouge">author_id</code> and <code class="language-plaintext highlighter-rouge">id</code> delimited by an
underscore. Once submitted, the controller can <a href="action_controller_overview.html#composite-key-parameters">extract each primary key
value</a> from the parameters and update the record as it would with a singular
primary key.</p>

<h4 id="the-fields_for-helper">The <code class="language-plaintext highlighter-rouge">fields_for</code> Helper</h4>

<p>The <code class="language-plaintext highlighter-rouge">fields_for</code> helper is used to render fields for related model objects
within the same form. The associated “inner” model is usually related to the
“main” form model via an Active Record association. For example, if you had a
<code class="language-plaintext highlighter-rouge">Person</code> model with an associated <code class="language-plaintext highlighter-rouge">ContactDetail</code> model, you could create a
single form with inputs for both models like so:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">person_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">person_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">fields_for</span> <span class="ss">:contact_detail</span><span class="p">,</span> <span class="vi">@person</span><span class="p">.</span><span class="nf">contact_detail</span> <span class="k">do</span> <span class="o">|</span><span class="n">contact_detail_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">contact_detail_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:phone_number</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The above will produce the following output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/people"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">value=</span><span class="s">"..."</span> <span class="na">autocomplete=</span><span class="s">"off"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"person[name]"</span> <span class="na">id=</span><span class="s">"person_name"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"contact_detail[phone_number]"</span> <span class="na">id=</span><span class="s">"contact_detail_phone_number"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>The object yielded by <code class="language-plaintext highlighter-rouge">fields_for</code> is a form builder like the one yielded by
<code class="language-plaintext highlighter-rouge">form_with</code>. The <code class="language-plaintext highlighter-rouge">fields_for</code> helper creates a similar binding but without
rendering a <code class="language-plaintext highlighter-rouge">&lt;form&gt;</code> tag. You can learn more about <code class="language-plaintext highlighter-rouge">fields_for</code> in the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-fields_for">API
docs</a>.</p>

<h3 id="relying-on-record-identification">Relying on Record Identification</h3>

<p>When dealing with RESTful resources, calls to <code class="language-plaintext highlighter-rouge">form_with</code> can be simplified by relying on <strong>record identification</strong>. This means you pass the model instance and have Rails figure out the model name, method, and other things. In the example below for creating a new record, both calls to <code class="language-plaintext highlighter-rouge">form_with</code> generate the same HTML:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># longer way:</span>
<span class="n">form_with</span><span class="p">(</span><span class="ss">model: </span><span class="vi">@article</span><span class="p">,</span> <span class="ss">url: </span><span class="n">articles_path</span><span class="p">)</span>
<span class="c1"># short-hand:</span>
<span class="n">form_with</span><span class="p">(</span><span class="ss">model: </span><span class="vi">@article</span><span class="p">)</span>
</code></pre></div></div>

<p>Similarly, for editing an existing article like below, both the calls to <code class="language-plaintext highlighter-rouge">form_with</code> will also generate the same HTML:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># longer way:</span>
<span class="n">form_with</span><span class="p">(</span><span class="ss">model: </span><span class="vi">@article</span><span class="p">,</span> <span class="ss">url: </span><span class="n">article_path</span><span class="p">(</span><span class="vi">@article</span><span class="p">),</span> <span class="ss">method: </span><span class="s2">"patch"</span><span class="p">)</span>
<span class="c1"># short-hand:</span>
<span class="n">form_with</span><span class="p">(</span><span class="ss">model: </span><span class="vi">@article</span><span class="p">)</span>
</code></pre></div></div>

<p>Notice how the short-hand <code class="language-plaintext highlighter-rouge">form_with</code> invocation is conveniently the same, regardless of the record being new or existing. Record identification is smart enough to figure out if the record is new by asking <a href="https://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-persisted-3F"><code class="language-plaintext highlighter-rouge">record.persisted?</code></a>. It also selects the correct path to submit to, and the name based on the class of the object.</p>

<p>This is assuming that the <code class="language-plaintext highlighter-rouge">Article</code> model is declared with <code class="language-plaintext highlighter-rouge">resources :articles</code> in the routes file.</p>

<p>If you have a <a href="routing.html#singular-resources">singular resource</a>, you will need to call <code class="language-plaintext highlighter-rouge">resource</code> and <code class="language-plaintext highlighter-rouge">resolve</code> for it to work with <code class="language-plaintext highlighter-rouge">form_with</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resource</span> <span class="ss">:article</span>
<span class="n">resolve</span><span class="p">(</span><span class="s2">"Article"</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="ss">:article</span><span class="p">]</span> <span class="p">}</span>
</code></pre></div></div>

<p>TIP: Declaring a resource has a number of side effects. See the <a href="routing.html#resource-routing-the-rails-default">Rails Routing from the Outside In</a> guide for more information on setting up and using resources.</p>

<p>WARNING: When you’re using <a href="association_basics.html#single-table-inheritance-sti">single-table inheritance</a> with your models, you can’t rely on record identification on a subclass if only their parent class is declared a resource. You will have to specify <code class="language-plaintext highlighter-rouge">:url</code>, and <code class="language-plaintext highlighter-rouge">:scope</code> (the model name) explicitly.</p>

<h3 id="working-with-namespaces">Working with Namespaces</h3>

<p>If you have namespaced routes, <code class="language-plaintext highlighter-rouge">form_with</code> has a shorthand for that. For example, if your application has an <code class="language-plaintext highlighter-rouge">admin</code> namespace:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">form_with</span> <span class="ss">model: </span><span class="p">[</span><span class="ss">:admin</span><span class="p">,</span> <span class="vi">@article</span><span class="p">]</span>
</code></pre></div></div>

<p>The above will create a form that submits to the <code class="language-plaintext highlighter-rouge">Admin::ArticlesController</code> inside the admin namespace,  therefore submitting to <code class="language-plaintext highlighter-rouge">admin_article_path(@article)</code> in the case of an update.</p>

<p>If you have several levels of namespacing then the syntax is similar:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">form_with</span> <span class="ss">model: </span><span class="p">[</span><span class="ss">:admin</span><span class="p">,</span> <span class="ss">:management</span><span class="p">,</span> <span class="vi">@article</span><span class="p">]</span>
</code></pre></div></div>

<p>For more information on Rails’ routing system and the associated conventions, please see the <a href="routing.html">Rails Routing from the Outside In</a> guide.</p>

<h3 id="forms-with-patch-put-or-delete-methods">Forms with PATCH, PUT, or DELETE Methods</h3>

<p>The Rails framework encourages RESTful design, which means forms in your application will make requests where the <code class="language-plaintext highlighter-rouge">method</code> is <code class="language-plaintext highlighter-rouge">PATCH</code>, <code class="language-plaintext highlighter-rouge">PUT</code>, or <code class="language-plaintext highlighter-rouge">DELETE</code> in addition to <code class="language-plaintext highlighter-rouge">GET</code> and <code class="language-plaintext highlighter-rouge">POST</code>. However, HTML forms <em>don’t support</em> methods other than <code class="language-plaintext highlighter-rouge">GET</code> and <code class="language-plaintext highlighter-rouge">POST</code> when it comes to submitting forms.</p>

<p>Rails works around this limitation by emulating other methods over POST with a hidden input named <code class="language-plaintext highlighter-rouge">"_method"</code>. For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">form_with</span><span class="p">(</span><span class="ss">url: </span><span class="n">search_path</span><span class="p">,</span> <span class="ss">method: </span><span class="s2">"patch"</span><span class="p">)</span>
</code></pre></div></div>

<p>The above form Will generate this HTML output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/search"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"patch"</span> <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">value=</span><span class="s">"R4quRuXQAq75TyWpSf8AwRyLt-R1uMtPP1dHTTWJE5zbukiaY8poSTXxq3Z7uAjXfPHiKQDsWE1i2_-h0HSktQ"</span> <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>When parsing POSTed data, Rails will take into account the special <code class="language-plaintext highlighter-rouge">_method</code> parameter and proceed as if the request’s HTTP method was the one set as the value of <code class="language-plaintext highlighter-rouge">_method</code> (<code class="language-plaintext highlighter-rouge">PATCH</code> in this example).</p>

<p>When rendering a form, submission buttons can override the declared <code class="language-plaintext highlighter-rouge">method</code> attribute through the <code class="language-plaintext highlighter-rouge">formmethod:</code> keyword:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s2">"/posts/1"</span><span class="p">,</span> <span class="ss">method: :patch</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">button</span> <span class="s2">"Delete"</span><span class="p">,</span> <span class="ss">formmethod: :delete</span><span class="p">,</span> <span class="ss">data: </span><span class="p">{</span> <span class="ss">confirm: </span><span class="s2">"Are you sure?"</span> <span class="p">}</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">button</span> <span class="s2">"Update"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Similar to <code class="language-plaintext highlighter-rouge">&lt;form&gt;</code> elements, most browsers <em>don’t support</em> overriding form methods declared through <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#attr-formmethod">formmethod</a> other than <code class="language-plaintext highlighter-rouge">GET</code> and <code class="language-plaintext highlighter-rouge">POST</code>.</p>

<p>Rails works around this issue by emulating other methods over POST through a combination of <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#attr-formmethod">formmethod</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#attr-value">value</a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#attr-name">name</a> attributes:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">action=</span><span class="s">"/posts/1"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"patch"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"f755bb0ed134b76c432144748a6d4b7a7ddf2b71"</span> <span class="nt">/&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>

  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">formmethod=</span><span class="s">"post"</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"delete"</span> <span class="na">data-confirm=</span><span class="s">"Are you sure?"</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"button"</span><span class="nt">&gt;</span>Update<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>In this case, the “Update” button will be treated as <code class="language-plaintext highlighter-rouge">PATCH</code> and the “Delete” button will be treated as <code class="language-plaintext highlighter-rouge">DELETE</code>.</p>

<h2 id="making-select-boxes-with-ease">Making Select Boxes with Ease</h2>

<p>Select boxes, also known as drop-down list, allow users to select from a list of options. The HTML for select boxes requires a decent amount of markup - one <code class="language-plaintext highlighter-rouge">&lt;option&gt;</code> element for each option to choose from. Rails provides helper methods to help generate that markup.</p>

<p>For example, let’s say we have a list of cities for the user to choose from. We can use the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-select"><code class="language-plaintext highlighter-rouge">select</code></a> helper:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"Madrid"</span><span class="p">]</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The above will generate this HTML output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Berlin"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Chicago"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Madrid"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<p>And the selection will be available in <code class="language-plaintext highlighter-rouge">params[:city]</code> as usual.</p>

<p>We can also specify <code class="language-plaintext highlighter-rouge">&lt;option&gt;</code> values that differ from their labels:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span> <span class="p">[[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"BE"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"CHI"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Madrid"</span><span class="p">,</span> <span class="s2">"MD"</span><span class="p">]]</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"BE"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"CHI"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"MD"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<p>This way, the user will see the full city name, but <code class="language-plaintext highlighter-rouge">params[:city]</code> will be one of <code class="language-plaintext highlighter-rouge">"BE"</code>, <code class="language-plaintext highlighter-rouge">"CHI"</code>, or <code class="language-plaintext highlighter-rouge">"MD"</code>.</p>

<p>Lastly, we can specify a default choice for the select box with the <code class="language-plaintext highlighter-rouge">:selected</code> argument:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span> <span class="p">[[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"BE"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"CHI"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Madrid"</span><span class="p">,</span> <span class="s2">"MD"</span><span class="p">]],</span> <span class="ss">selected: </span><span class="s2">"CHI"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"BE"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"CHI"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"MD"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<h3 id="option-groups-for-select-boxes">Option Groups for Select Boxes</h3>

<p>In some cases we may want to improve the user experience by grouping related options together. We can do so by passing a <code class="language-plaintext highlighter-rouge">Hash</code> (or comparable <code class="language-plaintext highlighter-rouge">Array</code>) to <code class="language-plaintext highlighter-rouge">select</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span>
      <span class="p">{</span>
        <span class="s2">"Europe"</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="p">[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"BE"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Madrid"</span><span class="p">,</span> <span class="s2">"MD"</span><span class="p">]</span> <span class="p">],</span>
        <span class="s2">"North America"</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="p">[</span><span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"CHI"</span><span class="p">]</span> <span class="p">],</span>
      <span class="p">},</span>
      <span class="ss">selected: </span><span class="s2">"CHI"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;optgroup</span> <span class="na">label=</span><span class="s">"Europe"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"BE"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"MD"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;/optgroup&gt;</span>
  <span class="nt">&lt;optgroup</span> <span class="na">label=</span><span class="s">"North America"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"CHI"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;/optgroup&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<h3 id="binding-select-boxes-to-model-objects">Binding Select Boxes to Model Objects</h3>

<p>Like other form controls, a select box can be bound to a model attribute. For example, if we have a <code class="language-plaintext highlighter-rouge">@person</code> model object like:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">city: </span><span class="s2">"MD"</span><span class="p">)</span>
</code></pre></div></div>

<p>The following form:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span> <span class="p">[[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"BE"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"CHI"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Madrid"</span><span class="p">,</span> <span class="s2">"MD"</span><span class="p">]]</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Will output this select box:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[city]"</span> <span class="na">id=</span><span class="s">"person_city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"BE"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"CHI"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"MD"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<p>The only difference is that the selected option will be found in <code class="language-plaintext highlighter-rouge">params[:person][:city]</code> instead of <code class="language-plaintext highlighter-rouge">params[:city]</code>.</p>

<p>Notice that the appropriate option was automatically marked <code class="language-plaintext highlighter-rouge">selected="selected"</code>. Since this select box was bound to an existing <code class="language-plaintext highlighter-rouge">@person</code> record, we didn’t need to specify a <code class="language-plaintext highlighter-rouge">:selected</code> argument.</p>

<h2 id="using-date-and-time-form-helpers">Using Date and Time Form Helpers</h2>

<p>In addition to the <code class="language-plaintext highlighter-rouge">date_field</code> and <code class="language-plaintext highlighter-rouge">time_field</code> helpers mentioned <a href="#other-helpers-of-interest">earlier</a>, Rails provides alternative date and time form helpers that render plain select boxes. The <code class="language-plaintext highlighter-rouge">date_select</code> helper renders a separate select box for year, month, and day.</p>

<p>For example, if we have a <code class="language-plaintext highlighter-rouge">@person</code> model object like:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">birth_date: </span><span class="no">Date</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
</code></pre></div></div>

<p>The following form:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">date_select</span> <span class="ss">:birth_date</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Will output select boxes like:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[birth_date(1i)]"</span> <span class="na">id=</span><span class="s">"person_birth_date_1i"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1990"</span><span class="nt">&gt;</span>1990<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1991"</span><span class="nt">&gt;</span>1991<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1992"</span><span class="nt">&gt;</span>1992<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1993"</span><span class="nt">&gt;</span>1993<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1994"</span><span class="nt">&gt;</span>1994<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1995"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>1995<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1996"</span><span class="nt">&gt;</span>1996<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1997"</span><span class="nt">&gt;</span>1997<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1998"</span><span class="nt">&gt;</span>1998<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1999"</span><span class="nt">&gt;</span>1999<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2000"</span><span class="nt">&gt;</span>2000<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[birth_date(2i)]"</span> <span class="na">id=</span><span class="s">"person_birth_date_2i"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>January<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>February<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"3"</span><span class="nt">&gt;</span>March<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"4"</span><span class="nt">&gt;</span>April<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"5"</span><span class="nt">&gt;</span>May<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"6"</span><span class="nt">&gt;</span>June<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"7"</span><span class="nt">&gt;</span>July<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"8"</span><span class="nt">&gt;</span>August<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"9"</span><span class="nt">&gt;</span>September<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"10"</span><span class="nt">&gt;</span>October<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"11"</span><span class="nt">&gt;</span>November<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"12"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>December<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[birth_date(3i)]"</span> <span class="na">id=</span><span class="s">"person_birth_date_3i"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/option&gt;</span>
  ...
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"21"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>21<span class="nt">&lt;/option&gt;</span>
  ...
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"31"</span><span class="nt">&gt;</span>31<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<p>Notice that, when the form is submitted, there will be no single value in the <code class="language-plaintext highlighter-rouge">params</code> hash that contains the full date. Instead, there will be several values with special names like <code class="language-plaintext highlighter-rouge">"birth_date(1i)"</code>. However, Active Model knows how to assemble these values into a full date, based on the declared type of the model attribute. So we can pass <code class="language-plaintext highlighter-rouge">params[:person]</code> to <code class="language-plaintext highlighter-rouge">Person.new</code> or <code class="language-plaintext highlighter-rouge">Person#update</code> just like we would if the form used a single field to represent the full date.</p>

<p>In addition to the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-date_select"><code class="language-plaintext highlighter-rouge">date_select</code></a> helper, Rails provides <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-time_select"><code class="language-plaintext highlighter-rouge">time_select</code></a> which outputs select boxes for the hour and minute. There is <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-datetime_select"><code class="language-plaintext highlighter-rouge">datetime_select</code></a> as well which combines both date and time select boxes.</p>

<h3 id="select-boxes-for-time-or-date-components">Select Boxes for Time or Date Components</h3>

<p>Rails also provides helpers to render select boxes for individual date and time components: <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-select_year"><code class="language-plaintext highlighter-rouge">select_year</code></a>, <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-select_month"><code class="language-plaintext highlighter-rouge">select_month</code></a>, <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-select_day"><code class="language-plaintext highlighter-rouge">select_day</code></a>, <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-select_hour"><code class="language-plaintext highlighter-rouge">select_hour</code></a>, <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-select_minute"><code class="language-plaintext highlighter-rouge">select_minute</code></a>, and <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-select_second"><code class="language-plaintext highlighter-rouge">select_second</code></a>.  These helpers are “bare” methods, meaning they are not called on a form builder instance.  For example:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">select_year</span> <span class="mi">2024</span><span class="p">,</span> <span class="ss">prefix: </span><span class="s2">"party"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The above outputs a select box like:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"party_year"</span> <span class="na">name=</span><span class="s">"party[year]"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2019"</span><span class="nt">&gt;</span>2019<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2020"</span><span class="nt">&gt;</span>2020<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2021"</span><span class="nt">&gt;</span>2021<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2022"</span><span class="nt">&gt;</span>2022<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2023"</span><span class="nt">&gt;</span>2023<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2024"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>2024<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2025"</span><span class="nt">&gt;</span>2025<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2026"</span><span class="nt">&gt;</span>2026<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2027"</span><span class="nt">&gt;</span>2027<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2028"</span><span class="nt">&gt;</span>2028<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2029"</span><span class="nt">&gt;</span>2029<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<p>For each of these helpers, you may specify a <code class="language-plaintext highlighter-rouge">Date</code> or <code class="language-plaintext highlighter-rouge">Time</code> object instead of a number as the default value (for example <code class="language-plaintext highlighter-rouge">&lt;%= select_year Date.today, prefix: "party" %&gt;</code> instead of the above), and the appropriate date and time parts will be extracted and used.</p>

<h3 id="selecting-time-zone">Selecting Time Zone</h3>

<p>When you need to ask users what time zone they are in, there is a very convenient <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-time_zone_select"><code class="language-plaintext highlighter-rouge">time_zone_select</code></a> helper to use.</p>

<p>Typically, you would have to provide a list of time zone options for users to select from. This can get tedious if not for the list of pre-defined <a href="https://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html"><code class="language-plaintext highlighter-rouge">ActiveSupport::TimeZone</code></a> objects. The <code class="language-plaintext highlighter-rouge">time_with_zone</code> helper wraps this and can be used as follows:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">time_zone_select</span> <span class="ss">:time_zone</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"time_zone"</span> <span class="na">id=</span><span class="s">"time_zone"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"International Date Line West"</span><span class="nt">&gt;</span>(GMT-12:00) International Date Line West<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"American Samoa"</span><span class="nt">&gt;</span>(GMT-11:00) American Samoa<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Midway Island"</span><span class="nt">&gt;</span>(GMT-11:00) Midway Island<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Hawaii"</span><span class="nt">&gt;</span>(GMT-10:00) Hawaii<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Alaska"</span><span class="nt">&gt;</span>(GMT-09:00) Alaska<span class="nt">&lt;/option&gt;</span>
  ...
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Samoa"</span><span class="nt">&gt;</span>(GMT+13:00) Samoa<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Tokelau Is."</span><span class="nt">&gt;</span>(GMT+13:00) Tokelau Is.<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<h2 id="collection-related-helpers">Collection Related Helpers</h2>

<p>If you need to generate a set of choices from a collection of arbitrary objects, Rails has <code class="language-plaintext highlighter-rouge">collection_select</code>, <code class="language-plaintext highlighter-rouge">collection_radio_button</code>, and <code class="language-plaintext highlighter-rouge">collection_checkboxes</code> helpers.</p>

<p>To see when these helpers are useful, suppose you have a <code class="language-plaintext highlighter-rouge">City</code> model and corresponding <code class="language-plaintext highlighter-rouge">belongs_to :city</code> association with <code class="language-plaintext highlighter-rouge">Person</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">City</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">belongs_to</span> <span class="ss">:city</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Assuming we have the following cities stored in the database:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">City</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">).</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">city</span><span class="o">|</span> <span class="p">[</span><span class="n">city</span><span class="p">.</span><span class="nf">name</span><span class="p">,</span> <span class="n">city</span><span class="p">.</span><span class="nf">id</span><span class="p">]</span> <span class="p">}</span>
<span class="c1"># =&gt; [["Berlin", 1], ["Chicago", 3], ["Madrid", 2]]</span>
</code></pre></div></div>

<p>We can allow the user to choose from the cities with the following form:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city_id</span><span class="p">,</span> <span class="no">City</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">).</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">city</span><span class="o">|</span> <span class="p">[</span><span class="n">city</span><span class="p">.</span><span class="nf">name</span><span class="p">,</span> <span class="n">city</span><span class="p">.</span><span class="nf">id</span><span class="p">]</span> <span class="p">}</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The above will generate this HTML:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[city_id]"</span> <span class="na">id=</span><span class="s">"person_city_id"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"3"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<p>The above example shows how you’d generate the choices manually. However, Rails has helpers that generate choices from a collection without having to explicitly iterate over it. These helpers determine the value and text label of each choice by calling specified methods on each object in the collection.</p>

<p>NOTE: When rendering a field for a <code class="language-plaintext highlighter-rouge">belongs_to</code> association, you must specify the name of the foreign key (<code class="language-plaintext highlighter-rouge">city_id</code> in the above example), rather than the name of the association itself.</p>

<h3 id="the-collection_select-helper">The <code class="language-plaintext highlighter-rouge">collection_select</code> Helper</h3>

<p>To generate a select box, we can use <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-collection_select"><code class="language-plaintext highlighter-rouge">collection_select</code></a>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">collection_select</span> <span class="ss">:city_id</span><span class="p">,</span> <span class="no">City</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">),</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The above outputs the same HTML as the manual iteration above:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[city_id]"</span> <span class="na">id=</span><span class="s">"person_city_id"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"3"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div></div>

<p>NOTE: The order of arguments for <code class="language-plaintext highlighter-rouge">collection_select</code> is different from the order for <code class="language-plaintext highlighter-rouge">select</code>. With <code class="language-plaintext highlighter-rouge">collection_select</code> we specify the value method first (<code class="language-plaintext highlighter-rouge">:id</code> in the example above), and the text label method second (<code class="language-plaintext highlighter-rouge">:name</code> in the example above).  This is opposite of the order used when specifying choices for the <code class="language-plaintext highlighter-rouge">select</code> helper, where the text label comes first and the value second (<code class="language-plaintext highlighter-rouge">["Berlin", 1]</code> in the previous example).</p>

<h3 id="the-collection_radio_buttons-helper">The <code class="language-plaintext highlighter-rouge">collection_radio_buttons</code> Helper</h3>

<p>To generate a set of radio buttons, we can use <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-collection_radio_buttons"><code class="language-plaintext highlighter-rouge">collection_radio_buttons</code></a>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">collection_radio_buttons</span> <span class="ss">:city_id</span><span class="p">,</span> <span class="no">City</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">),</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"person[city_id]"</span> <span class="na">id=</span><span class="s">"person_city_id_1"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_city_id_1"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">value=</span><span class="s">"3"</span> <span class="na">name=</span><span class="s">"person[city_id]"</span> <span class="na">id=</span><span class="s">"person_city_id_3"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_city_id_3"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">value=</span><span class="s">"2"</span> <span class="na">name=</span><span class="s">"person[city_id]"</span> <span class="na">id=</span><span class="s">"person_city_id_2"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_city_id_2"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/label&gt;</span>
</code></pre></div></div>

<h3 id="the-collection_checkboxes-helper">The <code class="language-plaintext highlighter-rouge">collection_checkboxes</code> Helper</h3>

<p>To generate a set of check boxes — for example, to support a <code class="language-plaintext highlighter-rouge">has_and_belongs_to_many</code> association — we can use <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-collection_checkboxes"><code class="language-plaintext highlighter-rouge">collection_checkboxes</code></a>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">collection_checkboxes</span> <span class="ss">:interest_ids</span><span class="p">,</span> <span class="no">Interest</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">),</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"person[interest_id][]"</span> <span class="na">value=</span><span class="s">"3"</span> <span class="na">id=</span><span class="s">"person_interest_id_3"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_interest_id_3"</span><span class="nt">&gt;</span>Engineering<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"person[interest_id][]"</span> <span class="na">value=</span><span class="s">"4"</span> <span class="na">id=</span><span class="s">"person_interest_id_4"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_interest_id_4"</span><span class="nt">&gt;</span>Math<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"person[interest_id][]"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="na">id=</span><span class="s">"person_interest_id_1"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_interest_id_1"</span><span class="nt">&gt;</span>Science<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"person[interest_id][]"</span> <span class="na">value=</span><span class="s">"2"</span> <span class="na">id=</span><span class="s">"person_interest_id_2"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_interest_id_2"</span><span class="nt">&gt;</span>Technology<span class="nt">&lt;/label&gt;</span>
</code></pre></div></div>

<h2 id="uploading-files">Uploading Files</h2>

<p>A common task with forms is allowing users to upload a file. It could be an avatar image or a CSV file with data to process. File upload fields can be rendered with the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html#method-i-file_field"><code class="language-plaintext highlighter-rouge">file_field</code></a> helper.</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">file_field</span> <span class="ss">:csv_file</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The most important thing to remember with file uploads is that the rendered form’s <code class="language-plaintext highlighter-rouge">enctype</code> attribute <strong>must</strong> be set to <code class="language-plaintext highlighter-rouge">multipart/form-data</code>. This is done automatically if you use a <code class="language-plaintext highlighter-rouge">file_field</code> inside a <code class="language-plaintext highlighter-rouge">form_with</code>. You can also set the attribute manually:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s2">"/uploads"</span><span class="p">,</span> <span class="ss">multipart: </span><span class="kp">true</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">file_field_tag</span> <span class="ss">:csv_file</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Both of which, output the following HTML form:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span> <span class="na">action=</span><span class="s">"/people"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>Note that, per <code class="language-plaintext highlighter-rouge">form_with</code> conventions, the field names in the two forms above will be different. In the first form, it will be <code class="language-plaintext highlighter-rouge">person[csv_file]</code> (accessible via <code class="language-plaintext highlighter-rouge">params[:person][:csv_file]</code>), and in the second form it will be just <code class="language-plaintext highlighter-rouge">csv_file</code> (accessible via <code class="language-plaintext highlighter-rouge">params[:csv_file]</code>).</p>

<h3 id="csv-file-upload-example">CSV File Upload Example</h3>

<p>When using <code class="language-plaintext highlighter-rouge">file_field</code>, the object in the <code class="language-plaintext highlighter-rouge">params</code> hash is an instance of <a href="https://api.rubyonrails.org/classes/ActionDispatch/Http/UploadedFile.html"><code class="language-plaintext highlighter-rouge">ActionDispatch::Http::UploadedFile</code></a>. Here is an example of how to save data in an uploaded CSV file to records in your application:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">require</span> <span class="s2">"csv"</span>

  <span class="k">def</span> <span class="nf">upload</span>
    <span class="n">uploaded_file</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="ss">:csv_file</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">uploaded_file</span><span class="p">.</span><span class="nf">present?</span>
      <span class="n">csv_data</span> <span class="o">=</span> <span class="no">CSV</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">uploaded_file</span><span class="p">.</span><span class="nf">read</span><span class="p">,</span> <span class="ss">headers: </span><span class="kp">true</span><span class="p">)</span>
      <span class="n">csv_data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
        <span class="c1"># Process each row of the CSV file</span>
        <span class="c1"># SomeInvoiceModel.create(amount: row['Amount'], status: row['Status'])</span>
        <span class="no">Rails</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="n">row</span><span class="p">.</span><span class="nf">inspect</span>
        <span class="c1">#&lt;CSV::Row "id":"po_1KE3FRDSYPMwkcNz9SFKuaYd" "Amount":"96.22" "Created (UTC)":"2022-01-04 02:59" "Arrival Date (UTC)":"2022-01-05 00:00" "Status":"paid"&gt;</span>
      <span class="k">end</span>
    <span class="k">end</span>
    <span class="c1"># ...</span>
  <span class="k">end</span>
</code></pre></div></div>

<p>If the file is an image that needs to be stored with a model (e.g. user’s profile picture), there are a number of tasks to consider, like where to store the file (on Disk, Amazon S3, etc), resizing image files, and generating thumbnails, etc. <a href="active_storage_overview.html">Active Storage</a> is designed to assist with these tasks.</p>

<h2 id="customizing-form-builders">Customizing Form Builders</h2>

<p>We call the objects yielded by <code class="language-plaintext highlighter-rouge">form_with</code> or <code class="language-plaintext highlighter-rouge">fields_for</code> Form Builders. Form builders allow you to generate form elements associated with a model object
and are an instance of
<a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html"><code class="language-plaintext highlighter-rouge">ActionView::Helpers::FormBuilder</code></a>. This class can be extended to add custom helpers for your application.</p>

<p>For example, if you want to display a <code class="language-plaintext highlighter-rouge">text_field</code> along with a <code class="language-plaintext highlighter-rouge">label</code> across your application, you could add the following helper method to <code class="language-plaintext highlighter-rouge">application_helper.rb</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">ApplicationHelper</span>
  <span class="k">def</span> <span class="nf">text_field_with_label</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span>
    <span class="n">form</span><span class="p">.</span><span class="nf">label</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="o">+</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>And use it in a form as usual:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">text_field_with_label</span> <span class="n">form</span><span class="p">,</span> <span class="ss">:first_name</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>But you can also create a subclass of <code class="language-plaintext highlighter-rouge">ActionView::Helpers::FormBuilder</code>, and
add the helpers there. After defining this <code class="language-plaintext highlighter-rouge">LabellingFormBuilder</code> subclass:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">LabellingFormBuilder</span> <span class="o">&lt;</span> <span class="no">ActionView</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">FormBuilder</span>
  <span class="k">def</span> <span class="nf">text_field</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{})</span>
    <span class="c1"># super will call the original text_field method</span>
    <span class="n">label</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="o">+</span> <span class="k">super</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The above form can be replaced with:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span><span class="p">,</span> <span class="ss">builder: </span><span class="no">LabellingFormBuilder</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:first_name</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>If you reuse this frequently you could define a <code class="language-plaintext highlighter-rouge">labeled_form_with</code> helper that automatically applies the <code class="language-plaintext highlighter-rouge">builder: LabellingFormBuilder</code> option:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">ApplicationHelper</span>
  <span class="k">def</span> <span class="nf">labeled_form_with</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
    <span class="n">options</span><span class="p">[</span><span class="ss">:builder</span><span class="p">]</span> <span class="o">=</span> <span class="no">LabellingFormBuilder</span>
    <span class="n">form_with</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The above can be used instead of <code class="language-plaintext highlighter-rouge">form_with</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">labeled_form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:first_name</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>All three cases above (the <code class="language-plaintext highlighter-rouge">text_field_with_label</code> helper, the <code class="language-plaintext highlighter-rouge">LabellingFormBuilder</code> subclass, and the <code class="language-plaintext highlighter-rouge">labeled_form_with</code> helper) will generate the same HTML output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/people"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_first_name"</span><span class="nt">&gt;</span>First name<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"person[first_name]"</span> <span class="na">id=</span><span class="s">"person_first_name"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>The form builder used also determines what happens when you do:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="n">f</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">f</code> is an instance of <code class="language-plaintext highlighter-rouge">ActionView::Helpers::FormBuilder</code>, then this will render the <code class="language-plaintext highlighter-rouge">form</code> partial, setting the partial’s object to the form builder. If the form builder is of class <code class="language-plaintext highlighter-rouge">LabellingFormBuilder</code>, then the <code class="language-plaintext highlighter-rouge">labelling_form</code> partial would be rendered instead.</p>

<p>Form builder customizations, such as <code class="language-plaintext highlighter-rouge">LabellingFormBuilder</code>, do hide the implementation details (and may seem like an overkill for the simple example above). Choose between different customizations, extending <code class="language-plaintext highlighter-rouge">FormBuilder</code> class or creating helpers, based on how frequently your forms use the custom elements.</p>

<h2 id="form-input-naming-conventions-and-params-hash">Form Input Naming Conventions and <code class="language-plaintext highlighter-rouge">params</code> Hash</h2>

<p>All of the form helpers described above help with generating the HTML for form elements so that the user can enter various types of input. How do you access the user input values in the Controller? The <code class="language-plaintext highlighter-rouge">params</code> hash is the answer. You’ve already seen the <code class="language-plaintext highlighter-rouge">params</code> hash in the above example. This section will more explicitly go over naming conventions around how form input is structured in the <code class="language-plaintext highlighter-rouge">params</code> hash.</p>

<p>The <code class="language-plaintext highlighter-rouge">params</code> hash can contain arrays and arrays of hashes. Values can be at the top level of the <code class="language-plaintext highlighter-rouge">params</code> hash or nested in another hash. For example, in a standard <code class="language-plaintext highlighter-rouge">create</code> action for a Person model, <code class="language-plaintext highlighter-rouge">params[:person]</code> will be a hash of all the attributes for the <code class="language-plaintext highlighter-rouge">Person</code> object.</p>

<p>Note that HTML forms don’t have an inherent structure to the user input data, all they generate is name-value string pairs. The arrays and hashes you see in your application are the result of parameter naming conventions that Rails uses.</p>

<p>NOTE: The fields in the <code class="language-plaintext highlighter-rouge">params</code> hash need to be <a href="#permitting-parameters-in-the-controller">permitted in the controller</a>.</p>

<h3 id="basic-structure">Basic Structure</h3>

<p>The two basic structures for user input form data are arrays and hashes.</p>

<p>Hashes mirror the syntax used for accessing the value in <code class="language-plaintext highlighter-rouge">params</code>. For example, if a form contains:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_name"</span> <span class="na">name=</span><span class="s">"person[name]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"Henry"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p>the <code class="language-plaintext highlighter-rouge">params</code> hash will contain</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span> <span class="s2">"person"</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Henry"</span> <span class="p">}</span> <span class="p">}</span>
</code></pre></div></div>

<p>and <code class="language-plaintext highlighter-rouge">params[:person][:name]</code> will retrieve the submitted value in the controller.</p>

<p>Hashes can be nested as many levels as required, for example:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_address_city"</span> <span class="na">name=</span><span class="s">"person[address][city]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"New York"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p>The above will result in the <code class="language-plaintext highlighter-rouge">params</code> hash being</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span> <span class="s2">"person"</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s2">"address"</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"New York"</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
</code></pre></div></div>

<p>The other structure is an Array. Normally Rails ignores duplicate parameter names, but if the parameter name ends with an empty set of square brackets <code class="language-plaintext highlighter-rouge">[]</code> then the parameters will be accumulated in an Array.</p>

<p>For example, if you want users to be able to input multiple phone numbers, you could place this in the form:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[phone_number][]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[phone_number][]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[phone_number][]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p>This would result in <code class="language-plaintext highlighter-rouge">params[:person][:phone_number]</code> being an array containing the submitted phone numbers:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span> <span class="s2">"person"</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s2">"phone_number"</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"555-0123"</span><span class="p">,</span> <span class="s2">"555-0124"</span><span class="p">,</span> <span class="s2">"555-0125"</span><span class="p">]</span> <span class="p">}</span> <span class="p">}</span>
</code></pre></div></div>

<h3 id="combining-arrays-and-hashes">Combining Arrays and Hashes</h3>

<p>You can mix and match these two concepts. One element of a hash might be an array as in the previous example <code class="language-plaintext highlighter-rouge">params[:person]</code> hash has a key called <code class="language-plaintext highlighter-rouge">[:phone_number]</code> whose value is an array.</p>

<p>You also can have an array of hashes. For example, you can create any number of addresses by repeating the following form fragment:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][line1]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][line2]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][city]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][line1]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][line2]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][city]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p>This would result in <code class="language-plaintext highlighter-rouge">params[:person][:addresses]</code> being an array of hashes. Each hash in the array will have the keys <code class="language-plaintext highlighter-rouge">line1</code>, <code class="language-plaintext highlighter-rouge">line2</code>, and <code class="language-plaintext highlighter-rouge">city</code>, something like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span> <span class="s2">"person"</span> <span class="o">=&gt;</span>
  <span class="p">{</span> <span class="s2">"addresses"</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="p">{</span> <span class="s2">"line1"</span> <span class="o">=&gt;</span> <span class="s2">"1000 Fifth Avenue"</span><span class="p">,</span>
      <span class="s2">"line2"</span> <span class="o">=&gt;</span> <span class="s2">""</span><span class="p">,</span>
      <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"New York"</span>
    <span class="p">},</span>
    <span class="p">{</span> <span class="s2">"line1"</span> <span class="o">=&gt;</span> <span class="s2">"Calle de Ruiz de Alarcón"</span><span class="p">,</span>
      <span class="s2">"line2"</span> <span class="o">=&gt;</span> <span class="s2">""</span><span class="p">,</span>
      <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"Madrid"</span>
    <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>It’s important to note that while hashes can be nested arbitrarily, only one level of “arrayness” is allowed. Arrays can usually be replaced by hashes. For example, instead of an array of model objects, you can have a hash of model objects keyed by their id or similar.</p>

<p>WARNING: Array parameters do not play well with the <code class="language-plaintext highlighter-rouge">checkbox</code> helper. According to the HTML specification unchecked checkboxes submit no value. However it is often convenient for a checkbox to always submit a value. The <code class="language-plaintext highlighter-rouge">checkbox</code> helper fakes this by creating an auxiliary hidden input with the same name. If the checkbox is unchecked only the hidden input is submitted. If it is checked then both are submitted but the value submitted by the checkbox takes precedence. There is a <code class="language-plaintext highlighter-rouge">include_hidden</code> option that can be set to <code class="language-plaintext highlighter-rouge">false</code> if you want to omit this hidden field. By default, this option is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<h3 id="hashes-with-an-index">Hashes with an Index</h3>

<p>Let’s say you want to render a form with a set of fields for each of a person’s
addresses. The <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-fields_for"><code class="language-plaintext highlighter-rouge">fields_for</code></a> helper with its <code class="language-plaintext highlighter-rouge">:index</code> option can assist:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">person_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">person_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="vi">@person</span><span class="p">.</span><span class="nf">addresses</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">address</span><span class="o">|</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">person_form</span><span class="p">.</span><span class="nf">fields_for</span> <span class="n">address</span><span class="p">,</span> <span class="ss">index: </span><span class="n">address</span><span class="p">.</span><span class="nf">id</span> <span class="k">do</span> <span class="o">|</span><span class="n">address_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">address_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:city</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Assuming the person has two addresses with IDs 23 and 45, the above form would
render this output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">action=</span><span class="s">"/people/1"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"patch"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_name"</span> <span class="na">name=</span><span class="s">"person[name]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_address_23_city"</span> <span class="na">name=</span><span class="s">"person[address][23][city]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_address_45_city"</span> <span class="na">name=</span><span class="s">"person[address][45][city]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>Which will result in a <code class="language-plaintext highlighter-rouge">params</code> hash that looks like:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="s2">"person"</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Bob"</span><span class="p">,</span>
    <span class="s2">"address"</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="s2">"23"</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"Paris"</span>
      <span class="p">},</span>
      <span class="s2">"45"</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"London"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>All of the form inputs map to the <code class="language-plaintext highlighter-rouge">"person"</code> hash because we called <code class="language-plaintext highlighter-rouge">fields_for</code>
on the <code class="language-plaintext highlighter-rouge">person_form</code> form builder. Also, by specifying <code class="language-plaintext highlighter-rouge">index: address.id</code>, we
rendered the <code class="language-plaintext highlighter-rouge">name</code> attribute of each city input as
<code class="language-plaintext highlighter-rouge">person[address][#{address.id}][city]</code> instead of <code class="language-plaintext highlighter-rouge">person[address][city]</code>. This
way you can tell which <code class="language-plaintext highlighter-rouge">Address</code> records should be modified when processing the
<code class="language-plaintext highlighter-rouge">params</code> hash.</p>

<p>You can find more details about <code class="language-plaintext highlighter-rouge">fields_for</code> index option in the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-fields_for">API docs</a>.</p>

<h2 id="building-complex-forms">Building Complex Forms</h2>

<p>As your application grows, you may need to create more complex forms, beyond editing a single object. For example, when creating a <code class="language-plaintext highlighter-rouge">Person</code> you can allow the user to create multiple <code class="language-plaintext highlighter-rouge">Address</code> records (home, work, etc.) within the same form. When editing a <code class="language-plaintext highlighter-rouge">Person</code> record later, the user should be able to add, remove, or update addresses as well.</p>

<h3 id="configuring-the-model-for-nested-attributes">Configuring the Model for Nested Attributes</h3>

<p>For editing an associated record for a given model (<code class="language-plaintext highlighter-rouge">Person</code> in this case), Active Record provides model level support via the <a href="https://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html#method-i-accepts_nested_attributes_for"><code class="language-plaintext highlighter-rouge">accepts_nested_attributes_for</code></a> method:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:addresses</span><span class="p">,</span> <span class="ss">inverse_of: :person</span>
  <span class="n">accepts_nested_attributes_for</span> <span class="ss">:addresses</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Address</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">belongs_to</span> <span class="ss">:person</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This creates an <code class="language-plaintext highlighter-rouge">addresses_attributes=</code> method on <code class="language-plaintext highlighter-rouge">Person</code> that allows you to create, update, and destroy addresses.</p>

<h3 id="nested-forms-in-the-view">Nested Forms in the View</h3>

<p>The following form allows a user to create a <code class="language-plaintext highlighter-rouge">Person</code> and its associated addresses.</p>

<pre><code class="language-html+erb">&lt;%= form_with model: @person do |form| %&gt;
  Addresses:
  &lt;ul&gt;
    &lt;%= form.fields_for :addresses do |addresses_form| %&gt;
      &lt;li&gt;
        &lt;%= addresses_form.label :kind %&gt;
        &lt;%= addresses_form.text_field :kind %&gt;

        &lt;%= addresses_form.label :street %&gt;
        &lt;%= addresses_form.text_field :street %&gt;
        ...
      &lt;/li&gt;
    &lt;% end %&gt;
  &lt;/ul&gt;
&lt;% end %&gt;
</code></pre>

<p>When an association accepts nested attributes, <code class="language-plaintext highlighter-rouge">fields_for</code> renders its block once for every element of the association. In particular, if a person has no addresses, it renders nothing.</p>

<p>A common pattern is for the controller to build one or more empty children so that at least one set of fields is shown to the user. The example below would result in 2 sets of address fields being rendered on the new person form.</p>

<p>For example, the above <code class="language-plaintext highlighter-rouge">form_with</code> with this change:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">new</span>
  <span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
  <span class="mi">2</span><span class="p">.</span><span class="nf">times</span> <span class="p">{</span> <span class="vi">@person</span><span class="p">.</span><span class="nf">addresses</span><span class="p">.</span><span class="nf">build</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Will output the following HTML:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/people"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">value=</span><span class="s">"lWTbg-4_5i4rNe6ygRFowjDfTj7uf-6UPFQnsL7H9U9Fe2GGUho5PuOxfcohgm2Z-By3veuXwcwDIl-MLdwFRg"</span> <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;</span>
  Addresses:
  <span class="nt">&lt;ul&gt;</span>
      <span class="nt">&lt;li&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_addresses_attributes_0_kind"</span><span class="nt">&gt;</span>Kind<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"person[addresses_attributes][0][kind]"</span> <span class="na">id=</span><span class="s">"person_addresses_attributes_0_kind"</span><span class="nt">&gt;</span>

        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_addresses_attributes_0_street"</span><span class="nt">&gt;</span>Street<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"person[addresses_attributes][0][street]"</span> <span class="na">id=</span><span class="s">"person_addresses_attributes_0_street"</span><span class="nt">&gt;</span>
        ...
      <span class="nt">&lt;/li&gt;</span>

      <span class="nt">&lt;li&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_addresses_attributes_1_kind"</span><span class="nt">&gt;</span>Kind<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"person[addresses_attributes][1][kind]"</span> <span class="na">id=</span><span class="s">"person_addresses_attributes_1_kind"</span><span class="nt">&gt;</span>

        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_addresses_attributes_1_street"</span><span class="nt">&gt;</span>Street<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"person[addresses_attributes][1][street]"</span> <span class="na">id=</span><span class="s">"person_addresses_attributes_1_street"</span><span class="nt">&gt;</span>
        ...
      <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">fields_for</code> yields a form builder. The parameter names will be what
<code class="language-plaintext highlighter-rouge">accepts_nested_attributes_for</code> expects. For example, when creating a person
with 2 addresses, the submitted parameters in <code class="language-plaintext highlighter-rouge">params</code> would look like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="s2">"person"</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"John Doe"</span><span class="p">,</span>
    <span class="s2">"addresses_attributes"</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="s2">"0"</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s2">"kind"</span> <span class="o">=&gt;</span> <span class="s2">"Home"</span><span class="p">,</span>
        <span class="s2">"street"</span> <span class="o">=&gt;</span> <span class="s2">"221b Baker Street"</span>
      <span class="p">},</span>
      <span class="s2">"1"</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s2">"kind"</span> <span class="o">=&gt;</span> <span class="s2">"Office"</span><span class="p">,</span>
        <span class="s2">"street"</span> <span class="o">=&gt;</span> <span class="s2">"31 Spooner Street"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The actual value of the keys in the <code class="language-plaintext highlighter-rouge">:addresses_attributes</code> hash is not important. But they need to be strings of integers and different for each address.</p>

<p>If the associated object is already saved, <code class="language-plaintext highlighter-rouge">fields_for</code> autogenerates a hidden input with the <code class="language-plaintext highlighter-rouge">id</code> of the saved record. You can disable this by passing <code class="language-plaintext highlighter-rouge">include_id: false</code> to <code class="language-plaintext highlighter-rouge">fields_for</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="s2">"person"</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"John Doe"</span><span class="p">,</span>
    <span class="s2">"addresses_attributes"</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="s2">"0"</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s2">"id"</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">"kind"</span> <span class="o">=&gt;</span> <span class="s2">"Home"</span><span class="p">,</span>
        <span class="s2">"street"</span> <span class="o">=&gt;</span> <span class="s2">"221b Baker Street"</span>
      <span class="p">},</span>
      <span class="s2">"1"</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s2">"id"</span> <span class="o">=&gt;</span> <span class="s2">"2"</span><span class="p">,</span>
        <span class="s2">"kind"</span> <span class="o">=&gt;</span> <span class="s2">"Office"</span><span class="p">,</span>
        <span class="s2">"street"</span> <span class="o">=&gt;</span> <span class="s2">"31 Spooner Street"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="permitting-parameters-in-the-controller">Permitting Parameters in the Controller</h3>

<p>As usual you need to <a href="action_controller_overview.html#strong-parameters">declare the permitted
parameters</a> in the controller
before you pass them to the model:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create</span>
  <span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">person_params</span><span class="p">)</span>
  <span class="c1"># ...</span>
<span class="k">end</span>

<span class="kp">private</span>
  <span class="k">def</span> <span class="nf">person_params</span>
    <span class="n">params</span><span class="p">.</span><span class="nf">expect</span><span class="p">(</span><span class="ss">person: </span><span class="p">[</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">addresses_attributes: </span><span class="p">[[</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:kind</span><span class="p">,</span> <span class="ss">:street</span> <span class="p">]]</span> <span class="p">])</span>
  <span class="k">end</span>
</code></pre></div></div>

<h3 id="removing-associated-objects">Removing Associated Objects</h3>

<p>You can allow users to delete associated objects by passing <code class="language-plaintext highlighter-rouge">allow_destroy: true</code> to <code class="language-plaintext highlighter-rouge">accepts_nested_attributes_for</code></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:addresses</span>
  <span class="n">accepts_nested_attributes_for</span> <span class="ss">:addresses</span><span class="p">,</span> <span class="ss">allow_destroy: </span><span class="kp">true</span>
<span class="k">end</span>
</code></pre></div></div>

<p>If the hash of attributes for an object contains the key <code class="language-plaintext highlighter-rouge">_destroy</code> with a value
that evaluates to <code class="language-plaintext highlighter-rouge">true</code> (e.g. <code class="language-plaintext highlighter-rouge">1</code>, <code class="language-plaintext highlighter-rouge">'1'</code>, <code class="language-plaintext highlighter-rouge">true</code>, or <code class="language-plaintext highlighter-rouge">'true'</code>) then the object will be
destroyed. This form allows users to remove addresses:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  Addresses:
  <span class="nt">&lt;ul&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">fields_for</span> <span class="ss">:addresses</span> <span class="k">do</span> <span class="o">|</span><span class="n">addresses_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
      <span class="nt">&lt;li&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">checkbox</span> <span class="ss">:_destroy</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:kind</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:kind</span> <span class="cp">%&gt;</span>
        ...
      <span class="nt">&lt;/li&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>The HTML for the <code class="language-plaintext highlighter-rouge">_destroy</code> field:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"person[addresses_attributes][0][_destroy]"</span> <span class="na">id=</span><span class="s">"person_addresses_attributes_0__destroy"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<p>You also need to update the permitted params in your controller to include
the <code class="language-plaintext highlighter-rouge">_destroy</code> field:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">person_params</span>
  <span class="n">params</span><span class="p">.</span><span class="nf">require</span><span class="p">(</span><span class="ss">:person</span><span class="p">).</span>
    <span class="nf">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">addresses_attributes: </span><span class="p">[</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:kind</span><span class="p">,</span> <span class="ss">:street</span><span class="p">,</span> <span class="ss">:_destroy</span><span class="p">])</span>
<span class="k">end</span>
</code></pre></div></div>

<h3 id="preventing-empty-records">Preventing Empty Records</h3>

<p>It is often useful to ignore sets of fields that the user has not filled in. You can control this by passing a <code class="language-plaintext highlighter-rouge">:reject_if</code> proc to <code class="language-plaintext highlighter-rouge">accepts_nested_attributes_for</code>. This proc will be called with each hash of attributes submitted by the form. If the proc returns <code class="language-plaintext highlighter-rouge">true</code> then Active Record will not build an associated object for that hash. The example below only tries to build an address if the <code class="language-plaintext highlighter-rouge">kind</code> attribute is set.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:addresses</span>
  <span class="n">accepts_nested_attributes_for</span> <span class="ss">:addresses</span><span class="p">,</span> <span class="ss">reject_if: </span><span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">attributes</span><span class="o">|</span> <span class="n">attributes</span><span class="p">[</span><span class="s2">"kind"</span><span class="p">].</span><span class="nf">blank?</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div></div>

<p>As a convenience you can instead pass the symbol <code class="language-plaintext highlighter-rouge">:all_blank</code> which will create a proc that will reject records where all the attributes are blank excluding any value for <code class="language-plaintext highlighter-rouge">_destroy</code>.</p>

<h2 id="forms-to-external-resources">Forms to External Resources</h2>

<p>Rails form helpers can be used to build a form for posting data to an external resource. If the external API expects an <code class="language-plaintext highlighter-rouge">authenticity_token</code> for the resource, this can be passed as an <code class="language-plaintext highlighter-rouge">authenticity_token: 'your_external_token'</code> parameter to <code class="language-plaintext highlighter-rouge">form_with</code>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s1">'http://farfar.away/form'</span><span class="p">,</span> <span class="ss">authenticity_token: </span><span class="s1">'external_token'</span> <span class="k">do</span> <span class="cp">%&gt;</span>
  Form contents
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>At other times, the fields that can be used in the form are limited by an external API and it may be undesirable to generate an <code class="language-plaintext highlighter-rouge">authenticity_token</code>. To <em>not</em> send a token, you can pass <code class="language-plaintext highlighter-rouge">false</code> to the <code class="language-plaintext highlighter-rouge">:authenticity_token</code> option:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s1">'http://farfar.away/form'</span><span class="p">,</span> <span class="ss">authenticity_token: </span><span class="kp">false</span> <span class="k">do</span> <span class="cp">%&gt;</span>
  Form contents
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<h2 id="using-tag-helpers-without-a-form-builder">Using Tag Helpers without a Form Builder</h2>

<p>In case you need to render form fields outside of the context of a form builder, Rails provides tag helpers for common form elements. For example, <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-checkbox_tag"><code class="language-plaintext highlighter-rouge">checkbox_tag</code></a>:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">checkbox_tag</span> <span class="s2">"accept"</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"accept"</span> <span class="na">id=</span><span class="s">"accept"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>Generally, these helpers have the same name as their form builder counterparts plus a <code class="language-plaintext highlighter-rouge">_tag</code> suffix.  For a complete list, see the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html"><code class="language-plaintext highlighter-rouge">FormTagHelper</code> API documentation</a>.</p>

<h2 id="using-form_tag-and-form_for">Using <code class="language-plaintext highlighter-rouge">form_tag</code> and <code class="language-plaintext highlighter-rouge">form_for</code></h2>

<p>Before <code class="language-plaintext highlighter-rouge">form_with</code> was introduced in Rails 5.1 its functionality was split between <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-form_tag"><code class="language-plaintext highlighter-rouge">form_tag</code></a> and <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for"><code class="language-plaintext highlighter-rouge">form_for</code></a>. Both are now discouraged in favor of <code class="language-plaintext highlighter-rouge">form_with</code>, but you can still find them being used in some codebases.</p>
</div>

    <footer class="guide-footer">
      <div class="feedback">
        <h3>Geri Bildirim</h3>
        <p>
          Bu kılavuzun kalitesini artırmamıza yardımcı olmak için geri
          bildirimlerinizi bekliyoruz.
        </p>
        <p>
          Lütfen
          <a href="https://github.com/dilankaya127/rails-tr-TR"
            >GitHub Issues</a
          >
          üzerinden katkıda bulunun.
        </p>
      </div>
    </footer>
  </article>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toc = document.getElementById("toc");
    const headings = document.querySelectorAll(
      ".guide-content h2, .guide-content h3, .guide-content h4"
    );

    if (headings.length > 0) {
      const tocList = document.createElement("ul");
      const headingMap = new Map();

      headings.forEach(function (heading, index) {
        const id = "heading-" + index;
        heading.id = id;

        const li = document.createElement("li");
        const a = document.createElement("a");
        a.href = "#" + id;
        a.textContent = heading.textContent;
        a.className = "toc-" + heading.tagName.toLowerCase();

        li.appendChild(a);
        tocList.appendChild(li);

        headingMap.set(id, a);
      });

      toc.appendChild(tocList);

      // Başlıkların görünürlük oranlarını takip et
      const visibilityMap = new Map();

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const id = entry.target.getAttribute("id");
            visibilityMap.set(id, entry.intersectionRatio);
          });

          // En çok görünür olan başlığı bul
          let mostVisibleId = null;
          let maxRatio = 0;

          visibilityMap.forEach((ratio, id) => {
            if (ratio > maxRatio) {
              mostVisibleId = id;
              maxRatio = ratio;
            }
          });

          if (mostVisibleId) {
            headingMap.forEach((linkEl) => linkEl.classList.remove("active"));
            const activeLink = headingMap.get(mostVisibleId);
            if (activeLink) {
              activeLink.classList.add("active");

              // Ortalamak için:
              const linkTop = activeLink.offsetTop;
              const linkHeight = activeLink.offsetHeight;
              const tocScrollParent = toc;
              const tocHeight = tocScrollParent.offsetHeight;

              tocScrollParent.scrollTo({
                top: linkTop - tocHeight / 2 + linkHeight / 2,
                behavior: "smooth",
              });
            }
          }
        },
        {
          threshold: [0, 0.25, 0.5, 0.75, 1.0],
        }
      );

      headings.forEach((heading) => {
        observer.observe(heading);
      });

      const toggleBtn = document.getElementById("toc-toggle");
      const sidebar = document.querySelector(".guide-sidebar");

      toggleBtn.addEventListener("click", function () {
        sidebar.classList.toggle("open");
      });
      const closeBtn = document.querySelector(".toc-close");

      closeBtn?.addEventListener("click", function () {
        sidebar.classList.remove("open");
      });
    }
  });
</script>

        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Rails Kılavuzları Türkçe Çevirisi. Gönüllüler tarafından hazırlanmıştır.</p>
            <p>Orijinal dokümantasyon <a href="https://guides.rubyonrails.org">Ruby on Rails</a> ekibine aittir.</p>
        </div>
    </footer>

    <script>hljs.highlightAll();</script>
</body>
</html>