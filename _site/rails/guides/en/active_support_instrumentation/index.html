<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Support Instrumentation - Rails Dokümantasyonu - Türkçe</title>
    <link rel="stylesheet" href="/assets/css/rails.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">

    <link rel="icon" type="image/svg" href="/assets/img/logo_rails-circle.svg">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">
                    <a href="/rails/">
                        <img src="/assets/img/logo_rails-circle.svg" alt="Rails Logo" class="logo-image">
                    </a>
                </h1>
                <nav class="nav">
                    <a href="/">Ana Sayfa</a>
                    <!-- <a href="https://dilankaya127.github.io">Portföy</a> -->
                    <a href="https://github.com/dilankaya127/rails-tr-TR">GitHub</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="guide-container">
  <button id="toc-toggle" class="toc-toggle">☰ İçindekiler</button>

  <aside class="guide-sidebar">
    <div class="guide-toc">
      <!-- <h3>İçindekiler</h3> -->
      <div id="toc"></div>
      <button class="toc-close" aria-label="İçindekileri Kapat">✕</button>
    </div>

    <!-- <div class="guide-nav">
            <h3>Diğer(Tüm) Kılavuzlar</h3>
            <ul>
                <li><a href="/rails/guides/tr/getting_started">Rails ile Başlarken</a></li>
                <li><a href="/rails/guides/en/active_record_basics">Active Record Temelleri</a></li>
                <li><a href="/rails/guides//en/action_controller_overview">Action Controller</a></li>
                <li><a href="/rails/guides/tr/action_cable_overview">Action Cable</a></li>
            </ul>
        </div> -->
  </aside>

  <article class="guide-content">
    <!-- <header class="guide-header">
            <h1>Active Support Instrumentation</h1>
            
        </header> -->

    <div class="guide-body"><p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1 id="active-support-instrumentation">Active Support Instrumentation</h1>

<p>Active Support is a part of core Rails that provides Ruby language extensions, utilities, and other things. One of the things it includes is an instrumentation API that can be used inside an application to measure certain actions that occur within Ruby code, such as those inside a Rails application or the framework itself. It is not limited to Rails, however. It can be used independently in other Ruby scripts if desired.</p>

<p>In this guide, you will learn how to use the Active Support’s instrumentation API to measure events inside of Rails and other Ruby code.</p>

<p>After reading this guide, you will know:</p>

<ul>
  <li>What instrumentation can provide.</li>
  <li>How to add a subscriber to a hook.</li>
  <li>The hooks inside the Rails framework for instrumentation.</li>
  <li>How to build a custom instrumentation implementation.</li>
</ul>

<hr />

<h2 id="introduction-to-instrumentation">Introduction to Instrumentation</h2>

<p>The instrumentation API provided by Active Support allows developers to provide hooks which other developers may hook into. There are <a href="#rails-framework-hooks">several of these</a> within the Rails framework. With this API, developers can choose to be notified when certain events occur inside their application or another piece of Ruby code.</p>

<p>For example, there is <a href="#sql-active-record">a hook</a> provided within Active Record that is called every time Active Record uses an SQL query on a database. This hook could be <strong>subscribed</strong> to, and used to track the number of queries during a certain action. There’s <a href="#process-action-action-controller">another hook</a> around the processing of an action of a controller. This could be used, for instance, to track how long a specific action has taken.</p>

<p>You are even able to <a href="#creating-custom-events">create your own events</a> inside your application which you can later subscribe to.</p>

<h2 id="subscribing-to-an-event">Subscribing to an Event</h2>

<p>Use <a href="https://api.rubyonrails.org/classes/ActiveSupport/Notifications.html#method-c-subscribe"><code class="language-plaintext highlighter-rouge">ActiveSupport::Notifications.subscribe</code></a> with a block to listen to any notification. Depending on the amount of
arguments the block takes, you will receive different data.</p>

<p>The first way to subscribe to an event is to use a block with a single argument. The argument will be an instance of
<a href="https://api.rubyonrails.org/classes/ActiveSupport/Notifications/Event.html"><code class="language-plaintext highlighter-rouge">ActiveSupport::Notifications::Event</code></a>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="s2">"process_action.action_controller"</span> <span class="k">do</span> <span class="o">|</span><span class="n">event</span><span class="o">|</span>
  <span class="n">event</span><span class="p">.</span><span class="nf">name</span>        <span class="c1"># =&gt; "process_action.action_controller"</span>
  <span class="n">event</span><span class="p">.</span><span class="nf">duration</span>    <span class="c1"># =&gt; 10 (in milliseconds)</span>
  <span class="n">event</span><span class="p">.</span><span class="nf">allocations</span> <span class="c1"># =&gt; 1826</span>
  <span class="n">event</span><span class="p">.</span><span class="nf">payload</span>     <span class="c1"># =&gt; {:extra=&gt;information}</span>

  <span class="no">Rails</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="s2">"</span><span class="si">#{</span><span class="n">event</span><span class="si">}</span><span class="s2"> Received!"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>If you don’t need all the data recorded by an Event object, you can also specify a
block that takes the following five arguments:</p>

<ul>
  <li>Name of the event</li>
  <li>Time when it started</li>
  <li>Time when it finished</li>
  <li>A unique ID for the instrumenter that fired the event</li>
  <li>The payload for the event</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="s2">"process_action.action_controller"</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">started</span><span class="p">,</span> <span class="n">finished</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">payload</span><span class="o">|</span>
  <span class="c1"># your own custom stuff</span>
  <span class="no">Rails</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="s2">"</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2"> Received! (started: </span><span class="si">#{</span><span class="n">started</span><span class="si">}</span><span class="s2">, finished: </span><span class="si">#{</span><span class="n">finished</span><span class="si">}</span><span class="s2">)"</span> <span class="c1"># process_action.action_controller Received! (started: 2019-05-05 13:43:57 -0800, finished: 2019-05-05 13:43:58 -0800)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>If you are concerned about the accuracy of <code class="language-plaintext highlighter-rouge">started</code> and <code class="language-plaintext highlighter-rouge">finished</code> to compute a precise elapsed time, then use <a href="https://api.rubyonrails.org/classes/ActiveSupport/Notifications.html#method-c-monotonic_subscribe"><code class="language-plaintext highlighter-rouge">ActiveSupport::Notifications.monotonic_subscribe</code></a>. The given block would receive the same arguments as above, but the <code class="language-plaintext highlighter-rouge">started</code> and <code class="language-plaintext highlighter-rouge">finished</code> will have values with an accurate monotonic time instead of wall-clock time.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">monotonic_subscribe</span> <span class="s2">"process_action.action_controller"</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">started</span><span class="p">,</span> <span class="n">finished</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">payload</span><span class="o">|</span>
  <span class="c1"># your own custom stuff</span>
  <span class="n">duration</span> <span class="o">=</span> <span class="n">finished</span> <span class="o">-</span> <span class="n">started</span> <span class="c1"># 1560979.429234 - 1560978.425334</span>
  <span class="no">Rails</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="s2">"</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2"> Received! (duration: </span><span class="si">#{</span><span class="n">duration</span><span class="si">}</span><span class="s2">)"</span> <span class="c1"># process_action.action_controller Received! (duration: 1.0039)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>You may also subscribe to events matching a regular expression. This enables you to subscribe to
multiple events at once. Here’s how to subscribe to everything from <code class="language-plaintext highlighter-rouge">ActionController</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span><span class="p">(</span><span class="sr">/action_controller/</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">event</span><span class="o">|</span>
  <span class="c1"># inspect all ActionController events</span>
<span class="k">end</span>
</code></pre></div></div>

<h2 id="rails-framework-hooks">Rails Framework Hooks</h2>

<p>Within the Ruby on Rails framework, there are a number of hooks provided for common events. These events and their payloads are detailed below.</p>

<h3 id="action-controller">Action Controller</h3>

<h4 id="start_processingaction_controller"><code class="language-plaintext highlighter-rouge">start_processing.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:controller</code></td>
      <td>The controller name</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:action</code></td>
      <td>The action</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:request</code></td>
      <td>The <a href="https://api.rubyonrails.org/classes/ActionDispatch/Request.html"><code class="language-plaintext highlighter-rouge">ActionDispatch::Request</code></a> object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:params</code></td>
      <td>Hash of request parameters without any filtered parameter</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:headers</code></td>
      <td>Request headers</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:format</code></td>
      <td>html/js/json/xml etc</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:method</code></td>
      <td>HTTP request verb</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:path</code></td>
      <td>Request path</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">controller: </span><span class="s2">"PostsController"</span><span class="p">,</span>
  <span class="ss">action: </span><span class="s2">"new"</span><span class="p">,</span>
  <span class="ss">params: </span><span class="p">{</span> <span class="s2">"action"</span> <span class="o">=&gt;</span> <span class="s2">"new"</span><span class="p">,</span> <span class="s2">"controller"</span> <span class="o">=&gt;</span> <span class="s2">"posts"</span> <span class="p">},</span>
  <span class="ss">headers: </span><span class="c1">#&lt;ActionDispatch::Http::Headers:0x0055a67a519b88&gt;,</span>
  <span class="ss">format: :html</span><span class="p">,</span>
  <span class="ss">method: </span><span class="s2">"GET"</span><span class="p">,</span>
  <span class="ss">path: </span><span class="s2">"/posts/new"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="process_actionaction_controller"><code class="language-plaintext highlighter-rouge">process_action.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:controller</code></td>
      <td>The controller name</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:action</code></td>
      <td>The action</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:params</code></td>
      <td>Hash of request parameters without any filtered parameter</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:headers</code></td>
      <td>Request headers</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:format</code></td>
      <td>html/js/json/xml etc</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:method</code></td>
      <td>HTTP request verb</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:path</code></td>
      <td>Request path</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:request</code></td>
      <td>The <a href="https://api.rubyonrails.org/classes/ActionDispatch/Request.html"><code class="language-plaintext highlighter-rouge">ActionDispatch::Request</code></a> object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:response</code></td>
      <td>The <a href="https://api.rubyonrails.org/classes/ActionDispatch/Response.html"><code class="language-plaintext highlighter-rouge">ActionDispatch::Response</code></a> object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:status</code></td>
      <td>HTTP status code</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:view_runtime</code></td>
      <td>Amount spent in view in ms</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:db_runtime</code></td>
      <td>Amount spent executing database queries in ms</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">controller: </span><span class="s2">"PostsController"</span><span class="p">,</span>
  <span class="ss">action: </span><span class="s2">"index"</span><span class="p">,</span>
  <span class="ss">params: </span><span class="p">{</span><span class="s2">"action"</span> <span class="o">=&gt;</span> <span class="s2">"index"</span><span class="p">,</span> <span class="s2">"controller"</span> <span class="o">=&gt;</span> <span class="s2">"posts"</span><span class="p">},</span>
  <span class="ss">headers: </span><span class="c1">#&lt;ActionDispatch::Http::Headers:0x0055a67a519b88&gt;,</span>
  <span class="ss">format: :html</span><span class="p">,</span>
  <span class="ss">method: </span><span class="s2">"GET"</span><span class="p">,</span>
  <span class="ss">path: </span><span class="s2">"/posts"</span><span class="p">,</span>
  <span class="ss">request: </span><span class="c1">#&lt;ActionDispatch::Request:0x00007ff1cb9bd7b8&gt;,</span>
  <span class="ss">response: </span><span class="c1">#&lt;ActionDispatch::Response:0x00007f8521841ec8&gt;,</span>
  <span class="ss">status: </span><span class="mi">200</span><span class="p">,</span>
  <span class="ss">view_runtime: </span><span class="mf">46.848</span><span class="p">,</span>
  <span class="ss">db_runtime: </span><span class="mf">0.157</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="send_fileaction_controller"><code class="language-plaintext highlighter-rouge">send_file.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:path</code></td>
      <td>Complete path to the file</td>
    </tr>
  </tbody>
</table>

<p>Additional keys may be added by the caller.</p>

<h4 id="send_dataaction_controller"><code class="language-plaintext highlighter-rouge">send_data.action_controller</code></h4>

<p><code class="language-plaintext highlighter-rouge">ActionController</code> does not add any specific information to the payload. All options are passed through to the payload.</p>

<h4 id="redirect_toaction_controller"><code class="language-plaintext highlighter-rouge">redirect_to.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:status</code></td>
      <td>HTTP response code</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:location</code></td>
      <td>URL to redirect to</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:request</code></td>
      <td>The <a href="https://api.rubyonrails.org/classes/ActionDispatch/Request.html"><code class="language-plaintext highlighter-rouge">ActionDispatch::Request</code></a> object</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">status: </span><span class="mi">302</span><span class="p">,</span>
  <span class="ss">location: </span><span class="s2">"http://localhost:3000/posts/new"</span><span class="p">,</span>
  <span class="ss">request: </span><span class="o">&lt;</span><span class="no">ActionDispatch</span><span class="o">::</span><span class="no">Request</span><span class="p">:</span><span class="mh">0x00007ff1cb9bd7b8</span><span class="o">&gt;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="halted_callbackaction_controller"><code class="language-plaintext highlighter-rouge">halted_callback.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:filter</code></td>
      <td>Filter that halted the action</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">filter: </span><span class="s2">":halting_filter"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="unpermitted_parametersaction_controller"><code class="language-plaintext highlighter-rouge">unpermitted_parameters.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:keys</code></td>
      <td>The unpermitted keys</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:context</code></td>
      <td>Hash with the following keys: <code class="language-plaintext highlighter-rouge">:controller</code>, <code class="language-plaintext highlighter-rouge">:action</code>, <code class="language-plaintext highlighter-rouge">:params</code>, <code class="language-plaintext highlighter-rouge">:request</code></td>
    </tr>
  </tbody>
</table>

<h4 id="send_streamaction_controller"><code class="language-plaintext highlighter-rouge">send_stream.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:filename</code></td>
      <td>The filename</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:type</code></td>
      <td>HTTP content type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:disposition</code></td>
      <td>HTTP content disposition</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">filename: </span><span class="s2">"subscribers.csv"</span><span class="p">,</span>
  <span class="ss">type: </span><span class="s2">"text/csv"</span><span class="p">,</span>
  <span class="ss">disposition: </span><span class="s2">"attachment"</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="action-controller-caching">Action Controller: Caching</h3>

<h4 id="write_fragmentaction_controller"><code class="language-plaintext highlighter-rouge">write_fragment.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>The complete key</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s1">'posts/1-dashboard-view'</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="read_fragmentaction_controller"><code class="language-plaintext highlighter-rouge">read_fragment.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>The complete key</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s1">'posts/1-dashboard-view'</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="expire_fragmentaction_controller"><code class="language-plaintext highlighter-rouge">expire_fragment.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>The complete key</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s1">'posts/1-dashboard-view'</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="exist_fragmentaction_controller"><code class="language-plaintext highlighter-rouge">exist_fragment?.action_controller</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>The complete key</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s1">'posts/1-dashboard-view'</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="action-dispatch">Action Dispatch</h3>

<h4 id="process_middlewareaction_dispatch"><code class="language-plaintext highlighter-rouge">process_middleware.action_dispatch</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:middleware</code></td>
      <td>Name of the middleware</td>
    </tr>
  </tbody>
</table>

<h4 id="redirectaction_dispatch"><code class="language-plaintext highlighter-rouge">redirect.action_dispatch</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:status</code></td>
      <td>HTTP response code</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:location</code></td>
      <td>URL to redirect to</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:request</code></td>
      <td>The <a href="https://api.rubyonrails.org/classes/ActionDispatch/Request.html"><code class="language-plaintext highlighter-rouge">ActionDispatch::Request</code></a> object</td>
    </tr>
  </tbody>
</table>

<h4 id="requestaction_dispatch"><code class="language-plaintext highlighter-rouge">request.action_dispatch</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:request</code></td>
      <td>The <a href="https://api.rubyonrails.org/classes/ActionDispatch/Request.html"><code class="language-plaintext highlighter-rouge">ActionDispatch::Request</code></a> object</td>
    </tr>
  </tbody>
</table>

<h3 id="action-view">Action View</h3>

<h4 id="render_templateaction_view"><code class="language-plaintext highlighter-rouge">render_template.action_view</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:identifier</code></td>
      <td>Full path to template</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:layout</code></td>
      <td>Applicable layout</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:locals</code></td>
      <td>Local variables passed to template</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">identifier: </span><span class="s2">"/Users/adam/projects/notifications/app/views/posts/index.html.erb"</span><span class="p">,</span>
  <span class="ss">layout: </span><span class="s2">"layouts/application"</span><span class="p">,</span>
  <span class="ss">locals: </span><span class="p">{</span> <span class="ss">foo: </span><span class="s2">"bar"</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="render_partialaction_view"><code class="language-plaintext highlighter-rouge">render_partial.action_view</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:identifier</code></td>
      <td>Full path to template</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:locals</code></td>
      <td>Local variables passed to template</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">identifier: </span><span class="s2">"/Users/adam/projects/notifications/app/views/posts/_form.html.erb"</span><span class="p">,</span>
  <span class="ss">locals: </span><span class="p">{</span> <span class="ss">foo: </span><span class="s2">"bar"</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="render_collectionaction_view"><code class="language-plaintext highlighter-rouge">render_collection.action_view</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:identifier</code></td>
      <td>Full path to template</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:count</code></td>
      <td>Size of collection</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:cache_hits</code></td>
      <td>Number of partials fetched from cache</td>
    </tr>
  </tbody>
</table>

<p>The <code class="language-plaintext highlighter-rouge">:cache_hits</code> key is only included if the collection is rendered with <code class="language-plaintext highlighter-rouge">cached: true</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">identifier: </span><span class="s2">"/Users/adam/projects/notifications/app/views/posts/_post.html.erb"</span><span class="p">,</span>
  <span class="ss">count: </span><span class="mi">3</span><span class="p">,</span>
  <span class="ss">cache_hits: </span><span class="mi">0</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="render_layoutaction_view"><code class="language-plaintext highlighter-rouge">render_layout.action_view</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:identifier</code></td>
      <td>Full path to template</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">identifier: </span><span class="s2">"/Users/adam/projects/notifications/app/views/layouts/application.html.erb"</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="active-record">Active Record</h3>

<h4 id="sqlactive_record"><code class="language-plaintext highlighter-rouge">sql.active_record</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:sql</code></td>
      <td>SQL statement</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:name</code></td>
      <td>Name of the operation</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:binds</code></td>
      <td>Bind parameters</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:type_casted_binds</code></td>
      <td>Typecasted bind parameters</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:async</code></td>
      <td><code class="language-plaintext highlighter-rouge">true</code> if query is loaded asynchronously</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:allow_retry</code></td>
      <td><code class="language-plaintext highlighter-rouge">true</code> if the query can be automatically retried</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:connection</code></td>
      <td>Connection object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:transaction</code></td>
      <td>Current transaction, if any</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:affected_rows</code></td>
      <td>Number of rows affected by the query</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:row_count</code></td>
      <td>Number of rows returned by the query</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:cached</code></td>
      <td><code class="language-plaintext highlighter-rouge">true</code> is added when result comes from the query cache</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:statement_name</code></td>
      <td>SQL Statement name (Postgres only)</td>
    </tr>
  </tbody>
</table>

<p>Adapters may add their own data as well.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">sql: </span><span class="s2">"SELECT </span><span class="se">\"</span><span class="s2">posts</span><span class="se">\"</span><span class="s2">.* FROM </span><span class="se">\"</span><span class="s2">posts</span><span class="se">\"</span><span class="s2"> "</span><span class="p">,</span>
  <span class="ss">name: </span><span class="s2">"Post Load"</span><span class="p">,</span>
  <span class="ss">binds: </span><span class="p">[</span><span class="o">&lt;</span><span class="no">ActiveModel</span><span class="o">::</span><span class="no">Attribute</span><span class="o">::</span><span class="no">WithCastValue</span><span class="p">:</span><span class="mh">0x00007fe19d15dc00</span><span class="o">&gt;</span><span class="p">],</span>
  <span class="ss">type_casted_binds: </span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
  <span class="ss">async: </span><span class="kp">false</span><span class="p">,</span>
  <span class="ss">allow_retry: </span><span class="kp">true</span><span class="p">,</span>
  <span class="ss">connection: </span><span class="o">&lt;</span><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">ConnectionAdapters</span><span class="o">::</span><span class="no">SQLite3Adapter</span><span class="p">:</span><span class="mh">0x00007f9f7a838850</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="ss">transaction: </span><span class="o">&lt;</span><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">ConnectionAdapters</span><span class="o">::</span><span class="no">RealTransaction</span><span class="p">:</span><span class="mh">0x0000000121b5d3e0</span><span class="o">&gt;</span>
  <span class="ss">affected_rows: </span><span class="mi">0</span>
  <span class="ss">row_count: </span><span class="mi">5</span><span class="p">,</span>
  <span class="ss">statement_name: </span><span class="kp">nil</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p>If the query is not executed in the context of a transaction, <code class="language-plaintext highlighter-rouge">:transaction</code> is <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<h4 id="strict_loading_violationactive_record"><code class="language-plaintext highlighter-rouge">strict_loading_violation.active_record</code></h4>

<p>This event is only emitted when <a href="configuring.html#config-active-record-action-on-strict-loading-violation"><code class="language-plaintext highlighter-rouge">config.active_record.action_on_strict_loading_violation</code></a> is set to <code class="language-plaintext highlighter-rouge">:log</code>.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:owner</code></td>
      <td>Model with <code class="language-plaintext highlighter-rouge">strict_loading</code> enabled</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:reflection</code></td>
      <td>Reflection of the association that tried to load</td>
    </tr>
  </tbody>
</table>

<h4 id="instantiationactive_record"><code class="language-plaintext highlighter-rouge">instantiation.active_record</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:record_count</code></td>
      <td>Number of records that instantiated</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:class_name</code></td>
      <td>Record’s class</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">record_count: </span><span class="mi">1</span><span class="p">,</span>
  <span class="ss">class_name: </span><span class="s2">"User"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="start_transactionactive_record"><code class="language-plaintext highlighter-rouge">start_transaction.active_record</code></h4>

<p>This event is emitted when a transaction has been started.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:transaction</code></td>
      <td>Transaction object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:connection</code></td>
      <td>Connection object</td>
    </tr>
  </tbody>
</table>

<p>Please, note that Active Record does not create the actual database transaction
until needed:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">transaction</span> <span class="k">do</span>
  <span class="c1"># We are inside the block, but no event has been triggered yet.</span>

  <span class="c1"># The following line makes Active Record start the transaction.</span>
  <span class="no">User</span><span class="p">.</span><span class="nf">count</span> <span class="c1"># Event fired here.</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Remember that ordinary nested calls do not create new transactions:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">transaction</span> <span class="k">do</span> <span class="o">|</span><span class="n">t1</span><span class="o">|</span>
  <span class="no">User</span><span class="p">.</span><span class="nf">count</span> <span class="c1"># Fires an event for t1.</span>
  <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">transaction</span> <span class="k">do</span> <span class="o">|</span><span class="n">t2</span><span class="o">|</span>
    <span class="c1"># The next line fires no event for t2, because the only</span>
    <span class="c1"># real database transaction in this example is t1.</span>
    <span class="no">User</span><span class="p">.</span><span class="nf">first</span><span class="p">.</span><span class="nf">touch</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>However, if <code class="language-plaintext highlighter-rouge">requires_new: true</code> is passed, you get an event for the nested
transaction too. This might be a savepoint under the hood:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">transaction</span> <span class="k">do</span> <span class="o">|</span><span class="n">t1</span><span class="o">|</span>
  <span class="no">User</span><span class="p">.</span><span class="nf">count</span> <span class="c1"># Fires an event for t1.</span>
  <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">transaction</span><span class="p">(</span><span class="ss">requires_new: </span><span class="kp">true</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">t2</span><span class="o">|</span>
    <span class="no">User</span><span class="p">.</span><span class="nf">first</span><span class="p">.</span><span class="nf">touch</span> <span class="c1"># Fires an event for t2.</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="transactionactive_record"><code class="language-plaintext highlighter-rouge">transaction.active_record</code></h4>

<p>This event is emitted when a database transaction finishes. The state of the
transaction can be found in the <code class="language-plaintext highlighter-rouge">:outcome</code> key.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:transaction</code></td>
      <td>Transaction object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:outcome</code></td>
      <td><code class="language-plaintext highlighter-rouge">:commit</code>, <code class="language-plaintext highlighter-rouge">:rollback</code>, <code class="language-plaintext highlighter-rouge">:restart</code>, or <code class="language-plaintext highlighter-rouge">:incomplete</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:connection</code></td>
      <td>Connection object</td>
    </tr>
  </tbody>
</table>

<p>In practice, you cannot do much with the transaction object, but it may still be
helpful for tracing database activity. For example, by tracking
<code class="language-plaintext highlighter-rouge">transaction.uuid</code>.</p>

<h3 id="action-mailer">Action Mailer</h3>

<h4 id="deliveraction_mailer"><code class="language-plaintext highlighter-rouge">deliver.action_mailer</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:mailer</code></td>
      <td>Name of the mailer class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:message_id</code></td>
      <td>ID of the message, generated by the Mail gem</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:subject</code></td>
      <td>Subject of the mail</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:to</code></td>
      <td>To address(es) of the mail</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:from</code></td>
      <td>From address of the mail</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:bcc</code></td>
      <td>BCC addresses of the mail</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:cc</code></td>
      <td>CC addresses of the mail</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:date</code></td>
      <td>Date of the mail</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:mail</code></td>
      <td>The encoded form of the mail</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:perform_deliveries</code></td>
      <td>Whether delivery of this message is performed or not</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">mailer: </span><span class="s2">"Notification"</span><span class="p">,</span>
  <span class="ss">message_id: </span><span class="s2">"4f5b5491f1774_181b23fc3d4434d38138e5@mba.local.mail"</span><span class="p">,</span>
  <span class="ss">subject: </span><span class="s2">"Rails Guides"</span><span class="p">,</span>
  <span class="ss">to: </span><span class="p">[</span><span class="s2">"users@rails.com"</span><span class="p">,</span> <span class="s2">"dhh@rails.com"</span><span class="p">],</span>
  <span class="ss">from: </span><span class="p">[</span><span class="s2">"me@rails.com"</span><span class="p">],</span>
  <span class="ss">date: </span><span class="no">Sat</span><span class="p">,</span> <span class="mi">10</span> <span class="no">Mar</span> <span class="mi">2012</span> <span class="mi">14</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">09</span> <span class="o">+</span><span class="mo">0100</span><span class="p">,</span>
  <span class="ss">mail: </span><span class="s2">"..."</span><span class="p">,</span> <span class="c1"># omitted for brevity</span>
  <span class="ss">perform_deliveries: </span><span class="kp">true</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="processaction_mailer"><code class="language-plaintext highlighter-rouge">process.action_mailer</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:mailer</code></td>
      <td>Name of the mailer class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:action</code></td>
      <td>The action</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:args</code></td>
      <td>The arguments</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">mailer: </span><span class="s2">"Notification"</span><span class="p">,</span>
  <span class="ss">action: </span><span class="s2">"welcome_email"</span><span class="p">,</span>
  <span class="ss">args: </span><span class="p">[]</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="active-support-caching">Active Support: Caching</h3>

<h4 id="cache_readactive_support"><code class="language-plaintext highlighter-rouge">cache_read.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Key used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:hit</code></td>
      <td>If this read is a hit</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:super_operation</code></td>
      <td><code class="language-plaintext highlighter-rouge">:fetch</code> if a read is done with <a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch"><code class="language-plaintext highlighter-rouge">fetch</code></a></td>
    </tr>
  </tbody>
</table>

<h4 id="cache_read_multiactive_support"><code class="language-plaintext highlighter-rouge">cache_read_multi.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Keys used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:hits</code></td>
      <td>Keys of cache hits</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:super_operation</code></td>
      <td><code class="language-plaintext highlighter-rouge">:fetch_multi</code> if a read is done with <a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch_multi"><code class="language-plaintext highlighter-rouge">fetch_multi</code></a></td>
    </tr>
  </tbody>
</table>

<h4 id="cache_generateactive_support"><code class="language-plaintext highlighter-rouge">cache_generate.active_support</code></h4>

<p>This event is only emitted when <a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch"><code class="language-plaintext highlighter-rouge">fetch</code></a> is called with a block.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Key used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
  </tbody>
</table>

<p>Options passed to <code class="language-plaintext highlighter-rouge">fetch</code> will be merged with the payload when writing to the store.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache_fetch_hitactive_support"><code class="language-plaintext highlighter-rouge">cache_fetch_hit.active_support</code></h4>

<p>This event is only emitted when <a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch"><code class="language-plaintext highlighter-rouge">fetch</code></a> is called with a block.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Key used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
  </tbody>
</table>

<p>Options passed to <code class="language-plaintext highlighter-rouge">fetch</code> will be merged with the payload.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache_writeactive_support"><code class="language-plaintext highlighter-rouge">cache_write.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Key used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
  </tbody>
</table>

<p>Cache stores may add their own data as well.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache_write_multiactive_support"><code class="language-plaintext highlighter-rouge">cache_write_multi.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Keys and values written to the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
  </tbody>
</table>

<h4 id="cache_incrementactive_support"><code class="language-plaintext highlighter-rouge">cache_increment.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Key used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:amount</code></td>
      <td>Increment amount</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"bottles-of-beer"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::RedisCacheStore"</span><span class="p">,</span>
  <span class="ss">amount: </span><span class="mi">99</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache_decrementactive_support"><code class="language-plaintext highlighter-rouge">cache_decrement.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Key used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:amount</code></td>
      <td>Decrement amount</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"bottles-of-beer"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::RedisCacheStore"</span><span class="p">,</span>
  <span class="ss">amount: </span><span class="mi">1</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache_deleteactive_support"><code class="language-plaintext highlighter-rouge">cache_delete.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Key used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache_delete_multiactive_support"><code class="language-plaintext highlighter-rouge">cache_delete_multi.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Keys used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
  </tbody>
</table>

<h4 id="cache_delete_matchedactive_support"><code class="language-plaintext highlighter-rouge">cache_delete_matched.active_support</code></h4>

<p>This event is only emitted when using <a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/RedisCacheStore.html"><code class="language-plaintext highlighter-rouge">RedisCacheStore</code></a>,
<a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/FileStore.html"><code class="language-plaintext highlighter-rouge">FileStore</code></a>, or <a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/MemoryStore.html"><code class="language-plaintext highlighter-rouge">MemoryStore</code></a>.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Key pattern used</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"posts/*"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::RedisCacheStore"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache_cleanupactive_support"><code class="language-plaintext highlighter-rouge">cache_cleanup.active_support</code></h4>

<p>This event is only emitted when using <a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/MemoryStore.html"><code class="language-plaintext highlighter-rouge">MemoryStore</code></a>.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:size</code></td>
      <td>Number of entries in the cache before cleanup</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemoryStore"</span><span class="p">,</span>
  <span class="ss">size: </span><span class="mi">9001</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache_pruneactive_support"><code class="language-plaintext highlighter-rouge">cache_prune.active_support</code></h4>

<p>This event is only emitted when using <a href="https://api.rubyonrails.org/classes/ActiveSupport/Cache/MemoryStore.html"><code class="language-plaintext highlighter-rouge">MemoryStore</code></a>.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Target size (in bytes) for the cache</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:from</code></td>
      <td>Size (in bytes) of the cache before prune</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemoryStore"</span><span class="p">,</span>
  <span class="ss">key: </span><span class="mi">5000</span><span class="p">,</span>
  <span class="ss">from: </span><span class="mi">9001</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="cache_existactive_support"><code class="language-plaintext highlighter-rouge">cache_exist?.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Key used in the store</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:store</code></td>
      <td>Name of the store class</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="active-support-messages">Active Support: Messages</h3>

<h4 id="message_serializer_fallbackactive_support"><code class="language-plaintext highlighter-rouge">message_serializer_fallback.active_support</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:serializer</code></td>
      <td>Primary (intended) serializer</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:fallback</code></td>
      <td>Fallback (actual) serializer</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:serialized</code></td>
      <td>Serialized string</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:deserialized</code></td>
      <td>Deserialized value</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">serializer: :json_allow_marshal</span><span class="p">,</span>
  <span class="ss">fallback: :marshal</span><span class="p">,</span>
  <span class="ss">serialized: </span><span class="s2">"</span><span class="se">\x04\b</span><span class="s2">{</span><span class="se">\x06</span><span class="s2">I</span><span class="se">\"\n</span><span class="s2">Hello</span><span class="se">\x06</span><span class="s2">:</span><span class="se">\x06</span><span class="s2">ETI</span><span class="se">\"\n</span><span class="s2">World</span><span class="se">\x06</span><span class="s2">;</span><span class="se">\x00</span><span class="s2">T"</span><span class="p">,</span>
  <span class="ss">deserialized: </span><span class="p">{</span> <span class="s2">"Hello"</span> <span class="o">=&gt;</span> <span class="s2">"World"</span> <span class="p">},</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="active-job">Active Job</h3>

<h4 id="enqueue_atactive_job"><code class="language-plaintext highlighter-rouge">enqueue_at.active_job</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:adapter</code></td>
      <td>QueueAdapter object processing the job</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:job</code></td>
      <td>Job object</td>
    </tr>
  </tbody>
</table>

<h4 id="enqueueactive_job"><code class="language-plaintext highlighter-rouge">enqueue.active_job</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:adapter</code></td>
      <td>QueueAdapter object processing the job</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:job</code></td>
      <td>Job object</td>
    </tr>
  </tbody>
</table>

<h4 id="enqueue_retryactive_job"><code class="language-plaintext highlighter-rouge">enqueue_retry.active_job</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:job</code></td>
      <td>Job object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:adapter</code></td>
      <td>QueueAdapter object processing the job</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:error</code></td>
      <td>The error that caused the retry</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:wait</code></td>
      <td>The delay of the retry</td>
    </tr>
  </tbody>
</table>

<h4 id="enqueue_allactive_job"><code class="language-plaintext highlighter-rouge">enqueue_all.active_job</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:adapter</code></td>
      <td>QueueAdapter object processing the job</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:jobs</code></td>
      <td>An array of Job objects</td>
    </tr>
  </tbody>
</table>

<h4 id="perform_startactive_job"><code class="language-plaintext highlighter-rouge">perform_start.active_job</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:adapter</code></td>
      <td>QueueAdapter object processing the job</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:job</code></td>
      <td>Job object</td>
    </tr>
  </tbody>
</table>

<h4 id="performactive_job"><code class="language-plaintext highlighter-rouge">perform.active_job</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:adapter</code></td>
      <td>QueueAdapter object processing the job</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:job</code></td>
      <td>Job object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:db_runtime</code></td>
      <td>Amount spent executing database queries in ms</td>
    </tr>
  </tbody>
</table>

<h4 id="retry_stoppedactive_job"><code class="language-plaintext highlighter-rouge">retry_stopped.active_job</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:adapter</code></td>
      <td>QueueAdapter object processing the job</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:job</code></td>
      <td>Job object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:error</code></td>
      <td>The error that caused the retry</td>
    </tr>
  </tbody>
</table>

<h4 id="discardactive_job"><code class="language-plaintext highlighter-rouge">discard.active_job</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:adapter</code></td>
      <td>QueueAdapter object processing the job</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:job</code></td>
      <td>Job object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:error</code></td>
      <td>The error that caused the discard</td>
    </tr>
  </tbody>
</table>

<h3 id="action-cable">Action Cable</h3>

<h4 id="perform_actionaction_cable"><code class="language-plaintext highlighter-rouge">perform_action.action_cable</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:channel_class</code></td>
      <td>Name of the channel class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:action</code></td>
      <td>The action</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:data</code></td>
      <td>A hash of data</td>
    </tr>
  </tbody>
</table>

<h4 id="transmitaction_cable"><code class="language-plaintext highlighter-rouge">transmit.action_cable</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:channel_class</code></td>
      <td>Name of the channel class</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:data</code></td>
      <td>A hash of data</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:via</code></td>
      <td>Via</td>
    </tr>
  </tbody>
</table>

<h4 id="transmit_subscription_confirmationaction_cable"><code class="language-plaintext highlighter-rouge">transmit_subscription_confirmation.action_cable</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:channel_class</code></td>
      <td>Name of the channel class</td>
    </tr>
  </tbody>
</table>

<h4 id="transmit_subscription_rejectionaction_cable"><code class="language-plaintext highlighter-rouge">transmit_subscription_rejection.action_cable</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:channel_class</code></td>
      <td>Name of the channel class</td>
    </tr>
  </tbody>
</table>

<h4 id="broadcastaction_cable"><code class="language-plaintext highlighter-rouge">broadcast.action_cable</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:broadcasting</code></td>
      <td>A named broadcasting</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:message</code></td>
      <td>A hash of message</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:coder</code></td>
      <td>The coder</td>
    </tr>
  </tbody>
</table>

<h3 id="active-storage">Active Storage</h3>

<h4 id="previewactive_storage"><code class="language-plaintext highlighter-rouge">preview.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Secure token</td>
    </tr>
  </tbody>
</table>

<h4 id="transformactive_storage"><code class="language-plaintext highlighter-rouge">transform.active_storage</code></h4>

<h4 id="analyzeactive_storage"><code class="language-plaintext highlighter-rouge">analyze.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:analyzer</code></td>
      <td>Name of analyzer e.g., ffprobe</td>
    </tr>
  </tbody>
</table>

<h3 id="active-storage-storage-service">Active Storage: Storage Service</h3>

<h4 id="service_uploadactive_storage"><code class="language-plaintext highlighter-rouge">service_upload.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Secure token</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:service</code></td>
      <td>Name of the service</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:checksum</code></td>
      <td>Checksum to ensure integrity</td>
    </tr>
  </tbody>
</table>

<h4 id="service_streaming_downloadactive_storage"><code class="language-plaintext highlighter-rouge">service_streaming_download.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Secure token</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:service</code></td>
      <td>Name of the service</td>
    </tr>
  </tbody>
</table>

<h4 id="service_download_chunkactive_storage"><code class="language-plaintext highlighter-rouge">service_download_chunk.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Secure token</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:service</code></td>
      <td>Name of the service</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:range</code></td>
      <td>Byte range attempted to be read</td>
    </tr>
  </tbody>
</table>

<h4 id="service_downloadactive_storage"><code class="language-plaintext highlighter-rouge">service_download.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Secure token</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:service</code></td>
      <td>Name of the service</td>
    </tr>
  </tbody>
</table>

<h4 id="service_deleteactive_storage"><code class="language-plaintext highlighter-rouge">service_delete.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Secure token</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:service</code></td>
      <td>Name of the service</td>
    </tr>
  </tbody>
</table>

<h4 id="service_delete_prefixedactive_storage"><code class="language-plaintext highlighter-rouge">service_delete_prefixed.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:prefix</code></td>
      <td>Key prefix</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:service</code></td>
      <td>Name of the service</td>
    </tr>
  </tbody>
</table>

<h4 id="service_existactive_storage"><code class="language-plaintext highlighter-rouge">service_exist.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Secure token</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:service</code></td>
      <td>Name of the service</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:exist</code></td>
      <td>File or blob exists or not</td>
    </tr>
  </tbody>
</table>

<h4 id="service_urlactive_storage"><code class="language-plaintext highlighter-rouge">service_url.active_storage</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Secure token</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:service</code></td>
      <td>Name of the service</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:url</code></td>
      <td>Generated URL</td>
    </tr>
  </tbody>
</table>

<h4 id="service_update_metadataactive_storage"><code class="language-plaintext highlighter-rouge">service_update_metadata.active_storage</code></h4>

<p>This event is only emitted when using the Google Cloud Storage service.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:key</code></td>
      <td>Secure token</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:service</code></td>
      <td>Name of the service</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:content_type</code></td>
      <td>HTTP <code class="language-plaintext highlighter-rouge">Content-Type</code> field</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:disposition</code></td>
      <td>HTTP <code class="language-plaintext highlighter-rouge">Content-Disposition</code> field</td>
    </tr>
  </tbody>
</table>

<h3 id="action-mailbox">Action Mailbox</h3>

<h4 id="processaction_mailbox"><code class="language-plaintext highlighter-rouge">process.action_mailbox</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:mailbox</code></td>
      <td>Instance of the Mailbox class inheriting from <a href="https://api.rubyonrails.org/classes/ActionMailbox/Base.html"><code class="language-plaintext highlighter-rouge">ActionMailbox::Base</code></a></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:inbound_email</code></td>
      <td>Hash with data about the inbound email being processed</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="ss">mailbox: </span><span class="c1">#&lt;RepliesMailbox:0x00007f9f7a8388&gt;,</span>
  <span class="ss">inbound_email: </span><span class="p">{</span>
    <span class="ss">id: </span><span class="mi">1</span><span class="p">,</span>
    <span class="ss">message_id: </span><span class="s2">"0CB459E0-0336-41DA-BC88-E6E28C697DDB@37signals.com"</span><span class="p">,</span>
    <span class="ss">status: </span><span class="s2">"processing"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="railties">Railties</h3>

<h4 id="load_config_initializerrailties"><code class="language-plaintext highlighter-rouge">load_config_initializer.railties</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:initializer</code></td>
      <td>Path of loaded initializer in <code class="language-plaintext highlighter-rouge">config/initializers</code></td>
    </tr>
  </tbody>
</table>

<h3 id="rails">Rails</h3>

<h4 id="deprecationrails"><code class="language-plaintext highlighter-rouge">deprecation.rails</code></h4>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:message</code></td>
      <td>The deprecation warning</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:callstack</code></td>
      <td>Where the deprecation came from</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:gem_name</code></td>
      <td>Name of the gem reporting the deprecation</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:deprecation_horizon</code></td>
      <td>Version where the deprecated behavior will be removed</td>
    </tr>
  </tbody>
</table>

<h2 id="exceptions">Exceptions</h2>

<p>If an exception happens during any instrumentation, the payload will include
information about it.</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:exception</code></td>
      <td>An array of two elements. Exception class name and the message</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">:exception_object</code></td>
      <td>The exception object</td>
    </tr>
  </tbody>
</table>

<h2 id="creating-custom-events">Creating Custom Events</h2>

<p>Adding your own events is easy as well. Active Support will take care of
all the heavy lifting for you. Simply call <a href="https://api.rubyonrails.org/classes/ActiveSupport/Notifications.html#method-c-instrument"><code class="language-plaintext highlighter-rouge">ActiveSupport::Notifications.instrument</code></a> with a <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">payload</code>, and a block.
The notification will be sent after the block returns. Active Support will generate the start and end times,
and add the instrumenter’s unique ID. All data passed into the <code class="language-plaintext highlighter-rouge">instrument</code> call will make
it into the payload.</p>

<p>Here’s an example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">instrument</span> <span class="s2">"my.custom.event"</span><span class="p">,</span> <span class="ss">this: :data</span> <span class="k">do</span>
  <span class="c1"># do your custom stuff here</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now you can listen to this event with:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="s2">"my.custom.event"</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">started</span><span class="p">,</span> <span class="n">finished</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">data</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">data</span><span class="p">.</span><span class="nf">inspect</span> <span class="c1"># {:this=&gt;:data}</span>
<span class="k">end</span>
</code></pre></div></div>

<p>You may also call <code class="language-plaintext highlighter-rouge">instrument</code> without passing a block. This lets you leverage the
instrumentation infrastructure for other messaging uses.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">instrument</span> <span class="s2">"my.custom.event"</span><span class="p">,</span> <span class="ss">this: :data</span>

<span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="s2">"my.custom.event"</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">started</span><span class="p">,</span> <span class="n">finished</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">data</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">data</span><span class="p">.</span><span class="nf">inspect</span> <span class="c1"># {:this=&gt;:data}</span>
<span class="k">end</span>
</code></pre></div></div>

<p>You should follow Rails conventions when defining your own events. The format is: <code class="language-plaintext highlighter-rouge">event.library</code>.
If your application is sending Tweets, you should create an event named <code class="language-plaintext highlighter-rouge">tweet.twitter</code>.</p>

</div>

    <footer class="guide-footer">
      <div class="feedback">
        <h3>Geri Bildirim</h3>
        <p>
          Bu kılavuzun kalitesini artırmamıza yardımcı olmak için geri
          bildirimlerinizi bekliyoruz.
        </p>
        <p>
          Lütfen
          <a href="https://github.com/dilankaya127/rails-tr-TR"
            >GitHub Issues</a
          >
          üzerinden katkıda bulunun.
        </p>
      </div>
    </footer>
  </article>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toc = document.getElementById("toc");
    const headings = document.querySelectorAll(
      ".guide-content h2, .guide-content h3, .guide-content h4"
    );

    if (headings.length > 0) {
      const tocList = document.createElement("ul");
      const headingMap = new Map();

      headings.forEach(function (heading, index) {
        const id = "heading-" + index;
        heading.id = id;

        const li = document.createElement("li");
        const a = document.createElement("a");
        a.href = "#" + id;
        a.textContent = heading.textContent;
        a.className = "toc-" + heading.tagName.toLowerCase();

        li.appendChild(a);
        tocList.appendChild(li);

        headingMap.set(id, a);
      });

      toc.appendChild(tocList);

      // Başlıkların görünürlük oranlarını takip et
      const visibilityMap = new Map();

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const id = entry.target.getAttribute("id");
            visibilityMap.set(id, entry.intersectionRatio);
          });

          // En çok görünür olan başlığı bul
          let mostVisibleId = null;
          let maxRatio = 0;

          visibilityMap.forEach((ratio, id) => {
            if (ratio > maxRatio) {
              mostVisibleId = id;
              maxRatio = ratio;
            }
          });

          if (mostVisibleId) {
            headingMap.forEach((linkEl) => linkEl.classList.remove("active"));
            const activeLink = headingMap.get(mostVisibleId);
            if (activeLink) {
              activeLink.classList.add("active");

              // Ortalamak için:
              const linkTop = activeLink.offsetTop;
              const linkHeight = activeLink.offsetHeight;
              const tocScrollParent = toc;
              const tocHeight = tocScrollParent.offsetHeight;

              tocScrollParent.scrollTo({
                top: linkTop - tocHeight / 2 + linkHeight / 2,
                behavior: "smooth",
              });
            }
          }
        },
        {
          threshold: [0, 0.25, 0.5, 0.75, 1.0],
        }
      );

      headings.forEach((heading) => {
        observer.observe(heading);
      });

      const toggleBtn = document.getElementById("toc-toggle");
      const sidebar = document.querySelector(".guide-sidebar");

      toggleBtn.addEventListener("click", function () {
        sidebar.classList.toggle("open");
      });
      const closeBtn = document.querySelector(".toc-close");

      closeBtn?.addEventListener("click", function () {
        sidebar.classList.remove("open");
      });
    }
  });
</script>

        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Rails Kılavuzları Türkçe Çevirisi. Gönüllüler tarafından hazırlanmıştır.</p>
            <p>Orijinal dokümantasyon <a href="https://guides.rubyonrails.org">Ruby on Rails</a> ekibine aittir.</p>
        </div>
    </footer>

    <script>hljs.highlightAll();</script>
</body>
</html>