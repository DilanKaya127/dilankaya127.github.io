<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Model Basics - Rails Dokümantasyonu - Türkçe</title>
    <link rel="stylesheet" href="/assets/css/rails.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">

    <link rel="icon" type="image/svg" href="/assets/img/logo_rails-circle.svg">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">
                    <a href="/rails/">
                        <img src="/assets/img/logo_rails-circle.svg" alt="Rails Logo" class="logo-image">
                    </a>
                </h1>
                <nav class="nav">
                    <a href="/">Ana Sayfa</a>
                    <!-- <a href="https://dilankaya127.github.io">Portföy</a> -->
                    <a href="https://github.com/dilankaya127/rails-tr-TR">GitHub</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="guide-container">
  <button id="toc-toggle" class="toc-toggle">☰ İçindekiler</button>

  <aside class="guide-sidebar">
    <div class="guide-toc">
      <!-- <h3>İçindekiler</h3> -->
      <div id="toc"></div>
      <button class="toc-close" aria-label="İçindekileri Kapat">✕</button>
    </div>

    <!-- <div class="guide-nav">
            <h3>Diğer(Tüm) Kılavuzlar</h3>
            <ul>
                <li><a href="/rails/guides/tr/getting_started">Rails ile Başlarken</a></li>
                <li><a href="/rails/guides/en/active_record_basics">Active Record Temelleri</a></li>
                <li><a href="/rails/guides//en/action_controller_overview">Action Controller</a></li>
                <li><a href="/rails/guides/tr/action_cable_overview">Action Cable</a></li>
            </ul>
        </div> -->
  </aside>

  <article class="guide-content">
    <!-- <header class="guide-header">
            <h1>Active Model Basics</h1>
            
        </header> -->

    <div class="guide-body"><p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1 id="active-model-basics">Active Model Basics</h1>

<p>This guide will provide you with what you need to get started using Active
Model. Active Model provides a way for Action Pack and Action View helpers to
interact with plain Ruby objects. It also helps to build custom ORMs for use
outside of the Rails framework.</p>

<p>After reading this guide, you will know:</p>

<ul>
  <li>What Active Model is, and how it relates to Active Record.</li>
  <li>The different modules that are included in Active Model.</li>
  <li>How to use Active Model in your classes.</li>
</ul>

<hr />

<h2 id="what-is-active-model">What is Active Model?</h2>

<p>To understand Active Model, you need to know a little about <a href="active_record_basics.html">Active
Record</a>. Active Record is an ORM (Object Relational
Mapper) that connects objects whose data requires persistent storage to a
relational database. However, it has functionality that is useful outside of the
ORM, some of these include validations, callbacks, translations, the ability to
create custom attributes, etc.</p>

<p>Some of this functionality was abstracted from Active Record to form Active
Model. Active Model is a library containing various modules that can be used on
plain Ruby objects that require model-like features but are not tied to any
table in a database.</p>

<p>In summary, while Active Record provides an interface for defining models that
correspond to database tables, Active Model provides functionality for building
model-like Ruby classes that don’t necessarily need to be backed by a database.
Active Model can be used independently of Active Record.</p>

<p>Some of these modules are explained below.</p>

<h3 id="api">API</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/API.html"><code class="language-plaintext highlighter-rouge">ActiveModel::API</code></a>
adds the ability for a class to work with <a href="https://api.rubyonrails.org/files/actionpack/README_rdoc.html">Action
Pack</a> and <a href="action_view_overview.html">Action
View</a> right out of the box.</p>

<p>When including <code class="language-plaintext highlighter-rouge">ActiveModel::API</code>, other modules are included by default which
enables you to get features like:</p>

<ul>
  <li><a href="#attribute-assignment">Attribute Assignment</a></li>
  <li><a href="#conversion">Conversion</a></li>
  <li><a href="#naming">Naming</a></li>
  <li><a href="#translation">Translation</a></li>
  <li><a href="#validations">Validations</a></li>
</ul>

<p>Here is an example of a class that includes <code class="language-plaintext highlighter-rouge">ActiveModel::API</code> and how it can be
used:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">EmailContact</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">API</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:message</span>
  <span class="n">validates</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:message</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>

  <span class="k">def</span> <span class="nf">deliver</span>
    <span class="k">if</span> <span class="n">valid?</span>
      <span class="c1"># Deliver email</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">email_contact</span> <span class="o">=</span> <span class="no">EmailContact</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"David"</span><span class="p">,</span> <span class="ss">email: </span><span class="s2">"david@example.com"</span><span class="p">,</span> <span class="ss">message: </span><span class="s2">"Hello World"</span><span class="p">)</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">email_contact</span><span class="p">.</span><span class="nf">name</span> <span class="c1"># Attribute Assignment</span>
<span class="p">=&gt;</span> <span class="s2">"David"</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">email_contact</span><span class="p">.</span><span class="nf">to_model</span> <span class="o">==</span> <span class="n">email_contact</span> <span class="c1"># Conversion</span>
<span class="p">=&gt;</span> <span class="kp">true</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">email_contact</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">name</span> <span class="c1"># Naming</span>
<span class="p">=&gt;</span> <span class="s2">"EmailContact"</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="no">EmailContact</span><span class="p">.</span><span class="nf">human_attribute_name</span><span class="p">(</span><span class="s2">"name"</span><span class="p">)</span> <span class="c1"># Translation if the locale is set</span>
<span class="p">=&gt;</span> <span class="s2">"Name"</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">email_contact</span><span class="p">.</span><span class="nf">valid?</span> <span class="c1"># Validations</span>
<span class="p">=&gt;</span> <span class="kp">true</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">empty_contact</span> <span class="o">=</span> <span class="no">EmailContact</span><span class="p">.</span><span class="nf">new</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">empty_contact</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>
</code></pre></div></div>

<p>Any class that includes <code class="language-plaintext highlighter-rouge">ActiveModel::API</code> can be used with <code class="language-plaintext highlighter-rouge">form_with</code>,
<code class="language-plaintext highlighter-rouge">render</code> and any other <a href="https://api.rubyonrails.org/classes/ActionView/Helpers.html">Action View helper
methods</a>, just like
Active Record objects.</p>

<p>For example, <code class="language-plaintext highlighter-rouge">form_with</code> can be used to create a form for an <code class="language-plaintext highlighter-rouge">EmailContact</code>
object as follows:</p>

<pre><code class="language-html+erb">&lt;%= form_with model: EmailContact.new do |form| %&gt;
  &lt;%= form.text_field :name %&gt;
&lt;% end %&gt;
</code></pre>

<p>which results in the following HTML:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/email_contacts"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"email_contact[name]"</span> <span class="na">id=</span><span class="s">"email_contact_name"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">render</code> can be used to render a partial with the object:</p>

<pre><code class="language-html+erb">&lt;%= render @email_contact %&gt;
</code></pre>

<p>NOTE: You can learn more about how to use <code class="language-plaintext highlighter-rouge">form_with</code> and <code class="language-plaintext highlighter-rouge">render</code> with
<code class="language-plaintext highlighter-rouge">ActiveModel::API</code> compatible objects in the <a href="form_helpers.html">Action View Form
Helpers</a> and <a href="layouts_and_rendering.html">Layouts and
Rendering</a>
guides, respectively.</p>

<h3 id="model">Model</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Model.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Model</code></a>
includes <a href="#api">ActiveModel::API</a> to interact with Action Pack and Action View
by default, and is the recommended approach to implement model-like Ruby
classes. It will be extended in the future to add more functionality.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Model</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:age</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s1">'bob'</span><span class="p">,</span> <span class="ss">age: </span><span class="s1">'18'</span><span class="p">)</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span> <span class="c1"># =&gt; "bob"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">age</span>  <span class="c1"># =&gt; "18"</span>
</code></pre></div></div>

<h3 id="attributes">Attributes</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Attributes.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Attributes</code></a>
allows you to define data types, set default values, and handle casting and
serialization on plain Ruby objects. This can be useful for form data which will
produce Active Record-like conversion for things like dates and booleans on
regular objects.</p>

<p>To use <code class="language-plaintext highlighter-rouge">Attributes</code>, include the module in your model class and define your
attributes using the <code class="language-plaintext highlighter-rouge">attribute</code> macro. It accepts a name, a cast type, a
default value, and any other options supported by the attribute type.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Attributes</span>

  <span class="n">attribute</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:string</span>
  <span class="n">attribute</span> <span class="ss">:date_of_birth</span><span class="p">,</span> <span class="ss">:date</span>
  <span class="n">attribute</span> <span class="ss">:active</span><span class="p">,</span> <span class="ss">:boolean</span><span class="p">,</span> <span class="ss">default: </span><span class="kp">true</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s2">"Jane"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span>
<span class="p">=&gt;</span> <span class="s2">"Jane"</span>

<span class="c"># Casts the string to a date set by the attribute
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">date_of_birth</span> <span class="o">=</span> <span class="s2">"2020-01-01"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">date_of_birth</span>
<span class="p">=&gt;</span> <span class="no">Wed</span><span class="p">,</span> <span class="mo">01</span> <span class="no">Jan</span> <span class="mi">2020</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">date_of_birth</span><span class="p">.</span><span class="nf">class</span>
<span class="p">=&gt;</span> <span class="no">Date</span>

<span class="c"># Uses the default value set by the attribute
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">active</span>
<span class="p">=&gt;</span> <span class="kp">true</span>

<span class="c"># Casts the integer to a boolean set by the attribute
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">active</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">active</span>
<span class="p">=&gt;</span> <span class="kp">false</span>
</code></pre></div></div>

<p>Some additional methods described below are available when using
<code class="language-plaintext highlighter-rouge">ActiveModel::Attributes</code>.</p>

<h4 id="method-attribute_names">Method: <code class="language-plaintext highlighter-rouge">attribute_names</code></h4>

<p>The <code class="language-plaintext highlighter-rouge">attribute_names</code> method returns an array of attribute names.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">attribute_names</span>
<span class="p">=&gt;</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">,</span> <span class="s2">"date_of_birth"</span><span class="p">,</span> <span class="s2">"active"</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="method-attributes">Method: <code class="language-plaintext highlighter-rouge">attributes</code></h4>

<p>The <code class="language-plaintext highlighter-rouge">attributes</code> method returns a hash of all the attributes with their names as
keys and the values of the attributes as values.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">attributes</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Jane"</span><span class="p">,</span> <span class="s2">"date_of_birth"</span> <span class="o">=&gt;</span> <span class="no">Wed</span><span class="p">,</span> <span class="mo">01</span> <span class="no">Jan</span> <span class="mi">2020</span><span class="p">,</span> <span class="s2">"active"</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">}</span>
</code></pre></div></div>

<h3 id="attribute-assignment">Attribute Assignment</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/AttributeAssignment.html"><code class="language-plaintext highlighter-rouge">ActiveModel::AttributeAssignment</code></a>
allows you to set an object’s attributes by passing in a hash of attributes with
keys matching the attribute names. This is useful when you want to set multiple
attributes at once.</p>

<p>Consider the following class:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">AttributeAssignment</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:date_of_birth</span><span class="p">,</span> <span class="ss">:active</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="c"># Set multiple attributes at once
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">assign_attributes</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"John"</span><span class="p">,</span> <span class="ss">date_of_birth: </span><span class="s2">"1998-01-01"</span><span class="p">,</span> <span class="ss">active: </span><span class="kp">false</span><span class="p">)</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span>
<span class="p">=&gt;</span> <span class="s2">"John"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">date_of_birth</span>
<span class="p">=&gt;</span> <span class="no">Thu</span><span class="p">,</span> <span class="mo">01</span> <span class="no">Jan</span> <span class="mi">1998</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">active</span>
<span class="p">=&gt;</span> <span class="kp">false</span>
</code></pre></div></div>

<p>If the passed hash responds to the <code class="language-plaintext highlighter-rouge">permitted?</code> method and the return value of
this method is <code class="language-plaintext highlighter-rouge">false</code>, an <code class="language-plaintext highlighter-rouge">ActiveModel::ForbiddenAttributesError</code> exception is
raised.</p>

<p>NOTE: <code class="language-plaintext highlighter-rouge">permitted?</code> is used for <a href="https://guides.rubyonrails.org/action_controller_overview.html#strong-parameters">strong
params</a>
integration whereby you are assigning a params attribute from a request.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="c"># Using strong parameters checks, build a hash of attributes similar to params from a request
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">params</span> <span class="o">=</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Parameters</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"John"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kt">#&lt;</span><span class="no">ActionController</span><span class="o">::</span><span class="no">Parameters</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=</span><span class="kt">&gt;</span> <span class="s2">"John"</span><span class="p">}</span> <span class="ss">permitted: </span><span class="kp">false</span><span class="o">&gt;</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">assign_attributes</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="c1"># Raises ActiveModel::ForbiddenAttributesError</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span>
<span class="p">=&gt;</span> <span class="kp">nil</span>

<span class="c"># Permit the attributes we want to allow assignment
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">permitted_params</span> <span class="o">=</span> <span class="n">params</span><span class="p">.</span><span class="nf">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kt">#&lt;</span><span class="no">ActionController</span><span class="o">::</span><span class="no">Parameters</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=</span><span class="kt">&gt;</span> <span class="s2">"John"</span><span class="p">}</span> <span class="ss">permitted: </span><span class="kp">true</span><span class="o">&gt;</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">assign_attributes</span><span class="p">(</span><span class="n">permitted_params</span><span class="p">)</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span>
<span class="p">=&gt;</span> <span class="s2">"John"</span>
</code></pre></div></div>

<h4 id="method-alias-attributes">Method alias: <code class="language-plaintext highlighter-rouge">attributes=</code></h4>

<p>The <code class="language-plaintext highlighter-rouge">assign_attributes</code> method has an alias <code class="language-plaintext highlighter-rouge">attributes=</code>.</p>

<p>INFO: A method alias is a method that performs the same action as another
method, but is called something different. Aliases exist for the sake of
readability and convenience.</p>

<p>The following example demonstrates the use of the <code class="language-plaintext highlighter-rouge">attributes=</code> method to set
multiple attributes at once:</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">attributes</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">name: </span><span class="s2">"John"</span><span class="p">,</span> <span class="ss">date_of_birth: </span><span class="s2">"1998-01-01"</span><span class="p">,</span> <span class="ss">active: </span><span class="kp">false</span> <span class="p">}</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span>
<span class="p">=&gt;</span> <span class="s2">"John"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">date_of_birth</span>
<span class="p">=&gt;</span> <span class="s2">"1998-01-01"</span>
</code></pre></div></div>

<p>INFO: <code class="language-plaintext highlighter-rouge">assign_attributes</code> and <code class="language-plaintext highlighter-rouge">attributes=</code> are both method calls, and accept
the hash of attributes to assign as an argument. In many cases, Ruby allows
parens <code class="language-plaintext highlighter-rouge">()</code> from method calls, and curly braces <code class="language-plaintext highlighter-rouge">{}</code> from hash definitions, to
be omitted. <br /><br />
“Setter” methods like <code class="language-plaintext highlighter-rouge">attributes=</code> are commonly written without <code class="language-plaintext highlighter-rouge">()</code>, even
though including them works the same, and they require the hash to always
include <code class="language-plaintext highlighter-rouge">{}</code>. <code class="language-plaintext highlighter-rouge">person.attributes=({ name: "John" })</code> is fine, but
<code class="language-plaintext highlighter-rouge">person.attributes = name: "John"</code> results in a <code class="language-plaintext highlighter-rouge">SyntaxError</code>.<br /><br />
Other method calls like <code class="language-plaintext highlighter-rouge">assign_attributes</code> may or may not contain both parens
<code class="language-plaintext highlighter-rouge">()</code> and <code class="language-plaintext highlighter-rouge">{}</code> for the hash argument. For example, <code class="language-plaintext highlighter-rouge">assign_attributes name:
"John"</code> and <code class="language-plaintext highlighter-rouge">assign_attributes({ name: "John" })</code> are both perfectly valid Ruby
code, however, <code class="language-plaintext highlighter-rouge">assign_attributes { name: "John" }</code> is not, because Ruby can’t
differentiate that hash argument from a block, and will raise a <code class="language-plaintext highlighter-rouge">SyntaxError</code>.</p>

<h3 id="attribute-methods">Attribute Methods</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/AttributeMethods.html"><code class="language-plaintext highlighter-rouge">ActiveModel::AttributeMethods</code></a>
provides a way to define methods dynamically for attributes of a model. This
module is particularly useful to simplify attribute access and manipulation, and
it can add custom prefixes and suffixes to the methods of a class. You can
define the prefixes and suffixes and which methods on the object will use them
as follows:</p>

<ol>
  <li>Include <code class="language-plaintext highlighter-rouge">ActiveModel::AttributeMethods</code> in your class.</li>
  <li>Call each of the methods you want to add, such as <code class="language-plaintext highlighter-rouge">attribute_method_suffix</code>,
<code class="language-plaintext highlighter-rouge">attribute_method_prefix</code>, <code class="language-plaintext highlighter-rouge">attribute_method_affix</code>.</li>
  <li>Call <code class="language-plaintext highlighter-rouge">define_attribute_methods</code> after the other methods to declare the
attribute(s) that should be prefixed and suffixed.</li>
  <li>Define the various generic <code class="language-plaintext highlighter-rouge">_attribute</code> methods that you have declared. The
 parameter <code class="language-plaintext highlighter-rouge">attribute</code> in these methods will be replaced by the argument
 passed in <code class="language-plaintext highlighter-rouge">define_attribute_methods</code>. In the example below it’s <code class="language-plaintext highlighter-rouge">name</code>.</li>
</ol>

<p>NOTE: <code class="language-plaintext highlighter-rouge">attribute_method_prefix</code> and <code class="language-plaintext highlighter-rouge">attribute_method_suffix</code> are used to define
the prefixes and suffixes that will be used to create the methods.
<code class="language-plaintext highlighter-rouge">attribute_method_affix</code> is used to define both the prefix and suffix at the
same time.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">AttributeMethods</span>

  <span class="n">attribute_method_affix</span> <span class="ss">prefix: </span><span class="s2">"reset_"</span><span class="p">,</span> <span class="ss">suffix: </span><span class="s2">"_to_default!"</span>
  <span class="n">attribute_method_prefix</span> <span class="s2">"first_"</span><span class="p">,</span> <span class="s2">"last_"</span>
  <span class="n">attribute_method_suffix</span> <span class="s2">"_short?"</span>

  <span class="n">define_attribute_methods</span> <span class="s2">"name"</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span>

  <span class="kp">private</span>
    <span class="c1"># Attribute method call for 'first_name'</span>
    <span class="k">def</span> <span class="nf">first_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
      <span class="n">public_send</span><span class="p">(</span><span class="n">attribute</span><span class="p">).</span><span class="nf">split</span><span class="p">.</span><span class="nf">first</span>
    <span class="k">end</span>

    <span class="c1"># Attribute method call for 'last_name'</span>
    <span class="k">def</span> <span class="nf">last_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
      <span class="n">public_send</span><span class="p">(</span><span class="n">attribute</span><span class="p">).</span><span class="nf">split</span><span class="p">.</span><span class="nf">last</span>
    <span class="k">end</span>

    <span class="c1"># Attribute method call for 'name_short?'</span>
    <span class="k">def</span> <span class="nf">attribute_short?</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
      <span class="n">public_send</span><span class="p">(</span><span class="n">attribute</span><span class="p">).</span><span class="nf">length</span> <span class="o">&lt;</span> <span class="mi">5</span>
    <span class="k">end</span>

    <span class="c1"># Attribute method call 'reset_name_to_default!'</span>
    <span class="k">def</span> <span class="nf">reset_attribute_to_default!</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
      <span class="n">public_send</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">="</span><span class="p">,</span> <span class="s2">"Default Name"</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s2">"Jane Doe"</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name</span>
<span class="p">=&gt;</span> <span class="s2">"Jane"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">last_name</span>
<span class="p">=&gt;</span> <span class="s2">"Doe"</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name_short?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">reset_name_to_default!</span>
<span class="p">=&gt;</span> <span class="s2">"Default Name"</span>
</code></pre></div></div>

<p>If you call a method that is not defined, it will raise a <code class="language-plaintext highlighter-rouge">NoMethodError</code> error.</p>

<h4 id="method-alias_attribute">Method: <code class="language-plaintext highlighter-rouge">alias_attribute</code></h4>

<p><code class="language-plaintext highlighter-rouge">ActiveModel::AttributeMethods</code> provides aliasing of attribute methods using
<code class="language-plaintext highlighter-rouge">alias_attribute</code>.</p>

<p>The example below creates an alias attribute for <code class="language-plaintext highlighter-rouge">name</code> called <code class="language-plaintext highlighter-rouge">full_name</code>. They
return the same value, but the alias <code class="language-plaintext highlighter-rouge">full_name</code> better reflects that the
attribute includes a first name and last name.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">AttributeMethods</span>

  <span class="n">attribute_method_suffix</span> <span class="s2">"_short?"</span>
  <span class="n">define_attribute_methods</span> <span class="ss">:name</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span>

  <span class="n">alias_attribute</span> <span class="ss">:full_name</span><span class="p">,</span> <span class="ss">:name</span>

  <span class="kp">private</span>
    <span class="k">def</span> <span class="nf">attribute_short?</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
      <span class="n">public_send</span><span class="p">(</span><span class="n">attribute</span><span class="p">).</span><span class="nf">length</span> <span class="o">&lt;</span> <span class="mi">5</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s2">"Joe Doe"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span>
<span class="p">=&gt;</span> <span class="s2">"Joe Doe"</span>

<span class="c"># `full_name` is the alias for `name`, and returns the same value
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">full_name</span>
<span class="p">=&gt;</span> <span class="s2">"Joe Doe"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name_short?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="c"># `full_name_short?` is the alias for `name_short?`, and returns the same value
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">full_name_short?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>
</code></pre></div></div>

<h3 id="callbacks">Callbacks</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Callbacks.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Callbacks</code></a>
gives plain Ruby objects <a href="active_record_callbacks.html">Active Record style
callbacks</a>. The
callbacks allow you to hook into model lifecycle events, such as <code class="language-plaintext highlighter-rouge">before_update</code>
and <code class="language-plaintext highlighter-rouge">after_create</code>, as well as to define custom logic to be executed at specific
points in the model’s lifecycle.</p>

<p>You can implement <code class="language-plaintext highlighter-rouge">ActiveModel::Callbacks</code> by following the steps below:</p>

<ol>
  <li>Extend <code class="language-plaintext highlighter-rouge">ActiveModel::Callbacks</code> within your class.</li>
  <li>Employ <code class="language-plaintext highlighter-rouge">define_model_callbacks</code> to establish a list of methods that should
have callbacks associated with them. When you designate a method such as
<code class="language-plaintext highlighter-rouge">:update</code>, it will automatically include all three default callbacks
(<code class="language-plaintext highlighter-rouge">before</code>, <code class="language-plaintext highlighter-rouge">around</code>, and <code class="language-plaintext highlighter-rouge">after</code>) for the <code class="language-plaintext highlighter-rouge">:update</code> event.</li>
  <li>Inside the defined method, utilize <code class="language-plaintext highlighter-rouge">run_callbacks</code>, which will execute the
callback chain when the specific event is triggered.</li>
  <li>In your class, you can then utilize the <code class="language-plaintext highlighter-rouge">before_update</code>, <code class="language-plaintext highlighter-rouge">after_update</code>, and
<code class="language-plaintext highlighter-rouge">around_update</code> methods like how you would use them in an Active Record
model.</li>
</ol>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Callbacks</span>

  <span class="n">define_model_callbacks</span> <span class="ss">:update</span>

  <span class="n">before_update</span> <span class="ss">:reset_me</span>
  <span class="n">after_update</span> <span class="ss">:finalize_me</span>
  <span class="n">around_update</span> <span class="ss">:log_me</span>

  <span class="c1"># `define_model_callbacks` method containing `run_callbacks` which runs the callback(s) for the given event</span>
  <span class="k">def</span> <span class="nf">update</span>
    <span class="n">run_callbacks</span><span class="p">(</span><span class="ss">:update</span><span class="p">)</span> <span class="k">do</span>
      <span class="nb">puts</span> <span class="s2">"update method called"</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kp">private</span>
    <span class="c1"># When update is called on an object, then this method is called by `before_update` callback</span>
    <span class="k">def</span> <span class="nf">reset_me</span>
      <span class="nb">puts</span> <span class="s2">"reset_me method: called before the update method"</span>
    <span class="k">end</span>

    <span class="c1"># When update is called on an object, then this method is called by `after_update` callback</span>
    <span class="k">def</span> <span class="nf">finalize_me</span>
      <span class="nb">puts</span> <span class="s2">"finalize_me method: called after the update method"</span>
    <span class="k">end</span>

    <span class="c1"># When update is called on an object, then this method is called by `around_update` callback</span>
    <span class="k">def</span> <span class="nf">log_me</span>
      <span class="nb">puts</span> <span class="s2">"log_me method: called around the update method"</span>
      <span class="k">yield</span>
      <span class="nb">puts</span> <span class="s2">"log_me method: block successfully called"</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The above class will yield the following which indicates the order in which the
callbacks are being called:</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">update</span>
<span class="go">reset_me method: called before the update method
log_me method: called around the update method
update method called
log_me method: block successfully called
finalize_me method: called after the update method
</span><span class="p">=&gt;</span> <span class="kp">nil</span>
</code></pre></div></div>

<p>As per the above example, when defining an ‘around’ callback remember to <code class="language-plaintext highlighter-rouge">yield</code>
to the block, otherwise, it won’t be executed.</p>

<p>NOTE: <code class="language-plaintext highlighter-rouge">method_name</code> passed to <code class="language-plaintext highlighter-rouge">define_model_callbacks</code> must not end with <code class="language-plaintext highlighter-rouge">!</code>,
<code class="language-plaintext highlighter-rouge">?</code> or <code class="language-plaintext highlighter-rouge">=</code>. In addition, defining the same callback multiple times will
overwrite previous callback definitions.</p>

<h4 id="defining-specific-callbacks">Defining Specific Callbacks</h4>

<p>You can choose to create specific callbacks by passing the <code class="language-plaintext highlighter-rouge">only</code> option to the
<code class="language-plaintext highlighter-rouge">define_model_callbacks</code> method:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">define_model_callbacks</span> <span class="ss">:update</span><span class="p">,</span> <span class="ss">:create</span><span class="p">,</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:after</span><span class="p">,</span> <span class="ss">:before</span><span class="p">]</span>
</code></pre></div></div>

<p>This will create only the <code class="language-plaintext highlighter-rouge">before_create</code> / <code class="language-plaintext highlighter-rouge">after_create</code> and <code class="language-plaintext highlighter-rouge">before_update</code> /
 <code class="language-plaintext highlighter-rouge">after_update</code> callbacks, but skip the <code class="language-plaintext highlighter-rouge">around_*</code> ones. The option will apply
to all callbacks defined on that method call. It’s possible to call
<code class="language-plaintext highlighter-rouge">define_model_callbacks</code> multiple times, to specify different lifecycle events:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">define_model_callbacks</span> <span class="ss">:create</span><span class="p">,</span> <span class="ss">only: :after</span>
<span class="n">define_model_callbacks</span> <span class="ss">:update</span><span class="p">,</span> <span class="ss">only: :before</span>
<span class="n">define_model_callbacks</span> <span class="ss">:destroy</span><span class="p">,</span> <span class="ss">only: :around</span>
</code></pre></div></div>

<p>This will create <code class="language-plaintext highlighter-rouge">after_create</code>, <code class="language-plaintext highlighter-rouge">before_update</code>, and <code class="language-plaintext highlighter-rouge">around_destroy</code> methods
only.</p>

<h4 id="defining-callbacks-with-a-class">Defining Callbacks with a Class</h4>

<p>You can pass a class to <code class="language-plaintext highlighter-rouge">before_&lt;type&gt;</code>, <code class="language-plaintext highlighter-rouge">after_&lt;type&gt;</code> and <code class="language-plaintext highlighter-rouge">around_&lt;type&gt;</code> for
more control over when and in what context your callbacks are triggered. The
callback will trigger that class’s <code class="language-plaintext highlighter-rouge">&lt;action&gt;_&lt;type&gt;</code> method, passing an instance
of the class as an argument.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Callbacks</span>

  <span class="n">define_model_callbacks</span> <span class="ss">:create</span>
  <span class="n">before_create</span> <span class="no">PersonCallbacks</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">PersonCallbacks</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">before_create</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="c1"># `obj` is the Person instance that the callback is being called on</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="aborting-callbacks">Aborting Callbacks</h4>

<p>The callback chain can be aborted at any point in time by throwing <code class="language-plaintext highlighter-rouge">:abort</code>.
This is similar to how Active Record callbacks work.</p>

<p>In the example below, since we throw <code class="language-plaintext highlighter-rouge">:abort</code> before an update in the <code class="language-plaintext highlighter-rouge">reset_me</code>
method, the remaining callback chain including <code class="language-plaintext highlighter-rouge">before_update</code> will be aborted,
and the body of the <code class="language-plaintext highlighter-rouge">update</code> method won’t be executed.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Callbacks</span>

  <span class="n">define_model_callbacks</span> <span class="ss">:update</span>

  <span class="n">before_update</span> <span class="ss">:reset_me</span>
  <span class="n">after_update</span> <span class="ss">:finalize_me</span>
  <span class="n">around_update</span> <span class="ss">:log_me</span>

  <span class="k">def</span> <span class="nf">update</span>
    <span class="n">run_callbacks</span><span class="p">(</span><span class="ss">:update</span><span class="p">)</span> <span class="k">do</span>
      <span class="nb">puts</span> <span class="s2">"update method called"</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kp">private</span>
    <span class="k">def</span> <span class="nf">reset_me</span>
      <span class="nb">puts</span> <span class="s2">"reset_me method: called before the update method"</span>
      <span class="kp">throw</span> <span class="ss">:abort</span>
      <span class="nb">puts</span> <span class="s2">"reset_me method: some code after abort"</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">finalize_me</span>
      <span class="nb">puts</span> <span class="s2">"finalize_me method: called after the update method"</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">log_me</span>
      <span class="nb">puts</span> <span class="s2">"log_me method: called around the update method"</span>
      <span class="k">yield</span>
      <span class="nb">puts</span> <span class="s2">"log_me method: block successfully called"</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">update</span>
<span class="go">reset_me method: called before the update method
</span><span class="p">=&gt;</span> <span class="kp">false</span>
</code></pre></div></div>

<h3 id="conversion">Conversion</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Conversion.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Conversion</code></a>
is a collection of methods that allow you to convert your object to different
forms for different purposes. A common use case is to convert your object to a
string or an integer to build URLs, form fields, and more.</p>

<p>The <code class="language-plaintext highlighter-rouge">ActiveModel::Conversion</code> module adds the following methods: <code class="language-plaintext highlighter-rouge">to_model</code>,
<code class="language-plaintext highlighter-rouge">to_key</code>, <code class="language-plaintext highlighter-rouge">to_param</code>, and <code class="language-plaintext highlighter-rouge">to_partial_path</code> to classes.</p>

<p>The return values of the methods depend on whether <code class="language-plaintext highlighter-rouge">persisted?</code> is defined and
if an <code class="language-plaintext highlighter-rouge">id</code> is provided. The <code class="language-plaintext highlighter-rouge">persisted?</code> method should return <code class="language-plaintext highlighter-rouge">true</code> if the
object has been saved to the database or store, otherwise, it should return
<code class="language-plaintext highlighter-rouge">false</code>. The <code class="language-plaintext highlighter-rouge">id</code> should reference the id of the object or nil if the object is
not saved.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Conversion</span>
  <span class="nb">attr_accessor</span> <span class="ss">:id</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="vi">@id</span> <span class="o">=</span> <span class="nb">id</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">persisted?</span>
    <span class="nb">id</span><span class="p">.</span><span class="nf">present?</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="to_model">to_model</h4>

<p>The <code class="language-plaintext highlighter-rouge">to_model</code> method returns the object itself.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">to_model</span> <span class="o">==</span> <span class="n">person</span>
<span class="p">=&gt;</span> <span class="kp">true</span>
</code></pre></div></div>

<p>If your model does not act like an Active Model object, then you should define
<code class="language-plaintext highlighter-rouge">:to_model</code> yourself returning a proxy object that wraps your object with Active
Model compliant methods.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">to_model</span>
    <span class="c1"># A proxy object that wraps your object with Active Model compliant methods.</span>
    <span class="no">PersonModel</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="to_key">to_key</h4>

<p>The <code class="language-plaintext highlighter-rouge">to_key</code> method returns an array of the object’s key attributes if any of
the attributes are set, whether or not the object is persisted. Returns nil if
there are no key attributes.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">to_key</span>
<span class="p">=&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<p>NOTE: A key attribute is an attribute that is used to identify the object. For
example, in a database-backed model, the key attribute is the primary key.</p>

<h4 id="to_param">to_param</h4>

<p>The <code class="language-plaintext highlighter-rouge">to_param</code> method returns a <code class="language-plaintext highlighter-rouge">string</code> representation of the object’s key
suitable for use in URLs, or <code class="language-plaintext highlighter-rouge">nil</code> in the case where <code class="language-plaintext highlighter-rouge">persisted?</code> is <code class="language-plaintext highlighter-rouge">false</code>.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">to_param</span>
<span class="p">=&gt;</span> <span class="s2">"1"</span>
</code></pre></div></div>

<h4 id="to_partial_path">to_partial_path</h4>

<p>The <code class="language-plaintext highlighter-rouge">to_partial_path</code> method returns a <code class="language-plaintext highlighter-rouge">string</code> representing the path associated
with the object. Action Pack uses this to find a suitable partial to represent
the object.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">to_partial_path</span>
<span class="p">=&gt;</span> <span class="s2">"people/person"</span>
</code></pre></div></div>

<h3 id="dirty">Dirty</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Dirty.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Dirty</code></a>
is useful for tracking changes made to model attributes before they are saved.
This functionality allows you to determine which attributes have been modified,
what their previous and current values are, and perform actions based on those
changes. It’s particularly handy for auditing, validation, and conditional logic
within your application. It provides a way to track changes in your object in
the same way as Active Record.</p>

<p>An object becomes dirty when it has gone through one or more changes to its
attributes and has not been saved. It has attribute-based accessor methods.</p>

<p>To use <code class="language-plaintext highlighter-rouge">ActiveModel::Dirty</code>, you need to:</p>

<ol>
  <li>Include the module in your class.</li>
  <li>Define the attribute methods that you want to track changes for, using
  <code class="language-plaintext highlighter-rouge">define_attribute_methods</code>.</li>
  <li>Call <code class="language-plaintext highlighter-rouge">[attr_name]_will_change!</code> before each change to the tracked attribute.</li>
  <li>Call <code class="language-plaintext highlighter-rouge">changes_applied</code> after the changes are persisted.</li>
  <li>Call <code class="language-plaintext highlighter-rouge">clear_changes_information</code> when you want to reset the changes
information.</li>
  <li>Call <code class="language-plaintext highlighter-rouge">restore_attributes</code> when you want to restore previous data.</li>
</ol>

<p>You can then use the methods provided by <code class="language-plaintext highlighter-rouge">ActiveModel::Dirty</code> to query the
object for its list of all changed attributes, the original values of the
changed attributes, and the changes made to the attributes.</p>

<p>Let’s consider a <code class="language-plaintext highlighter-rouge">Person</code> class with attributes <code class="language-plaintext highlighter-rouge">first_name</code> and <code class="language-plaintext highlighter-rouge">last_name</code> and
determine how we can use <code class="language-plaintext highlighter-rouge">ActiveModel::Dirty</code> to track changes to these
attributes.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Dirty</span>

  <span class="nb">attr_reader</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span>
  <span class="n">define_attribute_methods</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span>

  <span class="k">def</span> <span class="nf">initialize</span>
    <span class="vi">@first_name</span> <span class="o">=</span> <span class="kp">nil</span>
    <span class="vi">@last_name</span> <span class="o">=</span> <span class="kp">nil</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">first_name</span><span class="o">=</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="n">first_name_will_change!</span> <span class="k">unless</span> <span class="n">value</span> <span class="o">==</span> <span class="vi">@first_name</span>
    <span class="vi">@first_name</span> <span class="o">=</span> <span class="n">value</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">last_name</span><span class="o">=</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="n">last_name_will_change!</span> <span class="k">unless</span> <span class="n">value</span> <span class="o">==</span> <span class="vi">@last_name</span>
    <span class="vi">@last_name</span> <span class="o">=</span> <span class="n">value</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">save</span>
    <span class="c1"># Persist data - clears dirty data and moves `changes` to `previous_changes`.</span>
    <span class="n">changes_applied</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">reload!</span>
    <span class="c1"># Clears all dirty data: current changes and previous changes.</span>
    <span class="n">clear_changes_information</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">rollback!</span>
    <span class="c1"># Restores all previous data of the provided attributes.</span>
    <span class="n">restore_attributes</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h4 id="querying-an-object-directly-for-its-list-of-all-changed-attributes">Querying an Object Directly for its List of All Changed Attributes</h4>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="c"># A newly instantiated `Person` object is unchanged:
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">changed?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name</span> <span class="o">=</span> <span class="s2">"Jane Doe"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name</span>
<span class="p">=&gt;</span> <span class="s2">"Jane Doe"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">changed?</code></strong> returns <code class="language-plaintext highlighter-rouge">true</code> if any of the attributes have unsaved changes,
<code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">changed?</span>
<span class="p">=&gt;</span> <span class="kp">true</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">changed</code></strong> returns an array with the name of the attributes containing
unsaved changes.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">changed</span>
<span class="p">=&gt;</span> <span class="p">[</span><span class="s2">"first_name"</span><span class="p">]</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">changed_attributes</code></strong> returns a hash of the attributes with unsaved changes
indicating their original values like <code class="language-plaintext highlighter-rouge">attr =&gt; original value</code>.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">changed_attributes</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"first_name"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">}</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">changes</code></strong> returns a hash of changes, with the attribute names as the keys,
and the values as an array of the original and new values like <code class="language-plaintext highlighter-rouge">attr =&gt; [original value, new value]</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb&gt; person.changes
=&gt; {"first_name" =&gt; [nil, "Jane Doe"]}
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">previous_changes</code></strong> returns a hash of attributes that were changed before the
model was saved (i.e. before <code class="language-plaintext highlighter-rouge">changes_applied</code> is called).</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">previous_changes</span>
<span class="p">=&gt;</span> <span class="p">{}</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">save</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">previous_changes</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"first_name"</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="kp">nil</span><span class="p">,</span> <span class="s2">"Jane Doe"</span><span class="p">]}</span>
</code></pre></div></div>

<h4 id="attribute-based-accessor-methods">Attribute-based Accessor Methods</h4>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">changed?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name</span> <span class="o">=</span> <span class="s2">"John Doe"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name</span>
<span class="p">=&gt;</span> <span class="s2">"John Doe"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">[attr_name]_changed?</code></strong> checks whether the particular attribute has been
changed or not.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>irb&gt; person.first_name_changed?
=&gt; true
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">[attr_name]_was</code></strong> tracks the previous value of the attribute.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name_was</span>
<span class="p">=&gt;</span> <span class="kp">nil</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">[attr_name]_change</code></strong> tracks both the previous and current values of the
changed attribute. Returns an array with <code class="language-plaintext highlighter-rouge">[original value, new value]</code> if
changed, otherwise returns <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name_change</span>
<span class="p">=&gt;</span> <span class="p">[</span><span class="kp">nil</span><span class="p">,</span> <span class="s2">"John Doe"</span><span class="p">]</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">last_name_change</span>
<span class="p">=&gt;</span> <span class="kp">nil</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">[attr_name]_previously_changed?</code></strong> checks whether the particular attribute
has been changed before the model was saved (i.e. before <code class="language-plaintext highlighter-rouge">changes_applied</code> is
called).</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name_previously_changed?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">save</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name_previously_changed?</span>
<span class="p">=&gt;</span> <span class="kp">true</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">[attr_name]_previous_change</code></strong> tracks both previous and current values of the
changed attribute before the model was saved (i.e. before <code class="language-plaintext highlighter-rouge">changes_applied</code> is
called). Returns an array with <code class="language-plaintext highlighter-rouge">[original value, new value]</code> if changed,
otherwise returns <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">first_name_previous_change</span>
<span class="p">=&gt;</span> <span class="p">[</span><span class="kp">nil</span><span class="p">,</span> <span class="s2">"John Doe"</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="naming">Naming</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Naming.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Naming</code></a>
adds a class method and helper methods to make naming and routing easier to
manage. The module defines the <code class="language-plaintext highlighter-rouge">model_name</code> class method which will define
several accessors using some
<a href="https://api.rubyonrails.org/classes/ActiveSupport/Inflector.html"><code class="language-plaintext highlighter-rouge">ActiveSupport::Inflector</code></a>
methods.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Naming</span>
<span class="k">end</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">name</code></strong> returns the name of the model.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">name</span>
<span class="p">=&gt;</span> <span class="s2">"Person"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">singular</code></strong> returns the singular class name of a record or class.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">singular</span>
<span class="p">=&gt;</span> <span class="s2">"person"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">plural</code></strong> returns the plural class name of a record or class.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">plural</span>
<span class="p">=&gt;</span> <span class="s2">"people"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">element</code></strong> removes the namespace and returns the singular snake_cased name.
It is generally used by Action Pack and/or Action View helpers to aid in
rendering the name of partials/forms.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">element</span>
<span class="p">=&gt;</span> <span class="s2">"person"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">human</code></strong> transforms the model name into a more human format, using I18n. By
default, it will underscore and then humanize the class name.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">human</span>
<span class="p">=&gt;</span> <span class="s2">"Person"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">collection</code></strong> removes the namespace and returns the plural snake_cased name.
It is generally used by Action Pack and/or Action View helpers to aid in
rendering the name of partials/forms.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">collection</span>
<span class="p">=&gt;</span> <span class="s2">"people"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">param_key</code></strong> returns a string to use for params names.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">param_key</span>
<span class="p">=&gt;</span> <span class="s2">"person"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">i18n_key</code></strong> returns the name of the i18n key. It underscores the model name
and then returns it as a symbol.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">i18n_key</span>
<span class="p">=&gt;</span> <span class="ss">:person</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">route_key</code></strong> returns a string to use while generating route names.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">route_key</span>
<span class="p">=&gt;</span> <span class="s2">"people"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">singular_route_key</code></strong> returns a string to use while generating route names.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">singular_route_key</span>
<span class="p">=&gt;</span> <span class="s2">"person"</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">uncountable?</code></strong> identifies whether the class name of a record or class is
uncountable.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">model_name</span><span class="p">.</span><span class="nf">uncountable?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>
</code></pre></div></div>

<p>NOTE: Some <code class="language-plaintext highlighter-rouge">Naming</code> methods, like <code class="language-plaintext highlighter-rouge">param_key</code>, <code class="language-plaintext highlighter-rouge">route_key</code> and
<code class="language-plaintext highlighter-rouge">singular_route_key</code>, differ for namespaced models based on whether it’s inside
an isolated <a href="engines.html">Engine</a>.</p>

<h4 id="customize-the-name-of-the-model">Customize the Name of the Model</h4>

<p>Sometimes you may want to customize the name of the model that is used in form
helpers and URL generation. This can be useful in situations where you want to
use a more user-friendly name for the model, while still being able to reference
it using its full namespace.</p>

<p>For example, let’s say you have a <code class="language-plaintext highlighter-rouge">Person</code> namespace in your Rails application,
and you want to create a form for a new <code class="language-plaintext highlighter-rouge">Person::Profile</code>.</p>

<p>By default, Rails would generate the form with the URL <code class="language-plaintext highlighter-rouge">/person/profiles</code>, which
includes the namespace <code class="language-plaintext highlighter-rouge">person</code>. However, if you want the URL to simply point to
<code class="language-plaintext highlighter-rouge">profiles</code> without the namespace, you can customize the <code class="language-plaintext highlighter-rouge">model_name</code> method like
this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">Person</span>
  <span class="k">class</span> <span class="nc">Profile</span>
    <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Model</span>

    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">model_name</span>
      <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Name</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="nb">self</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="s2">"Profile"</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>With this setup, when you use the <code class="language-plaintext highlighter-rouge">form_with</code> helper to create a form for
creating a new <code class="language-plaintext highlighter-rouge">Person::Profile</code>, Rails will generate the form with the URL
<code class="language-plaintext highlighter-rouge">/profiles</code> instead of <code class="language-plaintext highlighter-rouge">/person/profiles</code>, because the <code class="language-plaintext highlighter-rouge">model_name</code> method has
been overridden to return <code class="language-plaintext highlighter-rouge">Profile</code>.</p>

<p>In addition, the path helpers will be generated without the namespace, so you
can use <code class="language-plaintext highlighter-rouge">profiles_path</code> instead of <code class="language-plaintext highlighter-rouge">person_profiles_path</code> to generate the URL
for the <code class="language-plaintext highlighter-rouge">profiles</code> resource. To use the <code class="language-plaintext highlighter-rouge">profiles_path</code> helper, you need to
define the routes for the <code class="language-plaintext highlighter-rouge">Person::Profile</code> model in your <code class="language-plaintext highlighter-rouge">config/routes.rb</code>
file like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:profiles</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Consequently, you can expect the model to return the following values for
methods that were described in the previous section:</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="nb">name</span> <span class="o">=</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Name</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">Person</span><span class="o">::</span><span class="no">Profile</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="s2">"Profile"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kt">#&lt;</span><span class="no">ActiveModel</span><span class="o">::</span><span class="no">Name</span><span class="p">:</span><span class="mh">0x000000014c5dbae0</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="nb">name</span><span class="p">.</span><span class="nf">singular</span>
<span class="p">=&gt;</span> <span class="s2">"profile"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="nb">name</span><span class="p">.</span><span class="nf">singular_route_key</span>
<span class="p">=&gt;</span> <span class="s2">"profile"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="nb">name</span><span class="p">.</span><span class="nf">route_key</span>
<span class="p">=&gt;</span> <span class="s2">"profiles"</span>
</code></pre></div></div>

<h3 id="securepassword">SecurePassword</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/SecurePassword.html"><code class="language-plaintext highlighter-rouge">ActiveModel::SecurePassword</code></a>
provides a way to securely store any password in an encrypted form. When you
include this module, a <code class="language-plaintext highlighter-rouge">has_secure_password</code> class method is provided which
defines a <code class="language-plaintext highlighter-rouge">password</code> accessor with certain validations on it by default.</p>

<p><code class="language-plaintext highlighter-rouge">ActiveModel::SecurePassword</code> depends on
<a href="https://github.com/bcrypt-ruby/bcrypt-ruby" title="BCrypt"><code class="language-plaintext highlighter-rouge">bcrypt</code></a>, so include this
gem in your <code class="language-plaintext highlighter-rouge">Gemfile</code> to use it.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gem</span> <span class="s2">"bcrypt"</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">ActiveModel::SecurePassword</code> requires you to have a <code class="language-plaintext highlighter-rouge">password_digest</code>
attribute.</p>

<p>The following validations are added automatically:</p>

<ol>
  <li>Password must be present on creation.</li>
  <li>Confirmation of password (using a <code class="language-plaintext highlighter-rouge">password_confirmation</code> attribute).</li>
  <li>The maximum length of a password is 72 bytes (required as <code class="language-plaintext highlighter-rouge">bcrypt</code> truncates
the string to this size before encrypting it).</li>
</ol>

<p>NOTE: If password confirmation validation is not needed, simply leave out the
value for <code class="language-plaintext highlighter-rouge">password_confirmation</code> (i.e. don’t provide a form field for it). When
this attribute has a <code class="language-plaintext highlighter-rouge">nil</code> value, the validation will not be triggered.</p>

<p>For further customization, it is possible to suppress the default validations by
passing <code class="language-plaintext highlighter-rouge">validations: false</code> as an argument.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">SecurePassword</span>

  <span class="n">has_secure_password</span>
  <span class="n">has_secure_password</span> <span class="ss">:recovery_password</span><span class="p">,</span> <span class="ss">validations: </span><span class="kp">false</span>

  <span class="nb">attr_accessor</span> <span class="ss">:password_digest</span><span class="p">,</span> <span class="ss">:recovery_password_digest</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="c"># When password is blank.
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="c"># When the confirmation doesn't match the password.
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">password</span> <span class="o">=</span> <span class="s2">"aditya"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">password_confirmation</span> <span class="o">=</span> <span class="s2">"nomatch"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="c"># When the length of password exceeds 72.
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">password</span> <span class="o">=</span> <span class="n">person</span><span class="p">.</span><span class="nf">password_confirmation</span> <span class="o">=</span> <span class="s2">"a"</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="c"># When only password is supplied with no password_confirmation.
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">password</span> <span class="o">=</span> <span class="s2">"aditya"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="kp">true</span>

<span class="c"># When all validations are passed.
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">password</span> <span class="o">=</span> <span class="n">person</span><span class="p">.</span><span class="nf">password_confirmation</span> <span class="o">=</span> <span class="s2">"aditya"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="kp">true</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">recovery_password</span> <span class="o">=</span> <span class="s2">"42password"</span>
<span class="err">
</span><span class="c"># `authenticate` is an alias for `authenticate_password`
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">authenticate</span><span class="p">(</span><span class="s2">"aditya"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kt">#&lt;</span><span class="no">Person</span><span class="kt">&gt;</span> <span class="c1"># == person</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">authenticate</span><span class="p">(</span><span class="s2">"notright"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kp">false</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">authenticate_password</span><span class="p">(</span><span class="s2">"aditya"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kt">#&lt;</span><span class="no">Person</span><span class="kt">&gt;</span> <span class="c1"># == person</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">authenticate_password</span><span class="p">(</span><span class="s2">"notright"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">authenticate_recovery_password</span><span class="p">(</span><span class="s2">"aditya"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kp">false</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">authenticate_recovery_password</span><span class="p">(</span><span class="s2">"42password"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kt">#&lt;</span><span class="no">Person</span><span class="kt">&gt;</span> <span class="c1"># == person</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">authenticate_recovery_password</span><span class="p">(</span><span class="s2">"notright"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">password_digest</span>
<span class="p">=&gt;</span> <span class="s2">"$2a$04$gF8RfZdoXHvyTjHhiU4ZsO.kQqV9oonYZu31PRE4hLQn3xM2qkpIy"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">recovery_password_digest</span>
<span class="p">=&gt;</span> <span class="s2">"$2a$04$iOfhwahFymCs5weB3BNH/uXkTG65HR.qpW.bNhEjFP3ftli3o5DQC"</span>
</code></pre></div></div>

<h3 id="serialization">Serialization</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Serialization.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Serialization</code></a>
provides basic serialization for your object. You need to declare an attributes
hash that contains the attributes you want to serialize. Attributes must be
strings, not symbols.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serialization</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:age</span>

  <span class="k">def</span> <span class="nf">attributes</span>
    <span class="c1"># Declaration of attributes that will be serialized</span>
    <span class="p">{</span> <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span> <span class="s2">"age"</span> <span class="o">=&gt;</span> <span class="kp">nil</span> <span class="p">}</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">capitalized_name</span>
    <span class="c1"># Declared methods can be later included in the serialized hash</span>
    <span class="nb">name</span><span class="o">&amp;</span><span class="p">.</span><span class="nf">capitalize</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now you can access a serialized hash of your object using the
<code class="language-plaintext highlighter-rouge">serializable_hash</code> method. Valid options for <code class="language-plaintext highlighter-rouge">serializable_hash</code> include
<code class="language-plaintext highlighter-rouge">:only</code>, <code class="language-plaintext highlighter-rouge">:except</code>, <code class="language-plaintext highlighter-rouge">:methods</code> and <code class="language-plaintext highlighter-rouge">:include</code>.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">serializable_hash</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span> <span class="s2">"age"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">}</span>

<span class="c"># Set the name and age attributes and serialize the object
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s2">"bob"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">age</span> <span class="o">=</span> <span class="mi">22</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">serializable_hash</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"bob"</span><span class="p">,</span> <span class="s2">"age"</span> <span class="o">=&gt;</span> <span class="mi">22</span><span class="p">}</span>

<span class="c"># Use the methods option to include the capitalized_name method
</span><span class="gp">irb&gt;</span><span class="w">  </span><span class="n">person</span><span class="p">.</span><span class="nf">serializable_hash</span><span class="p">(</span><span class="ss">methods: :capitalized_name</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"bob"</span><span class="p">,</span> <span class="s2">"age"</span> <span class="o">=&gt;</span> <span class="mi">22</span><span class="p">,</span> <span class="s2">"capitalized_name"</span> <span class="o">=&gt;</span> <span class="s2">"Bob"</span><span class="p">}</span>

<span class="c"># Use the only method to include only the name attribute
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">serializable_hash</span><span class="p">(</span><span class="ss">only: :name</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"bob"</span><span class="p">}</span>

<span class="c"># Use the except method to exclude the name attribute
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">serializable_hash</span><span class="p">(</span><span class="ss">except: :name</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"age"</span> <span class="o">=&gt;</span> <span class="mi">22</span><span class="p">}</span>
</code></pre></div></div>

<p>The example to utilize the <code class="language-plaintext highlighter-rouge">includes</code> option requires a slightly more complex
scenario as defined below:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">Person</span>
    <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serialization</span>
    <span class="nb">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:notes</span> <span class="c1"># Emulate has_many :notes</span>

    <span class="k">def</span> <span class="nf">attributes</span>
      <span class="p">{</span> <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="kp">nil</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">class</span> <span class="nc">Note</span>
    <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serialization</span>
    <span class="nb">attr_accessor</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">:text</span>

    <span class="k">def</span> <span class="nf">attributes</span>
      <span class="p">{</span> <span class="s2">"title"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span> <span class="s2">"text"</span> <span class="o">=&gt;</span> <span class="kp">nil</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">note</span> <span class="o">=</span> <span class="no">Note</span><span class="p">.</span><span class="nf">new</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">note</span><span class="p">.</span><span class="nf">title</span> <span class="o">=</span> <span class="s2">"Weekend Plans"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">note</span><span class="p">.</span><span class="nf">text</span> <span class="o">=</span> <span class="s2">"Some text here"</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s2">"Napoleon"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">notes</span> <span class="o">=</span> <span class="p">[</span><span class="n">note</span><span class="p">]</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">serializable_hash</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Napoleon"</span><span class="p">}</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">serializable_hash</span><span class="p">(</span><span class="ss">include: </span><span class="p">{</span> <span class="ss">notes: </span><span class="p">{</span> <span class="ss">only: </span><span class="s2">"title"</span> <span class="p">}})</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Napoleon"</span><span class="p">,</span> <span class="s2">"notes"</span> <span class="o">=&gt;</span> <span class="p">[{</span><span class="s2">"title"</span> <span class="o">=&gt;</span> <span class="s2">"Weekend Plans"</span><span class="p">}]}</span>
</code></pre></div></div>

<h4 id="activemodelserializersjson">ActiveModel::Serializers::JSON</h4>

<p>Active Model also provides the
<a href="https://api.rubyonrails.org/classes/ActiveModel/Serializers/JSON.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Serializers::JSON</code></a>
module for JSON serializing / deserializing.</p>

<p>To use the JSON serialization, change the module you are including from
<code class="language-plaintext highlighter-rouge">ActiveModel::Serialization</code> to <code class="language-plaintext highlighter-rouge">ActiveModel::Serializers::JSON</code>. It already
includes the former, so there is no need to explicitly include it.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serializers</span><span class="o">::</span><span class="no">JSON</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span>

  <span class="k">def</span> <span class="nf">attributes</span>
    <span class="p">{</span> <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="kp">nil</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">as_json</code> method, similar to <code class="language-plaintext highlighter-rouge">serializable_hash</code>, provides a hash
representing the model with its keys as a string. The <code class="language-plaintext highlighter-rouge">to_json</code> method returns a
JSON string representing the model.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="c"># A hash representing the model with its keys as a string
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">as_json</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">}</span>

<span class="c"># A JSON string representing the model
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">to_json</span>
<span class="p">=&gt;</span> <span class="s2">"{</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">:null}"</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s2">"Bob"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">as_json</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Bob"</span><span class="p">}</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">to_json</span>
<span class="p">=&gt;</span> <span class="s2">"{</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Bob</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre></div></div>

<p>You can also define the attributes for a model from a JSON string. To do that,
first define the <code class="language-plaintext highlighter-rouge">attributes=</code> method in your class:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serializers</span><span class="o">::</span><span class="no">JSON</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span>

  <span class="k">def</span> <span class="nf">attributes</span><span class="o">=</span><span class="p">(</span><span class="nb">hash</span><span class="p">)</span>
    <span class="nb">hash</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
      <span class="n">public_send</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">key</span><span class="si">}</span><span class="s2">="</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">attributes</span>
    <span class="p">{</span> <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="kp">nil</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now it is possible to create an instance of <code class="language-plaintext highlighter-rouge">Person</code> and set attributes using
<code class="language-plaintext highlighter-rouge">from_json</code>.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">json</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">name: </span><span class="s2">"Bob"</span> <span class="p">}.</span><span class="nf">to_json</span>
<span class="p">=&gt;</span> <span class="s2">"{</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Bob</span><span class="se">\"</span><span class="s2">}"</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">from_json</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
<span class="gp">=&gt; #&lt;Person:0x00000100c773f0 @name="Bob"&gt;</span><span class="w">
</span><span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span>
<span class="p">=&gt;</span> <span class="s2">"Bob"</span>
</code></pre></div></div>

<h3 id="translation">Translation</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Translation.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Translation</code></a>
provides integration between your object and the <a href="i18n.html">Rails internationalization
(i18n) framework</a>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Translation</span>
<span class="k">end</span>
</code></pre></div></div>

<p>With the <code class="language-plaintext highlighter-rouge">human_attribute_name</code> method, you can transform attribute names into a
more human-readable format. The human-readable format is defined in your locale
file(s).</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/locales/app.pt-BR.yml</span>
<span class="na">pt-BR</span><span class="pi">:</span>
  <span class="na">activemodel</span><span class="pi">:</span>
    <span class="na">attributes</span><span class="pi">:</span>
      <span class="na">person</span><span class="pi">:</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Nome"</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">human_attribute_name</span><span class="p">(</span><span class="s2">"name"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="s2">"Name"</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="no">I18n</span><span class="p">.</span><span class="nf">locale</span> <span class="o">=</span> <span class="ss">:"pt-BR"</span>
<span class="p">=&gt;</span> <span class="ss">:"pt-BR"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="no">Person</span><span class="p">.</span><span class="nf">human_attribute_name</span><span class="p">(</span><span class="s2">"name"</span><span class="p">)</span>
<span class="p">=&gt;</span> <span class="s2">"Nome"</span>
</code></pre></div></div>

<h3 id="validations">Validations</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Validations.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Validations</code></a>
adds the ability to validate objects and it is important for ensuring data
integrity and consistency within your application. By incorporating validations
into your models, you can define rules that govern the correctness of attribute
values, and prevent invalid data.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Validations</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:token</span>

  <span class="n">validates</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>
  <span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">format: </span><span class="p">{</span> <span class="ss">with: </span><span class="no">URI</span><span class="o">::</span><span class="no">MailTo</span><span class="o">::</span><span class="no">EMAIL_REGEXP</span> <span class="p">}</span>
  <span class="n">validates!</span> <span class="ss">:token</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">token</span> <span class="o">=</span> <span class="s2">"2b1f325"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s2">"Jane Doe"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">email</span> <span class="o">=</span> <span class="s2">"me"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="kp">false</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">email</span> <span class="o">=</span> <span class="s2">"jane.doe@gmail.com"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="kp">true</span>

<span class="c"># `token` uses validate! and will raise an exception when not set.
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">token</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="s2">"Token can't be blank (ActiveModel::StrictValidationFailed)"</span>
</code></pre></div></div>

<h4 id="validation-methods-and-options">Validation Methods and Options</h4>

<p>You can add validations using some of the following methods:</p>

<ul>
  <li>
    <p><a href="https://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validate"><code class="language-plaintext highlighter-rouge">validate</code></a>:
Adds validation through a method or a block to the class.</p>
  </li>
  <li>
    <p><a href="https://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates"><code class="language-plaintext highlighter-rouge">validates</code></a>:
An attribute can be passed to the <code class="language-plaintext highlighter-rouge">validates</code> method and it provides a
shortcut to all default validators.</p>
  </li>
  <li>
    <p><a href="https://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates-21"><code class="language-plaintext highlighter-rouge">validates!</code></a>
or setting <code class="language-plaintext highlighter-rouge">strict: true</code>: Used to define validations that cannot be corrected
by end users and are considered exceptional. Each validator defined with a
bang or <code class="language-plaintext highlighter-rouge">:strict</code> option set to true will always raise
<code class="language-plaintext highlighter-rouge">ActiveModel::StrictValidationFailed</code> instead of adding to the errors when
validation fails.</p>
  </li>
  <li>
    <p><a href="https://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates_with"><code class="language-plaintext highlighter-rouge">validates_with</code></a>:
Passes the record off to the class or classes specified and allows them to add
errors based on more complex conditions.</p>
  </li>
  <li>
    <p><a href="https://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates_each"><code class="language-plaintext highlighter-rouge">validates_each</code></a>:
Validates each attribute against a block.</p>
  </li>
</ul>

<p>Some of the options below can be used with certain validators. To determine if
the option you’re using can be used with a specific validator, read through <a href="https://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html">the
validation
documentation</a>.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:on</code>: Specifies the context in which to add the validation. You can pass a
symbol or an array of symbols. (e.g. <code class="language-plaintext highlighter-rouge">on: :create</code> or <code class="language-plaintext highlighter-rouge">on:
:custom_validation_context</code> or <code class="language-plaintext highlighter-rouge">on: [:create, :custom_validation_context]</code>).
Validations without an <code class="language-plaintext highlighter-rouge">:on</code> option will run no matter the context. Validations
with some <code class="language-plaintext highlighter-rouge">:on</code> option will only run in the specified context. You can pass the
context when validating via <code class="language-plaintext highlighter-rouge">valid?(:context)</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:if</code>: Specifies a method, proc or string to call to determine if the
validation should occur (e.g. <code class="language-plaintext highlighter-rouge">if: :allow_validation</code>, or <code class="language-plaintext highlighter-rouge">if: -&gt; {
signup_step &gt; 2 }</code>). The method, proc or string should return or evaluate to a
<code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> value.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:unless</code>: Specifies a method, proc or string to call to determine if the
validation should not occur (e.g. <code class="language-plaintext highlighter-rouge">unless: :skip_validation</code>, or <code class="language-plaintext highlighter-rouge">unless:
Proc.new { |user| user.signup_step &lt;= 2 }</code>). The method, proc or string should
return or evaluate to a <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> value.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:allow_nil</code>: Skip the validation if the attribute is <code class="language-plaintext highlighter-rouge">nil</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:allow_blank</code>: Skip the validation if the attribute is blank.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">:strict</code>: If the <code class="language-plaintext highlighter-rouge">:strict</code> option is set to true, it will raise
<code class="language-plaintext highlighter-rouge">ActiveModel::StrictValidationFailed</code> instead of adding the error. <code class="language-plaintext highlighter-rouge">:strict</code>
option can also be set to any other exception.</p>
  </li>
</ul>

<p>NOTE: Calling <code class="language-plaintext highlighter-rouge">validate</code> multiple times on the same method will overwrite
previous definitions.</p>

<h4 id="errors">Errors</h4>

<p><code class="language-plaintext highlighter-rouge">ActiveModel::Validations</code> automatically adds an <code class="language-plaintext highlighter-rouge">errors</code> method to your
instances initialized with a new
<a href="https://api.rubyonrails.org/classes/ActiveModel/Errors.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Errors</code></a>
object, so there is no need for you to do this manually.</p>

<p>Run <code class="language-plaintext highlighter-rouge">valid?</code> on the object to check if the object is valid or not. If the object
is not valid, it will return <code class="language-plaintext highlighter-rouge">false</code> and the errors will be added to the
<code class="language-plaintext highlighter-rouge">errors</code> object.</p>

<div class="language-irb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
<span class="err">
</span><span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">email</span> <span class="o">=</span> <span class="s2">"me"</span>
<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">valid?</span>
<span class="p">=&gt;</span> <span class="c1"># Raises Token can't be blank (ActiveModel::StrictValidationFailed)</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">errors</span><span class="p">.</span><span class="nf">to_hash</span>
<span class="p">=&gt;</span> <span class="p">{</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"can't be blank"</span><span class="p">],</span> <span class="ss">:email</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"is invalid"</span><span class="p">]}</span>

<span class="gp">irb&gt;</span><span class="w"> </span><span class="n">person</span><span class="p">.</span><span class="nf">errors</span><span class="p">.</span><span class="nf">full_messages</span>
<span class="p">=&gt;</span> <span class="p">[</span><span class="s2">"Name can't be blank"</span><span class="p">,</span> <span class="s2">"Email is invalid"</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="lint-tests">Lint Tests</h3>

<p><a href="https://api.rubyonrails.org/classes/ActiveModel/Lint/Tests.html"><code class="language-plaintext highlighter-rouge">ActiveModel::Lint::Tests</code></a>
allows you to test whether an object is compliant with the Active Model API. By
including <code class="language-plaintext highlighter-rouge">ActiveModel::Lint::Tests</code> in your TestCase, it will include tests
that tell you whether your object is fully compliant, or if not, which aspects
of the API are not implemented.</p>

<p>These tests do not attempt to determine the semantic correctness of the returned
values. For instance, you could implement <code class="language-plaintext highlighter-rouge">valid?</code> to always return <code class="language-plaintext highlighter-rouge">true</code>, and
the tests would pass. It is up to you to ensure that the values are semantically
meaningful.</p>

<p>Objects you pass in are expected to return a compliant object from a call to
<code class="language-plaintext highlighter-rouge">to_model</code>. It is perfectly fine for <code class="language-plaintext highlighter-rouge">to_model</code> to return <code class="language-plaintext highlighter-rouge">self</code>.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">app/models/person.rb</code></p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">Person</span>
    <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">API</span>
  <span class="k">end</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">test/models/person_test.rb</code></p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">require</span> <span class="s2">"test_helper"</span>

  <span class="k">class</span> <span class="nc">PersonTest</span> <span class="o">&lt;</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">TestCase</span>
    <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Lint</span><span class="o">::</span><span class="no">Tests</span>

    <span class="n">setup</span> <span class="k">do</span>
      <span class="vi">@model</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>See <a href="https://api.rubyonrails.org/classes/ActiveModel/Lint/Tests.html">the test methods
documentation</a>
for more details.</p>

<p>To run the tests you can use the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bin/rails <span class="nb">test

</span>Run options: <span class="nt">--seed</span> 14596

<span class="c"># Running:</span>

......

Finished <span class="k">in </span>0.024899s, 240.9735 runs/s, 1204.8677 assertions/s.

6 runs, 30 assertions, 0 failures, 0 errors, 0 skips
</code></pre></div></div>
</div>

    <footer class="guide-footer">
      <div class="feedback">
        <h3>Geri Bildirim</h3>
        <p>
          Bu kılavuzun kalitesini artırmamıza yardımcı olmak için geri
          bildirimlerinizi bekliyoruz.
        </p>
        <p>
          Lütfen
          <a href="https://github.com/dilankaya127/rails-tr-TR"
            >GitHub Issues</a
          >
          üzerinden katkıda bulunun.
        </p>
      </div>
    </footer>
  </article>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toc = document.getElementById("toc");
    const headings = document.querySelectorAll(
      ".guide-content h2, .guide-content h3, .guide-content h4"
    );

    if (headings.length > 0) {
      const tocList = document.createElement("ul");
      const headingMap = new Map();

      headings.forEach(function (heading, index) {
        const id = "heading-" + index;
        heading.id = id;

        const li = document.createElement("li");
        const a = document.createElement("a");
        a.href = "#" + id;
        a.textContent = heading.textContent;
        a.className = "toc-" + heading.tagName.toLowerCase();

        li.appendChild(a);
        tocList.appendChild(li);

        headingMap.set(id, a);
      });

      toc.appendChild(tocList);

      // Başlıkların görünürlük oranlarını takip et
      const visibilityMap = new Map();

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const id = entry.target.getAttribute("id");
            visibilityMap.set(id, entry.intersectionRatio);
          });

          // En çok görünür olan başlığı bul
          let mostVisibleId = null;
          let maxRatio = 0;

          visibilityMap.forEach((ratio, id) => {
            if (ratio > maxRatio) {
              mostVisibleId = id;
              maxRatio = ratio;
            }
          });

          if (mostVisibleId) {
            headingMap.forEach((linkEl) => linkEl.classList.remove("active"));
            const activeLink = headingMap.get(mostVisibleId);
            if (activeLink) {
              activeLink.classList.add("active");

              // Ortalamak için:
              const linkTop = activeLink.offsetTop;
              const linkHeight = activeLink.offsetHeight;
              const tocScrollParent = toc;
              const tocHeight = tocScrollParent.offsetHeight;

              tocScrollParent.scrollTo({
                top: linkTop - tocHeight / 2 + linkHeight / 2,
                behavior: "smooth",
              });
            }
          }
        },
        {
          threshold: [0, 0.25, 0.5, 0.75, 1.0],
        }
      );

      headings.forEach((heading) => {
        observer.observe(heading);
      });

      const toggleBtn = document.getElementById("toc-toggle");
      const sidebar = document.querySelector(".guide-sidebar");

      toggleBtn.addEventListener("click", function () {
        sidebar.classList.toggle("open");
      });
      const closeBtn = document.querySelector(".toc-close");

      closeBtn?.addEventListener("click", function () {
        sidebar.classList.remove("open");
      });
    }
  });
</script>

        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Rails Kılavuzları Türkçe Çevirisi. Gönüllüler tarafından hazırlanmıştır.</p>
            <p>Orijinal dokümantasyon <a href="https://guides.rubyonrails.org">Ruby on Rails</a> ekibine aittir.</p>
        </div>
    </footer>

    <script>hljs.highlightAll();</script>
</body>
</html>